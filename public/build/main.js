var dtp=function(){"use strict";const e=window.L;e.Control.GmxIcon=e.Control.extend({includes:e.Evented?e.Evented.prototype:e.Mixin.Events,options:{position:"topleft",id:"defaultIcon",isActive:!1},setActive:function(t,n,o){var l=this.options,s=this._container;if(l.togglable||l.toggle){var r=l.isActive,i=this._prefix,a=i+"-"+l.id;l.isActive=t,this._img&&(t&&l.activeImageUrl?this._img.src=l.activeImageUrl:!t&&l.regularImageUrl&&(this._img.src=l.regularImageUrl)),t?(e.DomUtil.addClass(s,i+"-active"),e.DomUtil.addClass(s,a+"-active"),s.children.length&&e.DomUtil.addClass(s,i+"-externalImage-active"),l.styleActive&&this.setStyle(l.styleActive)):(e.DomUtil.removeClass(s,i+"-active"),e.DomUtil.removeClass(s,a+"-active"),s.children.length&&e.DomUtil.removeClass(s,i+"-externalImage-active"),l.style&&this.setStyle(l.style)),n||r===t||this.fire("statechange",o)}if(e.gmxUtil&&e.gmxUtil.isIEOrEdge){var c=s.getElementsByTagName("use");if(c.length){var p=c[0],d=p.getAttribute("href")||p.getAttribute("xlink:href");p.setAttribute("href",d)}}},onAdd:function(t){var n=null,o=this.options,l=o.svgSprite||t.options.svgSprite,s="leaflet-gmx-icon"+(!l||o.regularImageUrl||o.text?"":"Svg"),r=s+"-"+o.id;this._prefix=s;var i=e.DomUtil.create("div",s+" "+r);if(i._id=o.id,this._container=i,o.title&&(i.title=o.title),this.setStyle=function(e){for(var t in e)i.style[t]=e[t]},o.className&&e.DomUtil.addClass(i,o.className),o.regularImageUrl)(n=e.DomUtil.create("img","",i)).src=o.regularImageUrl,this._img=n,e.DomUtil.addClass(i,s+"-img"),e.DomUtil.addClass(i,s+"-externalImage");else if(o.text)e.DomUtil.addClass(i,s+"-text"),e.DomUtil.create("span","",i).innerHTML=o.text;else if(l){e.DomUtil.addClass(i,"svgIcon");var a="#"+o.id.toLowerCase();i.innerHTML='<svg role="img" class="svgIcon"><use xlink:href="'+a+'" href="'+a+'"></use></svg>'}else e.DomUtil.addClass(i,s+"-img "+s+"-sprite");o.style&&this.setStyle(o.style),this._iconClick=function(e){i.parentNode&&i===e.toElement&&(this.setActive(!this.options.isActive,!1,e),this.fire("click",e),this.options.stateChange&&this.options.stateChange(this,e))};var c=e.DomEvent.stopPropagation;e.DomEvent.preventDefault;return e.DomEvent.on(i,"mousemove",c).on(i,"touchstart",c).on(i,"mousedown",c).on(i,"dblclick",c).on(i,"click",c).on(i,"click",this._iconClick,this),o.onAdd&&o.onAdd(this),this.fire("controladd"),t.fire("controladd",this),o.notHide&&(i._notHide=!0),t.gmxControlsManager&&t.gmxControlsManager.add(this),i},onRemove:function(t){t.gmxControlsManager&&t.gmxControlsManager.remove(this),this.fire("controlremove"),t.fire("controlremove",this);var n=this._container,o=e.DomEvent.stopPropagation;e.DomEvent.off(n,"mousemove",o).off(n,"touchstart",o).off(n,"mousedown",o).off(n,"dblclick",o).off(n,"click",o).off(n,"click",this._iconClick,this)},addTo:function(t){return e.Control.prototype.addTo.call(this,t),this.options.addBefore&&this.addBefore(this.options.addBefore),this},addBefore:function(e){var t=this._parent&&this._parent._container;if(t||(t=this._map&&this._map._controlCorners[this.getPosition()]),t)for(var n=0,o=t.childNodes.length;n<o;n++){var l=t.childNodes[n];if(e===l._id){t.insertBefore(this._container,l);break}}else this.options.addBefore=e;return this}}),e.Control.gmxIcon=e.Control.GmxIcon,e.control.gmxIcon=function(t){return new e.Control.GmxIcon(t)};const t=window.L;t.Control.GmxCenter=t.Control.extend({options:{position:"center",id:"center",notHide:!0,color:"red"},onRemove:function(e){e.gmxControlsManager&&e.gmxControlsManager.remove(this),e.fire("controlremove",this)},onAdd:function(e){var n="http://www.w3.org/2000/svg",o=t.DomUtil.create("div","leaflet-gmx-center"),l=t.DomUtil.create("div","leaflet-gmx-center"),s=document.createElementNS(n,"svg"),r=document.createElementNS(n,"g"),i=document.createElementNS(n,"path");return this._container=o,o._id=this.options.id,this.options.notHide&&(o._notHide=!0),i.setAttribute("stroke-width",2),i.setAttribute("stroke-opacity",2),i.setAttribute("d","M9 0L9 18M0 9L18 9"),this._path=i,r.appendChild(i),s.appendChild(r),s.setAttribute("width",18),s.setAttribute("height",18),l.appendChild(s),o.appendChild(l),this.setColor(this.options.color),e.fire("controladd",this),e.gmxControlsManager&&e.gmxControlsManager.add(this),o},setColor:function(e){return this.options.color=e,this._map&&this._path.setAttribute("stroke",e),this}}),t.Control.gmxCenter=t.Control.GmxCenter,t.control.gmxCenter=function(e){return new t.Control.GmxCenter(e)};const n=window.L;n.Control.FitCenter=n.Control.extend({options:{position:"topright",id:"fitcenter",notHide:!0,color:"#216b9c"},onRemove:function(e){e.gmxControlsManager&&e.gmxControlsManager.remove(this),e.off("moveend",this._update,this).fire("controlremove",this)},onAdd:function(e){var t=this.options.id,o="leaflet-gmx-"+t,l=n.DomUtil.create("div",o),s=n.DomUtil.create("input","",l),r=n.DomUtil.create("button","",l),i=n.DomUtil.create("div","results",l);return r.title="Переместить центр карты",s.placeholder="Поиск по адресам, координатам",this._input=s,this._container=l,this._results=i,l._id=t,e.on("mousemove",e=>{this._results.style.display="none"},this),n.DomEvent.on(s,"input",this._getSuggestions,this),n.DomEvent.on(s,"contextmenu",n.DomEvent.stopPropagation,this),n.DomEvent.on(l,"mousemove",n.DomEvent.stop),n.DomEvent.on(l,"mouseover",e=>{"block"!==this._results.style.display&&(this._results.style.display="block")},this),n.DomEvent.on(r,"click",(function(){let t=s.value.match(/[+-]?([0-9]*[.])?[0-9]+/g);t&&t.length>1&&e.setView([Number(t[0]),Number(t[1])])})),n.DomEvent.disableClickPropagation(l),e.on("moveend",this._update,this).fire("controladd",this),e.gmxControlsManager&&e.gmxControlsManager.add(this),l},_parseSearch:function(e){if((e=e||[]).length){this._results;let t=document.createDocumentFragment();e.forEach(e=>{let o=e.display_name,l=e.boundingbox,s=n.DomUtil.create("div","",t);s.innerHTML=o,n.DomEvent.on(s,"click",e=>{this._map.fitBounds([[l[0],l[2]],[l[1],l[3]]])},this)}),this._results.innerText="",this._results.appendChild(t),this._results.classList.add("active")}},_getSuggestions:function(e){const t=e.target.value||"калужское шоссе",n=["format=json","limit=10","polygon_text=1","bounded=1","viewbox=34,53,41,57"].join("&"),o="&q="+encodeURI(t);fetch(`//nominatim.openstreetmap.org/search?${n}${o}`,{}).then(e=>e.json()).then(this._parseSearch.bind(this))},_update:function(e){this._map&&this.setCoords(this._map.getCenter())},_trunc:function(e){return(""+(Math.round(1e7*e)/1e7+1e-8)).substring(0,9)},setCoords:function(e){return this}}),n.control.fitCenter=function(e){return new n.Control.FitCenter(e)};const o='&copy; <a href="https://n.maps.yandex.ru/?oid=1900133#!/?z=18&ll=36.860478%2C55.429679&l=nk%23map">Yandex</a> contributors',l="//inv.mvs.group/mapcache/",s=new Date,r=s.getMonth()+1,i=s.getDate(),a=(s.getFullYear(),{m1:{title:"Дороги",prefix:l+"m1/",postfix:"?x={x}&y={y}&z={z}&l=mrcss",errorTileUrlPrefix:"//core-nmaps-mrc-browser.maps.yandex.ru/tiles",options:{key:"m1",minZoom:10,maxZoom:19,attribution:o}},m2:{title:"Карта(Яндекс)",prefix:l+"m2/tiles",postfix:"?l=map&v=18.01.10-2&x={x}&y={y}&z={z}&scale=1&lang=ru_RU",errorTileUrlPrefix:"//vec01.maps.yandex.net/tiles",options:{key:"m2",maxNativeZoom:19,maxZoom:21,attribution:o}},m3:{title:"Снимки(Яндекс)",prefix:l+"m3/tiles",postfix:"?l=sat&v=3.462.0&x={x}&y={y}&z={z}&lang=ru_RU",errorTileUrlPrefix:"//sat04.maps.yandex.net/tiles",options:{key:"m3",maxNativeZoom:19,maxZoom:21,attribution:o}},m4:{title:"Скорость(Народная карта)",prefix:l+"m4/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=104,301135,302526,302827,5300026,5400046,70300236,70300638",errorTileUrlPrefix:"//04.core-nmaps-renderer-nmaps.maps.yandex.net/tile",options:{key:"m4",minZoom:8,maxZoom:19,attribution:o}},m5:{title:"Светофоры",prefix:l+"m5/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=301750",errorTileUrlPrefix:"//04.core-nmaps-renderer-nmaps.maps.yandex.net/tile",options:{key:"m4",minZoom:12,maxZoom:19,attribution:o}},m6:{title:"Дороги в стадии строительства",prefix:"//03.core-nmaps-renderer-nmaps.maps.yandex.net/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=70300289",errorTileUrlPrefix:"//03.core-nmaps-renderer-nmaps.maps.yandex.net/",options:{key:"m6",minZoom:10,maxZoom:19,attribution:o}}}),c={};window.URLSearchParams&&new URLSearchParams(window.location.search).forEach((e,t)=>{c[t]=e});const p=window.L;let d=p.canvas();const u=function(e,t){var n=p.Projection.Mercator.project(t),o=p.Projection.Mercator.unproject(new p.Point(n.x+40,n.y+30));return 156543.033928041*Math.pow(2,-e)*((e,t)=>{for(var n=Math.PI/180,o={lon:n*e.lng,lat:n*e.lat},l={lon:n*t.lng,lat:n*t.lat},s=6378137,r=6356752.3142,i=1/298.257223563,a=l.lon-o.lon,c=Math.atan((1-i)*Math.tan(o.lat)),p=Math.atan((1-i)*Math.tan(l.lat)),d=Math.sin(c),u=Math.cos(c),_=Math.sin(p),h=Math.cos(p),v=a,f=2*Math.PI,m=20;Math.abs(v-f)>1e-12&&--m>0;){var y=Math.sin(v),g=Math.cos(v),b=Math.sqrt(h*y*(h*y)+(u*_-d*h*g)*(u*_-d*h*g));if(0===b)return 0;var x=d*_+u*h*g,k=Math.atan2(b,x),j=u*h*y/b,L=1-j*j,C=x-2*d*_/L;isNaN(C)&&(C=0);var D=i/16*L*(4+i*(4-3*L));f=v,v=a+(1-D)*i*j*(k+D*b*(C+D*x*(2*C*C-1)))}if(0===m)return NaN;var w=L*(s*s/(r*r)-1),T=w/1024*(256+w*(w*(74-47*w)-128));return r*(1+w/16384*(4096+w*(w*(320-175*w)-768)))*(k-T*b*(C+T/4*(x*(2*C*C-1)-T/6*C*(4*b*b-3)*(4*C*C-3))))})(t,o)/50};p.canvas({padding:.5});p.Canvas.include({_updateMarkerPoint:function(e){if(!(!this._drawing||e._empty()||e.feature&&e.feature.properties._isHidden)){var t=e._point,n=e.options._radiusM,o=e.options.image,l=e._map,s=this._ctx,r=e.options.iconName||"border";if(l){if(o){let n=e.options.w||20,l=e.options.h||20;return void s.drawImage(o,t.x-n/2,t.y-l/2,n,l)}let i=l._zoom;n&&!l._rpx&&l._needRound&&(l._rpx=l._needRound*n/u(i,l.getCenter())),l._rpx>20&&l._needRound&&(s.save(),s.beginPath(),s.globalAlpha=.2,s.fillStyle="gray",s.arc(t.x,t.y,l._rpx,0,2*Math.PI),s.fill(),s.stroke(),s.closePath(),s.restore()),i>12&&(s.save(),s.beginPath(),s.globalAlpha=1,s.fillStyle="white",s.arc(t.x,t.y,14,0,2*Math.PI),s.fill(),s.closePath(),s.restore()),s.save(),s.beginPath(),s.translate(t.x-0,t.y-0),this._fillStroke(s,e),s.stroke(iconPaths[r].path),s.globalAlpha=e.options.fillOpacity,s.fill(iconPaths[r].path),s.closePath(),s.restore()}}},_updateCirclePoint:function(e){if(this._drawing&&!e._empty()){var t=e._point,n=e.options,o=n.radius||14,l=2*o,s=(e._map,this._ctx);s.save(),s.beginPath(),s.globalAlpha=1,s.fillStyle=n.fillColor||"red",n.triangle?(s.moveTo(t.x,t.y+o),s.lineTo(t.x+o,t.y-o),s.lineTo(t.x-o,t.y-o),s.lineTo(t.x,t.y+o)):n.rhomb?(s.moveTo(t.x+o,t.y),s.lineTo(t.x,t.y+o),s.lineTo(t.x-o,t.y),s.lineTo(t.x,t.y-o),s.lineTo(t.x+o,t.y)):n.box?s.fillRect(t.x-o,t.y-o,l,l):s.arc(t.x,t.y,o,0,2*Math.PI),s.fill(),n.stroke&&(s.stroke(),n.triangle?(s.moveTo(t.x,t.y+o),s.lineTo(t.x+o,t.y-o),s.lineTo(t.x-o,t.y-o),s.lineTo(t.x,t.y+o)):n.box?s.strokeRect(t.x-o,t.y-o,l,l):s.arc(t.x,t.y,o,0,2*Math.PI)),s.closePath(),s.restore()}}});p.CircleMarker.extend({_updatePath:function(){this._renderer._updateMarkerPoint(this)}});const _=p.CircleMarker.extend({options:{renderer:d},_updatePath:function(){this._renderer._updateCirclePoint(this)}});p.Rectangle.extend({options:{renderer:d}});function h(){}function v(e){return e()}function f(){return Object.create(null)}function m(e){e.forEach(v)}function y(e){return"function"==typeof e}function g(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function b(e){return null==e?"":e}function x(e,t){e.appendChild(t)}function k(e,t,n){e.insertBefore(t,n||null)}function j(e){e.parentNode.removeChild(e)}function C(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function D(e){return document.createElement(e)}function w(e){return document.createTextNode(e)}function T(){return w(" ")}function F(){return w("")}function O(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function E(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function M(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function z(e){return""===e?void 0:+e}function $(e,t){t=""+t,e.data!==t&&(e.data=t)}function P(e,t){(null!=t||e.value)&&(e.value=t)}function S(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function q(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];o.selected=~t.indexOf(o.__value)}}function H(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function U(e){return[].map.call(e.querySelectorAll(":checked"),e=>e.__value)}let B;function N(e){B=e}function A(){if(!B)throw new Error("Function called outside component initialization");return B}function I(e){A().$$.after_update.push(e)}function G(){const e=A();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const l=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);o.slice().forEach(t=>{t.call(e,l)})}}}const Z=[],R=[],Y=[],V=[],J=Promise.resolve();let K=!1;function W(e){Y.push(e)}let Q=!1;const X=new Set;function ee(){if(!Q){Q=!0;do{for(let e=0;e<Z.length;e+=1){const t=Z[e];N(t),te(t.$$)}for(Z.length=0;R.length;)R.pop()();for(let e=0;e<Y.length;e+=1){const t=Y[e];X.has(t)||(X.add(t),t())}Y.length=0}while(Z.length);for(;V.length;)V.pop()();K=!1,Q=!1,X.clear()}}function te(e){if(null!==e.fragment){e.update(),m(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(W)}}const ne=new Set;let oe;function le(){oe={r:0,c:[],p:oe}}function se(){oe.r||m(oe.c),oe=oe.p}function re(e,t){e&&e.i&&(ne.delete(e),e.i(t))}function ie(e,t,n,o){if(e&&e.o){if(ne.has(e))return;ne.add(e),oe.c.push(()=>{ne.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}function ae(e){e&&e.c()}function ce(e,t,n){const{fragment:o,on_mount:l,on_destroy:s,after_update:r}=e.$$;o&&o.m(t,n),W(()=>{const t=l.map(v).filter(y);s?s.push(...t):m(t),e.$$.on_mount=[]}),r.forEach(W)}function pe(e,t){const n=e.$$;null!==n.fragment&&(m(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function de(e,t){-1===e.$$.dirty[0]&&(Z.push(e),K||(K=!0,J.then(ee)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ue(e,t,n,o,l,s,r=[-1]){const i=B;N(e);const a=t.props||{},c=e.$$={fragment:null,ctx:null,props:s,update:h,not_equal:l,bound:f(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(i?i.$$.context:[]),callbacks:f(),dirty:r};let p=!1;if(c.ctx=n?n(e,a,(t,n,...o)=>{const s=o.length?o[0]:n;return c.ctx&&l(c.ctx[t],c.ctx[t]=s)&&(c.bound[t]&&c.bound[t](s),p&&de(e,t)),n}):[],c.update(),p=!0,m(c.before_update),c.fragment=!!o&&o(c.ctx),t.target){if(t.hydrate){const e=function(e){return Array.from(e.childNodes)}(t.target);c.fragment&&c.fragment.l(e),e.forEach(j)}else c.fragment&&c.fragment.c();t.intro&&re(e.$$.fragment),ce(e,t.target,t.anchor),ee()}N(i)}class _e{$destroy(){pe(this,1),this.$destroy=h}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function he(e,t,n){const o=e.slice();return o[7]=t[n],o[9]=n,o}function ve(e){let t,n,o,l,s;function r(...t){return e[6](e[9],...t)}return{c(){t=D("li"),M(t,"class",n="dot"+(e[9]===e[1]?" selected":"")+" svelte-jjp3es"),t.value=o=e[9],M(t,"role","button"),M(t,"tabindex","0"),M(t,"aria-label",l="slide item "+e[9])},m(e,n,o){k(e,t,n),o&&s(),s=O(t,"click",E(r))},p(o,l){e=o,2&l&&n!==(n="dot"+(e[9]===e[1]?" selected":"")+" svelte-jjp3es")&&M(t,"class",n)},d(e){e&&j(t),s()}}}function fe(e){let t,n,o,l,s,r,i,a,c,p,d,u,_,v,f,y,g,b,L,F,z,P,S,q,H,U,B,N,A,I,G=(e[0][e[1]].kindName||"Фото и схемы ДТП")+"",Z=e[1]+1+"",R=e[0].length+"",Y=e[0],V=[];for(let t=0;t<Y.length;t+=1)V[t]=ve(he(e,Y,t));return{c(){t=D("div"),n=T(),o=D("div"),l=D("div"),s=T(),r=D("div"),i=D("div"),a=D("div"),c=w(G),p=T(),d=D("div"),u=D("div"),_=D("div"),v=D("button"),f=T(),y=D("div"),g=D("a"),b=D("img"),z=T(),P=D("button"),S=T(),q=D("ul");for(let e=0;e<V.length;e+=1)V[e].c();H=T(),U=D("p"),B=w(Z),N=w(" из "),A=w(R),M(t,"class","modal-background svelte-jjp3es"),M(l,"title","Закрыть"),M(l,"class","ant-modal-close svelte-jjp3es"),M(a,"class","ant-modal-title"),M(a,"id","rcDialogTitle1"),M(i,"class","ant-modal-header svelte-jjp3es"),M(v,"type","button"),M(v,"aria-label","previous slide / item"),M(v,"class","control-arrow control-prev svelte-jjp3es"),b.src!==(L=""+(me+e[0][e[1]].guid))&&M(b,"src",L),M(b,"alt",""),M(b,"class","svelte-jjp3es"),M(g,"target","_blank"),M(g,"href",F=""+(me+e[0][e[1]].guid)),M(g,"title","Открыть на весь экран"),M(g,"class","svelte-jjp3es"),M(y,"class","slider-wrapper axis-horizontal svelte-jjp3es"),M(P,"type","button"),M(P,"aria-label","next slide / item"),M(P,"class","control-arrow control-next svelte-jjp3es"),M(q,"class","control-dots svelte-jjp3es"),M(U,"class","carousel-status svelte-jjp3es"),M(_,"class","carousel carousel-slider svelte-jjp3es"),function(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}(_,"width","100%"),M(d,"class","ant-modal-body svelte-jjp3es"),M(r,"class","ant-modal-content svelte-jjp3es"),M(o,"class","modal svelte-jjp3es"),M(o,"role","dialog"),M(o,"aria-modal","true")},m(h,j,L){k(h,t,j),k(h,n,j),k(h,o,j),x(o,l),x(o,s),x(o,r),x(r,i),x(i,a),x(a,c),x(r,p),x(r,d),x(d,u),x(u,_),x(_,v),x(_,f),x(_,y),x(y,g),x(g,b),x(_,z),x(_,P),x(_,S),x(_,q);for(let e=0;e<V.length;e+=1)V[e].m(q,null);x(_,H),x(_,U),x(U,B),x(U,N),x(U,A),L&&m(I),I=[O(t,"click",E(e[2])),O(l,"click",E(e[2])),O(v,"click",E(e[3])),O(P,"click",E(e[4])),O(o,"click",E(ye))]},p(e,[t]){if(3&t&&G!==(G=(e[0][e[1]].kindName||"Фото и схемы ДТП")+"")&&$(c,G),3&t&&b.src!==(L=""+(me+e[0][e[1]].guid))&&M(b,"src",L),3&t&&F!==(F=""+(me+e[0][e[1]].guid))&&M(g,"href",F),3&t){let n;for(Y=e[0],n=0;n<Y.length;n+=1){const o=he(e,Y,n);V[n]?V[n].p(o,t):(V[n]=ve(o),V[n].c(),V[n].m(q,null))}for(;n<V.length;n+=1)V[n].d(1);V.length=Y.length}2&t&&Z!==(Z=e[1]+1+"")&&$(B,Z),1&t&&R!==(R=e[0].length+"")&&$(A,R)},i:h,o:h,d(e){e&&j(t),e&&j(n),e&&j(o),C(V,e),m(I)}}}const me="//map.mvs.group/skpdi/proxy.php?guid=",ye=()=>{};function ge(e,t,n){const o=G();let{data:l}=t,s=0;return e.$set=e=>{"data"in e&&n(0,l=e.data)},[l,s,()=>{o("close")},()=>{s&&n(1,s--,s)},()=>{s<l.length-1&&n(1,s++,s)},o,e=>{n(1,s=e)}]}class be extends _e{constructor(e){super(),ue(this,e,ge,fe,g,{data:0})}}function xe(e,t,n){const o=e.slice();return o[9]=t[n],o}function ke(e,t,n){const o=e.slice();return o[6]=t[n],o}function je(e){let t,n,o,l=e[9].k_uch&&(e[9].npdd||e[9].sop_npdd)&&function(e){let t,n,o=e[9].k_uch+"";return{c(){t=D("li"),n=w(o)},m(e,o){k(e,t,o),x(t,n)},p:h,d(e){e&&j(t)}}}(e),s=e[9].npdd&&function(e){let t,n,o=e[9].npdd+"";return{c(){t=D("li"),n=w(o)},m(e,o){k(e,t,o),x(t,n)},p:h,d(e){e&&j(t)}}}(e),r=e[9].sop_npdd&&function(e){let t,n,o=e[9].sop_npdd+"";return{c(){t=D("li"),n=w(o)},m(e,o){k(e,t,o),x(t,n)},p:h,d(e){e&&j(t)}}}(e);return{c(){l&&l.c(),t=T(),s&&s.c(),n=T(),r&&r.c(),o=F()},m(e,i){l&&l.m(e,i),k(e,t,i),s&&s.m(e,i),k(e,n,i),r&&r.m(e,i),k(e,o,i)},p(e,t){e[9].k_uch&&(e[9].npdd||e[9].sop_npdd)&&l.p(e,t),e[9].npdd&&s.p(e,t),e[9].sop_npdd&&r.p(e,t)},d(e){l&&l.d(e),e&&j(t),s&&s.d(e),e&&j(n),r&&r.d(e),e&&j(o)}}}function Le(e){let t,n,o=e[6].ts&&function(e){let t,n,o=e[6].ts+"";return{c(){t=D("li"),n=w(o)},m(e,o){k(e,t,o),x(t,n)},p:h,d(e){e&&j(t)}}}(e),l=e[6].arr,s=[];for(let t=0;t<l.length;t+=1)s[t]=je(xe(e,l,t));return{c(){o&&o.c(),t=T();for(let e=0;e<s.length;e+=1)s[e].c();n=F()},m(e,l){o&&o.m(e,l),k(e,t,l);for(let t=0;t<s.length;t+=1)s[t].m(e,l);k(e,n,l)},p(e,t){if(e[6].ts&&o.p(e,t),4&t){let o;for(l=e[6].arr,o=0;o<l.length;o+=1){const r=xe(e,l,o);s[o]?s[o].p(r,t):(s[o]=je(r),s[o].c(),s[o].m(n.parentNode,n))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(e){o&&o.d(e),e&&j(t),C(s,e),e&&j(n)}}}function Ce(e){let t,n,o,l,s,r=e[0].spog+"";return{c(){t=D("div"),n=D("div"),n.textContent="Погода:",o=T(),l=D("div"),s=w(r),M(n,"class","stitle"),M(l,"class","sval")},m(e,r){k(e,t,r),x(t,n),x(t,o),x(t,l),x(l,s)},p(e,t){1&t&&r!==(r=e[0].spog+"")&&$(s,r)},d(e){e&&j(t)}}}function De(e){let t,n,o,l,s,r=e[0].s_pch+"";return{c(){t=D("div"),n=D("div"),n.textContent="Покрытие:",o=T(),l=D("div"),s=w(r),M(n,"class","stitle"),M(l,"class","sval")},m(e,r){k(e,t,r),x(t,n),x(t,o),x(t,l),x(l,s)},p(e,t){1&t&&r!==(r=e[0].s_pch+"")&&$(s,r)},d(e){e&&j(t)}}}function we(e){let t,n,o,l,s,r=e[0].osv+"";return{c(){t=D("div"),n=D("div"),n.textContent="Освещенность:",o=T(),l=D("div"),s=w(r),M(n,"class","stitle"),M(l,"class","sval")},m(e,r){k(e,t,r),x(t,n),x(t,o),x(t,l),x(l,s)},p(e,t){1&t&&r!==(r=e[0].osv+"")&&$(s,r)},d(e){e&&j(t)}}}function Te(e){let t,n,o,l,s,r=e[0].ndu+"";return{c(){t=D("div"),n=D("div"),n.textContent="Иные условия:",o=T(),l=D("div"),s=w(r),M(n,"class","stitle"),M(l,"class","sval")},m(e,r){k(e,t,r),x(t,n),x(t,o),x(t,l),x(l,s)},p(e,t){1&t&&r!==(r=e[0].ndu+"")&&$(s,r)},d(e){e&&j(t)}}}function Fe(e){let t,n,o,l,s,r,i,a,c,p,d,u,_,v,f,m,y,g,b,L,F,E,z,P,S,q,H,U,B,N,A,I,G,Z,R,Y,V,J,K,W,Q,X,ee,te,ne,oe,le,se,re,ie,ae,ce,pe,de,ue,_e,he,ve,fe,me,ye,ge=(e[0].name||e[0].dtvp||"")+"",be=(e[0].district||"")+"",xe=(e[0].dor||"")+"",je=e[0].lat+"",Fe=e[0].lon+"",Oe=(e[0].collision_date||e[0].dtp_date||"")+"",Ee=(e[0].dtvp||"")+"",Me=e[0].pog+"",ze=e[0].ran+"",$e=e[2],Pe=[];for(let t=0;t<$e.length;t+=1)Pe[t]=Le(ke(e,$e,t));let Se=e[0].spog&&Ce(e),qe=e[0].s_pch&&De(e),He=e[0].osv&&we(e),Ue=e[0].ndu&&Te(e);return{c(){t=D("div"),n=D("div"),o=D("b"),l=w(ge),s=T(),r=D("div"),i=D("table"),a=D("tbody"),c=D("tr"),p=D("td"),p.textContent="Адрес:",d=T(),u=D("td"),_=w(be),v=T(),f=w(xe),m=T(),y=D("tr"),g=D("td"),g.textContent="Координаты:",b=T(),L=D("td"),F=w(je),E=T(),z=w(Fe),P=T(),S=D("span"),q=T(),H=D("tr"),U=D("td"),U.textContent="Дата/время:",B=T(),N=D("td"),A=w(Oe),I=T(),G=D("tr"),Z=D("td"),Z.textContent="Вид ДТП:",R=T(),Y=D("td"),V=w(Ee),J=T(),K=D("tr"),W=D("td"),W.textContent="Нарушения:",Q=T(),X=D("td"),ee=D("ul");for(let e=0;e<Pe.length;e+=1)Pe[e].c();te=T(),ne=D("tr"),oe=D("td"),oe.textContent="Условия:",le=T(),se=D("td"),Se&&Se.c(),re=T(),qe&&qe.c(),ie=T(),He&&He.c(),ae=T(),Ue&&Ue.c(),ce=T(),pe=D("tr"),de=D("td"),de.textContent="Количество погибших/раненых:",ue=T(),_e=D("td"),he=D("b"),ve=w(Me),fe=w("/"),me=w(ze),M(n,"class","pLine"),M(p,"class","first svelte-ipyqnf"),M(g,"class","first svelte-ipyqnf"),M(S,"title","Скопировать в буфер обмена"),M(S,"class","leaflet-gmx-icon-copy"),M(U,"class","first svelte-ipyqnf"),M(Z,"class","first svelte-ipyqnf"),M(W,"class","first svelte-ipyqnf"),M(oe,"class","first svelte-ipyqnf"),M(de,"class","first svelte-ipyqnf"),M(i,"class","table"),M(r,"class","featureCont"),M(t,"class","mvsPopup svelte-ipyqnf")},m(h,j,C){k(h,t,j),x(t,n),x(n,o),x(o,l),x(t,s),x(t,r),x(r,i),x(i,a),x(a,c),x(c,p),x(c,d),x(c,u),x(u,_),x(u,v),x(u,f),x(a,m),x(a,y),x(y,g),x(y,b),x(y,L),x(L,F),x(L,E),x(L,z),x(L,P),x(L,S),x(a,q),x(a,H),x(H,U),x(H,B),x(H,N),x(N,A),x(a,I),x(a,G),x(G,Z),x(G,R),x(G,Y),x(Y,V),x(a,J),x(a,K),x(K,W),x(K,Q),x(K,X),x(X,ee);for(let e=0;e<Pe.length;e+=1)Pe[e].m(ee,null);x(a,te),x(a,ne),x(ne,oe),x(ne,le),x(ne,se),Se&&Se.m(se,null),x(se,re),qe&&qe.m(se,null),x(se,ie),He&&He.m(se,null),x(se,ae),Ue&&Ue.m(se,null),x(a,ce),x(a,pe),x(pe,de),x(pe,ue),x(pe,_e),x(_e,he),x(he,ve),x(he,fe),x(he,me),C&&ye(),ye=O(S,"click",e[1])},p(e,[t]){if(1&t&&ge!==(ge=(e[0].name||e[0].dtvp||"")+"")&&$(l,ge),1&t&&be!==(be=(e[0].district||"")+"")&&$(_,be),1&t&&xe!==(xe=(e[0].dor||"")+"")&&$(f,xe),1&t&&je!==(je=e[0].lat+"")&&$(F,je),1&t&&Fe!==(Fe=e[0].lon+"")&&$(z,Fe),1&t&&Oe!==(Oe=(e[0].collision_date||e[0].dtp_date||"")+"")&&$(A,Oe),1&t&&Ee!==(Ee=(e[0].dtvp||"")+"")&&$(V,Ee),4&t){let n;for($e=e[2],n=0;n<$e.length;n+=1){const o=ke(e,$e,n);Pe[n]?Pe[n].p(o,t):(Pe[n]=Le(o),Pe[n].c(),Pe[n].m(ee,null))}for(;n<Pe.length;n+=1)Pe[n].d(1);Pe.length=$e.length}e[0].spog?Se?Se.p(e,t):(Se=Ce(e),Se.c(),Se.m(se,re)):Se&&(Se.d(1),Se=null),e[0].s_pch?qe?qe.p(e,t):(qe=De(e),qe.c(),qe.m(se,ie)):qe&&(qe.d(1),qe=null),e[0].osv?He?He.p(e,t):(He=we(e),He.c(),He.m(se,ae)):He&&(He.d(1),He=null),e[0].ndu?Ue?Ue.p(e,t):(Ue=Te(e),Ue.c(),Ue.m(se,null)):Ue&&(Ue.d(1),Ue=null),1&t&&Me!==(Me=e[0].pog+"")&&$(ve,Me),1&t&&ze!==(ze=e[0].ran+"")&&$(me,ze)},i:h,o:h,d(e){e&&j(t),C(Pe,e),Se&&Se.d(),qe&&qe.d(),He&&He.d(),Ue&&Ue.d(),ye()}}}function Oe(e,t,n){let o,{showModal:l=!1}=t,{prp:s}=t;s.skpdiFiles;I(()=>{l&&(o=new be({target:document.body,props:{data:s.skpdiFiles}}),o.$on("close",e=>{o.$destroy(),n(3,l=!1)}))});const r=(s.tsInfo||[]).map(e=>{let t=e.ts_uch||[];return{ts:"Осталось на месте ДТП"!==e.ts?e.ts:"",arr:t.map(e=>({k_uch:e.k_uch||"",npdd:"Нет нарушений"!==e.npdd?e.npdd:"",sop_npdd:"Нет нарушений"!==e.sop_npdd?e.sop_npdd:""}))}});return e.$set=e=>{"showModal"in e&&n(3,l=e.showModal),"prp"in e&&n(0,s=e.prp)},[s,e=>{navigator.clipboard.writeText(e.target.parentNode.textContent).catch(e=>{console.log("Something went wrong",e)})},r,l]}class Ee extends _e{constructor(e){super(),ue(this,e,Oe,Fe,g,{showModal:3,prp:0})}}const Me=window.L,ze=Me.popup();let $e;const Pe=Me.featureGroup([]);function Se(e,t,n){const o=e.slice();return o[6]=t[n],o}function qe(e,t,n){const o=e.slice();return o[6]=t[n],o}function He(e){let t,n=e[1].collisionTypes,o=[];for(let t=0;t<n.length;t+=1)o[t]=Ue(qe(e,n,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=F()},m(e,n){for(let t=0;t<o.length;t+=1)o[t].m(e,n);k(e,t,n)},p(e,l){if(2&l){let s;for(n=e[1].collisionTypes,s=0;s<n.length;s+=1){const r=qe(e,n,s);o[s]?o[s].p(r,l):(o[s]=Ue(r),o[s].c(),o[s].m(t.parentNode,t))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(e){C(o,e),e&&j(t)}}}function Ue(e){let t,n,o=(e[6].collisionType||"")+"";return{c(){t=D("li"),n=w(o)},m(e,o){k(e,t,o),x(t,n)},p(e,t){2&t&&o!==(o=(e[6].collisionType||"")+"")&&$(n,o)},d(e){e&&j(t)}}}function Be(e){let t,n=e[1].uchs,o=[];for(let t=0;t<n.length;t+=1)o[t]=Ne(Se(e,n,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=F()},m(e,n){for(let t=0;t<o.length;t+=1)o[t].m(e,n);k(e,t,n)},p(e,l){if(2&l){let s;for(n=e[1].uchs,s=0;s<n.length;s+=1){const r=Se(e,n,s);o[s]?o[s].p(r,l):(o[s]=Ne(r),o[s].c(),o[s].m(t.parentNode,t))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(e){C(o,e),e&&j(t)}}}function Ne(e){let t,n,o,l,s,r,i,a,c=(e[6].collisionPartyCategory||"")+"",p=(e[6].collisionPartyCond||"")+"";return{c(){t=D("li"),n=w(c),o=T(),l=D("b"),s=D("i"),r=w("("),i=w(p),a=w(")")},m(e,c){k(e,t,c),x(t,n),x(t,o),x(t,l),x(l,s),x(s,r),x(s,i),x(s,a)},p(e,t){2&t&&c!==(c=(e[6].collisionPartyCategory||"")+"")&&$(n,c),2&t&&p!==(p=(e[6].collisionPartyCond||"")+"")&&$(i,p)},d(e){e&&j(t)}}}function Ae(e){let t,n,o,l,s,r,i,a,c,p,d,u,_,v,f,y,g,b,L,C,F,E,z,P,S,q,H,U,B,N,A,I,G,Z,R,Y,V,J,K,W,Q,X,ee,te,ne,oe,le,se,re=(e[1].name||e[1].dtvp||"")+"",ie=e[1].lat+"",ae=e[1].lon+"",ce=(e[1].collision_date||e[1].dtp_date||"")+"",pe=(e[1].collision_context||e[1].dtp_date||"")+"",de=e[1].collisionTypes&&e[1].collisionTypes.length&&He(e),ue=e[1].uchs&&e[1].uchs.length&&Be(e);return{c(){t=D("div"),n=D("div"),o=D("b"),l=w(re),s=T(),r=D("div"),i=D("table"),a=D("tbody"),c=D("tr"),p=D("td"),p.textContent="Координаты:",d=T(),u=D("td"),_=w(ie),v=T(),f=w(ae),y=T(),g=D("span"),b=T(),L=D("tr"),C=D("td"),C.textContent="Дата/время:",F=T(),E=D("td"),z=w(ce),P=T(),S=D("tr"),q=D("td"),H=D("div"),H.textContent="Условия ДТП:",U=T(),B=D("div"),N=w(pe),A=T(),I=D("tr"),G=D("td"),G.textContent="Нарушения:",Z=T(),R=D("td"),Y=D("ul"),de&&de.c(),V=T(),J=D("tr"),K=D("td"),K.textContent="Участники:",W=T(),Q=D("td"),X=D("ul"),ue&&ue.c(),ee=T(),te=D("tr"),ne=D("td"),oe=D("button"),le=w("Фото и схемы"),M(n,"class","pLine"),M(p,"class","first"),M(g,"title","Скопировать в буфер обмена"),M(g,"class","leaflet-gmx-icon-copy"),M(C,"class","first"),M(H,"class","first"),M(q,"colspan","2"),M(G,"class","first"),M(K,"class","first"),M(oe,"class","primary svelte-1aipaym"),oe.disabled=e[2],M(ne,"class","center"),M(ne,"colspan","2"),M(i,"class","table"),M(r,"class","featureCont"),M(t,"class","mvsPopup")},m(h,j,D){k(h,t,j),x(t,n),x(n,o),x(o,l),x(t,s),x(t,r),x(r,i),x(i,a),x(a,c),x(c,p),x(c,d),x(c,u),x(u,_),x(u,v),x(u,f),x(u,y),x(u,g),x(a,b),x(a,L),x(L,C),x(L,F),x(L,E),x(E,z),x(a,P),x(a,S),x(S,q),x(q,H),x(q,U),x(q,B),x(B,N),x(a,A),x(a,I),x(I,G),x(I,Z),x(I,R),x(R,Y),de&&de.m(Y,null),x(a,V),x(a,J),x(J,K),x(J,W),x(J,Q),x(Q,X),ue&&ue.m(X,null),x(a,ee),x(a,te),x(te,ne),x(ne,oe),x(oe,le),D&&m(se),se=[O(g,"click",e[3]),O(oe,"click",e[5])]},p(e,[t]){2&t&&re!==(re=(e[1].name||e[1].dtvp||"")+"")&&$(l,re),2&t&&ie!==(ie=e[1].lat+"")&&$(_,ie),2&t&&ae!==(ae=e[1].lon+"")&&$(f,ae),2&t&&ce!==(ce=(e[1].collision_date||e[1].dtp_date||"")+"")&&$(z,ce),2&t&&pe!==(pe=(e[1].collision_context||e[1].dtp_date||"")+"")&&$(N,pe),e[1].collisionTypes&&e[1].collisionTypes.length?de?de.p(e,t):(de=He(e),de.c(),de.m(Y,null)):de&&(de.d(1),de=null),e[1].uchs&&e[1].uchs.length?ue?ue.p(e,t):(ue=Be(e),ue.c(),ue.m(X,null)):ue&&(ue.d(1),ue=null),4&t&&(oe.disabled=e[2])},i:h,o:h,d(e){e&&j(t),de&&de.d(),ue&&ue.d(),m(se)}}}function Ie(e,t,n){let o,{showModal:l=!1}=t,{prp:s}=t,r=s.files&&s.files.length?"":"disabled";I(()=>{n(2,r=s.files&&s.files.length?"":"disabled"),l&&(o=new be({target:document.body,props:{data:s.files}}),o.$on("close",e=>{o.$destroy(),n(0,l=!1)}))});return e.$set=e=>{"showModal"in e&&n(0,l=e.showModal),"prp"in e&&n(1,s=e.prp)},[l,s,r,e=>{navigator.clipboard.writeText(e.target.parentNode.textContent).catch(e=>{console.log("Something went wrong",e)})},o,()=>n(0,l=!0)]}Pe._needHeat={radius:19,blur:11.26,minOpacity:.34},Pe.checkZoom=e=>{Object.keys(Pe._layers).length?e<12&&Pe.setFilter($e):e>11&&Pe.setFilter($e)},Pe.setFilter=e=>{Pe.clearLayers(),$e=e||[];let t=[],n=[];Pe._group&&(Pe._group.getLayers().forEach(e=>{let o=e.options.props,l=0;$e.forEach(e=>{"collision_type"===e.type?(""===e.zn[0]||e.zn.filter(e=>e===o.collision_type).length)&&l++:"date"===e.type&&o.date>=e.zn[0]&&o.date<e.zn[1]&&l++}),l===$e.length&&(t.push(e),n.push(e._latlng))}),Pe._needHeat?(Pe._map.addLayer(Pe._heat),Pe._heat.setLatLngs(n),Pe._heat.setOptions(Pe._needHeat),Pe._map._zoom>11&&Pe.addLayer(Me.layerGroup(t))):(Pe.addLayer(Me.layerGroup(t)),Pe._map.removeLayer(Pe._heat)))},Pe.on("remove",e=>{Pe._map.removeLayer(Pe._heat),Pe.clearLayers()}).on("add",e=>{Pe._heat=Me.heatLayer([],{gradient:{.1:"blue",.4:"lime",1:"red"}}),fetch("https://dtp.mvs.group/scripts/index.php?request=get_stat_gipdd",{}).then(e=>e.json()).then(e=>{let t={collision_type:{},iconType:{}},n=[],o=e.map(e=>{let o=e.iconType||0,l=!1,s="#2F4F4F";o&&(l=o%2==0,o>=1&&o<=6?s="#8B4513":7===o||8===o?s="#228B22":o>=9&&o<=14?s="#8B4513":15===o||16===o?s="#7B68EE":17!==o&&18!==o||(s="#2F4F4F")),e.lat&&e.lon||(console.log("_______",e),e.lat=e.lon=0);let r=t.collision_type[e.collision_type];r?r++:r=1,t.collision_type[e.collision_type]=r,t.iconType[e.collision_type]=o;let i=Me.latLng(e.lat,e.lon);return n.push(i),new _(i,{props:e,radius:6,stroke:l,fillColor:s}).bindPopup(ze).on("popupopen",e=>{var t;t=e.target.options.props.id,fetch("https://dtp.mvs.group/scripts/index.php?request=get_dtp_id&id="+t+"&type=gibdd",{}).then(e=>e.json()).then(e=>{let t=Me.DomUtil.create("div");const n=new Ee({target:t,props:{prp:e}});ze._svObj=n,ze.setContent(t)})}).on("popupclose",e=>{e.popup._svObj&&(e.popup._svObj.$destroy(),delete e.popup._svObj)})});Pe.addLayer(Pe._heat),Pe._heat.setLatLngs(n),Pe._heat.setOptions(Pe._needHeat),Pe._opt=t,Pe._group=Me.layerGroup(o),$e?Pe.setFilter($e):Pe._map._zoom>11&&Pe.addLayer(Pe._group),Pe._refreshFilters()})});class Ge extends _e{constructor(e){super(),ue(this,e,Ie,Ae,g,{showModal:0,prp:1})}}const Ze=window.L,Re=Ze.popup();let Ye;const Ve=Ze.featureGroup([]);function Je(e,t,n){const o=e.slice();return o[6]=t[n],o[8]=n,o}function Ke(e){let t,n,o,l,s,r="gibdd"===e[6].type?"ГИБДД":"СКПДИ";return{c(){t=D("button"),n=w(r),M(t,"class",o=b(e[2]===e[8]?"current":"")+" svelte-txaali"),t.value=l=e[8]},m(o,l,r){k(o,t,l),x(t,n),r&&s(),s=O(t,"click",e[4])},p(e,l){1&l&&r!==(r="gibdd"===e[6].type?"ГИБДД":"СКПДИ")&&$(n,r),4&l&&o!==(o=b(e[2]===e[8]?"current":"")+" svelte-txaali")&&M(t,"class",o)},d(e){e&&j(t),s()}}}function We(e){let t;const n=new Ge({props:{prp:e[3]}});return{c(){ae(n.$$.fragment)},m(e,o){ce(n,e,o),t=!0},p(e,t){const o={};8&t&&(o.prp=e[3]),n.$set(o)},i(e){t||(re(n.$$.fragment,e),t=!0)},o(e){ie(n.$$.fragment,e),t=!1},d(e){pe(n,e)}}}function Qe(e){let t;const n=new Ee({props:{prp:e[3]}});return{c(){ae(n.$$.fragment)},m(e,o){ce(n,e,o),t=!0},p(e,t){const o={};8&t&&(o.prp=e[3]),n.$set(o)},i(e){t||(re(n.$$.fragment,e),t=!0)},o(e){ie(n.$$.fragment,e),t=!1},d(e){pe(n,e)}}}function Xe(e){let t,n,o,l,s,r,i,a,c,p,d=e[0]._cur,u=[];for(let t=0;t<d.length;t+=1)u[t]=Ke(Je(e,d,t));const _=[Qe,We],h=[];function v(e,t){return"gibdd"===e[0]._cur[e[2]].type?0:1}return i=v(e),a=h[i]=_[i](e),{c(){t=D("div"),n=D("div"),o=D("a"),o.textContent="×",l=T(),s=D("div");for(let e=0;e<u.length;e+=1)u[e].c();r=T(),a.c(),M(o,"class","leaflet-popup-close-button"),M(o,"href","#close"),M(n,"class","close"),M(s,"class","pLine"),M(t,"class","mvsPopup")},m(a,d,_){k(a,t,d),x(t,n),x(n,o),x(t,l),x(t,s);for(let e=0;e<u.length;e+=1)u[e].m(s,null);var v;x(t,r),h[i].m(t,null),c=!0,_&&p(),p=O(o,"click",(v=function(){y(e[1])&&e[1].apply(this,arguments)},function(e){return e.preventDefault(),v.call(this,e)}))},p(n,[o]){if(e=n,21&o){let t;for(d=e[0]._cur,t=0;t<d.length;t+=1){const n=Je(e,d,t);u[t]?u[t].p(n,o):(u[t]=Ke(n),u[t].c(),u[t].m(s,null))}for(;t<u.length;t+=1)u[t].d(1);u.length=d.length}let l=i;i=v(e),i===l?h[i].p(e,o):(le(),ie(h[l],1,1,()=>{h[l]=null}),se(),a=h[i],a||(a=h[i]=_[i](e),a.c()),re(a,1),a.m(t,null))},i(e){c||(re(a),c=!0)},o(e){ie(a),c=!1},d(e){e&&j(t),C(u,e),h[i].d(),p()}}}function et(e,t,n){let{prp:o}=t,{closeMe:l=(()=>{})}=t,s=0,r={};const i=e=>{let t=o._cur[e],l=t.type,s="https://dtp.mvs.group/scripts/index.php?request=get_dtp_id&id="+t.id+"&type="+l;fetch(s,{}).then(e=>e.json()).then(e=>{n(3,r=e)})};return i(s),e.$set=e=>{"prp"in e&&n(0,o=e.prp),"closeMe"in e&&n(1,l=e.closeMe)},[o,l,s,r,e=>{let t=e.target,o=Number(t.value);s!==o&&(n(2,s=o),i(s))}]}Ve._needHeat={radius:19,blur:11.26,minOpacity:.34},Ve.checkZoom=e=>{Object.keys(Ve._layers).length?e<12&&Ve.setFilter(Ye):e>11&&Ve.setFilter(Ye)},Ve.setFilter=e=>{Ve.clearLayers(),Ye=e||[];let t=[],n=[];Ve._group&&(Ve._group.getLayers().forEach(e=>{let o=e.options.props,l=0;Ye.forEach(e=>{"collision_type"===e.type?(""===e.zn[0]||e.zn.filter(e=>e===o.collision_type).length)&&l++:"date"===e.type&&o.date>=e.zn[0]&&o.date<e.zn[1]&&l++}),l===Ye.length&&(t.push(e),n.push(e._latlng))}),Ve._needHeat?(Ve._map.addLayer(Ve._heat),Ve._heat.setLatLngs(n),Ve._heat.setOptions(Ve._needHeat),Ve._map._zoom>11&&Ve.addLayer(Ze.layerGroup(t))):(Ve.addLayer(Ze.layerGroup(t)),Ve._map.removeLayer(Ve._heat)))},Ve.on("remove",()=>{Ve._map.removeLayer(Ve._heat),Ve.clearLayers()}).on("add",e=>{Ve._heat=Ze.heatLayer([]),fetch("https://dtp.mvs.group/scripts/index.php?request=get_skpdi",{}).then(e=>e.json()).then(e=>{let t={collision_type:{},iconType:{}},n=[],o=e.map(e=>{let o=e.iconType||0,l=!1,s="#2F4F4F";o&&(l=o%2==0,o>=1&&o<=6?s="#8B4513":7===o||8===o?s="#228B22":o>=9&&o<=14?s="#8B4513":15===o||16===o?s="#7B68EE":17!==o&&18!==o||(s="#2F4F4F")),e.lat&&e.lon||(console.log("_______",e),e.lat=e.lon=0);let r=t.collision_type[e.collision_type];r?r++:r=1,t.collision_type[e.collision_type]=r,t.iconType[e.collision_type]=o;let i=Ze.latLng(e.lat,e.lon);return n.push(i),new _(i,{props:e,radius:6,box:!0,stroke:l,fillColor:s}).bindPopup(Re).on("popupopen",e=>{var t;t=e.target.options.props.id,fetch("https://dtp.mvs.group/scripts/index.php?request=get_dtp_id&id="+t+"&type=skpdi",{}).then(e=>e.json()).then(e=>{let t=Ze.DomUtil.create("div");const n=new Ge({target:t,props:{prp:e}});Re._svObj=n,Re.setContent(t)})}).on("popupclose",e=>{console.log("popupclose",e),e.popup._svObj&&(e.popup._svObj.$destroy(),delete e.popup._svObj)})});Ve.addLayer(Ve._heat),Ve._heat.setLatLngs(n),Ve._heat.setOptions(Ve._needHeat),Ve._opt=t,Ve._group=Ze.layerGroup(o),Ye?Ve.setFilter(Ye):Ve.addLayer(Ve._group),Ve.checkZoom(Ve._map._zoom),Ve._refreshFilters()})});class tt extends _e{constructor(e){super(),ue(this,e,et,Xe,g,{prp:0,closeMe:1})}}const nt=window.L,ot=nt.popup();let lt;const st=nt.featureGroup([]);function rt(e,t,n){const o=e.slice();return o[125]=t[n],o}function it(e,t,n){const o=e.slice();return o[125]=t[n],o}function at(e,t,n){const o=e.slice();return o[125]=t[n],o}function ct(e,t,n){const o=e.slice();return o[125]=t[n],o}function pt(e,t,n){const o=e.slice();return o[136]=t[n],o}function dt(e,t,n){const o=e.slice();return o[125]=t[n],o}function ut(e,t,n){const o=e.slice();return o[125]=t[n],o}function _t(e,t,n){const o=e.slice();return o[125]=t[n],o}function ht(e,t,n){const o=e.slice();return o[136]=t[n],o}function vt(e,t,n){const o=e.slice();return o[125]=t[n],o}function ft(e,t,n){const o=e.slice();return o[125]=t[n],o}function mt(e,t,n){const o=e.slice();return o[125]=t[n],o}function yt(e,t,n){const o=e.slice();return o[136]=t[n],o}function gt(e,t,n){const o=e.slice();return o[125]=t[n],o}function bt(e,t,n){const o=e.slice();return o[125]=t[n],o}function xt(e,t,n){const o=e.slice();return o[125]=t[n],o}function kt(e,t,n){const o=e.slice();return o[125]=t[n],o}function jt(e,t,n){const o=e.slice();return o[125]=t[n],o}function Lt(e,t,n){const o=e.slice();return o[125]=t[n],o}function Ct(e){let t,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,y,g,b,L,w,F,E,z,$,P,H,U=Object.keys(e[3]._opt.years).sort(),B=[];for(let t=0;t<U.length;t+=1)B[t]=Dt(Lt(e,U,t));let N=e[55],A=[];for(let t=0;t<N.length;t+=1)A[t]=wt(jt(e,N,t));return{c(){t=D("div"),t.innerHTML="Фильтры - <b>ДТП Очаги (5)</b>",n=T(),o=D("div"),l=D("div"),s=D("fieldset"),r=D("legend"),r.textContent="Фильтрация по периодам:",i=T(),a=D("div"),c=D("input"),u=D("label"),u.textContent="Фильтрация по годам",_=T(),h=D("div");for(let e=0;e<B.length;e+=1)B[e].c();v=T(),f=D("div"),y=D("select"),g=D("option"),g.textContent=`\n\t\t\t\t\t\tВсе типы (${e[55].reduce(e[91],0)})\n\t\t\t\t\t`;for(let e=0;e<A.length;e+=1)A[e].c();b=T(),L=D("div"),w=D("select"),F=D("option"),F.textContent="Очаги все",E=D("option"),E.textContent="Только с погибшими",z=D("option"),z.textContent="Только с пострадавшими",$=D("option"),$.textContent="С пострадавшими или погибшими",P=D("option"),P.textContent="С пострадавшими и погибшими",M(t,"class","pLine svelte-1jsovbn"),M(c,"type","radio"),c.__value=p=1,c.value=c.__value,c.checked=d=1===e[19],M(c,"id","hearths_period_type_51"),M(c,"name","hearths_period_type_5"),M(c,"class","svelte-1jsovbn"),e[90][4].push(c),M(u,"for","hearths_period_type_51"),M(u,"class","svelte-1jsovbn"),M(h,"class","pLine margin svelte-1jsovbn"),M(a,"class","pLine type svelte-1jsovbn"),M(l,"class","pLine nowrap svelte-1jsovbn"),g.__value="",g.value=g.__value,M(g,"class","svelte-1jsovbn"),M(y,"class","multiple_icon_typeTmp svelte-1jsovbn"),y.multiple=!0,void 0===e[18]&&W(()=>e[92].call(y)),M(f,"class","pLine svelte-1jsovbn"),F.__value="",F.value=F.__value,E.__value="1",E.value=E.__value,z.__value="2",z.value=z.__value,$.__value="3",$.value=$.__value,P.__value="4",P.value=P.__value,M(w,"class","svelte-1jsovbn"),void 0===e[17]&&W(()=>e[93].call(w)),M(L,"class","pLine svelte-1jsovbn"),M(o,"class","filtersCont svelte-1jsovbn")},m(p,d,j){k(p,t,d),k(p,n,d),k(p,o,d),x(o,l),x(l,s),x(s,r),x(s,i),x(s,a),x(a,c),c.checked=c.__value===e[19],x(a,u),x(a,_),x(a,h);for(let e=0;e<B.length;e+=1)B[e].m(h,null);x(o,v),x(o,f),x(f,y),x(y,g);for(let e=0;e<A.length;e+=1)A[e].m(y,null);q(y,e[18]),x(o,b),x(o,L),x(L,w),x(w,F),x(w,E),x(w,z),x(w,$),x(w,P),S(w,e[17]),j&&m(H),H=[O(c,"change",e[65]),O(c,"change",e[89]),O(y,"change",e[92]),O(y,"change",e[65]),O(w,"change",e[93]),O(w,"change",e[65])]},p(e,t){if(524288&t[0]&&d!==(d=1===e[19])&&(c.checked=d),524288&t[0]&&(c.checked=c.__value===e[19]),1572872&t[0]|8&t[2]){let n;for(U=Object.keys(e[3]._opt.years).sort(),n=0;n<U.length;n+=1){const o=Lt(e,U,n);B[n]?B[n].p(o,t):(B[n]=Dt(o),B[n].c(),B[n].m(h,null))}for(;n<B.length;n+=1)B[n].d(1);B.length=U.length}if(25165824&t[1]){let n;for(N=e[55],n=0;n<N.length;n+=1){const o=jt(e,N,n);A[n]?A[n].p(o,t):(A[n]=wt(o),A[n].c(),A[n].m(y,null))}for(;n<A.length;n+=1)A[n].d(1);A.length=N.length}262144&t[0]&&q(y,e[18]),131072&t[0]&&S(w,e[17])},d(l){l&&j(t),l&&j(n),l&&j(o),e[90][4].splice(e[90][4].indexOf(c),1),C(B,l),C(A,l),m(H)}}}function Dt(e){let t,n,o,l,s,r,i,a=e[125]+"";return{c(){t=D("input"),s=D("label"),r=w(a),M(t,"type","checkbox"),M(t,"id","hearths_year_5"),t.checked=n=e[20][e[125]],t.disabled=o=2===e[19],M(t,"name",l=e[125]),M(t,"class","svelte-1jsovbn"),M(s,"for","hearths_year_5"),M(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,t,o),k(n,s,o),x(s,r),l&&i(),i=O(t,"change",e[65])},p(e,s){1048584&s[0]&&n!==(n=e[20][e[125]])&&(t.checked=n),524288&s[0]&&o!==(o=2===e[19])&&(t.disabled=o),8&s[0]&&l!==(l=e[125])&&M(t,"name",l),8&s[0]&&a!==(a=e[125]+"")&&$(r,a)},d(e){e&&j(t),e&&j(s),i()}}}function wt(e){let t,n,o,l,s,r,i,a=e[125]+"",c=e[54].str_icon_type[e[125]]+"";return{c(){t=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),t.__value=r=e[125],t.value=t.__value,M(t,"class",i="icon_type_"+e[54].iconType[e[125]]+" svelte-1jsovbn")},m(e,r){k(e,t,r),x(t,n),x(t,o),x(t,l),x(t,s)},p:h,d(e){e&&j(t)}}}function Tt(e){let t,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,y,g,b,L,w,F,E,z,$,P,H,U=Object.keys(e[4]._opt.years).sort(),B=[];for(let t=0;t<U.length;t+=1)B[t]=Ft(kt(e,U,t));let N=e[53],A=[];for(let t=0;t<N.length;t+=1)A[t]=Ot(xt(e,N,t));return{c(){t=D("div"),t.innerHTML="Фильтры - <b>ДТП Очаги (3)</b>",n=T(),o=D("div"),l=D("div"),s=D("fieldset"),r=D("legend"),r.textContent="Фильтрация по периодам:",i=T(),a=D("div"),c=D("input"),u=D("label"),u.textContent="Фильтрация по годам",_=T(),h=D("div");for(let e=0;e<B.length;e+=1)B[e].c();v=T(),f=D("div"),y=D("select"),g=D("option"),g.textContent=`\n\t\t\t\t\t\tВсе типы (${e[53].reduce(e[95],0)})\n\t\t\t\t\t`;for(let e=0;e<A.length;e+=1)A[e].c();b=T(),L=D("div"),w=D("select"),F=D("option"),F.textContent="Очаги все",E=D("option"),E.textContent="Только с погибшими",z=D("option"),z.textContent="Только с пострадавшими",$=D("option"),$.textContent="С пострадавшими или погибшими",P=D("option"),P.textContent="С пострадавшими и погибшими",M(t,"class","pLine svelte-1jsovbn"),M(c,"type","radio"),c.__value=p=1,c.value=c.__value,c.checked=d=1===e[23],M(c,"id","hearths_period_type_31"),M(c,"name","hearths_period_type_3"),M(c,"class","svelte-1jsovbn"),e[90][3].push(c),M(u,"for","hearths_period_type_31"),M(u,"class","svelte-1jsovbn"),M(h,"class","pLine margin svelte-1jsovbn"),M(a,"class","pLine type svelte-1jsovbn"),M(l,"class","pLine nowrap svelte-1jsovbn"),g.__value="",g.value=g.__value,M(g,"class","svelte-1jsovbn"),M(y,"class","multiple_icon_typeTmp svelte-1jsovbn"),y.multiple=!0,void 0===e[22]&&W(()=>e[96].call(y)),M(f,"class","pLine svelte-1jsovbn"),F.__value="",F.value=F.__value,E.__value="1",E.value=E.__value,z.__value="2",z.value=z.__value,$.__value="3",$.value=$.__value,P.__value="4",P.value=P.__value,M(w,"class","svelte-1jsovbn"),void 0===e[21]&&W(()=>e[97].call(w)),M(L,"class","pLine svelte-1jsovbn"),M(o,"class","filtersCont svelte-1jsovbn")},m(p,d,j){k(p,t,d),k(p,n,d),k(p,o,d),x(o,l),x(l,s),x(s,r),x(s,i),x(s,a),x(a,c),c.checked=c.__value===e[23],x(a,u),x(a,_),x(a,h);for(let e=0;e<B.length;e+=1)B[e].m(h,null);x(o,v),x(o,f),x(f,y),x(y,g);for(let e=0;e<A.length;e+=1)A[e].m(y,null);q(y,e[22]),x(o,b),x(o,L),x(L,w),x(w,F),x(w,E),x(w,z),x(w,$),x(w,P),S(w,e[21]),j&&m(H),H=[O(c,"change",e[66]),O(c,"change",e[94]),O(y,"change",e[96]),O(y,"change",e[66]),O(w,"change",e[97]),O(w,"change",e[66])]},p(e,t){if(8388608&t[0]&&d!==(d=1===e[23])&&(c.checked=d),8388608&t[0]&&(c.checked=c.__value===e[23]),25165840&t[0]|16&t[2]){let n;for(U=Object.keys(e[4]._opt.years).sort(),n=0;n<U.length;n+=1){const o=kt(e,U,n);B[n]?B[n].p(o,t):(B[n]=Ft(o),B[n].c(),B[n].m(h,null))}for(;n<B.length;n+=1)B[n].d(1);B.length=U.length}if(6291456&t[1]){let n;for(N=e[53],n=0;n<N.length;n+=1){const o=xt(e,N,n);A[n]?A[n].p(o,t):(A[n]=Ot(o),A[n].c(),A[n].m(y,null))}for(;n<A.length;n+=1)A[n].d(1);A.length=N.length}4194304&t[0]&&q(y,e[22]),2097152&t[0]&&S(w,e[21])},d(l){l&&j(t),l&&j(n),l&&j(o),e[90][3].splice(e[90][3].indexOf(c),1),C(B,l),C(A,l),m(H)}}}function Ft(e){let t,n,o,l,s,r,i,a=e[125]+"";return{c(){t=D("input"),s=D("label"),r=w(a),M(t,"type","checkbox"),M(t,"id","hearths_year_3"),t.checked=n=e[24][e[125]],t.disabled=o=2===e[23],M(t,"name",l=e[125]),M(t,"class","svelte-1jsovbn"),M(s,"for","hearths_year_3"),M(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,t,o),k(n,s,o),x(s,r),l&&i(),i=O(t,"change",e[66])},p(e,s){16777232&s[0]&&n!==(n=e[24][e[125]])&&(t.checked=n),8388608&s[0]&&o!==(o=2===e[23])&&(t.disabled=o),16&s[0]&&l!==(l=e[125])&&M(t,"name",l),16&s[0]&&a!==(a=e[125]+"")&&$(r,a)},d(e){e&&j(t),e&&j(s),i()}}}function Ot(e){let t,n,o,l,s,r,i,a=e[125]+"",c=e[52].str_icon_type[e[125]]+"";return{c(){t=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),t.__value=r=e[125],t.value=t.__value,M(t,"class",i="icon_type_"+e[52].iconType[e[125]]+" svelte-1jsovbn")},m(e,r){k(e,t,r),x(t,n),x(t,o),x(t,l),x(t,s)},p:h,d(e){e&&j(t)}}}function Et(e){let t,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,y,g,b,L,w,F,E,z,$,P,H,U,B,N,A,I,G,Z,R=Object.keys(e[5]._opt.years).sort(),Y=[];for(let t=0;t<R.length;t+=1)Y[t]=Mt(bt(e,R,t));let V=Object.keys(e[5]._opt.years).sort(),J=[];for(let t=0;t<V.length;t+=1)J[t]=$t(gt(e,V,t));let K=e[51],Q=[];for(let t=0;t<K.length;t+=1)Q[t]=Pt(mt(e,K,t));return{c(){t=D("div"),t.innerHTML="Фильтры - <b>ДТП Очаги (Stat)</b>",n=T(),o=D("div"),l=D("div"),s=D("fieldset"),r=D("legend"),r.textContent="Фильтрация по периодам:",i=T(),a=D("div"),c=D("input"),u=D("label"),u.textContent="Фильтрация по годам",_=T(),h=D("div");for(let e=0;e<Y.length;e+=1)Y[e].c();v=T(),f=D("div"),y=D("input"),b=D("label"),b.textContent="Фильтрация по кварталам",L=T(),w=D("div");for(let e=0;e<J.length;e+=1)J[e].c();F=T(),E=D("div"),z=D("select"),$=D("option"),$.textContent=`\n\t\t\t\t\t\tВсе типы (${e[51].reduce(e[100],0)})\n\t\t\t\t\t`;for(let e=0;e<Q.length;e+=1)Q[e].c();P=T(),H=D("div"),U=D("select"),B=D("option"),B.textContent="Очаги все",N=D("option"),N.textContent="Только с погибшими",A=D("option"),A.textContent="Только с пострадавшими",I=D("option"),I.textContent="С пострадавшими или погибшими",G=D("option"),G.textContent="С пострадавшими и погибшими",M(t,"class","pLine svelte-1jsovbn"),M(c,"type","radio"),c.__value=p=1,c.value=c.__value,c.checked=d=1===e[27],M(c,"id","hearths_period_type_Stat1"),M(c,"name","hearths_period_type_Stat"),M(c,"class","svelte-1jsovbn"),e[90][2].push(c),M(u,"for","hearths_period_type_Stat1"),M(u,"class","svelte-1jsovbn"),M(h,"class","pLine margin svelte-1jsovbn"),M(a,"class","pLine type svelte-1jsovbn"),M(y,"type","radio"),y.__value=g=2,y.value=y.__value,M(y,"id","hearths_period_type_Stat2"),M(y,"name","hearths_period_type_Stat"),M(y,"class","svelte-1jsovbn"),e[90][2].push(y),M(b,"for","hearths_period_type_Stat2"),M(b,"class","svelte-1jsovbn"),M(w,"class","pLine margin svelte-1jsovbn"),M(f,"class","pLine type svelte-1jsovbn"),M(l,"class","pLine nowrap svelte-1jsovbn"),$.__value="",$.value=$.__value,M($,"class","svelte-1jsovbn"),M(z,"class","multiple_icon_typeTmp svelte-1jsovbn"),z.multiple=!0,void 0===e[26]&&W(()=>e[101].call(z)),M(E,"class","pLine svelte-1jsovbn"),B.__value="",B.value=B.__value,N.__value="1",N.value=N.__value,A.__value="2",A.value=A.__value,I.__value="3",I.value=I.__value,G.__value="4",G.value=G.__value,M(U,"class","svelte-1jsovbn"),void 0===e[25]&&W(()=>e[102].call(U)),M(H,"class","pLine svelte-1jsovbn"),M(o,"class","filtersCont svelte-1jsovbn")},m(p,d,g){k(p,t,d),k(p,n,d),k(p,o,d),x(o,l),x(l,s),x(s,r),x(s,i),x(s,a),x(a,c),c.checked=c.__value===e[27],x(a,u),x(a,_),x(a,h);for(let e=0;e<Y.length;e+=1)Y[e].m(h,null);x(s,v),x(s,f),x(f,y),y.checked=y.__value===e[27],x(f,b),x(f,L),x(f,w);for(let e=0;e<J.length;e+=1)J[e].m(w,null);x(o,F),x(o,E),x(E,z),x(z,$);for(let e=0;e<Q.length;e+=1)Q[e].m(z,null);q(z,e[26]),x(o,P),x(o,H),x(H,U),x(U,B),x(U,N),x(U,A),x(U,I),x(U,G),S(U,e[25]),g&&m(Z),Z=[O(c,"change",e[67]),O(c,"change",e[98]),O(y,"change",e[67]),O(y,"change",e[99]),O(z,"change",e[101]),O(z,"change",e[67]),O(U,"change",e[102]),O(U,"change",e[67])]},p(e,t){if(134217728&t[0]&&d!==(d=1===e[27])&&(c.checked=d),134217728&t[0]&&(c.checked=c.__value===e[27]),402653216&t[0]|32&t[2]){let n;for(R=Object.keys(e[5]._opt.years).sort(),n=0;n<R.length;n+=1){const o=bt(e,R,n);Y[n]?Y[n].p(o,t):(Y[n]=Mt(o),Y[n].c(),Y[n].m(h,null))}for(;n<Y.length;n+=1)Y[n].d(1);Y.length=R.length}if(134217728&t[0]&&(y.checked=y.__value===e[27]),671088672&t[0]|32&t[2]){let n;for(V=Object.keys(e[5]._opt.years).sort(),n=0;n<V.length;n+=1){const o=gt(e,V,n);J[n]?J[n].p(o,t):(J[n]=$t(o),J[n].c(),J[n].m(w,null))}for(;n<J.length;n+=1)J[n].d(1);J.length=V.length}if(1572864&t[1]){let n;for(K=e[51],n=0;n<K.length;n+=1){const o=mt(e,K,n);Q[n]?Q[n].p(o,t):(Q[n]=Pt(o),Q[n].c(),Q[n].m(z,null))}for(;n<Q.length;n+=1)Q[n].d(1);Q.length=K.length}67108864&t[0]&&q(z,e[26]),33554432&t[0]&&S(U,e[25])},d(l){l&&j(t),l&&j(n),l&&j(o),e[90][2].splice(e[90][2].indexOf(c),1),C(Y,l),e[90][2].splice(e[90][2].indexOf(y),1),C(J,l),C(Q,l),m(Z)}}}function Mt(e){let t,n,o,l,s,r,i,a=e[125]+"";return{c(){t=D("input"),s=D("label"),r=w(a),M(t,"type","checkbox"),M(t,"id","hearths_year_Stat"),t.checked=n=e[28][e[125]],t.disabled=o=2===e[27],M(t,"name",l=e[125]),M(t,"class","svelte-1jsovbn"),M(s,"for","hearths_year_Stat"),M(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,t,o),k(n,s,o),x(s,r),l&&i(),i=O(t,"change",e[67])},p(e,s){268435488&s[0]&&n!==(n=e[28][e[125]])&&(t.checked=n),134217728&s[0]&&o!==(o=2===e[27])&&(t.disabled=o),32&s[0]&&l!==(l=e[125])&&M(t,"name",l),32&s[0]&&a!==(a=e[125]+"")&&$(r,a)},d(e){e&&j(t),e&&j(s),i()}}}function zt(e){let t,n,o,l,s,r,i,a,c,p,d=e[136]+"",u=e[125]+"";return{c(){t=D("input"),s=D("label"),r=w(d),i=w(" кв. "),a=w(u),M(t,"type","checkbox"),M(t,"id","hearths_quarter_Stat"),t.checked=n=e[29][e[125]]&&e[29][e[125]][e[136]],t.disabled=o=1===e[27],M(t,"name",l=e[125]+"_"+e[136]),M(t,"class","svelte-1jsovbn"),M(s,"for",c="hearths_quarter_Stat_"+e[125]+"_"+e[136]),M(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,t,o),k(n,s,o),x(s,r),x(s,i),x(s,a),l&&p(),p=O(t,"change",e[67])},p(e,i){536870944&i[0]&&n!==(n=e[29][e[125]]&&e[29][e[125]][e[136]])&&(t.checked=n),134217728&i[0]&&o!==(o=1===e[27])&&(t.disabled=o),32&i[0]&&l!==(l=e[125]+"_"+e[136])&&M(t,"name",l),32&i[0]&&d!==(d=e[136]+"")&&$(r,d),32&i[0]&&u!==(u=e[125]+"")&&$(a,u),32&i[0]&&c!==(c="hearths_quarter_Stat_"+e[125]+"_"+e[136])&&M(s,"for",c)},d(e){e&&j(t),e&&j(s),p()}}}function $t(e){let t,n,o=Object.keys(e[5]._opt.years[e[125]]).sort(),l=[];for(let t=0;t<o.length;t+=1)l[t]=zt(yt(e,o,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=T(),n=D("br")},m(e,o){for(let t=0;t<l.length;t+=1)l[t].m(e,o);k(e,t,o),k(e,n,o)},p(e,n){if(671088672&n[0]|32&n[2]){let s;for(o=Object.keys(e[5]._opt.years[e[125]]).sort(),s=0;s<o.length;s+=1){const r=yt(e,o,s);l[s]?l[s].p(r,n):(l[s]=zt(r),l[s].c(),l[s].m(t.parentNode,t))}for(;s<l.length;s+=1)l[s].d(1);l.length=o.length}},d(e){C(l,e),e&&j(t),e&&j(n)}}}function Pt(e){let t,n,o,l,s,r,i,a=e[125]+"",c=e[50].str_icon_type[e[125]]+"";return{c(){t=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),t.__value=r=e[125],t.value=t.__value,M(t,"class",i="icon_type_"+e[50].iconType[e[125]]+" svelte-1jsovbn")},m(e,r){k(e,t,r),x(t,n),x(t,o),x(t,l),x(t,s)},p:h,d(e){e&&j(t)}}}function St(e){let t,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,y,g,b,L,w,F,E,z,$,P,H,U,B,N,A,I,G,Z,R=Object.keys(e[6]._opt.years).sort(),Y=[];for(let t=0;t<R.length;t+=1)Y[t]=qt(ft(e,R,t));let V=Object.keys(e[6]._opt.years).sort(),J=[];for(let t=0;t<V.length;t+=1)J[t]=Ut(vt(e,V,t));let K=e[49],Q=[];for(let t=0;t<K.length;t+=1)Q[t]=Bt(_t(e,K,t));return{c(){t=D("div"),t.innerHTML="Фильтры - <b>ДТП Очаги (TMP)</b>",n=T(),o=D("div"),l=D("div"),s=D("fieldset"),r=D("legend"),r.textContent="Фильтрация по периодам:",i=T(),a=D("div"),c=D("input"),u=D("label"),u.textContent="Фильтрация по годам",_=T(),h=D("div");for(let e=0;e<Y.length;e+=1)Y[e].c();v=T(),f=D("div"),y=D("input"),b=D("label"),b.textContent="Фильтрация по кварталам",L=T(),w=D("div");for(let e=0;e<J.length;e+=1)J[e].c();F=T(),E=D("div"),z=D("select"),$=D("option"),$.textContent=`\n\t\t\t\t\t\tВсе типы (${e[49].reduce(e[105],0)})\n\t\t\t\t\t`;for(let e=0;e<Q.length;e+=1)Q[e].c();P=T(),H=D("div"),U=D("select"),B=D("option"),B.textContent="Очаги все",N=D("option"),N.textContent="Только с погибшими",A=D("option"),A.textContent="Только с пострадавшими",I=D("option"),I.textContent="С пострадавшими или погибшими",G=D("option"),G.textContent="С пострадавшими и погибшими",M(t,"class","pLine svelte-1jsovbn"),M(c,"type","radio"),c.__value=p=1,c.value=c.__value,c.checked=d=1===e[32],M(c,"id","hearths_period_type_tmp1"),M(c,"name","hearths_period_type_tmp"),M(c,"class","svelte-1jsovbn"),e[90][1].push(c),M(u,"for","hearths_period_type_tmp1"),M(u,"class","svelte-1jsovbn"),M(h,"class","pLine margin svelte-1jsovbn"),M(a,"class","pLine type svelte-1jsovbn"),M(y,"type","radio"),y.__value=g=2,y.value=y.__value,M(y,"id","hearths_period_type_tmp2"),M(y,"name","hearths_period_type_tmp"),M(y,"class","svelte-1jsovbn"),e[90][1].push(y),M(b,"for","hearths_period_type_tmp2"),M(b,"class","svelte-1jsovbn"),M(w,"class","pLine margin svelte-1jsovbn"),M(f,"class","pLine type svelte-1jsovbn"),M(l,"class","pLine nowrap svelte-1jsovbn"),$.__value="",$.value=$.__value,M($,"class","svelte-1jsovbn"),M(z,"class","multiple_icon_typeTmp svelte-1jsovbn"),z.multiple=!0,void 0===e[31]&&W(()=>e[106].call(z)),M(E,"class","pLine svelte-1jsovbn"),B.__value="",B.value=B.__value,N.__value="1",N.value=N.__value,A.__value="2",A.value=A.__value,I.__value="3",I.value=I.__value,G.__value="4",G.value=G.__value,M(U,"class","svelte-1jsovbn"),void 0===e[30]&&W(()=>e[107].call(U)),M(H,"class","pLine svelte-1jsovbn"),M(o,"class","filtersCont svelte-1jsovbn")},m(p,d,g){k(p,t,d),k(p,n,d),k(p,o,d),x(o,l),x(l,s),x(s,r),x(s,i),x(s,a),x(a,c),c.checked=c.__value===e[32],x(a,u),x(a,_),x(a,h);for(let e=0;e<Y.length;e+=1)Y[e].m(h,null);x(s,v),x(s,f),x(f,y),y.checked=y.__value===e[32],x(f,b),x(f,L),x(f,w);for(let e=0;e<J.length;e+=1)J[e].m(w,null);x(o,F),x(o,E),x(E,z),x(z,$);for(let e=0;e<Q.length;e+=1)Q[e].m(z,null);q(z,e[31]),x(o,P),x(o,H),x(H,U),x(U,B),x(U,N),x(U,A),x(U,I),x(U,G),S(U,e[30]),g&&m(Z),Z=[O(c,"change",e[68]),O(c,"change",e[103]),O(y,"change",e[68]),O(y,"change",e[104]),O(z,"change",e[106]),O(z,"change",e[68]),O(U,"change",e[107]),O(U,"change",e[68])]},p(e,t){if(2&t[1]&&d!==(d=1===e[32])&&(c.checked=d),2&t[1]&&(c.checked=c.__value===e[32]),64&t[0]|6&t[1]|64&t[2]){let n;for(R=Object.keys(e[6]._opt.years).sort(),n=0;n<R.length;n+=1){const o=ft(e,R,n);Y[n]?Y[n].p(o,t):(Y[n]=qt(o),Y[n].c(),Y[n].m(h,null))}for(;n<Y.length;n+=1)Y[n].d(1);Y.length=R.length}if(2&t[1]&&(y.checked=y.__value===e[32]),64&t[0]|10&t[1]|64&t[2]){let n;for(V=Object.keys(e[6]._opt.years).sort(),n=0;n<V.length;n+=1){const o=vt(e,V,n);J[n]?J[n].p(o,t):(J[n]=Ut(o),J[n].c(),J[n].m(w,null))}for(;n<J.length;n+=1)J[n].d(1);J.length=V.length}if(393216&t[1]){let n;for(K=e[49],n=0;n<K.length;n+=1){const o=_t(e,K,n);Q[n]?Q[n].p(o,t):(Q[n]=Bt(o),Q[n].c(),Q[n].m(z,null))}for(;n<Q.length;n+=1)Q[n].d(1);Q.length=K.length}1&t[1]&&q(z,e[31]),1073741824&t[0]&&S(U,e[30])},d(l){l&&j(t),l&&j(n),l&&j(o),e[90][1].splice(e[90][1].indexOf(c),1),C(Y,l),e[90][1].splice(e[90][1].indexOf(y),1),C(J,l),C(Q,l),m(Z)}}}function qt(e){let t,n,o,l,s,r,i,a=e[125]+"";return{c(){t=D("input"),s=D("label"),r=w(a),M(t,"type","checkbox"),M(t,"id","hearths_year_tmp"),t.checked=n=e[33][e[125]],t.disabled=o=2===e[32],M(t,"name",l=e[125]),M(t,"class","svelte-1jsovbn"),M(s,"for","hearths_year_tmp"),M(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,t,o),k(n,s,o),x(s,r),l&&i(),i=O(t,"change",e[68])},p(e,s){64&s[0]|4&s[1]&&n!==(n=e[33][e[125]])&&(t.checked=n),2&s[1]&&o!==(o=2===e[32])&&(t.disabled=o),64&s[0]&&l!==(l=e[125])&&M(t,"name",l),64&s[0]&&a!==(a=e[125]+"")&&$(r,a)},d(e){e&&j(t),e&&j(s),i()}}}function Ht(e){let t,n,o,l,s,r,i,a,c,p,d=e[136]+"",u=e[125]+"";return{c(){t=D("input"),s=D("label"),r=w(d),i=w(" кв. "),a=w(u),M(t,"type","checkbox"),M(t,"id","hearths_quarter_tmp"),t.checked=n=e[34][e[125]]&&e[34][e[125]][e[136]],t.disabled=o=1===e[32],M(t,"name",l=e[125]+"_"+e[136]),M(t,"class","svelte-1jsovbn"),M(s,"for",c="hearths_quarter_tmp_"+e[125]+"_"+e[136]),M(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,t,o),k(n,s,o),x(s,r),x(s,i),x(s,a),l&&p(),p=O(t,"change",e[68])},p(e,i){64&i[0]|8&i[1]&&n!==(n=e[34][e[125]]&&e[34][e[125]][e[136]])&&(t.checked=n),2&i[1]&&o!==(o=1===e[32])&&(t.disabled=o),64&i[0]&&l!==(l=e[125]+"_"+e[136])&&M(t,"name",l),64&i[0]&&d!==(d=e[136]+"")&&$(r,d),64&i[0]&&u!==(u=e[125]+"")&&$(a,u),64&i[0]&&c!==(c="hearths_quarter_tmp_"+e[125]+"_"+e[136])&&M(s,"for",c)},d(e){e&&j(t),e&&j(s),p()}}}function Ut(e){let t,n,o=Object.keys(e[6]._opt.years[e[125]]).sort(),l=[];for(let t=0;t<o.length;t+=1)l[t]=Ht(ht(e,o,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=T(),n=D("br")},m(e,o){for(let t=0;t<l.length;t+=1)l[t].m(e,o);k(e,t,o),k(e,n,o)},p(e,n){if(64&n[0]|10&n[1]|64&n[2]){let s;for(o=Object.keys(e[6]._opt.years[e[125]]).sort(),s=0;s<o.length;s+=1){const r=ht(e,o,s);l[s]?l[s].p(r,n):(l[s]=Ht(r),l[s].c(),l[s].m(t.parentNode,t))}for(;s<l.length;s+=1)l[s].d(1);l.length=o.length}},d(e){C(l,e),e&&j(t),e&&j(n)}}}function Bt(e){let t,n,o,l,s,r,i,a=e[125]+"",c=e[48].str_icon_type[e[125]]+"";return{c(){t=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),t.__value=r=e[125],t.value=t.__value,M(t,"class",i="icon_type_"+e[48].iconType[e[125]]+" svelte-1jsovbn")},m(e,r){k(e,t,r),x(t,n),x(t,o),x(t,l),x(t,s)},p:h,d(e){e&&j(t)}}}function Nt(e){let t,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,y,g,b,L,w,F,E,z,$,P,H,U,B,N,A,I,G,Z,R,Y,V=Object.keys(e[7]._opt.years).sort(),J=[];for(let t=0;t<V.length;t+=1)J[t]=At(ut(e,V,t));let K=Object.keys(e[7]._opt.years).sort(),Q=[];for(let t=0;t<K.length;t+=1)Q[t]=Gt(dt(e,K,t));let X=e[47],ee=[];for(let t=0;t<X.length;t+=1)ee[t]=Zt(ct(e,X,t));return{c(){t=D("div"),t.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=D("div"),o.innerHTML="Фильтры - <b>ДТП Очаги</b>",l=T(),s=D("div"),r=D("div"),i=D("fieldset"),a=D("legend"),a.textContent="Фильтрация по периодам:",c=T(),p=D("div"),d=D("input"),h=D("label"),h.textContent="Фильтрация по годам",v=T(),f=D("div");for(let e=0;e<J.length;e+=1)J[e].c();y=T(),g=D("div"),b=D("input"),w=D("label"),w.textContent="Фильтрация по кварталам",F=T(),E=D("div");for(let e=0;e<Q.length;e+=1)Q[e].c();z=T(),$=D("div"),P=D("select"),H=D("option"),H.textContent=`\n\t\t\t\t\t\tВсе типы (${e[47].reduce(e[110],0)})\n\t\t\t\t\t`;for(let e=0;e<ee.length;e+=1)ee[e].c();U=T(),B=D("div"),N=D("select"),A=D("option"),A.textContent="Очаги все",I=D("option"),I.textContent="Только с погибшими",G=D("option"),G.textContent="Только с пострадавшими",Z=D("option"),Z.textContent="С пострадавшими или погибшими",R=D("option"),R.textContent="С пострадавшими и погибшими",M(t,"class","pLine svelte-1jsovbn"),M(o,"class","pLine svelte-1jsovbn"),M(d,"type","radio"),d.__value=u=1,d.value=d.__value,d.checked=_=1===e[37],M(d,"id","hearths_period_type1"),M(d,"name","hearths_period_type"),M(d,"class","svelte-1jsovbn"),e[90][0].push(d),M(h,"for","hearths_period_type1"),M(h,"class","svelte-1jsovbn"),M(f,"class","pLine margin svelte-1jsovbn"),M(p,"class","pLine type svelte-1jsovbn"),M(b,"type","radio"),b.__value=L=2,b.value=b.__value,M(b,"id","hearths_period_type2"),M(b,"name","hearths_period_type"),M(b,"class","svelte-1jsovbn"),e[90][0].push(b),M(w,"for","hearths_period_type2"),M(w,"class","svelte-1jsovbn"),M(E,"class","pLine margin svelte-1jsovbn"),M(g,"class","pLine type svelte-1jsovbn"),M(r,"class","pLine nowrap svelte-1jsovbn"),H.__value="",H.value=H.__value,M(H,"class","svelte-1jsovbn"),M(P,"class","multiple_icon_typeTmp svelte-1jsovbn"),P.multiple=!0,void 0===e[36]&&W(()=>e[111].call(P)),M($,"class","pLine svelte-1jsovbn"),A.__value="",A.value=A.__value,I.__value="1",I.value=I.__value,G.__value="2",G.value=G.__value,Z.__value="3",Z.value=Z.__value,R.__value="4",R.value=R.__value,M(N,"class","svelte-1jsovbn"),void 0===e[35]&&W(()=>e[112].call(N)),M(B,"class","pLine svelte-1jsovbn"),M(s,"class","filtersCont svelte-1jsovbn")},m(u,_,j){k(u,t,_),k(u,n,_),k(u,o,_),k(u,l,_),k(u,s,_),x(s,r),x(r,i),x(i,a),x(i,c),x(i,p),x(p,d),d.checked=d.__value===e[37],x(p,h),x(p,v),x(p,f);for(let e=0;e<J.length;e+=1)J[e].m(f,null);x(i,y),x(i,g),x(g,b),b.checked=b.__value===e[37],x(g,w),x(g,F),x(g,E);for(let e=0;e<Q.length;e+=1)Q[e].m(E,null);x(s,z),x(s,$),x($,P),x(P,H);for(let e=0;e<ee.length;e+=1)ee[e].m(P,null);q(P,e[36]),x(s,U),x(s,B),x(B,N),x(N,A),x(N,I),x(N,G),x(N,Z),x(N,R),S(N,e[35]),j&&m(Y),Y=[O(d,"change",e[69]),O(d,"change",e[108]),O(b,"change",e[69]),O(b,"change",e[109]),O(P,"change",e[111]),O(P,"change",e[69]),O(N,"change",e[112]),O(N,"change",e[69])]},p(e,t){if(64&t[1]&&_!==(_=1===e[37])&&(d.checked=_),64&t[1]&&(d.checked=d.__value===e[37]),128&t[0]|192&t[1]|128&t[2]){let n;for(V=Object.keys(e[7]._opt.years).sort(),n=0;n<V.length;n+=1){const o=ut(e,V,n);J[n]?J[n].p(o,t):(J[n]=At(o),J[n].c(),J[n].m(f,null))}for(;n<J.length;n+=1)J[n].d(1);J.length=V.length}if(64&t[1]&&(b.checked=b.__value===e[37]),128&t[0]|320&t[1]|128&t[2]){let n;for(K=Object.keys(e[7]._opt.years).sort(),n=0;n<K.length;n+=1){const o=dt(e,K,n);Q[n]?Q[n].p(o,t):(Q[n]=Gt(o),Q[n].c(),Q[n].m(E,null))}for(;n<Q.length;n+=1)Q[n].d(1);Q.length=K.length}if(98304&t[1]){let n;for(X=e[47],n=0;n<X.length;n+=1){const o=ct(e,X,n);ee[n]?ee[n].p(o,t):(ee[n]=Zt(o),ee[n].c(),ee[n].m(P,null))}for(;n<ee.length;n+=1)ee[n].d(1);ee.length=X.length}32&t[1]&&q(P,e[36]),16&t[1]&&S(N,e[35])},d(r){r&&j(t),r&&j(n),r&&j(o),r&&j(l),r&&j(s),e[90][0].splice(e[90][0].indexOf(d),1),C(J,r),e[90][0].splice(e[90][0].indexOf(b),1),C(Q,r),C(ee,r),m(Y)}}}function At(e){let t,n,o,l,s,r,i,a,c=e[125]+"";return{c(){t=D("input"),s=D("label"),r=w(c),M(t,"type","checkbox"),M(t,"id","hearths_year"),t.checked=n=e[38][e[125]],t.disabled=o=2===e[37],M(t,"name",l=e[125]),M(t,"class","svelte-1jsovbn"),M(s,"for",i="hearths_year"+e[125]),M(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,t,o),k(n,s,o),x(s,r),l&&a(),a=O(t,"change",e[69])},p(e,a){128&a[0]|128&a[1]&&n!==(n=e[38][e[125]])&&(t.checked=n),64&a[1]&&o!==(o=2===e[37])&&(t.disabled=o),128&a[0]&&l!==(l=e[125])&&M(t,"name",l),128&a[0]&&c!==(c=e[125]+"")&&$(r,c),128&a[0]&&i!==(i="hearths_year"+e[125])&&M(s,"for",i)},d(e){e&&j(t),e&&j(s),a()}}}function It(e){let t,n,o,l,s,r,i,a,c,p,d=e[136]+"",u=e[125]+"";return{c(){t=D("input"),s=D("label"),r=w(d),i=w(" кв. "),a=w(u),M(t,"type","checkbox"),M(t,"id","hearths_quarter"),t.checked=n=e[39][e[125]]&&e[39][e[125]][e[136]],t.disabled=o=1===e[37],M(t,"name",l=e[125]+"_"+e[136]),M(t,"class","svelte-1jsovbn"),M(s,"for",c="hearths_quarter_"+e[125]+"_"+e[136]),M(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,t,o),k(n,s,o),x(s,r),x(s,i),x(s,a),l&&p(),p=O(t,"change",e[69])},p(e,i){128&i[0]|256&i[1]&&n!==(n=e[39][e[125]]&&e[39][e[125]][e[136]])&&(t.checked=n),64&i[1]&&o!==(o=1===e[37])&&(t.disabled=o),128&i[0]&&l!==(l=e[125]+"_"+e[136])&&M(t,"name",l),128&i[0]&&d!==(d=e[136]+"")&&$(r,d),128&i[0]&&u!==(u=e[125]+"")&&$(a,u),128&i[0]&&c!==(c="hearths_quarter_"+e[125]+"_"+e[136])&&M(s,"for",c)},d(e){e&&j(t),e&&j(s),p()}}}function Gt(e){let t,n,o=Object.keys(e[7]._opt.years[e[125]]).sort(),l=[];for(let t=0;t<o.length;t+=1)l[t]=It(pt(e,o,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=T(),n=D("br")},m(e,o){for(let t=0;t<l.length;t+=1)l[t].m(e,o);k(e,t,o),k(e,n,o)},p(e,n){if(128&n[0]|320&n[1]|128&n[2]){let s;for(o=Object.keys(e[7]._opt.years[e[125]]).sort(),s=0;s<o.length;s+=1){const r=pt(e,o,s);l[s]?l[s].p(r,n):(l[s]=It(r),l[s].c(),l[s].m(t.parentNode,t))}for(;s<l.length;s+=1)l[s].d(1);l.length=o.length}},d(e){C(l,e),e&&j(t),e&&j(n)}}}function Zt(e){let t,n,o,l,s,r,i,a=e[125]+"",c=e[46].str_icon_type[e[125]]+"";return{c(){t=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),t.__value=r=e[125],t.value=t.__value,M(t,"class",i="icon_type_"+e[46].iconType[e[125]]+" svelte-1jsovbn")},m(e,r){k(e,t,r),x(t,n),x(t,o),x(t,l),x(t,s)},p:h,d(e){e&&j(t)}}}function Rt(e){let t;return{c(){t=D("div"),t.textContent="Нет включенных слоев",M(t,"class","pLine svelte-1jsovbn")},m(e,n){k(e,t,n)},p:h,d(e){e&&j(t)}}}function Yt(e){let t,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,y,g,b,L,C,F,E,z,S,q,H,U,B,N,A,I,G,Z,R,Y,V,J,K,W,Q,X,ee,te,ne,oe;return{c(){t=D("div"),t.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=D("div"),l=D("button"),s=T(),r=D("input"),i=T(),a=D("input"),c=T(),p=D("button"),d=T(),u=D("div"),_=D("br"),h=T(),v=D("label"),f=D("input"),g=D("span"),b=w("Мин.яркость ("),L=w(e[15]),C=w(")"),F=T(),E=D("br"),z=T(),S=D("label"),q=D("input"),U=D("span"),B=w("Радиус ("),N=w(e[13]),A=w(")"),I=T(),G=D("br"),Z=T(),R=D("label"),Y=D("input"),J=D("span"),K=w("Размытие ("),W=w(e[14]),Q=w(")"),X=T(),ee=D("div"),te=D("input"),ne=D("label"),ne.textContent="- тепловая карта",M(t,"class","pLine svelte-1jsovbn"),M(l,"class","pika-prev"),M(r,"type","text"),M(r,"class","begDate svelte-1jsovbn"),M(a,"type","text"),M(a,"class","endDate svelte-1jsovbn"),M(p,"class","pika-next"),M(o,"class","pikaday pLine svelte-1jsovbn"),M(f,"type","range"),M(f,"min","0.05"),M(f,"max","1"),M(f,"step","0.01"),f.disabled=y=!e[56],M(f,"class","svelte-1jsovbn"),M(v,"class","svelte-1jsovbn"),M(q,"type","range"),M(q,"min","0"),M(q,"max","100"),M(q,"step","1"),q.disabled=H=!e[56],M(q,"class","svelte-1jsovbn"),M(S,"class","svelte-1jsovbn"),M(Y,"type","range"),M(Y,"min","0"),M(Y,"max","15"),M(Y,"step","0.01"),Y.disabled=V=!e[56],M(Y,"class","svelte-1jsovbn"),M(R,"class","svelte-1jsovbn"),M(u,"class","pLine svelte-1jsovbn"),M(te,"type","checkbox"),te.checked=!0,M(te,"name","heat"),M(te,"class","svelte-1jsovbn"),M(ne,"for","heat"),M(ne,"class","svelte-1jsovbn"),M(ee,"class","pLine svelte-1jsovbn")},m(y,j,D){k(y,t,j),k(y,n,j),k(y,o,j),x(o,l),x(o,s),x(o,r),e[113](r),x(o,i),x(o,a),e[114](a),x(o,c),x(o,p),k(y,d,j),k(y,u,j),x(u,_),x(u,h),x(u,v),x(v,f),P(f,e[15]),x(v,g),x(g,b),x(g,L),x(g,C),x(u,F),x(u,E),x(u,z),x(u,S),x(S,q),P(q,e[13]),x(S,U),x(U,B),x(U,N),x(U,A),x(u,I),x(u,G),x(u,Z),x(u,R),x(R,Y),P(Y,e[14]),x(R,J),x(J,K),x(J,W),x(J,Q),k(y,X,j),k(y,ee,j),x(ee,te),e[118](te),x(ee,ne),D&&m(oe),oe=[O(l,"click",e[63]),O(p,"click",e[64]),O(f,"change",e[115]),O(f,"input",e[115]),O(f,"input",e[58]),O(q,"change",e[116]),O(q,"input",e[116]),O(q,"input",e[58]),O(Y,"change",e[117]),O(Y,"input",e[117]),O(Y,"input",e[58]),O(te,"change",e[57])]},p(e,t){32768&t[0]&&P(f,e[15]),32768&t[0]&&$(L,e[15]),8192&t[0]&&P(q,e[13]),8192&t[0]&&$(N,e[13]),16384&t[0]&&P(Y,e[14]),16384&t[0]&&$(W,e[14])},d(l){l&&j(t),l&&j(n),l&&j(o),e[113](null),e[114](null),l&&j(d),l&&j(u),l&&j(X),l&&j(ee),e[118](null),m(oe)}}}function Vt(e){let t,n,o,l,s,r,i,a,c,p,d,u,_,h,v;function f(e,t){return e[0]._arm?Kt:Jt}let y=f(e),g=y(e),b=e[40].collision_type&&function(e){let t,n,o,l,s=e[41],r=[];for(let t=0;t<s.length;t+=1)r[t]=Wt(at(e,s,t));return{c(){t=D("div"),n=D("select"),o=D("option"),o.textContent=`\n\t\t\t\t\t\tВсе типы (${e[41].reduce(e[119],0)})\n\t\t\t\t\t`;for(let e=0;e<r.length;e+=1)r[e].c();o.__value="",o.value=o.__value,M(o,"class","svelte-1jsovbn"),M(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===e[10]&&W(()=>e[120].call(n)),M(t,"class","pLine svelte-1jsovbn")},m(s,i,a){k(s,t,i),x(t,n),x(n,o);for(let e=0;e<r.length;e+=1)r[e].m(n,null);q(n,e[10]),a&&m(l),l=[O(n,"change",e[120]),O(n,"change",e[59])]},p(e,t){if(1536&t[1]){let o;for(s=e[41],o=0;o<s.length;o+=1){const l=at(e,s,o);r[o]?r[o].p(l,t):(r[o]=Wt(l),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=s.length}1024&t[0]&&q(n,e[10])},d(e){e&&j(t),C(r,e),m(l)}}}(e);return{c(){t=D("div"),t.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=D("div"),o.innerHTML="Фильтры - <b>ДТП Сводный</b>",l=T(),s=D("div"),r=D("div"),i=D("input"),a=D("label"),a.textContent="Все",c=T(),g.c(),p=T(),d=D("div"),u=D("input"),_=D("label"),_.textContent="Только ГИБДД",h=T(),b&&b.c(),M(t,"class","pLine svelte-1jsovbn"),M(o,"class","pLine svelte-1jsovbn"),M(i,"type","radio"),M(i,"id","d0"),M(i,"name","drone"),i.value="0",i.checked=!0,M(i,"class","svelte-1jsovbn"),M(a,"for","d0"),M(a,"class","svelte-1jsovbn"),M(r,"class","pLine svelte-1jsovbn"),M(u,"type","radio"),M(u,"id","d3"),M(u,"name","drone"),u.value="3",M(u,"class","svelte-1jsovbn"),M(_,"for","d3"),M(_,"class","svelte-1jsovbn"),M(d,"class","pLine svelte-1jsovbn"),M(s,"class","filtersCont svelte-1jsovbn")},m(f,y,j){k(f,t,y),k(f,n,y),k(f,o,y),k(f,l,y),k(f,s,y),x(s,r),x(r,i),x(r,a),x(s,c),g.m(s,null),x(s,p),x(s,d),x(d,u),x(d,_),x(s,h),b&&b.m(s,null),j&&m(v),v=[O(i,"click",e[62]),O(u,"click",e[62])]},p(e,t){y===(y=f(e))&&g?g.p(e,t):(g.d(1),g=y(e),g&&(g.c(),g.m(s,p))),e[40].collision_type&&b.p(e,t)},d(e){e&&j(t),e&&j(n),e&&j(o),e&&j(l),e&&j(s),g.d(),b&&b.d(),m(v)}}}function Jt(e){let t,n,o,l,s,r,i,a;return{c(){t=D("div"),n=D("input"),o=D("label"),o.textContent="Только Пересечения",l=T(),s=D("div"),r=D("input"),i=D("label"),i.textContent="Только СКПДИ",M(n,"type","radio"),M(n,"id","d1"),M(n,"name","drone"),n.value="1",M(n,"class","svelte-1jsovbn"),M(o,"for","d1"),M(o,"class","svelte-1jsovbn"),M(t,"class","pLine svelte-1jsovbn"),M(r,"type","radio"),M(r,"id","d2"),M(r,"name","drone"),r.value="2",M(r,"class","svelte-1jsovbn"),M(i,"for","d2"),M(i,"class","svelte-1jsovbn"),M(s,"class","pLine svelte-1jsovbn")},m(c,p,d){k(c,t,p),x(t,n),x(t,o),k(c,l,p),k(c,s,p),x(s,r),x(s,i),d&&m(a),a=[O(n,"click",e[62]),O(r,"click",e[62])]},p:h,d(e){e&&j(t),e&&j(l),e&&j(s),m(a)}}}function Kt(e){let t,n,o,l;return{c(){t=D("div"),n=D("input"),o=D("label"),o.textContent="Только Пересечения ГИБДД и СКПДИ",M(n,"type","radio"),M(n,"id","d1"),M(n,"name","drone"),n.value="1",M(n,"class","svelte-1jsovbn"),M(o,"for","d1"),M(o,"class","svelte-1jsovbn"),M(t,"class","pLine svelte-1jsovbn")},m(s,r,i){k(s,t,r),x(t,n),x(t,o),i&&l(),l=O(n,"click",e[62])},p:h,d(e){e&&j(t),l()}}}function Wt(e){let t,n,o,l,s,r,i,a=e[125]+"",c=e[40].collision_type[e[125]]+"";return{c(){t=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),t.__value=r=e[125],t.value=t.__value,M(t,"class",i="icon_type_"+e[40].iconType[e[125]]+" svelte-1jsovbn")},m(e,r){k(e,t,r),x(t,n),x(t,o),x(t,l),x(t,s)},p:h,d(e){e&&j(t)}}}function Qt(e){let t,n,o,l,s,r=e[42].collision_type&&function(e){let t,n,o,l,s=e[43],r=[];for(let t=0;t<s.length;t+=1)r[t]=Xt(it(e,s,t));return{c(){t=D("div"),n=D("select"),o=D("option"),o.textContent=`\n\t\t\t\t\t\tВсе типы (${e[43].reduce(e[121],0)})\n\t\t\t\t\t`;for(let e=0;e<r.length;e+=1)r[e].c();o.__value="",o.value=o.__value,M(o,"class","svelte-1jsovbn"),M(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===e[11]&&W(()=>e[122].call(n)),M(t,"class","pLine svelte-1jsovbn")},m(s,i,a){k(s,t,i),x(t,n),x(n,o);for(let e=0;e<r.length;e+=1)r[e].m(n,null);q(n,e[11]),a&&m(l),l=[O(n,"change",e[122]),O(n,"change",e[61])]},p(e,t){if(6144&t[1]){let o;for(s=e[43],o=0;o<s.length;o+=1){const l=it(e,s,o);r[o]?r[o].p(l,t):(r[o]=Xt(l),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=s.length}2048&t[0]&&q(n,e[11])},d(e){e&&j(t),C(r,e),m(l)}}}(e);return{c(){t=D("div"),t.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=D("div"),o.innerHTML="Фильтры - <b>ДТП СКПДИ</b>",l=T(),s=D("div"),r&&r.c(),M(t,"class","pLine svelte-1jsovbn"),M(o,"class","pLine svelte-1jsovbn"),M(s,"class","filtersCont svelte-1jsovbn")},m(e,i){k(e,t,i),k(e,n,i),k(e,o,i),k(e,l,i),k(e,s,i),r&&r.m(s,null)},p(e,t){e[42].collision_type&&r.p(e,t)},d(e){e&&j(t),e&&j(n),e&&j(o),e&&j(l),e&&j(s),r&&r.d()}}}function Xt(e){let t,n,o,l,s,r,i,a=e[125]+"",c=e[42].collision_type[e[125]]+"";return{c(){t=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),t.__value=r=e[125],t.value=t.__value,M(t,"class",i="icon_type_"+e[42].iconType[e[125]]+" svelte-1jsovbn")},m(e,r){k(e,t,r),x(t,n),x(t,o),x(t,l),x(t,s)},p:h,d(e){e&&j(t)}}}function en(e){let t,n,o,l,s,r=e[44].collision_type&&function(e){let t,n,o,l,s=e[45],r=[];for(let t=0;t<s.length;t+=1)r[t]=tn(rt(e,s,t));return{c(){t=D("div"),n=D("select"),o=D("option"),o.textContent=`\n\t\t\t\t\t\tВсе типы (${e[45].reduce(e[123],0)})\n\t\t\t\t\t`;for(let e=0;e<r.length;e+=1)r[e].c();o.__value="",o.value=o.__value,M(o,"class","svelte-1jsovbn"),M(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===e[12]&&W(()=>e[124].call(n)),M(t,"class","pLine svelte-1jsovbn")},m(s,i,a){k(s,t,i),x(t,n),x(n,o);for(let e=0;e<r.length;e+=1)r[e].m(n,null);q(n,e[12]),a&&m(l),l=[O(n,"change",e[124]),O(n,"change",e[60])]},p(e,t){if(24576&t[1]){let o;for(s=e[45],o=0;o<s.length;o+=1){const l=rt(e,s,o);r[o]?r[o].p(l,t):(r[o]=tn(l),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=s.length}4096&t[0]&&q(n,e[12])},d(e){e&&j(t),C(r,e),m(l)}}}(e);return{c(){t=D("div"),t.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=D("div"),o.innerHTML="Фильтры - <b>ДТП ГИБДД</b>",l=T(),s=D("div"),r&&r.c(),M(t,"class","pLine svelte-1jsovbn"),M(o,"class","pLine svelte-1jsovbn"),M(s,"class","filtersCont svelte-1jsovbn")},m(e,i){k(e,t,i),k(e,n,i),k(e,o,i),k(e,l,i),k(e,s,i),r&&r.m(s,null)},p(e,t){e[44].collision_type&&r.p(e,t)},d(e){e&&j(t),e&&j(n),e&&j(o),e&&j(l),e&&j(s),r&&r.d()}}}function tn(e){let t,n,o,l,s,r,i,a=e[125]+"",c=e[44].collision_type[e[125]]+"";return{c(){t=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),t.__value=r=e[125],t.value=t.__value,M(t,"class",i="icon_type_"+e[44].iconType[e[125]]+" svelte-1jsovbn")},m(e,r){k(e,t,r),x(t,n),x(t,o),x(t,l),x(t,s)},p:h,d(e){e&&j(t)}}}function nn(e){let t,n,o,l,s,r,i,a,c,p=e[3]._map&&e[3]._opt&&e[3]._opt.years&&Ct(e),d=e[4]._map&&e[4]._opt&&e[4]._opt.years&&Tt(e),u=e[5]._map&&e[5]._opt&&e[5]._opt.years&&Et(e),_=e[6]._map&&e[6]._opt&&e[6]._opt.years&&St(e),v=e[7]._map&&e[7]._opt&&e[7]._opt.years&&Nt(e);function f(e,t){return e[0]._map||e[1]._map||e[2]._map?Yt:e[7]._map||e[6]._map?void 0:Rt}let m=f(e),y=m&&m(e),g=e[0]._map&&Vt(e),b=e[1]._map&&Qt(e),L=e[2]._map&&en(e);return{c(){t=D("div"),p&&p.c(),n=T(),d&&d.c(),o=T(),u&&u.c(),l=T(),_&&_.c(),s=T(),v&&v.c(),r=T(),y&&y.c(),i=T(),g&&g.c(),a=T(),b&&b.c(),c=T(),L&&L.c(),M(t,"class","mvsFilters")},m(e,h){k(e,t,h),p&&p.m(t,null),x(t,n),d&&d.m(t,null),x(t,o),u&&u.m(t,null),x(t,l),_&&_.m(t,null),x(t,s),v&&v.m(t,null),x(t,r),y&&y.m(t,null),x(t,i),g&&g.m(t,null),x(t,a),b&&b.m(t,null),x(t,c),L&&L.m(t,null)},p(e,h){e[3]._map&&e[3]._opt&&e[3]._opt.years?p?p.p(e,h):(p=Ct(e),p.c(),p.m(t,n)):p&&(p.d(1),p=null),e[4]._map&&e[4]._opt&&e[4]._opt.years?d?d.p(e,h):(d=Tt(e),d.c(),d.m(t,o)):d&&(d.d(1),d=null),e[5]._map&&e[5]._opt&&e[5]._opt.years?u?u.p(e,h):(u=Et(e),u.c(),u.m(t,l)):u&&(u.d(1),u=null),e[6]._map&&e[6]._opt&&e[6]._opt.years?_?_.p(e,h):(_=St(e),_.c(),_.m(t,s)):_&&(_.d(1),_=null),e[7]._map&&e[7]._opt&&e[7]._opt.years?v?v.p(e,h):(v=Nt(e),v.c(),v.m(t,r)):v&&(v.d(1),v=null),m===(m=f(e))&&y?y.p(e,h):(y&&y.d(1),y=m&&m(e),y&&(y.c(),y.m(t,i))),e[0]._map?g?g.p(e,h):(g=Vt(e),g.c(),g.m(t,a)):g&&(g.d(1),g=null),e[1]._map?b?b.p(e,h):(b=Qt(e),b.c(),b.m(t,c)):b&&(b.d(1),b=null),e[2]._map?L?L.p(e,h):(L=en(e),L.c(),L.m(t,null)):L&&(L.d(1),L=null)},i:h,o:h,d(e){e&&j(t),p&&p.d(),d&&d.d(),u&&u.d(),_&&_.d(),v&&v.d(),y&&y.d(),g&&g.d(),b&&b.d(),L&&L.d()}}}function on(e,t,n){let o,l,{DtpVerifyed:s}=t,{DtpHearths5:r}=t,{DtpHearths3:i}=t,{DtpHearthsStat:a}=t,{DtpHearthsTmp:c}=t,{DtpHearths:p}=t,{DtpSkpdi:d}=t,{DtpGibdd:u}=t,_=0;const h=new Date,v=new Date(new Date(h.getFullYear(),h.getMonth(),h.getDate()).getTime()),f=h,m=new Date(2018,0,1);let y,g,b,x=[m.getTime()/1e3,f.getTime()/1e3],k=s._opt||{},j=k.collision_type?Object.keys(k.collision_type).sort((e,t)=>k.collision_type[t]-k.collision_type[e]):[],C=d._opt||{},D=C.collision_type?Object.keys(C.collision_type).sort((e,t)=>C.collision_type[t]-C.collision_type[e]):[],w=u._opt||{},T=w.collision_type?Object.keys(w.collision_type).sort((e,t)=>w.collision_type[t]-w.collision_type[e]):[],F=p._opt||{},O=F.str_icon_type?Object.keys(F.str_icon_type).sort((e,t)=>F.str_icon_type[t]-F.str_icon_type[e]):[],E=c._opt||{},M=E.str_icon_type?Object.keys(E.str_icon_type).sort((e,t)=>E.str_icon_type[t]-E.str_icon_type[e]):[],$=a._opt||{},P=$.str_icon_type?Object.keys($.str_icon_type).sort((e,t)=>$.str_icon_type[t]-$.str_icon_type[e]):[],S=i._opt||{},q=S.str_icon_type?Object.keys(S.str_icon_type).sort((e,t)=>S.str_icon_type[t]-S.str_icon_type[e]):[],B=r._opt||{},N=B.str_icon_type?Object.keys(B.str_icon_type).sort((e,t)=>B.str_icon_type[t]-B.str_icon_type[e]):[],I=[""],G=[""],Z=[""],Y={radius:19,blur:11.26,minOpacity:.34},V=Y.radius,J=11.26,K=.34;const W=()=>{let e=[{type:"itemType",zn:_}];x&&e.push({type:"date",zn:x}),I&&e.push({type:"collision_type",zn:I}),s.setFilter(e)},Q=()=>{let e=[];x&&e.push({type:"date",zn:x}),Z&&e.push({type:"collision_type",zn:Z}),u.setFilter(e)},X=()=>{let e=[];x&&e.push({type:"date",zn:x}),G&&e.push({type:"collision_type",zn:G}),d.setFilter(e)};var ee;ee=()=>{let e={onSelect(e){this._o.field.value=this.toString(),x[this._o._dint]=this.getDate().getTime()/1e3+24*this._o._dint*60*60,W(),X(),Q()},toString(e,t){let n=e.getDate();n<10&&(n="0"+n);let o=e.getMonth()+1;return o<10&&(o="0"+o),`${n}.${o}.${e.getFullYear()}`},parse(e,t){const n=e.split("."),o=parseInt(n[0],10),l=parseInt(n[1],10)-1,s=parseInt(n[2],10);return new Date(s,l,o)},i18n:{previousMonth:"Предыдущий месяц",nextMonth:"Следующий месяц",months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],weekdays:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],weekdaysShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"]},format:"DD.MM.YYYY",setDefaultDate:!0,yearRange:20,blurFieldOnSelect:!1};y=new Pikaday(L.extend({},e,{_dint:0,field:o,defaultDate:new Date(1e3*x[0])})),g=new Pikaday(L.extend({},e,{_dint:1,field:l,defaultDate:new Date(1e3*x[1])}))},A().$$.on_mount.push(ee);let te,ne,oe=[""],le=1,se={},re={};Object.keys(B.years||{}).sort().forEach(e=>{n(20,se[e]=!0,se),Object.keys(B.years[e]).sort().forEach(t=>{ne={},ne[e]={},ne[e][t]=!0})}),re=ne||{};let ie,ae,ce=[""],pe=1,de={},ue={};Object.keys(S.years||{}).sort().forEach(e=>{n(24,de[e]=!0,de),Object.keys(S.years[e]).sort().forEach(t=>{ae={},ae[e]={},ae[e][t]=!0})}),ue=ae||{};let _e,he,ve=[""],fe=1,me={},ye={};Object.keys($.years||{}).sort().forEach(e=>{n(28,me[e]=!0,me),Object.keys($.years[e]).sort().forEach(t=>{he={},he[e]={},he[e][t]=!0})}),ye=he||{};let ge,be,xe=[""],ke=1,je={},Le={};Object.keys(E.years||{}).sort().forEach(e=>{n(33,je[e]=!0,je),Object.keys(E.years[e]).sort().forEach(t=>{be={},be[e]={},be[e][t]=!0})}),Le=be||{};let Ce,De,we=[""],Te=1,Fe={},Oe={};Object.keys(F.years||{}).sort().forEach(e=>{n(38,Fe[e]=!0,Fe),Object.keys(F.years[e]).sort().forEach(t=>{De={},De[e]={},De[e][t]=!0})}),Oe=De||{};return e.$set=e=>{"DtpVerifyed"in e&&n(0,s=e.DtpVerifyed),"DtpHearths5"in e&&n(3,r=e.DtpHearths5),"DtpHearths3"in e&&n(4,i=e.DtpHearths3),"DtpHearthsStat"in e&&n(5,a=e.DtpHearthsStat),"DtpHearthsTmp"in e&&n(6,c=e.DtpHearthsTmp),"DtpHearths"in e&&n(7,p=e.DtpHearths),"DtpSkpdi"in e&&n(1,d=e.DtpSkpdi),"DtpGibdd"in e&&n(2,u=e.DtpGibdd)},[s,d,u,r,i,a,c,p,o,l,I,G,Z,V,J,K,b,te,oe,le,se,ie,ce,pe,de,_e,ve,fe,me,ye,ge,xe,ke,je,Le,Ce,we,Te,Fe,Oe,k,j,C,D,w,T,F,O,E,M,$,P,S,q,B,N,Y,e=>{let t=e.target;n(2,u._needHeat=n(1,d._needHeat=n(0,s._needHeat=!!t.checked&&Y,s),d),u),Q(),X(),W()},()=>{let e={radius:V,blur:J,minOpacity:K};u._heat&&u._heat.setOptions(e),d._heat&&d._heat.setOptions(e),s._heat&&s._heat.setOptions(e)},W,Q,X,e=>{let t=e.target;_=Number(t.value),W()},()=>{let e=g.getDate(),t=y.getDate(),n=e-t;0===n&&(n=864e5),y.setDate(new Date(t.getTime()-n)),g.setDate(new Date(e.getTime()-n)),x=[y.getDate().getTime()/1e3,86400+g.getDate().getTime()/1e3],W()},()=>{let e=g.getDate(),t=y.getDate(),n=e-t;0===n&&(n=864e5),y.setDate(new Date(t.getTime()+n)),g.setDate(new Date(e.getTime()+n)),x=[y.getDate().getTime()/1e3,86400+g.getDate().getTime()/1e3],W()},e=>{let t=[],o=e.target||{},l=o.checked,s=o.id,i=o.name;if("hearths_period_type_52"===s)n(19,le=2);else if("hearths_period_type_51"===s)n(19,le=1);else if("hearths_year_5"===s)l?n(20,se[i]=!0,se):delete se[i];else if("hearths_quarter_5"===s){let e=i.split("_");l?(re[e[0]]||(re[e[0]]={}),re[e[0]][e[1]]=!0):(re[e[0]]&&delete re[e[0]][e[1]],0===Object.keys(re[e[0]]).length&&delete re[e[0]])}1===le?t.push({type:"year",zn:se}):2===le&&t.push({type:"quarter",zn:re}),te&&t.push({type:"stricken",zn:Number(te)}),oe.length>0&&oe[0]&&t.push({type:"str_icon_type",zn:oe}),r.setFilter(t)},e=>{let t=[],o=e.target||{},l=o.checked,s=o.id,r=o.name;if("hearths_period_type_32"===s)n(23,pe=2);else if("hearths_period_type_31"===s)n(23,pe=1);else if("hearths_year_3"===s)l?n(24,de[r]=!0,de):delete de[r];else if("hearths_quarter_3"===s){let e=r.split("_");l?(ue[e[0]]||(ue[e[0]]={}),ue[e[0]][e[1]]=!0):(ue[e[0]]&&delete ue[e[0]][e[1]],0===Object.keys(ue[e[0]]).length&&delete ue[e[0]])}1===pe?t.push({type:"year",zn:de}):2===pe&&t.push({type:"quarter",zn:ue}),ie&&t.push({type:"stricken",zn:Number(ie)}),ce.length>0&&ce[0]&&t.push({type:"str_icon_type",zn:ce}),i.setFilter(t)},e=>{let t=[],o=e.target||{},l=o.checked,s=o.id,r=o.name;if("hearths_period_type_Stat2"===s)n(27,fe=2);else if("hearths_period_type_Stat1"===s)n(27,fe=1);else if("hearths_year_Stat"===s)l?n(28,me[r]=!0,me):delete me[r];else if("hearths_quarter_Stat"===s){let e=r.split("_");l?(ye[e[0]]||n(29,ye[e[0]]={},ye),n(29,ye[e[0]][e[1]]=!0,ye)):(ye[e[0]]&&delete ye[e[0]][e[1]],0===Object.keys(ye[e[0]]).length&&delete ye[e[0]])}1===fe?t.push({type:"year",zn:me}):2===fe&&t.push({type:"quarter",zn:ye}),_e&&t.push({type:"stricken",zn:Number(_e)}),ve.length>0&&ve[0]&&t.push({type:"str_icon_type",zn:ve}),a.setFilter(t)},e=>{let t=[],o=e.target||{},l=o.checked,s=o.id,r=o.name;if("hearths_period_type_tmp2"===s)n(32,ke=2);else if("hearths_period_type_tmp1"===s)n(32,ke=1);else if("hearths_year_tmp"===s)l?n(33,je[r]=!0,je):delete je[r];else if("hearths_quarter_tmp"===s){let e=r.split("_");l?(Le[e[0]]||n(34,Le[e[0]]={},Le),n(34,Le[e[0]][e[1]]=!0,Le)):(Le[e[0]]&&delete Le[e[0]][e[1]],0===Object.keys(Le[e[0]]).length&&delete Le[e[0]])}1===ke?t.push({type:"year",zn:je}):2===ke&&t.push({type:"quarter",zn:Le}),ge&&t.push({type:"stricken",zn:Number(ge)}),xe.length>0&&xe[0]&&t.push({type:"str_icon_type",zn:xe}),c.setFilter(t)},e=>{let t=[],o=e.target||{},l=o.checked,s=o.id,r=o.name;if(console.log("setFilterHearths",l,s,r,e),"hearths_period_type2"===s)n(37,Te=2);else if("hearths_period_type1"===s)n(37,Te=1);else if("hearths_year"===s)l?n(38,Fe[r]=!0,Fe):delete Fe[r];else if("hearths_quarter"===s){let e=r.split("_");l?(Oe[e[0]]||n(39,Oe[e[0]]={},Oe),n(39,Oe[e[0]][e[1]]=!0,Oe)):(Oe[e[0]]&&delete Oe[e[0]][e[1]],0===Object.keys(Oe[e[0]]).length&&delete Oe[e[0]])}1===Te?t.push({type:"year",zn:Fe}):2===Te&&t.push({type:"quarter",zn:Oe}),Ce&&t.push({type:"stricken",zn:Number(Ce)}),we.length>0&&we[0]&&t.push({type:"str_icon_type",zn:we}),p.setFilter(t)},_,x,y,g,re,ne,ue,ae,he,be,De,h,v,f,m,void 0,void 0,void 0,void 0,function(){le=this.__value,n(19,le)},[[],[],[],[],[]],(e,t)=>e+=B.str_icon_type[t],function(){oe=U(this),n(18,oe),n(55,N)},function(){te=H(this),n(17,te)},function(){pe=this.__value,n(23,pe)},(e,t)=>e+=S.str_icon_type[t],function(){ce=U(this),n(22,ce),n(53,q)},function(){ie=H(this),n(21,ie)},function(){fe=this.__value,n(27,fe)},function(){fe=this.__value,n(27,fe)},(e,t)=>e+=$.str_icon_type[t],function(){ve=U(this),n(26,ve),n(51,P)},function(){_e=H(this),n(25,_e)},function(){ke=this.__value,n(32,ke)},function(){ke=this.__value,n(32,ke)},(e,t)=>e+=E.str_icon_type[t],function(){xe=U(this),n(31,xe),n(49,M)},function(){ge=H(this),n(30,ge)},function(){Te=this.__value,n(37,Te)},function(){Te=this.__value,n(37,Te)},(e,t)=>e+=F.str_icon_type[t],function(){we=U(this),n(36,we),n(47,O)},function(){Ce=H(this),n(35,Ce)},function(e){R[e?"unshift":"push"](()=>{n(8,o=e)})},function(e){R[e?"unshift":"push"](()=>{n(9,l=e)})},function(){K=z(this.value),n(15,K)},function(){V=z(this.value),n(13,V)},function(){J=z(this.value),n(14,J)},function(e){R[e?"unshift":"push"](()=>{n(16,b=e)})},(e,t)=>e+=k.collision_type[t],function(){I=U(this),n(10,I),n(41,j)},(e,t)=>e+=C.collision_type[t],function(){G=U(this),n(11,G),n(43,D)},(e,t)=>e+=w.collision_type[t],function(){Z=U(this),n(12,Z),n(45,T)}]}st._needHeat={radius:19,blur:11.26,minOpacity:.34},st.checkZoom=e=>{Object.keys(st._layers).length?e<12&&st.setFilter(lt):e>11&&st.setFilter(lt)},st.setFilter=e=>{st.clearLayers(),lt=e||[];let t=[],n=[];st._group&&(st._group.getLayers().forEach(e=>{let o=e.options.props,l=0;lt.forEach(e=>{"itemType"===e.type?(0===e.zn||1===e.zn&&o.id_stat&&o.id_skpdi||2===e.zn&&o.id_skpdi&&!o.id_stat||3===e.zn&&o.id_stat&&!o.id_skpdi)&&l++:"collision_type"===e.type?(""===e.zn[0]||e.zn.filter(e=>e===o.collision_type).length)&&l++:"date"===e.type&&o.date>=e.zn[0]&&o.date<e.zn[1]&&l++}),l===lt.length&&(t.push(e),n.push(e._latlng))}),st._needHeat?(st._map.addLayer(st._heat),st._heat.setLatLngs(n),st._heat.setOptions(st._needHeat),st._map._zoom>11&&st.addLayer(nt.layerGroup(t))):(st.addLayer(nt.layerGroup(t)),st._map.removeLayer(st._heat)))},st.on("remove",()=>{st._map.removeLayer(st._heat),st.clearLayers()}).on("add",e=>{st._heat=nt.heatLayer([],{interactive:!1}),fetch("https://dtp.mvs.group/scripts/index.php?request=get_collision",{}).then(e=>e.json()).then(e=>{let t={collision_type:{},iconType:{}},n=[],o=e.map(e=>{let o=e.iconType||0,l=[],s=!1,r="#2F4F4F";o&&(s=o%2==0,o>=1&&o<=6?r="#8B4513":7===o||8===o?r="#228B22":o>=9&&o<=14?r="#8B4513":15===o||16===o?r="#7B68EE":17!==o&&18!==o||(r="#2F4F4F")),e.id_skpdi&&l.push({type:"skpdi",id:e.id_skpdi}),e.id_stat&&l.push({type:"gibdd",id:e.id_stat}),e._cur=l,e.lat&&e.lon||(console.log("_______",e),e.lat=e.lon=0);let i=t.collision_type[e.collision_type];i?i++:i=1,t.collision_type[e.collision_type]=i,t.iconType[e.collision_type]=o;let a=nt.latLng(e.lat,e.lon);return n.push(a),new _(a,{props:e,radius:6,triangle:l.length>1,box:!!e.id_skpdi,stroke:s,fillColor:r}).bindPopup(ot).on("popupopen",e=>{!function(e){let t=nt.DomUtil.create("div");new tt({target:t,props:{prp:e}}),ot.setContent(t)}(e.target.options.props)}).on("popupclose",e=>{e.popup._svObj&&(e.popup._svObj.$destroy(),delete e.popup._svObj)})});st.addLayer(st._heat),st._heat.setLatLngs(n),st._heat.setOptions(st._needHeat),st._opt=t,st._group=nt.layerGroup(o),lt?st.setFilter(lt):st.addLayer(st._group),st.checkZoom(st._map._zoom),st._refreshFilters()})});class ln extends _e{constructor(e){super(),ue(this,e,on,nn,g,{DtpVerifyed:0,DtpHearths5:3,DtpHearths3:4,DtpHearthsStat:5,DtpHearthsTmp:6,DtpHearths:7,DtpSkpdi:1,DtpGibdd:2},[-1,-1,-1,-1,-1,-1])}}function sn(e,t,n){const o=e.slice();return o[7]=t[n],o[9]=n,o}function rn(e){let t,n;const o=new tt({props:{prp:e[7],closeMe:e[6]}});return{c(){t=D("div"),ae(o.$$.fragment),M(t,"class","win leaflet-popup-content-wrapper  svelte-mnr9l0")},m(e,l){k(e,t,l),ce(o,t,null),n=!0},p(e,t){const n={};1&t&&(n.prp=e[7]),2&t&&(n.closeMe=e[6]),o.$set(n)},i(e){n||(re(o.$$.fragment,e),n=!0)},o(e){ie(o.$$.fragment,e),n=!1},d(e){e&&j(t),pe(o)}}}function an(e){let t,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,y,g,b,L,C,F,E=new Date(1e3*e[7].date).toLocaleDateString()+"",z=e[7].lost+"",P=e[7].stricken+"",S=e[7].address+"";function q(...t){return e[4](e[9],...t)}function H(...t){return e[5](e[9],...t)}let U=e[1]===e[9]&&rn(e);return{c(){t=D("tr"),n=D("td"),o=D("ul"),l=D("li"),s=w(E),r=w(" погибших "),i=w(z),a=w(", раненых "),c=w(P),d=T(),u=D("tr"),_=D("td"),_.textContent="Адрес:",h=T(),v=D("td"),f=w(S),y=D("br"),g=D("span"),g.textContent="подробнее",b=T(),U&&U.c(),L=T(),M(l,"title",p="id: "+e[7].id),M(l,"class","svelte-mnr9l0"),M(n,"class","first svelte-mnr9l0"),M(n,"colspan","2"),M(_,"class","first svelte-mnr9l0"),M(g,"class","link svelte-mnr9l0")},m(e,p,j){k(e,t,p),x(t,n),x(n,o),x(o,l),x(l,s),x(l,r),x(l,i),x(l,a),x(l,c),k(e,d,p),k(e,u,p),x(u,_),x(u,h),x(u,v),x(v,f),x(v,y),x(v,g),x(v,b),U&&U.m(v,null),x(u,L),C=!0,j&&m(F),F=[O(l,"click",q),O(g,"click",H)]},p(t,n){e=t,(!C||1&n)&&E!==(E=new Date(1e3*e[7].date).toLocaleDateString()+"")&&$(s,E),(!C||1&n)&&z!==(z=e[7].lost+"")&&$(i,z),(!C||1&n)&&P!==(P=e[7].stricken+"")&&$(c,P),(!C||1&n&&p!==(p="id: "+e[7].id))&&M(l,"title",p),(!C||1&n)&&S!==(S=e[7].address+"")&&$(f,S),e[1]===e[9]?U?(U.p(e,n),re(U,1)):(U=rn(e),U.c(),re(U,1),U.m(v,null)):U&&(le(),ie(U,1,1,()=>{U=null}),se())},i(e){C||(re(U),C=!0)},o(e){ie(U),C=!1},d(e){e&&j(t),e&&j(d),e&&j(u),U&&U.d(),m(F)}}}function cn(e){let t,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,m,y,g,b,L,F,O,E,z,P,S,q,H,U,B,N,A,I,G,Z,R,Y,V,J,K=e[0].id+"",W=e[0].quarter?e[0].quarter+" кв.":"",Q=e[0].year+"",X=(e[0].str_icon_type||"")+"",ee=e[0].list_dtp.length+"",te=e[0].count_lost+"",ne=e[0].count_stricken+"",oe=e[0].list_dtp,ae=[];for(let t=0;t<oe.length;t+=1)ae[t]=an(sn(e,oe,t));const ce=e=>ie(ae[e],1,1,()=>{ae[e]=null});return{c(){t=D("div"),n=D("div"),o=w("Очаг ДТП (id: "),l=w(K),s=w(")"),r=T(),i=D("div"),a=w(W),c=T(),p=w(Q),d=w("г."),u=T(),_=D("div"),h=D("table"),v=D("tbody"),f=D("tr"),m=D("td"),m.textContent="Тип ДТП:",y=T(),g=D("td"),b=w(X),L=T(),F=D("tr"),O=D("td"),O.textContent="Всего ДТП:",E=T(),z=D("td"),P=w(ee),S=T(),q=D("tr"),H=D("td"),H.textContent="Погибших:",U=T(),B=D("td"),N=w(te),A=T(),I=D("tr"),G=D("td"),G.textContent="Раненых:",Z=T(),R=D("td"),Y=w(ne),V=T();for(let e=0;e<ae.length;e+=1)ae[e].c();M(n,"class","pLine"),M(i,"class","pLine"),M(m,"class","first svelte-mnr9l0"),M(O,"class","first svelte-mnr9l0"),M(H,"class","first svelte-mnr9l0"),M(G,"class","first svelte-mnr9l0"),M(h,"class","table svelte-mnr9l0"),M(_,"class","featureCont"),M(t,"class","mvsPopup svelte-mnr9l0")},m(e,j){k(e,t,j),x(t,n),x(n,o),x(n,l),x(n,s),x(t,r),x(t,i),x(i,a),x(i,c),x(i,p),x(i,d),x(t,u),x(t,_),x(_,h),x(h,v),x(v,f),x(f,m),x(f,y),x(f,g),x(g,b),x(v,L),x(v,F),x(F,O),x(F,E),x(F,z),x(z,P),x(v,S),x(v,q),x(q,H),x(q,U),x(q,B),x(B,N),x(v,A),x(v,I),x(I,G),x(I,Z),x(I,R),x(R,Y),x(v,V);for(let e=0;e<ae.length;e+=1)ae[e].m(v,null);J=!0},p(e,[t]){if((!J||1&t)&&K!==(K=e[0].id+"")&&$(l,K),(!J||1&t)&&W!==(W=e[0].quarter?e[0].quarter+" кв.":"")&&$(a,W),(!J||1&t)&&Q!==(Q=e[0].year+"")&&$(p,Q),(!J||1&t)&&X!==(X=(e[0].str_icon_type||"")+"")&&$(b,X),(!J||1&t)&&ee!==(ee=e[0].list_dtp.length+"")&&$(P,ee),(!J||1&t)&&te!==(te=e[0].count_lost+"")&&$(N,te),(!J||1&t)&&ne!==(ne=e[0].count_stricken+"")&&$(Y,ne),7&t){let n;for(oe=e[0].list_dtp,n=0;n<oe.length;n+=1){const o=sn(e,oe,n);ae[n]?(ae[n].p(o,t),re(ae[n],1)):(ae[n]=an(o),ae[n].c(),re(ae[n],1),ae[n].m(v,null))}for(le(),n=oe.length;n<ae.length;n+=1)ce(n);se()}},i(e){if(!J){for(let e=0;e<oe.length;e+=1)re(ae[e]);J=!0}},o(e){ae=ae.filter(Boolean);for(let e=0;e<ae.length;e+=1)ie(ae[e]);J=!1},d(e){e&&j(t),C(ae,e)}}}function pn(e,t,n){let o,{prp:l}=t;const s=e=>{let t=l._bounds.options.items[e];t&&t._map&&t._map.panTo(t._latlng)};return e.$set=e=>{"prp"in e&&n(0,l=e.prp)},[l,o,s,e=>{console.log("showDtpInfo ",e)},e=>{s(e)},e=>{n(1,o=e)},()=>{n(1,o=null)}]}class dn extends _e{constructor(e){super(),ue(this,e,pn,cn,g,{prp:0})}}const un=window.L,_n=un.popup(),hn=un.popup({minWidth:200});let vn;const fn=function(e){let t=un.DomUtil.create("div");return new tt({target:t,props:{prp:e}}),_n.setContent(t),t},mn=un.featureGroup([]);mn.setFilter=e=>{mn.clearLayers(),vn=e;let t=[];mn._group&&(mn._group.getLayers().forEach(e=>{let n=e.options.cluster,o=0;vn.forEach(e=>{if("quarter"===e.type)e.zn[n.year]&&e.zn[n.year][n.quarter]&&o++;else if("year"===e.type)e.zn[n.year]&&o++;else if("str_icon_type"===e.type)e.zn.filter(e=>e===n.str_icon_type).length&&o++;else if("stricken"===e.type){let t=e.zn;t?(1===t&&n.count_lost||2===t&&n.count_stricken||3===t&&(n.count_stricken||n.count_lost)||3===t&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===vn.length&&t.push(e)}),mn.addLayer(un.layerGroup(t)))},mn.on("remove",()=>{mn.clearLayers()}).on("add",e=>{let t={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(e=>fetch("https://dtp.mvs.group/scripts/hearths/"+e+".txt",{}).then(e=>e.json()))).then(e=>{e.forEach(e=>{e.forEach(e=>{let o=e.icon_type||1,l=un.latLngBounds(),s=e.list_dtp,r=!1,i="#FF0000";if(s.length){Number(e.year),Number(e.quarter);let a=t.years[e.year];a||(a=t.years[e.year]={}),t.years[e.year]=a;let c=a[e.quarter];e.quarter in a?c++:c=a[e.quarter]=1,a[e.quarter]=c;let p=t.str_icon_type[e.str_icon_type];p?p++:p=1,t.str_icon_type[e.str_icon_type]=p,t.iconType[e.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=un.latLng(o.lat,o.lon),a=[];l.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let c=t.dtps[n.id];return c?c[e.id]?c[e.id]++:c[e.id]=1:(c={},c[e.id]=1),t.dtps[n.id]=c,new _(un.latLng(o.lat,o.lon),{cluster:e,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(_n).on("popupopen",e=>{fn(e.target.options.props)}).on("popupclose",e=>{e.popup._svObj&&(e.popup._svObj.$destroy(),delete e.popup._svObj)})});e._bounds=un.rectangle(l,{items:d,cluster:e,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",e=>{let t=e.target;t._color=t.options.color,t.options.color="red",t._renderer._updateStyle(t)}).on("mouseout",e=>{let t=e.target;t.options.color=t._color,t._renderer._updateStyle(t)}).on("click",t=>{un.DomEvent.stopPropagation(t);let n,o=1e3,l=t.target,s=t.latlng;t.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(e=>{let t=e._latlng.distanceTo(s);t<o&&(o=t,n=e)}),o<10?(fn(n.options.props),_n.setLatLng(n._latlng).openOn(mn._map)):(!function(e){let t=un.DomUtil.create("div");new dn({target:t,props:{prp:e}}),hn.setContent(t)}(e),hn.setLatLng(s).openOn(mn._map))}),n.push(e._bounds),n=n.concat(d)}}),mn._opt=t,mn._group=un.layerGroup(n),vn?mn.setFilter(vn):mn.addLayer(mn._group),mn._refreshFilters()}),console.log("__allJson_____",e,mn._opt)})});const yn=window.L,gn=yn.popup(),bn=yn.popup({minWidth:200});let xn;const kn=function(e){let t=yn.DomUtil.create("div");return new tt({target:t,props:{prp:e}}),gn.setContent(t),t},jn=yn.featureGroup([]);jn.setFilter=e=>{jn.clearLayers(),xn=e;let t=[];jn._group&&(jn._group.getLayers().forEach(e=>{let n=e.options.cluster,o=0;xn.forEach(e=>{if("quarter"===e.type)e.zn[n.year]&&e.zn[n.year][n.quarter]&&o++;else if("year"===e.type)e.zn[n.year]&&o++;else if("str_icon_type"===e.type)e.zn.filter(e=>e===n.str_icon_type).length&&o++;else if("stricken"===e.type){let t=e.zn;t?(1===t&&n.count_lost||2===t&&n.count_stricken||3===t&&(n.count_stricken||n.count_lost)||3===t&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===xn.length&&t.push(e)}),jn.addLayer(yn.layerGroup(t)))},jn.on("remove",()=>{jn.clearLayers()}).on("add",e=>{let t={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(e=>fetch("https://dtp.mvs.group/scripts/hearthstmp/"+e+".txt",{}).then(e=>e.json()))).then(e=>{e.forEach(e=>{e.forEach(e=>{let o=e.icon_type||1,l=yn.latLngBounds(),s=e.list_dtp,r=!1,i="#FF0000";if(s.length){Number(e.year),Number(e.quarter);let a=t.years[e.year];a||(a=t.years[e.year]={}),t.years[e.year]=a;let c=a[e.quarter];e.quarter in a?c++:c=a[e.quarter]=1,a[e.quarter]=c;let p=t.str_icon_type[e.str_icon_type];p?p++:p=1,t.str_icon_type[e.str_icon_type]=p,t.iconType[e.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=yn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let c=t.dtps[n.id];return c?c[e.id]?c[e.id]++:c[e.id]=1:(c={},c[e.id]=1),t.dtps[n.id]=c,new _(yn.latLng(o.lat,o.lon),{cluster:e,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(gn).on("popupopen",e=>{kn(e.target.options.props)}).on("popupclose",e=>{e.popup._svObj&&(e.popup._svObj.$destroy(),delete e.popup._svObj)})});e._bounds=yn.rectangle(l,{items:d,cluster:e,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",e=>{let t=e.target;t._color=t.options.color,t.options.color="red",t._renderer._updateStyle(t)}).on("mouseout",e=>{let t=e.target;t.options.color=t._color,t._renderer._updateStyle(t)}).on("click",t=>{yn.DomEvent.stopPropagation(t);let n,o=1e3,l=t.target,s=t.latlng;t.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(e=>{let t=e._latlng.distanceTo(s);t<o&&(o=t,n=e)}),o<10?(kn(n.options.props),gn.setLatLng(n._latlng).openOn(jn._map)):(!function(e){let t=yn.DomUtil.create("div");new dn({target:t,props:{prp:e}}),bn.setContent(t)}(e),bn.setLatLng(s).openOn(jn._map))}),n.push(e._bounds),n=n.concat(d)}}),jn._opt=t,jn._group=yn.layerGroup(n),xn?jn.setFilter(xn):jn.addLayer(jn._group),jn._refreshFilters()}),console.log("__allJson_____",e,jn._opt)})});const Ln=window.L,Cn=Ln.popup(),Dn=Ln.popup({minWidth:200});let wn;const Tn=function(e){let t=Ln.DomUtil.create("div");return new tt({target:t,props:{prp:e}}),Cn.setContent(t),t},Fn=Ln.featureGroup([]);Fn.setFilter=e=>{Fn.clearLayers(),wn=e;let t=[];Fn._group&&(Fn._group.getLayers().forEach(e=>{let n=e.options.cluster,o=0;wn.forEach(e=>{if("quarter"===e.type)e.zn[n.year]&&e.zn[n.year][n.quarter]&&o++;else if("year"===e.type)e.zn[n.year]&&o++;else if("str_icon_type"===e.type)e.zn.filter(e=>e===n.str_icon_type).length&&o++;else if("stricken"===e.type){let t=e.zn;t?(1===t&&n.count_lost||2===t&&n.count_stricken||3===t&&(n.count_stricken||n.count_lost)||3===t&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===wn.length&&t.push(e)}),Fn.addLayer(Ln.layerGroup(t)))},Fn.on("remove",()=>{Fn.clearLayers()}).on("add",e=>{let t={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(e=>fetch("https://dtp.mvs.group/scripts/hearthsstat/"+e+".txt",{}).then(e=>e.json()))).then(e=>{e.forEach(e=>{e.forEach(e=>{let o=e.icon_type||1,l=Ln.latLngBounds(),s=e.list_dtp,r=!1,i="#FF0000";if(s.length){Number(e.year),Number(e.quarter);let a=t.years[e.year];a||(a=t.years[e.year]={}),t.years[e.year]=a;let c=a[e.quarter];e.quarter in a?c++:c=a[e.quarter]=1,a[e.quarter]=c;let p=t.str_icon_type[e.str_icon_type];p?p++:p=1,t.str_icon_type[e.str_icon_type]=p,t.iconType[e.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=Ln.latLng(o.lat,o.lon),a=[];l.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let c=t.dtps[n.id];return c?c[e.id]?c[e.id]++:c[e.id]=1:(c={},c[e.id]=1),t.dtps[n.id]=c,new _(Ln.latLng(o.lat,o.lon),{cluster:e,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(Cn).on("popupopen",e=>{Tn(e.target.options.props)}).on("popupclose",e=>{e.popup._svObj&&(e.popup._svObj.$destroy(),delete e.popup._svObj)})});e._bounds=Ln.rectangle(l,{items:d,cluster:e,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",e=>{let t=e.target;t._color=t.options.color,t.options.color="red",t._renderer._updateStyle(t)}).on("mouseout",e=>{let t=e.target;t.options.color=t._color,t._renderer._updateStyle(t)}).on("click",t=>{Ln.DomEvent.stopPropagation(t);let n,o=1e3,l=t.target,s=t.latlng,r=t.layerPoint;t.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(e=>{let t=e._point.distanceTo(r);t<o&&(o=t,n=e)}),o<10?(Tn(n.options.props),Cn.setLatLng(n._latlng).openOn(Fn._map)):(!function(e){let t=Ln.DomUtil.create("div");new dn({target:t,props:{prp:e}}),Dn.setContent(t)}(e),Dn.setLatLng(s).openOn(Fn._map))}),n.push(e._bounds),n=n.concat(d)}}),Fn._opt=t,Fn._group=Ln.layerGroup(n),wn?Fn.setFilter(wn):Fn.addLayer(Fn._group),Fn._refreshFilters()}),console.log("__allJson_____",e,Fn._opt)})});const On=window.L,En=On.popup(),Mn=On.popup({minWidth:200});let zn;const $n=function(e){let t=On.DomUtil.create("div");return new tt({target:t,props:{prp:e}}),En.setContent(t),t},Pn=On.featureGroup([]);Pn.setFilter=e=>{Pn.clearLayers(),zn=e;let t=[];Pn._group&&(Pn._group.getLayers().forEach(e=>{let n=e.options.cluster,o=0;zn.forEach(e=>{if("quarter"===e.type)e.zn[n.year]&&e.zn[n.year][n.quarter]&&o++;else if("year"===e.type)e.zn[n.year]&&o++;else if("str_icon_type"===e.type)e.zn.filter(e=>e===n.str_icon_type).length&&o++;else if("stricken"===e.type){let t=e.zn;t?(1===t&&n.count_lost||2===t&&n.count_stricken||3===t&&(n.count_stricken||n.count_lost)||3===t&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===zn.length&&t.push(e)}),Pn.addLayer(On.layerGroup(t)))},Pn.on("remove",()=>{Pn.clearLayers()}).on("add",e=>{let t={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(e=>fetch("https://dtp.mvs.group/scripts/hearths3/"+e+".txt",{}).then(e=>e.json()))).then(e=>{e.forEach(e=>{e.forEach(e=>{let o=e.icon_type||1,l=On.latLngBounds(),s=e.list_dtp,r=!1,i="#FF0000";if(s.length){Number(e.year),Number(e.quarter);let a=t.years[e.year];a||(a=t.years[e.year]={}),t.years[e.year]=a;let c=a[e.quarter];e.quarter in a?c++:c=a[e.quarter]=1,a[e.quarter]=c;let p,d=t.str_icon_type[e.str_icon_type];d?d++:d=1,t.str_icon_type[e.str_icon_type]=d,t.iconType[e.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let u=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=On.latLng(o.lat,o.lon),a=[];l.extend(s),n.id===e.head&&(p=n),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let c=t.dtps[n.id];return c?c[e.id]?c[e.id]++:c[e.id]=1:(c={},c[e.id]=1),t.dtps[n.id]=c,new _(On.latLng(o.lat,o.lon),{cluster:e,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(En).on("popupopen",e=>{$n(e.target.options.props)}).on("popupclose",e=>{e.popup._svObj&&(e.popup._svObj.$destroy(),delete e.popup._svObj)})});e._bounds=p?On.circle(On.latLng(p.coords.lat,p.coords.lon),{radius:e.radius||500,items:u,cluster:e,color:i}):On.rectangle(l,{items:u,cluster:e,fill:!0,color:i,dashArray:"8 3 1"}),e._bounds.on("mouseover",e=>{let t=e.target;t._color=t.options.color,t.options.color="red",t._renderer._updateStyle(t)}).on("mouseout",e=>{let t=e.target;t.options.color=t._color,t._renderer._updateStyle(t)}).on("click",t=>{On.DomEvent.stopPropagation(t);let n,o=1e3,l=t.target,s=t.latlng,r=t.layerPoint;t.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(e=>{let t=e._point.distanceTo(r);t<o&&(o=t,n=e)}),o<10?($n(n.options.props),En.setLatLng(n._latlng).openOn(Pn._map)):(!function(e){let t=On.DomUtil.create("div");new dn({target:t,props:{prp:e}}),Mn.setContent(t)}(e),Mn.setLatLng(s).openOn(Pn._map))}),n.push(e._bounds),n=n.concat(u)}}),Pn._opt=t,Pn._group=On.layerGroup(n),zn?Pn.setFilter(zn):Pn.addLayer(Pn._group),Pn._refreshFilters()}),console.log("__allJson_____",e,Pn._opt)})});const Sn=window.L,qn=Sn.popup(),Hn=Sn.popup({minWidth:200});let Un;const Bn=function(e){let t=Sn.DomUtil.create("div");return new tt({target:t,props:{prp:e}}),qn.setContent(t),t},Nn=Sn.featureGroup([]);Nn.setFilter=e=>{Nn.clearLayers(),Un=e;let t=[];Nn._group&&(Nn._group.getLayers().forEach(e=>{let n=e.options.cluster,o=0;Un.forEach(e=>{if("quarter"===e.type)e.zn[n.year]&&e.zn[n.year][n.quarter]&&o++;else if("year"===e.type)e.zn[n.year]&&o++;else if("str_icon_type"===e.type)e.zn.filter(e=>e===n.str_icon_type).length&&o++;else if("stricken"===e.type){let t=e.zn;t?(1===t&&!n.count_stricken&&n.count_lost||2===t&&n.count_stricken&&!n.count_lost||3===t&&(n.count_stricken||n.count_lost)||3===t&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===Un.length&&t.push(e)}),Nn.addLayer(Sn.layerGroup(t)))},Nn.on("remove",()=>{Nn.clearLayers()}).on("add",e=>{let t={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(e=>fetch("https://dtp.mvs.group/scripts/hearths5/"+e+".txt",{}).then(e=>e.json()))).then(e=>{e.forEach(e=>{e.forEach(e=>{let o=e.icon_type||1,l=Sn.latLngBounds(),s=e.list_dtp,r=!1,i="#FF0000";if(s.length){Number(e.year),Number(e.quarter);let a=t.years[e.year];a||(a=t.years[e.year]={}),t.years[e.year]=a;let c=a[e.quarter];e.quarter in a?c++:c=a[e.quarter]=1,a[e.quarter]=c;let p,d=t.str_icon_type[e.str_icon_type];d?d++:d=1,t.str_icon_type[e.str_icon_type]=d,t.iconType[e.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let u=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=Sn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id===e.head&&(p=n),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let c=t.dtps[n.id];return c?c[e.id]?c[e.id]++:c[e.id]=1:(c={},c[e.id]=1),t.dtps[n.id]=c,new _(Sn.latLng(o.lat,o.lon),{cluster:e,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(qn).on("popupopen",e=>{Bn(e.target.options.props)}).on("popupclose",e=>{e.popup._svObj&&(e.popup._svObj.$destroy(),delete e.popup._svObj)})});e._bounds=p?Sn.circle(Sn.latLng(p.coords.lat,p.coords.lon),{radius:e.radius||500,items:u,cluster:e,color:i}):Sn.rectangle(l,{items:u,cluster:e,fill:!0,color:i,dashArray:"8 3 1"}),e._bounds.on("mouseover",e=>{let t=e.target;t._color=t.options.color,t.options.color="red",t._renderer._updateStyle(t)}).on("mouseout",e=>{let t=e.target;t.options.color=t._color,t._renderer._updateStyle(t)}).on("click",t=>{Sn.DomEvent.stopPropagation(t);let n,o=1e3,l=t.target,s=t.latlng,r=t.layerPoint;t.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(e=>{let t=e._point.distanceTo(r);t<o&&(o=t,n=e)}),o<10?(Bn(n.options.props),qn.setLatLng(n._latlng).openOn(Nn._map)):(!function(e){let t=Sn.DomUtil.create("div");new dn({target:t,props:{prp:e}}),Hn.setContent(t)}(e),Hn.setLatLng(s).openOn(Nn._map))}),n.push(e._bounds),n=n.concat(u)}}),Nn._opt=t,Nn._group=Sn.layerGroup(n),Un?Nn.setFilter(Un):Nn.addLayer(Nn._group),Nn._refreshFilters()}),console.log("__allJson_____",e,Nn._opt)})});const An=window.L,In=An.map(document.body,{center:[55.758031,37.611694],minZoom:1,zoom:8,maxZoom:21,attributionControl:!1,trackResize:!0,fadeAnimation:!0,zoomAnimation:!0,distanceUnit:"auto",squareUnit:"auto"});var Gn=In._controlCorners,Zn=In._controlContainer,Rn="leaflet-top leaflet-bottom",Yn="leaflet-left leaflet-right",Vn={bottom:"leaflet-bottom "+Yn,gmxbottomleft:"leaflet-bottom leaflet-left",gmxbottomcenter:"leaflet-bottom "+Yn,gmxbottomright:"leaflet-bottom leaflet-right",center:Rn+" "+Yn,right:"leaflet-right "+Rn,left:"leaflet-left "+Rn,top:"leaflet-top "+Yn};for(var Jn in Vn)Gn[Jn]||(Gn[Jn]=An.DomUtil.create("div",Vn[Jn],Zn));In.addControl(An.control.gmxCenter()).addControl(An.control.fitCenter());var Kn=An.TileLayer.extend({options:{tilesCRS:An.CRS.EPSG3395},_getTiledPixelBounds:function(e){var t=An.TileLayer.prototype._getTiledPixelBounds.call(this,e);return this._shiftY=this._getShiftY(this._tileZoom),t.min.y+=this._shiftY,t.max.y+=this._shiftY,t},_tileOnError:function(e,t,n){var o=t.getAttribute("src"),l=o.indexOf("/mapcache/");if(l>-1){var s=new URL("http:"+o).searchParams,r=o.substr(l+1).split("/"),i=a[r[1]];t.src=An.Util.template(i.errorTileUrlPrefix+i.postfix,{z:s.get("z"),x:s.get("x"),y:s.get("y")})}e(n,t)},_getTilePos:function(e){return An.TileLayer.prototype._getTilePos.call(this,e).subtract([0,this._shiftY])},_getShiftY:function(e){var t=this._map,n=t.getCenter(),o=t.options.crs.project(n).y-this.options.tilesCRS.project(n).y;return Math.floor(An.CRS.scale(e)*o/40075016.685578495)}});An.TileLayer.Mercator=Kn,An.tileLayer.Mercator=function(e,t){return new Kn(e,t)};let Wn={};c.b||(c.b="m2"),["m2","m3"].forEach(e=>{let t=a[e],n=An.tileLayer.Mercator(t.prefix+t.postfix,t.options);Wn[t.title]=n,c.b===t.options.key&&n.addTo(In)}),Wn.OpenStreetMap=An.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:21,maxNativeZoom:18});let Qn={"ДТП Очаги(5)":Nn,"ДТП Очаги(3)":Pn,"ДТП Очаги(Stat)":Fn,"ДТП Очаги(tmp)":jn,"ДТП Очаги":mn,"ДТП Сводный":st,"ДТП СКПДИ":Ve,"ДТП ГИБДД":Pe},Xn=c.o?c.o.split(",").reduce((e,t)=>(e[t]=!0,e),{}):{};["m1","m4","m5"].forEach(e=>{let t=a[e],n=An.tileLayer.Mercator(t.prefix+t.postfix,t.options);Qn[t.title]=n,Xn[t.options.key]&&n.addTo(In)}),An.control.layers(Wn,Qn).addTo(In);let eo=An.control.gmxIcon({id:"filters",className:"leaflet-bar",togglable:!0,title:"Фильтры"}).on("statechange",(function(e){let t=e.target,n=t._container,o=t._win;t.options.isActive?o||(o=t._win=An.DomUtil.create("div","win leaflet-control-layers",n),An.DomEvent.disableScrollPropagation(o),o._Filters=new ln({target:o,props:{DtpGibdd:Pe,DtpSkpdi:Ve,DtpHearths5:Nn,DtpHearths3:Pn,DtpHearthsStat:Fn,DtpHearthsTmp:jn,DtpHearths:mn,DtpVerifyed:st}})):(t._win.parentNode.removeChild(t._win),t._win=null)})).addTo(In);const to=(e,t)=>{for(var n=Math.PI/180,o={lon:n*e.lng,lat:n*e.lat},l={lon:n*t.lng,lat:n*t.lat},s=6378137,r=6356752.3142,i=1/298.257223563,a=l.lon-o.lon,c=Math.atan((1-i)*Math.tan(o.lat)),p=Math.atan((1-i)*Math.tan(l.lat)),d=Math.sin(c),u=Math.cos(c),_=Math.sin(p),h=Math.cos(p),v=a,f=2*Math.PI,m=20;Math.abs(v-f)>1e-12&&--m>0;){var y=Math.sin(v),g=Math.cos(v),b=Math.sqrt(h*y*(h*y)+(u*_-d*h*g)*(u*_-d*h*g));if(0===b)return 0;var x=d*_+u*h*g,k=Math.atan2(b,x),j=u*h*y/b,L=1-j*j,C=x-2*d*_/L;isNaN(C)&&(C=0);var D=i/16*L*(4+i*(4-3*L));f=v,v=a+(1-D)*i*j*(k+D*b*(C+D*x*(2*C*C-1)))}if(0===m)return NaN;var w=L*(s*s/(r*r)-1),T=w/1024*(256+w*(w*(74-47*w)-128));return r*(1+w/16384*(4096+w*(w*(320-175*w)-768)))*(k-T*b*(C+T/4*(x*(2*C*C-1)-T/6*C*(4*b*b-3)*(4*C*C-3))))};let no,oo;In.pm.setLang("customName",{tooltips:{finishLine:"Щелкните любой существующий маркер для завершения"}},"ru"),In.pm.setLang("ru"),In.on("pm:create",e=>{In.removeLayer(e.layer),lo.setActive(!1)}).on("pm:drawstart",e=>{let t=e.workingLayer;if("Line"===e.shape){let n=In.pm.Draw.Line._hintMarker;n&&n.on("move",(function(e){var o=t.getLatLngs();if(o.length){var l=(e=>{let t=0,n=(e=e||[])[0];return e.forEach(e=>{t+=to(e,n),n=e}),t})(o),s=to(o[o.length-1],e.latlng),r=(l+=s)>1e3?(l/1e3).toFixed(2)+" км":Math.ceil(l)+" м",i=s>1e3?(s/1e3).toFixed(2)+" км":Math.ceil(s)+" м";n._tooltip.setContent("Отрезок <b>("+i+")</b>участка <b>("+r+")</b>")}})),no&&e.target.pm.Toolbar.buttons.drawPolyline.buttonsDomNode&&(oo=e.target.pm.Toolbar.buttons.drawPolyline.buttonsDomNode.children[1],oo.style.display="none")}});let lo=An.control.gmxIcon({id:"measure",className:"leaflet-bar",togglable:!0,title:"Включить/Отключить режим измерения расстояний"}).on("statechange",(function(e){no=e.target.options.isActive,no?In.pm.enableDraw("Line",{finishOn:"dblclick"}):(In.pm.disableDraw("Line"),oo&&(oo.style.display=""))})).addTo(In);const so=()=>{setTimeout(()=>{eo.options.isActive&&(eo.setActive(!1),eo._win=null,eo.setActive(!0))})};Pe._refreshFilters=Ve._refreshFilters=st._refreshFilters=mn._refreshFilters=Fn._refreshFilters=Pn._refreshFilters=Nn._refreshFilters=jn._refreshFilters=so;return Pe.on("remove",so),Ve.on("remove",so),st.on("remove",so),mn.on("remove",so),jn.on("remove",so),Fn.on("remove",so),Pn.on("remove",so),Nn.on("remove",so),In.on("zoomend",e=>{In._crpx=0,st._map&&st.checkZoom(In._zoom),Ve._map&&Ve.checkZoom(In._zoom),Pe._map&&Pe.checkZoom(In._zoom)}),In}();
//# sourceMappingURL=main.js.map
