var dtp=function(){"use strict";const t=window.L;t.Control.GmxIcon=t.Control.extend({includes:t.Evented?t.Evented.prototype:t.Mixin.Events,options:{position:"topleft",id:"defaultIcon",isActive:!1},setActive:function(e,n,o){var l=this.options,s=this._container;if(l.togglable||l.toggle){var r=l.isActive,i=this._prefix,a=i+"-"+l.id;l.isActive=e,this._img&&(e&&l.activeImageUrl?this._img.src=l.activeImageUrl:!e&&l.regularImageUrl&&(this._img.src=l.regularImageUrl)),e?(t.DomUtil.addClass(s,i+"-active"),t.DomUtil.addClass(s,a+"-active"),s.children.length&&t.DomUtil.addClass(s,i+"-externalImage-active"),l.styleActive&&this.setStyle(l.styleActive)):(t.DomUtil.removeClass(s,i+"-active"),t.DomUtil.removeClass(s,a+"-active"),s.children.length&&t.DomUtil.removeClass(s,i+"-externalImage-active"),l.style&&this.setStyle(l.style)),n||r===e||this.fire("statechange",o)}if(t.gmxUtil&&t.gmxUtil.isIEOrEdge){var p=s.getElementsByTagName("use");if(p.length){var c=p[0],d=c.getAttribute("href")||c.getAttribute("xlink:href");c.setAttribute("href",d)}}},onAdd:function(e){var n=null,o=this.options,l=o.svgSprite||e.options.svgSprite,s="leaflet-gmx-icon"+(!l||o.regularImageUrl||o.text?"":"Svg"),r=s+"-"+o.id;this._prefix=s;var i=t.DomUtil.create("div",s+" "+r);if(i._id=o.id,this._container=i,o.title&&(i.title=o.title),this.setStyle=function(t){for(var e in t)i.style[e]=t[e]},o.className&&t.DomUtil.addClass(i,o.className),o.regularImageUrl)(n=t.DomUtil.create("img","",i)).src=o.regularImageUrl,this._img=n,t.DomUtil.addClass(i,s+"-img"),t.DomUtil.addClass(i,s+"-externalImage");else if(o.text)t.DomUtil.addClass(i,s+"-text"),t.DomUtil.create("span","",i).innerHTML=o.text;else if(l){t.DomUtil.addClass(i,"svgIcon");var a="#"+o.id.toLowerCase();i.innerHTML='<svg role="img" class="svgIcon"><use xlink:href="'+a+'" href="'+a+'"></use></svg>'}else t.DomUtil.addClass(i,s+"-img "+s+"-sprite");o.style&&this.setStyle(o.style),this._iconClick=function(t){i.parentNode&&i===t.toElement&&(this.setActive(!this.options.isActive,!1,t),this.fire("click",t),this.options.stateChange&&this.options.stateChange(this,t))};var p=t.DomEvent.stopPropagation;t.DomEvent.preventDefault;return t.DomEvent.on(i,"mousemove",p).on(i,"touchstart",p).on(i,"mousedown",p).on(i,"dblclick",p).on(i,"click",p).on(i,"click",this._iconClick,this),o.onAdd&&o.onAdd(this),this.fire("controladd"),e.fire("controladd",this),o.notHide&&(i._notHide=!0),e.gmxControlsManager&&e.gmxControlsManager.add(this),i},onRemove:function(e){e.gmxControlsManager&&e.gmxControlsManager.remove(this),this.fire("controlremove"),e.fire("controlremove",this);var n=this._container,o=t.DomEvent.stopPropagation;t.DomEvent.off(n,"mousemove",o).off(n,"touchstart",o).off(n,"mousedown",o).off(n,"dblclick",o).off(n,"click",o).off(n,"click",this._iconClick,this)},addTo:function(e){return t.Control.prototype.addTo.call(this,e),this.options.addBefore&&this.addBefore(this.options.addBefore),this},addBefore:function(t){var e=this._parent&&this._parent._container;if(e||(e=this._map&&this._map._controlCorners[this.getPosition()]),e)for(var n=0,o=e.childNodes.length;n<o;n++){var l=e.childNodes[n];if(t===l._id){e.insertBefore(this._container,l);break}}else this.options.addBefore=t;return this}}),t.Control.gmxIcon=t.Control.GmxIcon,t.control.gmxIcon=function(e){return new t.Control.GmxIcon(e)};const e=window.L;e.Control.GmxCenter=e.Control.extend({options:{position:"center",id:"center",notHide:!0,color:"red"},onRemove:function(t){t.gmxControlsManager&&t.gmxControlsManager.remove(this),t.fire("controlremove",this)},onAdd:function(t){var n="http://www.w3.org/2000/svg",o=e.DomUtil.create("div","leaflet-gmx-center"),l=e.DomUtil.create("div","leaflet-gmx-center"),s=document.createElementNS(n,"svg"),r=document.createElementNS(n,"g"),i=document.createElementNS(n,"path");return this._container=o,o._id=this.options.id,this.options.notHide&&(o._notHide=!0),i.setAttribute("stroke-width",2),i.setAttribute("stroke-opacity",2),i.setAttribute("d","M9 0L9 18M0 9L18 9"),this._path=i,r.appendChild(i),s.appendChild(r),s.setAttribute("width",18),s.setAttribute("height",18),l.appendChild(s),o.appendChild(l),this.setColor(this.options.color),t.fire("controladd",this),t.gmxControlsManager&&t.gmxControlsManager.add(this),o},setColor:function(t){return this.options.color=t,this._map&&this._path.setAttribute("stroke",t),this}}),e.Control.gmxCenter=e.Control.GmxCenter,e.control.gmxCenter=function(t){return new e.Control.GmxCenter(t)};const n=window.L;n.Control.FitCenter=n.Control.extend({options:{position:"topright",id:"fitcenter",notHide:!0,color:"#216b9c"},onRemove:function(t){t.gmxControlsManager&&t.gmxControlsManager.remove(this),t.off("moveend",this._update,this).fire("controlremove",this)},onAdd:function(t){var e=this.options.id,o="leaflet-gmx-"+e,l=n.DomUtil.create("div",o),s=n.DomUtil.create("input","",l),r=n.DomUtil.create("button","",l),i=n.DomUtil.create("div","results",l);return r.title="Переместить центр карты",s.placeholder="Поиск по адресам, координатам",this._input=s,this._container=l,this._results=i,l._id=e,t.on("mousemove",t=>{this._results.style.display="none"},this),n.DomEvent.on(s,"input",this._getSuggestions,this),n.DomEvent.on(s,"contextmenu",n.DomEvent.stopPropagation,this),n.DomEvent.on(l,"mousemove",n.DomEvent.stop),n.DomEvent.on(l,"mouseover",t=>{"block"!==this._results.style.display&&(this._results.style.display="block")},this),n.DomEvent.on(r,"click",(function(){let e=s.value.match(/[+-]?([0-9]*[.])?[0-9]+/g);e&&e.length>1&&t.setView([Number(e[0]),Number(e[1])])})),n.DomEvent.disableClickPropagation(l),t.on("moveend",this._update,this).fire("controladd",this),t.gmxControlsManager&&t.gmxControlsManager.add(this),l},_parseSearch:function(t){if((t=t||[]).length){this._results;let e=document.createDocumentFragment();t.forEach(t=>{let o=t.display_name,l=t.boundingbox,s=n.DomUtil.create("div","",e);s.innerHTML=o,n.DomEvent.on(s,"click",t=>{this._map.fitBounds([[l[0],l[2]],[l[1],l[3]]])},this)}),this._results.innerText="",this._results.appendChild(e),this._results.classList.add("active")}},_getSuggestions:function(t){const e=t.target.value||"калужское шоссе",n=["format=json","limit=10","polygon_text=1","bounded=1","viewbox=34,53,41,57"].join("&"),o="&q="+encodeURI(e);fetch(`//nominatim.openstreetmap.org/search?${n}${o}`,{}).then(t=>t.json()).then(this._parseSearch.bind(this))},_update:function(t){this._map&&this.setCoords(this._map.getCenter())},_trunc:function(t){return(""+(Math.round(1e7*t)/1e7+1e-8)).substring(0,9)},setCoords:function(t){return this}}),n.control.fitCenter=function(t){return new n.Control.FitCenter(t)};const o='&copy; <a href="https://n.maps.yandex.ru/?oid=1900133#!/?z=18&ll=36.860478%2C55.429679&l=nk%23map">Yandex</a> contributors',l="//inv.mvs.group/mapcache/",s=new Date,r=s.getMonth()+1,i=s.getDate(),a=(s.getFullYear(),{m1:{title:"Дороги",prefix:l+"m1/",postfix:"?x={x}&y={y}&z={z}&l=mrcss",errorTileUrlPrefix:"//core-nmaps-mrc-browser.maps.yandex.ru/tiles",options:{key:"m1",minZoom:10,maxZoom:19,attribution:o}},m2:{title:"Карта(Яндекс)",prefix:l+"m2/tiles",postfix:"?l=map&v=18.01.10-2&x={x}&y={y}&z={z}&scale=1&lang=ru_RU",errorTileUrlPrefix:"//vec01.maps.yandex.net/tiles",options:{key:"m2",maxNativeZoom:19,maxZoom:21,attribution:o}},m3:{title:"Снимки(Яндекс)",prefix:l+"m3/tiles",postfix:"?l=sat&v=3.462.0&x={x}&y={y}&z={z}&lang=ru_RU",errorTileUrlPrefix:"//sat04.maps.yandex.net/tiles",options:{key:"m3",maxNativeZoom:19,maxZoom:21,attribution:o}},m4:{title:"Скорость(Народная карта)",prefix:l+"m4/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=104,301135,302526,302827,5300026,5400046,70300236,70300638",errorTileUrlPrefix:"//04.core-nmaps-renderer-nmaps.maps.yandex.net/tile",options:{key:"m4",minZoom:8,maxZoom:19,attribution:o}},m5:{title:"Светофоры",prefix:l+"m5/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=301750",errorTileUrlPrefix:"//04.core-nmaps-renderer-nmaps.maps.yandex.net/tile",options:{key:"m4",minZoom:12,maxZoom:19,attribution:o}},m6:{title:"Дороги в стадии строительства",prefix:"//03.core-nmaps-renderer-nmaps.maps.yandex.net/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=70300289",errorTileUrlPrefix:"//03.core-nmaps-renderer-nmaps.maps.yandex.net/",options:{key:"m6",minZoom:10,maxZoom:19,attribution:o}}}),p={};window.URLSearchParams&&new URLSearchParams(window.location.search).forEach((t,e)=>{p[e]=t});const c=window.L;let d=c.canvas();const u=function(t,e){var n=c.Projection.Mercator.project(e),o=c.Projection.Mercator.unproject(new c.Point(n.x+40,n.y+30));return 156543.033928041*Math.pow(2,-t)*((t,e)=>{for(var n=Math.PI/180,o={lon:n*t.lng,lat:n*t.lat},l={lon:n*e.lng,lat:n*e.lat},s=6378137,r=6356752.3142,i=1/298.257223563,a=l.lon-o.lon,p=Math.atan((1-i)*Math.tan(o.lat)),c=Math.atan((1-i)*Math.tan(l.lat)),d=Math.sin(p),u=Math.cos(p),_=Math.sin(c),h=Math.cos(c),v=a,f=2*Math.PI,m=20;Math.abs(v-f)>1e-12&&--m>0;){var g=Math.sin(v),y=Math.cos(v),b=Math.sqrt(h*g*(h*g)+(u*_-d*h*y)*(u*_-d*h*y));if(0===b)return 0;var x=d*_+u*h*y,k=Math.atan2(b,x),j=u*h*g/b,L=1-j*j,C=x-2*d*_/L;isNaN(C)&&(C=0);var w=i/16*L*(4+i*(4-3*L));f=v,v=a+(1-w)*i*j*(k+w*b*(C+w*x*(2*C*C-1)))}if(0===m)return NaN;var D=L*(s*s/(r*r)-1),F=D/1024*(256+D*(D*(74-47*D)-128));return r*(1+D/16384*(4096+D*(D*(320-175*D)-768)))*(k-F*b*(C+F/4*(x*(2*C*C-1)-F/6*C*(4*b*b-3)*(4*C*C-3))))})(e,o)/50},_=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),h={camera:((t,e,n)=>{let o=new Path2D(t),l=new Path2D;return l.addPath(o,_.translate(e,n).rotate(180).scale(-20/832,-20/832)),l})("M864 260H728l-32.4-90.8a32.07 32.07 0 0 0-30.2-21.2H358.6c-13.5 0-25.6 8.5-30.1 21.2L296 260H160c-44.2 0-80 35.8-80 80v456c0 44.2 35.8 80 80 80h704c44.2 0 80-35.8 80-80V340c0-44.2-35.8-80-80-80zM512 716c-88.4 0-160-71.6-160-160s71.6-160 160-160 160 71.6 160 160-71.6 160-160 160zm-96-160a96 96 0 1 0 192 0 96 96 0 1 0-192 0z",-12,-13)};c.canvas({padding:.5});c.Canvas.include({_updateMarkerPoint:function(t){if(!(!this._drawing||t._empty()||t.feature&&t.feature.properties._isHidden)){var e=t._point,n=t.options._radiusM,o=t.options.image,l=t._map,s=this._ctx,r=t.options.iconName||"border";if(l){if(o){let n=t.options.w||20,l=t.options.h||20;return void s.drawImage(o,e.x-n/2,e.y-l/2,n,l)}let i=l._zoom;n&&!l._rpx&&l._needRound&&(l._rpx=l._needRound*n/u(i,l.getCenter())),l._rpx>20&&l._needRound&&(s.save(),s.beginPath(),s.globalAlpha=.2,s.fillStyle="gray",s.arc(e.x,e.y,l._rpx,0,2*Math.PI),s.fill(),s.stroke(),s.closePath(),s.restore()),i>12&&(s.save(),s.beginPath(),s.globalAlpha=1,s.fillStyle="white",s.arc(e.x,e.y,14,0,2*Math.PI),s.fill(),s.closePath(),s.restore()),s.save(),s.beginPath(),s.translate(e.x-0,e.y-0),this._fillStroke(s,t),s.stroke(iconPaths[r].path),s.globalAlpha=t.options.fillOpacity,s.fill(iconPaths[r].path),s.closePath(),s.restore()}}},_updateCirclePoint:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=t.options,o=n.radius||14,l=2*o,s=(t._map,this._ctx);if(s.save(),s.beginPath(),s.globalAlpha=1,s.fillStyle=n.fillColor||"red",n.triangle)s.moveTo(e.x,e.y+o),s.lineTo(e.x+o,e.y-o),s.lineTo(e.x-o,e.y-o),s.lineTo(e.x,e.y+o);else if(n.rhomb)s.moveTo(e.x+o,e.y),s.lineTo(e.x,e.y+o),s.lineTo(e.x-o,e.y),s.lineTo(e.x,e.y-o),s.lineTo(e.x+o,e.y);else if(n.box)s.fillRect(e.x-o,e.y-o,l,l);else if(n.path){let t=h[n.path];s.translate(e.x,e.y),s.fill(t),s.stroke(t)}else s.arc(e.x,e.y,o,0,2*Math.PI);s.fill(),n.stroke&&(s.stroke(),n.triangle?(s.moveTo(e.x,e.y+o),s.lineTo(e.x+o,e.y-o),s.lineTo(e.x-o,e.y-o),s.lineTo(e.x,e.y+o)):n.box?s.strokeRect(e.x-o,e.y-o,l,l):s.arc(e.x,e.y,o,0,2*Math.PI)),s.closePath(),s.restore()}}});c.CircleMarker.extend({_updatePath:function(){this._renderer._updateMarkerPoint(this)}});const v=c.CircleMarker.extend({options:{renderer:d},_updatePath:function(){this._renderer._updateCirclePoint(this)}});c.Rectangle.extend({options:{renderer:d}});function f(){}function m(t){return t()}function g(){return Object.create(null)}function y(t){t.forEach(m)}function b(t){return"function"==typeof t}function x(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function k(t){return null==t?"":t}function j(t,e){t.appendChild(e)}function C(t,e,n){t.insertBefore(e,n||null)}function w(t){t.parentNode.removeChild(t)}function D(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function F(t){return document.createElement(t)}function z(t){return document.createTextNode(t)}function T(){return z(" ")}function O(){return z("")}function E(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function M(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function q(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function P(t){return""===t?void 0:+t}function $(t,e){e=""+e,t.data!==e&&(t.data=e)}function N(t,e){(null!=e||t.value)&&(t.value=e)}function S(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}}function H(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];o.selected=~e.indexOf(o.__value)}}function B(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function U(t){return[].map.call(t.querySelectorAll(":checked"),t=>t.__value)}let G;function A(t){G=t}function I(){if(!G)throw new Error("Function called outside component initialization");return G}function R(t){I().$$.after_update.push(t)}function Z(){const t=I();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const l=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);o.slice().forEach(e=>{e.call(t,l)})}}}const Y=[],V=[],W=[],J=[],K=Promise.resolve();let Q=!1;function X(t){W.push(t)}let tt=!1;const et=new Set;function nt(){if(!tt){tt=!0;do{for(let t=0;t<Y.length;t+=1){const e=Y[t];A(e),ot(e.$$)}for(Y.length=0;V.length;)V.pop()();for(let t=0;t<W.length;t+=1){const e=W[t];et.has(e)||(et.add(e),e())}W.length=0}while(Y.length);for(;J.length;)J.pop()();Q=!1,tt=!1,et.clear()}}function ot(t){if(null!==t.fragment){t.update(),y(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(X)}}const lt=new Set;let st;function rt(){st={r:0,c:[],p:st}}function it(){st.r||y(st.c),st=st.p}function at(t,e){t&&t.i&&(lt.delete(t),t.i(e))}function pt(t,e,n,o){if(t&&t.o){if(lt.has(t))return;lt.add(t),st.c.push(()=>{lt.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}function ct(t){t&&t.c()}function dt(t,e,n){const{fragment:o,on_mount:l,on_destroy:s,after_update:r}=t.$$;o&&o.m(e,n),X(()=>{const e=l.map(m).filter(b);s?s.push(...e):y(e),t.$$.on_mount=[]}),r.forEach(X)}function ut(t,e){const n=t.$$;null!==n.fragment&&(y(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function _t(t,e){-1===t.$$.dirty[0]&&(Y.push(t),Q||(Q=!0,K.then(nt)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ht(t,e,n,o,l,s,r=[-1]){const i=G;A(t);const a=e.props||{},p=t.$$={fragment:null,ctx:null,props:s,update:f,not_equal:l,bound:g(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(i?i.$$.context:[]),callbacks:g(),dirty:r};let c=!1;if(p.ctx=n?n(t,a,(e,n,...o)=>{const s=o.length?o[0]:n;return p.ctx&&l(p.ctx[e],p.ctx[e]=s)&&(p.bound[e]&&p.bound[e](s),c&&_t(t,e)),n}):[],p.update(),c=!0,y(p.before_update),p.fragment=!!o&&o(p.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);p.fragment&&p.fragment.l(t),t.forEach(w)}else p.fragment&&p.fragment.c();e.intro&&at(t.$$.fragment),dt(t,e.target,e.anchor),nt()}A(i)}class vt{$destroy(){ut(this,1),this.$destroy=f}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function ft(t,e,n){const o=t.slice();return o[7]=e[n],o[9]=n,o}function mt(t){let e,n,o,l,s;function r(...e){return t[6](t[9],...e)}return{c(){e=F("li"),q(e,"class",n="dot"+(t[9]===t[1]?" selected":"")+" svelte-jjp3es"),e.value=o=t[9],q(e,"role","button"),q(e,"tabindex","0"),q(e,"aria-label",l="slide item "+t[9])},m(t,n,o){C(t,e,n),o&&s(),s=E(e,"click",M(r))},p(o,l){t=o,2&l&&n!==(n="dot"+(t[9]===t[1]?" selected":"")+" svelte-jjp3es")&&q(e,"class",n)},d(t){t&&w(e),s()}}}function gt(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,m,g,b,x,k,L,O,P,N,S,H,B,U,G,A,I=(t[0][t[1]].kindName||"Фото и схемы ДТП")+"",R=t[1]+1+"",Z=t[0].length+"",Y=t[0],V=[];for(let e=0;e<Y.length;e+=1)V[e]=mt(ft(t,Y,e));return{c(){e=F("div"),n=T(),o=F("div"),l=F("div"),s=T(),r=F("div"),i=F("div"),a=F("div"),p=z(I),c=T(),d=F("div"),u=F("div"),_=F("div"),h=F("button"),v=T(),m=F("div"),g=F("a"),b=F("img"),L=T(),O=F("button"),P=T(),N=F("ul");for(let t=0;t<V.length;t+=1)V[t].c();S=T(),H=F("p"),B=z(R),U=z(" из "),G=z(Z),q(e,"class","modal-background svelte-jjp3es"),q(l,"title","Закрыть"),q(l,"class","ant-modal-close svelte-jjp3es"),q(a,"class","ant-modal-title"),q(a,"id","rcDialogTitle1"),q(i,"class","ant-modal-header svelte-jjp3es"),q(h,"type","button"),q(h,"aria-label","previous slide / item"),q(h,"class","control-arrow control-prev svelte-jjp3es"),b.src!==(x=""+(yt+t[0][t[1]].guid))&&q(b,"src",x),q(b,"alt",""),q(b,"class","svelte-jjp3es"),q(g,"target","_blank"),q(g,"href",k=""+(yt+t[0][t[1]].guid)),q(g,"title","Открыть на весь экран"),q(g,"class","svelte-jjp3es"),q(m,"class","slider-wrapper axis-horizontal svelte-jjp3es"),q(O,"type","button"),q(O,"aria-label","next slide / item"),q(O,"class","control-arrow control-next svelte-jjp3es"),q(N,"class","control-dots svelte-jjp3es"),q(H,"class","carousel-status svelte-jjp3es"),q(_,"class","carousel carousel-slider svelte-jjp3es"),function(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}(_,"width","100%"),q(d,"class","ant-modal-body svelte-jjp3es"),q(r,"class","ant-modal-content svelte-jjp3es"),q(o,"class","modal svelte-jjp3es"),q(o,"role","dialog"),q(o,"aria-modal","true")},m(f,x,k){C(f,e,x),C(f,n,x),C(f,o,x),j(o,l),j(o,s),j(o,r),j(r,i),j(i,a),j(a,p),j(r,c),j(r,d),j(d,u),j(u,_),j(_,h),j(_,v),j(_,m),j(m,g),j(g,b),j(_,L),j(_,O),j(_,P),j(_,N);for(let t=0;t<V.length;t+=1)V[t].m(N,null);j(_,S),j(_,H),j(H,B),j(H,U),j(H,G),k&&y(A),A=[E(e,"click",M(t[2])),E(l,"click",M(t[2])),E(h,"click",M(t[3])),E(O,"click",M(t[4])),E(o,"click",M(bt))]},p(t,[e]){if(3&e&&I!==(I=(t[0][t[1]].kindName||"Фото и схемы ДТП")+"")&&$(p,I),3&e&&b.src!==(x=""+(yt+t[0][t[1]].guid))&&q(b,"src",x),3&e&&k!==(k=""+(yt+t[0][t[1]].guid))&&q(g,"href",k),3&e){let n;for(Y=t[0],n=0;n<Y.length;n+=1){const o=ft(t,Y,n);V[n]?V[n].p(o,e):(V[n]=mt(o),V[n].c(),V[n].m(N,null))}for(;n<V.length;n+=1)V[n].d(1);V.length=Y.length}2&e&&R!==(R=t[1]+1+"")&&$(B,R),1&e&&Z!==(Z=t[0].length+"")&&$(G,Z)},i:f,o:f,d(t){t&&w(e),t&&w(n),t&&w(o),D(V,t),y(A)}}}const yt="//map.mvs.group/skpdi/proxy.php?guid=",bt=()=>{};function xt(t,e,n){const o=Z();let{data:l}=e,s=0;return t.$set=t=>{"data"in t&&n(0,l=t.data)},[l,s,()=>{o("close")},()=>{s&&n(1,s--,s)},()=>{s<l.length-1&&n(1,s++,s)},o,t=>{n(1,s=t)}]}class kt extends vt{constructor(t){super(),ht(this,t,xt,gt,x,{data:0})}}function jt(t,e,n){const o=t.slice();return o[9]=e[n],o}function Lt(t,e,n){const o=t.slice();return o[6]=e[n],o}function Ct(t){let e,n,o,l=t[9].k_uch&&(t[9].npdd||t[9].sop_npdd)&&function(t){let e,n,o=t[9].k_uch+"";return{c(){e=F("li"),n=z(o)},m(t,o){C(t,e,o),j(e,n)},p:f,d(t){t&&w(e)}}}(t),s=t[9].npdd&&function(t){let e,n,o=t[9].npdd+"";return{c(){e=F("li"),n=z(o)},m(t,o){C(t,e,o),j(e,n)},p:f,d(t){t&&w(e)}}}(t),r=t[9].sop_npdd&&function(t){let e,n,o=t[9].sop_npdd+"";return{c(){e=F("li"),n=z(o)},m(t,o){C(t,e,o),j(e,n)},p:f,d(t){t&&w(e)}}}(t);return{c(){l&&l.c(),e=T(),s&&s.c(),n=T(),r&&r.c(),o=O()},m(t,i){l&&l.m(t,i),C(t,e,i),s&&s.m(t,i),C(t,n,i),r&&r.m(t,i),C(t,o,i)},p(t,e){t[9].k_uch&&(t[9].npdd||t[9].sop_npdd)&&l.p(t,e),t[9].npdd&&s.p(t,e),t[9].sop_npdd&&r.p(t,e)},d(t){l&&l.d(t),t&&w(e),s&&s.d(t),t&&w(n),r&&r.d(t),t&&w(o)}}}function wt(t){let e,n,o=t[6].ts&&function(t){let e,n,o=t[6].ts+"";return{c(){e=F("li"),n=z(o)},m(t,o){C(t,e,o),j(e,n)},p:f,d(t){t&&w(e)}}}(t),l=t[6].arr,s=[];for(let e=0;e<l.length;e+=1)s[e]=Ct(jt(t,l,e));return{c(){o&&o.c(),e=T();for(let t=0;t<s.length;t+=1)s[t].c();n=O()},m(t,l){o&&o.m(t,l),C(t,e,l);for(let e=0;e<s.length;e+=1)s[e].m(t,l);C(t,n,l)},p(t,e){if(t[6].ts&&o.p(t,e),4&e){let o;for(l=t[6].arr,o=0;o<l.length;o+=1){const r=jt(t,l,o);s[o]?s[o].p(r,e):(s[o]=Ct(r),s[o].c(),s[o].m(n.parentNode,n))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(t){o&&o.d(t),t&&w(e),D(s,t),t&&w(n)}}}function Dt(t){let e,n,o,l,s,r=t[0].spog+"";return{c(){e=F("div"),n=F("div"),n.textContent="Погода:",o=T(),l=F("div"),s=z(r),q(n,"class","stitle"),q(l,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,o),j(e,l),j(l,s)},p(t,e){1&e&&r!==(r=t[0].spog+"")&&$(s,r)},d(t){t&&w(e)}}}function Ft(t){let e,n,o,l,s,r=t[0].s_pch+"";return{c(){e=F("div"),n=F("div"),n.textContent="Покрытие:",o=T(),l=F("div"),s=z(r),q(n,"class","stitle"),q(l,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,o),j(e,l),j(l,s)},p(t,e){1&e&&r!==(r=t[0].s_pch+"")&&$(s,r)},d(t){t&&w(e)}}}function zt(t){let e,n,o,l,s,r=t[0].osv+"";return{c(){e=F("div"),n=F("div"),n.textContent="Освещенность:",o=T(),l=F("div"),s=z(r),q(n,"class","stitle"),q(l,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,o),j(e,l),j(l,s)},p(t,e){1&e&&r!==(r=t[0].osv+"")&&$(s,r)},d(t){t&&w(e)}}}function Tt(t){let e,n,o,l,s,r=t[0].ndu+"";return{c(){e=F("div"),n=F("div"),n.textContent="Иные условия:",o=T(),l=F("div"),s=z(r),q(n,"class","stitle"),q(l,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,o),j(e,l),j(l,s)},p(t,e){1&e&&r!==(r=t[0].ndu+"")&&$(s,r)},d(t){t&&w(e)}}}function Ot(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,m,g,y,b,x,k,L,O,M,P,N,S,H,B,U,G,A,I,R,Z,Y,V,W,J,K,Q,X,tt,et,nt,ot,lt,st,rt,it,at,pt,ct,dt,ut,_t,ht,vt,ft,mt,gt,yt,bt,xt,kt,jt,Ct,Ot,Et,Mt,qt,Pt,$t,Nt,St,Ht,Bt,Ut,Gt=(t[0].name||t[0].dtvp||"")+"",At=(t[0].sid||t[0].id_stat||t[0].id_skpdi||"")+"",It=(t[0].district||"")+"",Rt=(t[0].dor||"")+"",Zt=(t[0].km||0)+"",Yt=(t[0].m||0)+"",Vt=t[0].lat+"",Wt=t[0].lon+"",Jt=(t[0].collision_date||t[0].dtp_date||"")+"",Kt=(t[0].dtvp||"")+"",Qt=t[0].pog+"",Xt=t[0].ran+"",te=t[2],ee=[];for(let e=0;e<te.length;e+=1)ee[e]=wt(Lt(t,te,e));let ne=t[0].spog&&Dt(t),oe=t[0].s_pch&&Ft(t),le=t[0].osv&&zt(t),se=t[0].ndu&&Tt(t);return{c(){e=F("div"),n=F("div"),o=F("b"),l=z(Gt),s=T(),r=F("div"),i=F("table"),a=F("tbody"),p=F("tr"),c=F("td"),c.textContent="ID:",d=T(),u=F("td"),_=z(At),h=T(),v=F("tr"),m=F("td"),m.textContent="Адрес:",g=T(),y=F("td"),b=z(It),x=T(),k=z(Rt),L=T(),O=F("tr"),M=F("td"),M.textContent="Пикетаж:",P=T(),N=F("td"),S=F("b"),H=z(Zt),B=z(" км. "),U=F("b"),G=z(Yt),A=z(" м."),I=T(),R=F("tr"),Z=F("td"),Z.textContent="Координаты:",Y=T(),V=F("td"),W=z(Vt),J=T(),K=z(Wt),Q=T(),X=F("span"),tt=T(),et=F("tr"),nt=F("td"),nt.textContent="Дата/время:",ot=T(),lt=F("td"),st=z(Jt),rt=T(),it=F("tr"),at=F("td"),at.textContent="Вид ДТП:",pt=T(),ct=F("td"),dt=z(Kt),ut=T(),_t=F("tr"),ht=F("td"),ht.textContent="Нарушения:",vt=T(),ft=F("td"),mt=F("ul");for(let t=0;t<ee.length;t+=1)ee[t].c();gt=T(),yt=F("tr"),bt=F("td"),bt.textContent="Условия:",xt=T(),kt=F("td"),ne&&ne.c(),jt=T(),oe&&oe.c(),Ct=T(),le&&le.c(),Ot=T(),se&&se.c(),Et=T(),Mt=F("tr"),qt=F("td"),qt.textContent="Количество погибших/раненых:",Pt=T(),$t=F("td"),Nt=F("b"),St=z(Qt),Ht=z("/"),Bt=z(Xt),q(n,"class","pLine"),q(c,"class","first svelte-ipyqnf"),q(m,"class","first svelte-ipyqnf"),q(M,"class","first svelte-ipyqnf"),q(Z,"class","first svelte-ipyqnf"),q(X,"title","Скопировать в буфер обмена"),q(X,"class","leaflet-gmx-icon-copy"),q(nt,"class","first svelte-ipyqnf"),q(at,"class","first svelte-ipyqnf"),q(ht,"class","first svelte-ipyqnf"),q(bt,"class","first svelte-ipyqnf"),q(qt,"class","first svelte-ipyqnf"),q(i,"class","table"),q(r,"class","featureCont"),q(e,"class","mvsPopup svelte-ipyqnf")},m(f,w,D){C(f,e,w),j(e,n),j(n,o),j(o,l),j(e,s),j(e,r),j(r,i),j(i,a),j(a,p),j(p,c),j(p,d),j(p,u),j(u,_),j(a,h),j(a,v),j(v,m),j(v,g),j(v,y),j(y,b),j(y,x),j(y,k),j(a,L),j(a,O),j(O,M),j(O,P),j(O,N),j(N,S),j(S,H),j(N,B),j(N,U),j(U,G),j(N,A),j(a,I),j(a,R),j(R,Z),j(R,Y),j(R,V),j(V,W),j(V,J),j(V,K),j(V,Q),j(V,X),j(a,tt),j(a,et),j(et,nt),j(et,ot),j(et,lt),j(lt,st),j(a,rt),j(a,it),j(it,at),j(it,pt),j(it,ct),j(ct,dt),j(a,ut),j(a,_t),j(_t,ht),j(_t,vt),j(_t,ft),j(ft,mt);for(let t=0;t<ee.length;t+=1)ee[t].m(mt,null);j(a,gt),j(a,yt),j(yt,bt),j(yt,xt),j(yt,kt),ne&&ne.m(kt,null),j(kt,jt),oe&&oe.m(kt,null),j(kt,Ct),le&&le.m(kt,null),j(kt,Ot),se&&se.m(kt,null),j(a,Et),j(a,Mt),j(Mt,qt),j(Mt,Pt),j(Mt,$t),j($t,Nt),j(Nt,St),j(Nt,Ht),j(Nt,Bt),D&&Ut(),Ut=E(X,"click",t[1])},p(t,[e]){if(1&e&&Gt!==(Gt=(t[0].name||t[0].dtvp||"")+"")&&$(l,Gt),1&e&&At!==(At=(t[0].sid||t[0].id_stat||t[0].id_skpdi||"")+"")&&$(_,At),1&e&&It!==(It=(t[0].district||"")+"")&&$(b,It),1&e&&Rt!==(Rt=(t[0].dor||"")+"")&&$(k,Rt),1&e&&Zt!==(Zt=(t[0].km||0)+"")&&$(H,Zt),1&e&&Yt!==(Yt=(t[0].m||0)+"")&&$(G,Yt),1&e&&Vt!==(Vt=t[0].lat+"")&&$(W,Vt),1&e&&Wt!==(Wt=t[0].lon+"")&&$(K,Wt),1&e&&Jt!==(Jt=(t[0].collision_date||t[0].dtp_date||"")+"")&&$(st,Jt),1&e&&Kt!==(Kt=(t[0].dtvp||"")+"")&&$(dt,Kt),4&e){let n;for(te=t[2],n=0;n<te.length;n+=1){const o=Lt(t,te,n);ee[n]?ee[n].p(o,e):(ee[n]=wt(o),ee[n].c(),ee[n].m(mt,null))}for(;n<ee.length;n+=1)ee[n].d(1);ee.length=te.length}t[0].spog?ne?ne.p(t,e):(ne=Dt(t),ne.c(),ne.m(kt,jt)):ne&&(ne.d(1),ne=null),t[0].s_pch?oe?oe.p(t,e):(oe=Ft(t),oe.c(),oe.m(kt,Ct)):oe&&(oe.d(1),oe=null),t[0].osv?le?le.p(t,e):(le=zt(t),le.c(),le.m(kt,Ot)):le&&(le.d(1),le=null),t[0].ndu?se?se.p(t,e):(se=Tt(t),se.c(),se.m(kt,null)):se&&(se.d(1),se=null),1&e&&Qt!==(Qt=t[0].pog+"")&&$(St,Qt),1&e&&Xt!==(Xt=t[0].ran+"")&&$(Bt,Xt)},i:f,o:f,d(t){t&&w(e),D(ee,t),ne&&ne.d(),oe&&oe.d(),le&&le.d(),se&&se.d(),Ut()}}}function Et(t,e,n){let o,{showModal:l=!1}=e,{prp:s}=e;s.skpdiFiles;R(()=>{l&&(o=new kt({target:document.body,props:{data:s.skpdiFiles}}),o.$on("close",t=>{o.$destroy(),n(3,l=!1)}))});const r=(s.tsInfo||[]).map(t=>{let e=t.ts_uch||[];return{ts:"Осталось на месте ДТП"!==t.ts?t.ts:"",arr:e.map(t=>({k_uch:t.k_uch||"",npdd:"Нет нарушений"!==t.npdd?t.npdd:"",sop_npdd:"Нет нарушений"!==t.sop_npdd?t.sop_npdd:""}))}});return t.$set=t=>{"showModal"in t&&n(3,l=t.showModal),"prp"in t&&n(0,s=t.prp)},[s,t=>{navigator.clipboard.writeText(t.target.parentNode.textContent).catch(t=>{console.log("Something went wrong",t)})},r,l]}class Mt extends vt{constructor(t){super(),ht(this,t,Et,Ot,x,{showModal:3,prp:0})}}const qt=window.L,Pt=qt.popup();let $t;const Nt=qt.featureGroup([]);function St(t,e,n){const o=t.slice();return o[6]=e[n],o}function Ht(t,e,n){const o=t.slice();return o[6]=e[n],o}function Bt(t){let e,n=t[1].collisionTypes,o=[];for(let e=0;e<n.length;e+=1)o[e]=Ut(Ht(t,n,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=O()},m(t,n){for(let e=0;e<o.length;e+=1)o[e].m(t,n);C(t,e,n)},p(t,l){if(2&l){let s;for(n=t[1].collisionTypes,s=0;s<n.length;s+=1){const r=Ht(t,n,s);o[s]?o[s].p(r,l):(o[s]=Ut(r),o[s].c(),o[s].m(e.parentNode,e))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(t){D(o,t),t&&w(e)}}}function Ut(t){let e,n,o=(t[6].collisionType||"")+"";return{c(){e=F("li"),n=z(o)},m(t,o){C(t,e,o),j(e,n)},p(t,e){2&e&&o!==(o=(t[6].collisionType||"")+"")&&$(n,o)},d(t){t&&w(e)}}}function Gt(t){let e,n=t[1].uchs,o=[];for(let e=0;e<n.length;e+=1)o[e]=At(St(t,n,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=O()},m(t,n){for(let e=0;e<o.length;e+=1)o[e].m(t,n);C(t,e,n)},p(t,l){if(2&l){let s;for(n=t[1].uchs,s=0;s<n.length;s+=1){const r=St(t,n,s);o[s]?o[s].p(r,l):(o[s]=At(r),o[s].c(),o[s].m(e.parentNode,e))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(t){D(o,t),t&&w(e)}}}function At(t){let e,n,o,l,s,r,i,a,p=(t[6].collisionPartyCategory||"")+"",c=(t[6].collisionPartyCond||"")+"";return{c(){e=F("li"),n=z(p),o=T(),l=F("b"),s=F("i"),r=z("("),i=z(c),a=z(")")},m(t,p){C(t,e,p),j(e,n),j(e,o),j(e,l),j(l,s),j(s,r),j(s,i),j(s,a)},p(t,e){2&e&&p!==(p=(t[6].collisionPartyCategory||"")+"")&&$(n,p),2&e&&c!==(c=(t[6].collisionPartyCond||"")+"")&&$(i,c)},d(t){t&&w(e)}}}function It(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,m,g,b,x,k,L,D,O,M,P,N,S,H,B,U,G,A,I,R,Z,Y,V,W,J,K,Q,X,tt,et,nt,ot,lt,st,rt,it,at,pt,ct,dt,ut,_t,ht,vt,ft,mt,gt,yt,bt,xt,kt,jt=(t[1].name||t[1].dtvp||"")+"",Lt=(t[1].sid||t[1].id_stat||t[1].id_skpdi||"")+"",Ct=(t[1].km||0)+"",wt=(t[1].m||0)+"",Dt=t[1].lat+"",Ft=t[1].lon+"",zt=(t[1].collision_date||t[1].dtp_date||"")+"",Tt=(t[1].collision_context||t[1].dtp_date||"")+"",Ot=t[1].collisionTypes&&t[1].collisionTypes.length&&Bt(t),Et=t[1].uchs&&t[1].uchs.length&&Gt(t);return{c(){e=F("div"),n=F("div"),o=F("b"),l=z(jt),s=T(),r=F("div"),i=F("table"),a=F("tbody"),p=F("tr"),c=F("td"),c.textContent="ID:",d=T(),u=F("td"),_=z(Lt),h=T(),v=F("tr"),m=F("td"),m.textContent="Пикетаж:",g=T(),b=F("td"),x=F("b"),k=z(Ct),L=z(" км. "),D=F("b"),O=z(wt),M=z(" м."),P=T(),N=F("tr"),S=F("td"),S.textContent="Координаты:",H=T(),B=F("td"),U=z(Dt),G=T(),A=z(Ft),I=T(),R=F("span"),Z=T(),Y=F("tr"),V=F("td"),V.textContent="Дата/время:",W=T(),J=F("td"),K=z(zt),Q=T(),X=F("tr"),tt=F("td"),et=F("div"),et.textContent="Условия ДТП:",nt=T(),ot=F("div"),lt=z(Tt),st=T(),rt=F("tr"),it=F("td"),it.textContent="Нарушения:",at=T(),pt=F("td"),ct=F("ul"),Ot&&Ot.c(),dt=T(),ut=F("tr"),_t=F("td"),_t.textContent="Участники:",ht=T(),vt=F("td"),ft=F("ul"),Et&&Et.c(),mt=T(),gt=F("tr"),yt=F("td"),bt=F("button"),xt=z("Фото и схемы"),q(n,"class","pLine"),q(c,"class","first"),q(m,"class","first"),q(S,"class","first"),q(R,"title","Скопировать в буфер обмена"),q(R,"class","leaflet-gmx-icon-copy"),q(V,"class","first"),q(et,"class","first"),q(tt,"colspan","2"),q(it,"class","first"),q(_t,"class","first"),q(bt,"class","primary svelte-1aipaym"),bt.disabled=t[2],q(yt,"class","center"),q(yt,"colspan","2"),q(i,"class","table"),q(r,"class","featureCont"),q(e,"class","mvsPopup")},m(f,w,F){C(f,e,w),j(e,n),j(n,o),j(o,l),j(e,s),j(e,r),j(r,i),j(i,a),j(a,p),j(p,c),j(p,d),j(p,u),j(u,_),j(a,h),j(a,v),j(v,m),j(v,g),j(v,b),j(b,x),j(x,k),j(b,L),j(b,D),j(D,O),j(b,M),j(a,P),j(a,N),j(N,S),j(N,H),j(N,B),j(B,U),j(B,G),j(B,A),j(B,I),j(B,R),j(a,Z),j(a,Y),j(Y,V),j(Y,W),j(Y,J),j(J,K),j(a,Q),j(a,X),j(X,tt),j(tt,et),j(tt,nt),j(tt,ot),j(ot,lt),j(a,st),j(a,rt),j(rt,it),j(rt,at),j(rt,pt),j(pt,ct),Ot&&Ot.m(ct,null),j(a,dt),j(a,ut),j(ut,_t),j(ut,ht),j(ut,vt),j(vt,ft),Et&&Et.m(ft,null),j(a,mt),j(a,gt),j(gt,yt),j(yt,bt),j(bt,xt),F&&y(kt),kt=[E(R,"click",t[3]),E(bt,"click",t[5])]},p(t,[e]){2&e&&jt!==(jt=(t[1].name||t[1].dtvp||"")+"")&&$(l,jt),2&e&&Lt!==(Lt=(t[1].sid||t[1].id_stat||t[1].id_skpdi||"")+"")&&$(_,Lt),2&e&&Ct!==(Ct=(t[1].km||0)+"")&&$(k,Ct),2&e&&wt!==(wt=(t[1].m||0)+"")&&$(O,wt),2&e&&Dt!==(Dt=t[1].lat+"")&&$(U,Dt),2&e&&Ft!==(Ft=t[1].lon+"")&&$(A,Ft),2&e&&zt!==(zt=(t[1].collision_date||t[1].dtp_date||"")+"")&&$(K,zt),2&e&&Tt!==(Tt=(t[1].collision_context||t[1].dtp_date||"")+"")&&$(lt,Tt),t[1].collisionTypes&&t[1].collisionTypes.length?Ot?Ot.p(t,e):(Ot=Bt(t),Ot.c(),Ot.m(ct,null)):Ot&&(Ot.d(1),Ot=null),t[1].uchs&&t[1].uchs.length?Et?Et.p(t,e):(Et=Gt(t),Et.c(),Et.m(ft,null)):Et&&(Et.d(1),Et=null),4&e&&(bt.disabled=t[2])},i:f,o:f,d(t){t&&w(e),Ot&&Ot.d(),Et&&Et.d(),y(kt)}}}function Rt(t,e,n){let o,{showModal:l=!1}=e,{prp:s}=e,r=s.files&&s.files.length?"":"disabled";R(()=>{n(2,r=s.files&&s.files.length?"":"disabled"),l&&(o=new kt({target:document.body,props:{data:s.files}}),o.$on("close",t=>{o.$destroy(),n(0,l=!1)}))});return t.$set=t=>{"showModal"in t&&n(0,l=t.showModal),"prp"in t&&n(1,s=t.prp)},[l,s,r,t=>{navigator.clipboard.writeText(t.target.parentNode.textContent).catch(t=>{console.log("Something went wrong",t)})},o,()=>n(0,l=!0)]}Nt._needHeat={radius:19,blur:11.26,minOpacity:.34},Nt.checkZoom=t=>{Object.keys(Nt._layers).length?t<12&&Nt.setFilter($t):t>11&&Nt.setFilter($t)},Nt.setFilter=t=>{if(!Nt._map)return;Nt.clearLayers(),$t=t||[];let e=[],n=[];Nt._group&&(Nt._group.getLayers().forEach(t=>{let o=t.options.props,l=0;$t.forEach(t=>{"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===o.collision_type).length)&&l++:"date"===t.type&&o.date>=t.zn[0]&&o.date<t.zn[1]&&l++}),l===$t.length&&(e.push(t),n.push(t._latlng))}),Nt._needHeat?(Nt._map.addLayer(Nt._heat),Nt._heat.setLatLngs(n),Nt._heat.setOptions(Nt._needHeat),Nt._map._zoom>11&&Nt.addLayer(qt.layerGroup(e))):(Nt.addLayer(qt.layerGroup(e)),Nt._map.removeLayer(Nt._heat)))},Nt.on("remove",t=>{Nt._map.removeLayer(Nt._heat),Nt.clearLayers()}).on("add",t=>{Nt._heat=qt.heatLayer([],{gradient:{.1:"blue",.4:"lime",1:"red"}}),fetch("https://dtp.mvs.group/scripts/index.php?request=get_stat_gipdd",{}).then(t=>t.json()).then(t=>{let e={collision_type:{},iconType:{}},n=[],o=t.map(t=>{let o=t.iconType||0,l=!1,s="#2F4F4F";o&&(l=o%2==0,o>=1&&o<=6?s="#8B4513":7===o||8===o?s="#228B22":o>=9&&o<=14?s="#8B4513":15===o||16===o?s="#7B68EE":17!==o&&18!==o||(s="#2F4F4F")),t.lat&&t.lon||(console.log("_______",t),t.lat=t.lon=0);let r=e.collision_type[t.collision_type];r?r++:r=1,e.collision_type[t.collision_type]=r,e.iconType[t.collision_type]=o;let i=qt.latLng(t.lat,t.lon,l?1:.5);return n.push(i),new v(i,{props:t,radius:6,stroke:l,fillColor:s}).bindPopup(Pt).on("popupopen",t=>{var e;e=t.target.options.props.id,fetch("https://dtp.mvs.group/scripts/index.php?request=get_dtp_id&id="+e+"&type=gibdd",{}).then(t=>t.json()).then(t=>{let e=qt.DomUtil.create("div");const n=new Mt({target:e,props:{prp:t}});Pt._svObj=n,Pt.setContent(e)})}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});Nt.addLayer(Nt._heat),Nt._heat.setLatLngs(n),Nt._heat.setOptions(Nt._needHeat),Nt._opt=e,Nt._group=qt.layerGroup(o),$t?Nt.setFilter($t):Nt._map._zoom>11&&Nt.addLayer(Nt._group),Nt._refreshFilters()})});class Zt extends vt{constructor(t){super(),ht(this,t,Rt,It,x,{showModal:0,prp:1})}}const Yt=window.L,Vt=Yt.popup();let Wt;const Jt=Yt.featureGroup([]);function Kt(t,e,n){const o=t.slice();return o[6]=e[n],o[8]=n,o}function Qt(t){let e,n,o,l,s,r="gibdd"===t[6].type?"ГИБДД":"СКПДИ";return{c(){e=F("button"),n=z(r),q(e,"class",o=k(t[2]===t[8]?"current":"")+" svelte-txaali"),e.value=l=t[8]},m(o,l,r){C(o,e,l),j(e,n),r&&s(),s=E(e,"click",t[4])},p(t,l){1&l&&r!==(r="gibdd"===t[6].type?"ГИБДД":"СКПДИ")&&$(n,r),4&l&&o!==(o=k(t[2]===t[8]?"current":"")+" svelte-txaali")&&q(e,"class",o)},d(t){t&&w(e),s()}}}function Xt(t){let e;const n=new Zt({props:{prp:t[3]}});return{c(){ct(n.$$.fragment)},m(t,o){dt(n,t,o),e=!0},p(t,e){const o={};8&e&&(o.prp=t[3]),n.$set(o)},i(t){e||(at(n.$$.fragment,t),e=!0)},o(t){pt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function te(t){let e;const n=new Mt({props:{prp:t[3]}});return{c(){ct(n.$$.fragment)},m(t,o){dt(n,t,o),e=!0},p(t,e){const o={};8&e&&(o.prp=t[3]),n.$set(o)},i(t){e||(at(n.$$.fragment,t),e=!0)},o(t){pt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function ee(t){let e,n,o,l,s,r,i,a,p,c,d=t[0]._cur,u=[];for(let e=0;e<d.length;e+=1)u[e]=Qt(Kt(t,d,e));const _=[te,Xt],h=[];function v(t,e){return"gibdd"===t[0]._cur[t[2]].type?0:1}return i=v(t),a=h[i]=_[i](t),{c(){e=F("div"),n=F("div"),o=F("a"),o.textContent="×",l=T(),s=F("div");for(let t=0;t<u.length;t+=1)u[t].c();r=T(),a.c(),q(o,"class","leaflet-popup-close-button"),q(o,"href","#close"),q(n,"class","close"),q(s,"class","pLine"),q(e,"class","mvsPopup")},m(a,d,_){C(a,e,d),j(e,n),j(n,o),j(e,l),j(e,s);for(let t=0;t<u.length;t+=1)u[t].m(s,null);var v;j(e,r),h[i].m(e,null),p=!0,_&&c(),c=E(o,"click",(v=function(){b(t[1])&&t[1].apply(this,arguments)},function(t){return t.preventDefault(),v.call(this,t)}))},p(n,[o]){if(t=n,21&o){let e;for(d=t[0]._cur,e=0;e<d.length;e+=1){const n=Kt(t,d,e);u[e]?u[e].p(n,o):(u[e]=Qt(n),u[e].c(),u[e].m(s,null))}for(;e<u.length;e+=1)u[e].d(1);u.length=d.length}let l=i;i=v(t),i===l?h[i].p(t,o):(rt(),pt(h[l],1,1,()=>{h[l]=null}),it(),a=h[i],a||(a=h[i]=_[i](t),a.c()),at(a,1),a.m(e,null))},i(t){p||(at(a),p=!0)},o(t){pt(a),p=!1},d(t){t&&w(e),D(u,t),h[i].d(),c()}}}function ne(t,e,n){let{prp:o}=e,{closeMe:l=(()=>{})}=e,s=0,r={};const i=t=>{let e=o._cur[t],l=e.type,s="https://dtp.mvs.group/scripts/index.php?request=get_dtp_id&id="+e.id+"&type="+l;fetch(s,{}).then(t=>t.json()).then(t=>{n(3,r=t)})};return i(s),t.$set=t=>{"prp"in t&&n(0,o=t.prp),"closeMe"in t&&n(1,l=t.closeMe)},[o,l,s,r,t=>{let e=t.target,o=Number(e.value);s!==o&&(n(2,s=o),i(s))}]}Jt._needHeat={radius:19,blur:11.26,minOpacity:.34},Jt.checkZoom=t=>{Object.keys(Jt._layers).length?t<12&&Jt.setFilter(Wt):t>11&&Jt.setFilter(Wt)},Jt.setFilter=t=>{if(!Jt._map)return;Jt.clearLayers(),Wt=t||[];let e=[],n=[];Jt._group&&(Jt._group.getLayers().forEach(t=>{let o=t.options.props,l=0;Wt.forEach(t=>{"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===o.collision_type).length)&&l++:"date"===t.type&&o.date>=t.zn[0]&&o.date<t.zn[1]&&l++}),l===Wt.length&&(e.push(t),n.push(t._latlng))}),Jt._needHeat?(Jt._map.addLayer(Jt._heat),Jt._heat.setLatLngs(n),Jt._heat.setOptions(Jt._needHeat),Jt._map._zoom>11&&Jt.addLayer(Yt.layerGroup(e))):(Jt.addLayer(Yt.layerGroup(e)),Jt._map.removeLayer(Jt._heat)))},Jt.on("remove",()=>{Jt._map.removeLayer(Jt._heat),Jt.clearLayers()}).on("add",t=>{Jt._heat=Yt.heatLayer([]),fetch("https://dtp.mvs.group/scripts/index.php?request=get_skpdi",{}).then(t=>t.json()).then(t=>{let e={collision_type:{},iconType:{}},n=[],o=t.map(t=>{let o=t.iconType||0,l=!1,s="#2F4F4F";o&&(l=o%2==0,o>=1&&o<=6?s="#8B4513":7===o||8===o?s="#228B22":o>=9&&o<=14?s="#8B4513":15===o||16===o?s="#7B68EE":17!==o&&18!==o||(s="#2F4F4F")),t.lat&&t.lon||(console.log("_______",t),t.lat=t.lon=0);let r=e.collision_type[t.collision_type];r?r++:r=1,e.collision_type[t.collision_type]=r,e.iconType[t.collision_type]=o;let i=Yt.latLng(t.lat,t.lon,l?1:.5);return n.push(i),new v(i,{props:t,radius:6,box:!0,stroke:l,fillColor:s}).bindPopup(Vt).on("popupopen",t=>{var e;e=t.target.options.props.id,fetch("https://dtp.mvs.group/scripts/index.php?request=get_dtp_id&id="+e+"&type=skpdi",{}).then(t=>t.json()).then(t=>{let e=Yt.DomUtil.create("div");const n=new Zt({target:e,props:{prp:t}});Vt._svObj=n,Vt.setContent(e)})}).on("popupclose",t=>{console.log("popupclose",t),t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});Jt.addLayer(Jt._heat),Jt._heat.setLatLngs(n),Jt._heat.setOptions(Jt._needHeat),Jt._opt=e,Jt._group=Yt.layerGroup(o),Wt?Jt.setFilter(Wt):Jt.addLayer(Jt._group),Jt.checkZoom(Jt._map._zoom),Jt._refreshFilters()})});class oe extends vt{constructor(t){super(),ht(this,t,ne,ee,x,{prp:0,closeMe:1})}}const le=window.L,se=le.popup();let re;const ie=le.featureGroup([]);function ae(t,e,n){const o=t.slice();return o[157]=e[n],o}function pe(t,e,n){const o=t.slice();return o[157]=e[n],o}function ce(t,e,n){const o=t.slice();return o[157]=e[n],o}function de(t,e,n){const o=t.slice();return o[157]=e[n],o}function ue(t,e,n){const o=t.slice();return o[157]=e[n],o}function _e(t,e,n){const o=t.slice();return o[170]=e[n],o}function he(t,e,n){const o=t.slice();return o[157]=e[n],o}function ve(t,e,n){const o=t.slice();return o[157]=e[n],o}function fe(t,e,n){const o=t.slice();return o[157]=e[n],o}function me(t,e,n){const o=t.slice();return o[170]=e[n],o}function ge(t,e,n){const o=t.slice();return o[157]=e[n],o}function ye(t,e,n){const o=t.slice();return o[157]=e[n],o}function be(t,e,n){const o=t.slice();return o[157]=e[n],o}function xe(t,e,n){const o=t.slice();return o[170]=e[n],o}function ke(t,e,n){const o=t.slice();return o[157]=e[n],o}function je(t,e,n){const o=t.slice();return o[157]=e[n],o}function Le(t,e,n){const o=t.slice();return o[157]=e[n],o}function Ce(t,e,n){const o=t.slice();return o[157]=e[n],o}function we(t,e,n){const o=t.slice();return o[157]=e[n],o}function De(t,e,n){const o=t.slice();return o[157]=e[n],o}function Fe(t,e,n){const o=t.slice();return o[157]=e[n],o}function ze(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,O,M,P=t[71],$=[];for(let e=0;e<P.length;e+=1)$[e]=Te(Fe(t,P,e));return{c(){e=F("div"),e.innerHTML="Фильтры - <b>ДТП Очаги(Picket)</b>",n=T(),o=F("div"),l=F("div"),s=z("ID Очага: "),r=F("input"),i=T(),a=F("div"),p=z("ID ДТП: "),c=F("input"),d=T(),u=F("div"),_=F("input"),v=F("label"),v.textContent="одного типа",f=T(),m=F("input"),b=F("label"),b.textContent="разного типа",x=T(),k=F("div"),L=F("select"),O=F("option"),O.textContent=`\n\t\t\t\t\t\tВсе дороги (${t[71].reduce(t[113],0)})\n\t\t\t\t\t`;for(let t=0;t<$.length;t+=1)$[t].c();q(e,"class","pLine svelte-1jsovbn"),q(r,"type","text"),r.value=t[15],q(r,"class","svelte-1jsovbn"),q(l,"class","pLine svelte-1jsovbn"),q(c,"type","text"),c.value=t[16],q(c,"class","svelte-1jsovbn"),q(a,"class","pLine svelte-1jsovbn"),q(_,"type","checkbox"),q(_,"id","ht_3"),_.checked=h=t[14].hearth3,q(_,"name","hearth3"),q(_,"class","svelte-1jsovbn"),q(v,"for","ht_3"),q(v,"class","svelte-1jsovbn"),q(m,"type","checkbox"),q(m,"id","ht_5"),m.checked=g=t[14].hearth5,q(m,"name","hearth5"),q(m,"class","svelte-1jsovbn"),q(b,"for","ht_5"),q(b,"class","svelte-1jsovbn"),q(u,"class","pLine svelte-1jsovbn"),O.__value="",O.value=O.__value,q(O,"class","svelte-1jsovbn"),q(L,"class","multiple_icon_typeTmp svelte-1jsovbn"),L.multiple=!0,void 0===t[13]&&X(()=>t[114].call(L)),q(k,"class","pLine svelte-1jsovbn"),q(o,"class","filtersCont svelte-1jsovbn")},m(h,g,w){C(h,e,g),C(h,n,g),C(h,o,g),j(o,l),j(l,s),j(l,r),j(o,i),j(o,a),j(a,p),j(a,c),j(o,d),j(o,u),j(u,_),j(u,v),j(u,f),j(u,m),j(u,b),j(o,x),j(o,k),j(k,L),j(L,O);for(let t=0;t<$.length;t+=1)$[t].m(L,null);H(L,t[13]),w&&y(M),M=[E(r,"input",t[76]),E(c,"input",t[75]),E(_,"change",t[77]),E(m,"change",t[77]),E(L,"change",t[114]),E(L,"change",t[74])]},p(t,e){if(32768&e[0]&&r.value!==t[15]&&(r.value=t[15]),65536&e[0]&&c.value!==t[16]&&(c.value=t[16]),16384&e[0]&&h!==(h=t[14].hearth3)&&(_.checked=h),16384&e[0]&&g!==(g=t[14].hearth5)&&(m.checked=g),768&e[2]){let n;for(P=t[71],n=0;n<P.length;n+=1){const o=Fe(t,P,n);$[n]?$[n].p(o,e):($[n]=Te(o),$[n].c(),$[n].m(L,null))}for(;n<$.length;n+=1)$[n].d(1);$.length=P.length}8192&e[0]&&H(L,t[13])},d(t){t&&w(e),t&&w(n),t&&w(o),D($,t),y(M)}}}function Te(t){let e,n,o,l,s,r,i,a,p=t[70].road[t[157]]+"",c=t[157]+"";return{c(){e=F("option"),n=z("("),o=z(p),l=z(") - "),s=z(c),r=T(),e.__value=i=t[157],e.value=e.__value,q(e,"class",a="road_"+t[157]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,o),j(e,l),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function Oe(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,z,O,M,P,$,N=Object.keys(t[5]._opt.years).sort(),B=[];for(let e=0;e<N.length;e+=1)B[e]=Ee(De(t,N,e));let U=t[69],G=[];for(let e=0;e<U.length;e+=1)G[e]=Me(we(t,U,e));return{c(){e=F("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (5)</b>",n=T(),o=F("div"),l=F("div"),s=F("fieldset"),r=F("legend"),r.textContent="Фильтрация по периодам:",i=T(),a=F("div"),p=F("input"),u=F("label"),u.textContent="Фильтрация по годам",_=T(),h=F("div");for(let t=0;t<B.length;t+=1)B[t].c();v=T(),f=F("div"),m=F("select"),g=F("option"),g.textContent=`\n\t\t\t\t\t\tВсе типы (${t[69].reduce(t[117],0)})\n\t\t\t\t\t`;for(let t=0;t<G.length;t+=1)G[t].c();b=T(),x=F("div"),k=F("select"),L=F("option"),L.textContent="Очаги все",z=F("option"),z.textContent="Только с погибшими",O=F("option"),O.textContent="Только с пострадавшими",M=F("option"),M.textContent="С пострадавшими или погибшими",P=F("option"),P.textContent="С пострадавшими и погибшими",q(e,"class","pLine svelte-1jsovbn"),q(p,"type","radio"),p.__value=c=1,p.value=p.__value,p.checked=d=1===t[31],q(p,"id","hearths_period_type_51"),q(p,"name","hearths_period_type_5"),q(p,"class","svelte-1jsovbn"),t[116][4].push(p),q(u,"for","hearths_period_type_51"),q(u,"class","svelte-1jsovbn"),q(h,"class","pLine margin svelte-1jsovbn"),q(a,"class","pLine type svelte-1jsovbn"),q(l,"class","pLine nowrap svelte-1jsovbn"),g.__value="",g.value=g.__value,q(g,"class","svelte-1jsovbn"),q(m,"class","multiple_icon_typeTmp svelte-1jsovbn"),m.multiple=!0,void 0===t[30]&&X(()=>t[118].call(m)),q(f,"class","pLine svelte-1jsovbn"),L.__value="",L.value=L.__value,z.__value="1",z.value=z.__value,O.__value="2",O.value=O.__value,M.__value="3",M.value=M.__value,P.__value="4",P.value=P.__value,q(k,"class","svelte-1jsovbn"),void 0===t[29]&&X(()=>t[119].call(k)),q(x,"class","pLine svelte-1jsovbn"),q(o,"class","filtersCont svelte-1jsovbn")},m(c,d,w){C(c,e,d),C(c,n,d),C(c,o,d),j(o,l),j(l,s),j(s,r),j(s,i),j(s,a),j(a,p),p.checked=p.__value===t[31],j(a,u),j(a,_),j(a,h);for(let t=0;t<B.length;t+=1)B[t].m(h,null);j(o,v),j(o,f),j(f,m),j(m,g);for(let t=0;t<G.length;t+=1)G[t].m(m,null);H(m,t[30]),j(o,b),j(o,x),j(x,k),j(k,L),j(k,z),j(k,O),j(k,M),j(k,P),S(k,t[29]),w&&y($),$=[E(p,"change",t[87]),E(p,"change",t[115]),E(m,"change",t[118]),E(m,"change",t[87]),E(k,"change",t[119]),E(k,"change",t[87])]},p(t,e){if(1&e[1]&&d!==(d=1===t[31])&&(p.checked=d),1&e[1]&&(p.checked=p.__value===t[31]),32&e[0]|3&e[1]|33554432&e[2]){let n;for(N=Object.keys(t[5]._opt.years).sort(),n=0;n<N.length;n+=1){const o=De(t,N,n);B[n]?B[n].p(o,e):(B[n]=Ee(o),B[n].c(),B[n].m(h,null))}for(;n<B.length;n+=1)B[n].d(1);B.length=N.length}if(192&e[2]){let n;for(U=t[69],n=0;n<U.length;n+=1){const o=we(t,U,n);G[n]?G[n].p(o,e):(G[n]=Me(o),G[n].c(),G[n].m(m,null))}for(;n<G.length;n+=1)G[n].d(1);G.length=U.length}1073741824&e[0]&&H(m,t[30]),536870912&e[0]&&S(k,t[29])},d(l){l&&w(e),l&&w(n),l&&w(o),t[116][4].splice(t[116][4].indexOf(p),1),D(B,l),D(G,l),y($)}}}function Ee(t){let e,n,o,l,s,r,i,a=t[157]+"";return{c(){e=F("input"),s=F("label"),r=z(a),q(e,"type","checkbox"),q(e,"id","hearths_year_5"),e.checked=n=t[32][t[157]],e.disabled=o=2===t[31],q(e,"name",l=t[157]),q(e,"class","svelte-1jsovbn"),q(s,"for","hearths_year_5"),q(s,"class","svelte-1jsovbn")},m(n,o,l){C(n,e,o),C(n,s,o),j(s,r),l&&i(),i=E(e,"change",t[87])},p(t,s){32&s[0]|2&s[1]&&n!==(n=t[32][t[157]])&&(e.checked=n),1&s[1]&&o!==(o=2===t[31])&&(e.disabled=o),32&s[0]&&l!==(l=t[157])&&q(e,"name",l),32&s[0]&&a!==(a=t[157]+"")&&$(r,a)},d(t){t&&w(e),t&&w(s),i()}}}function Me(t){let e,n,o,l,s,r,i,a,p=t[68].str_icon_type[t[157]]+"",c=t[157]+"";return{c(){e=F("option"),n=z("("),o=z(p),l=z(") - "),s=z(c),r=T(),e.__value=i=t[157],e.value=e.__value,q(e,"class",a="icon_type_"+t[68].iconType[t[157]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,o),j(e,l),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function qe(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,z,O,M,P,$,N=Object.keys(t[6]._opt.years).sort(),B=[];for(let e=0;e<N.length;e+=1)B[e]=Pe(Ce(t,N,e));let U=t[67],G=[];for(let e=0;e<U.length;e+=1)G[e]=$e(Le(t,U,e));return{c(){e=F("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (3)</b>",n=T(),o=F("div"),l=F("div"),s=F("fieldset"),r=F("legend"),r.textContent="Фильтрация по периодам:",i=T(),a=F("div"),p=F("input"),u=F("label"),u.textContent="Фильтрация по годам",_=T(),h=F("div");for(let t=0;t<B.length;t+=1)B[t].c();v=T(),f=F("div"),m=F("select"),g=F("option"),g.textContent=`\n\t\t\t\t\t\tВсе типы (${t[67].reduce(t[121],0)})\n\t\t\t\t\t`;for(let t=0;t<G.length;t+=1)G[t].c();b=T(),x=F("div"),k=F("select"),L=F("option"),L.textContent="Очаги все",z=F("option"),z.textContent="Только с погибшими",O=F("option"),O.textContent="Только с пострадавшими",M=F("option"),M.textContent="С пострадавшими или погибшими",P=F("option"),P.textContent="С пострадавшими и погибшими",q(e,"class","pLine svelte-1jsovbn"),q(p,"type","radio"),p.__value=c=1,p.value=p.__value,p.checked=d=1===t[35],q(p,"id","hearths_period_type_31"),q(p,"name","hearths_period_type_3"),q(p,"class","svelte-1jsovbn"),t[116][3].push(p),q(u,"for","hearths_period_type_31"),q(u,"class","svelte-1jsovbn"),q(h,"class","pLine margin svelte-1jsovbn"),q(a,"class","pLine type svelte-1jsovbn"),q(l,"class","pLine nowrap svelte-1jsovbn"),g.__value="",g.value=g.__value,q(g,"class","svelte-1jsovbn"),q(m,"class","multiple_icon_typeTmp svelte-1jsovbn"),m.multiple=!0,void 0===t[34]&&X(()=>t[122].call(m)),q(f,"class","pLine svelte-1jsovbn"),L.__value="",L.value=L.__value,z.__value="1",z.value=z.__value,O.__value="2",O.value=O.__value,M.__value="3",M.value=M.__value,P.__value="4",P.value=P.__value,q(k,"class","svelte-1jsovbn"),void 0===t[33]&&X(()=>t[123].call(k)),q(x,"class","pLine svelte-1jsovbn"),q(o,"class","filtersCont svelte-1jsovbn")},m(c,d,w){C(c,e,d),C(c,n,d),C(c,o,d),j(o,l),j(l,s),j(s,r),j(s,i),j(s,a),j(a,p),p.checked=p.__value===t[35],j(a,u),j(a,_),j(a,h);for(let t=0;t<B.length;t+=1)B[t].m(h,null);j(o,v),j(o,f),j(f,m),j(m,g);for(let t=0;t<G.length;t+=1)G[t].m(m,null);H(m,t[34]),j(o,b),j(o,x),j(x,k),j(k,L),j(k,z),j(k,O),j(k,M),j(k,P),S(k,t[33]),w&&y($),$=[E(p,"change",t[88]),E(p,"change",t[120]),E(m,"change",t[122]),E(m,"change",t[88]),E(k,"change",t[123]),E(k,"change",t[88])]},p(t,e){if(16&e[1]&&d!==(d=1===t[35])&&(p.checked=d),16&e[1]&&(p.checked=p.__value===t[35]),64&e[0]|48&e[1]|67108864&e[2]){let n;for(N=Object.keys(t[6]._opt.years).sort(),n=0;n<N.length;n+=1){const o=Ce(t,N,n);B[n]?B[n].p(o,e):(B[n]=Pe(o),B[n].c(),B[n].m(h,null))}for(;n<B.length;n+=1)B[n].d(1);B.length=N.length}if(48&e[2]){let n;for(U=t[67],n=0;n<U.length;n+=1){const o=Le(t,U,n);G[n]?G[n].p(o,e):(G[n]=$e(o),G[n].c(),G[n].m(m,null))}for(;n<G.length;n+=1)G[n].d(1);G.length=U.length}8&e[1]&&H(m,t[34]),4&e[1]&&S(k,t[33])},d(l){l&&w(e),l&&w(n),l&&w(o),t[116][3].splice(t[116][3].indexOf(p),1),D(B,l),D(G,l),y($)}}}function Pe(t){let e,n,o,l,s,r,i,a=t[157]+"";return{c(){e=F("input"),s=F("label"),r=z(a),q(e,"type","checkbox"),q(e,"id","hearths_year_3"),e.checked=n=t[36][t[157]],e.disabled=o=2===t[35],q(e,"name",l=t[157]),q(e,"class","svelte-1jsovbn"),q(s,"for","hearths_year_3"),q(s,"class","svelte-1jsovbn")},m(n,o,l){C(n,e,o),C(n,s,o),j(s,r),l&&i(),i=E(e,"change",t[88])},p(t,s){64&s[0]|32&s[1]&&n!==(n=t[36][t[157]])&&(e.checked=n),16&s[1]&&o!==(o=2===t[35])&&(e.disabled=o),64&s[0]&&l!==(l=t[157])&&q(e,"name",l),64&s[0]&&a!==(a=t[157]+"")&&$(r,a)},d(t){t&&w(e),t&&w(s),i()}}}function $e(t){let e,n,o,l,s,r,i,a,p=t[66].str_icon_type[t[157]]+"",c=t[157]+"";return{c(){e=F("option"),n=z("("),o=z(p),l=z(") - "),s=z(c),r=T(),e.__value=i=t[157],e.value=e.__value,q(e,"class",a="icon_type_"+t[66].iconType[t[157]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,o),j(e,l),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function Ne(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,z,O,M,P,$,N,B,U,G,A,I,R,Z=Object.keys(t[7]._opt.years).sort(),Y=[];for(let e=0;e<Z.length;e+=1)Y[e]=Se(je(t,Z,e));let V=Object.keys(t[7]._opt.years).sort(),W=[];for(let e=0;e<V.length;e+=1)W[e]=Be(ke(t,V,e));let J=t[65],K=[];for(let e=0;e<J.length;e+=1)K[e]=Ue(be(t,J,e));return{c(){e=F("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (Stat)</b>",n=T(),o=F("div"),l=F("div"),s=F("fieldset"),r=F("legend"),r.textContent="Фильтрация по периодам:",i=T(),a=F("div"),p=F("input"),u=F("label"),u.textContent="Фильтрация по годам",_=T(),h=F("div");for(let t=0;t<Y.length;t+=1)Y[t].c();v=T(),f=F("div"),m=F("input"),b=F("label"),b.textContent="Фильтрация по кварталам",x=T(),k=F("div");for(let t=0;t<W.length;t+=1)W[t].c();L=T(),z=F("div"),O=F("select"),M=F("option"),M.textContent=`\n\t\t\t\t\t\tВсе типы (${t[65].reduce(t[126],0)})\n\t\t\t\t\t`;for(let t=0;t<K.length;t+=1)K[t].c();P=T(),$=F("div"),N=F("select"),B=F("option"),B.textContent="Очаги все",U=F("option"),U.textContent="Только с погибшими",G=F("option"),G.textContent="Только с пострадавшими",A=F("option"),A.textContent="С пострадавшими или погибшими",I=F("option"),I.textContent="С пострадавшими и погибшими",q(e,"class","pLine svelte-1jsovbn"),q(p,"type","radio"),p.__value=c=1,p.value=p.__value,p.checked=d=1===t[39],q(p,"id","hearths_period_type_Stat1"),q(p,"name","hearths_period_type_Stat"),q(p,"class","svelte-1jsovbn"),t[116][2].push(p),q(u,"for","hearths_period_type_Stat1"),q(u,"class","svelte-1jsovbn"),q(h,"class","pLine margin svelte-1jsovbn"),q(a,"class","pLine type svelte-1jsovbn"),q(m,"type","radio"),m.__value=g=2,m.value=m.__value,q(m,"id","hearths_period_type_Stat2"),q(m,"name","hearths_period_type_Stat"),q(m,"class","svelte-1jsovbn"),t[116][2].push(m),q(b,"for","hearths_period_type_Stat2"),q(b,"class","svelte-1jsovbn"),q(k,"class","pLine margin svelte-1jsovbn"),q(f,"class","pLine type svelte-1jsovbn"),q(l,"class","pLine nowrap svelte-1jsovbn"),M.__value="",M.value=M.__value,q(M,"class","svelte-1jsovbn"),q(O,"class","multiple_icon_typeTmp svelte-1jsovbn"),O.multiple=!0,void 0===t[38]&&X(()=>t[127].call(O)),q(z,"class","pLine svelte-1jsovbn"),B.__value="",B.value=B.__value,U.__value="1",U.value=U.__value,G.__value="2",G.value=G.__value,A.__value="3",A.value=A.__value,I.__value="4",I.value=I.__value,q(N,"class","svelte-1jsovbn"),void 0===t[37]&&X(()=>t[128].call(N)),q($,"class","pLine svelte-1jsovbn"),q(o,"class","filtersCont svelte-1jsovbn")},m(c,d,g){C(c,e,d),C(c,n,d),C(c,o,d),j(o,l),j(l,s),j(s,r),j(s,i),j(s,a),j(a,p),p.checked=p.__value===t[39],j(a,u),j(a,_),j(a,h);for(let t=0;t<Y.length;t+=1)Y[t].m(h,null);j(s,v),j(s,f),j(f,m),m.checked=m.__value===t[39],j(f,b),j(f,x),j(f,k);for(let t=0;t<W.length;t+=1)W[t].m(k,null);j(o,L),j(o,z),j(z,O),j(O,M);for(let t=0;t<K.length;t+=1)K[t].m(O,null);H(O,t[38]),j(o,P),j(o,$),j($,N),j(N,B),j(N,U),j(N,G),j(N,A),j(N,I),S(N,t[37]),g&&y(R),R=[E(p,"change",t[89]),E(p,"change",t[124]),E(m,"change",t[89]),E(m,"change",t[125]),E(O,"change",t[127]),E(O,"change",t[89]),E(N,"change",t[128]),E(N,"change",t[89])]},p(t,e){if(256&e[1]&&d!==(d=1===t[39])&&(p.checked=d),256&e[1]&&(p.checked=p.__value===t[39]),128&e[0]|768&e[1]|134217728&e[2]){let n;for(Z=Object.keys(t[7]._opt.years).sort(),n=0;n<Z.length;n+=1){const o=je(t,Z,n);Y[n]?Y[n].p(o,e):(Y[n]=Se(o),Y[n].c(),Y[n].m(h,null))}for(;n<Y.length;n+=1)Y[n].d(1);Y.length=Z.length}if(256&e[1]&&(m.checked=m.__value===t[39]),128&e[0]|1280&e[1]|134217728&e[2]){let n;for(V=Object.keys(t[7]._opt.years).sort(),n=0;n<V.length;n+=1){const o=ke(t,V,n);W[n]?W[n].p(o,e):(W[n]=Be(o),W[n].c(),W[n].m(k,null))}for(;n<W.length;n+=1)W[n].d(1);W.length=V.length}if(12&e[2]){let n;for(J=t[65],n=0;n<J.length;n+=1){const o=be(t,J,n);K[n]?K[n].p(o,e):(K[n]=Ue(o),K[n].c(),K[n].m(O,null))}for(;n<K.length;n+=1)K[n].d(1);K.length=J.length}128&e[1]&&H(O,t[38]),64&e[1]&&S(N,t[37])},d(l){l&&w(e),l&&w(n),l&&w(o),t[116][2].splice(t[116][2].indexOf(p),1),D(Y,l),t[116][2].splice(t[116][2].indexOf(m),1),D(W,l),D(K,l),y(R)}}}function Se(t){let e,n,o,l,s,r,i,a=t[157]+"";return{c(){e=F("input"),s=F("label"),r=z(a),q(e,"type","checkbox"),q(e,"id","hearths_year_Stat"),e.checked=n=t[40][t[157]],e.disabled=o=2===t[39],q(e,"name",l=t[157]),q(e,"class","svelte-1jsovbn"),q(s,"for","hearths_year_Stat"),q(s,"class","svelte-1jsovbn")},m(n,o,l){C(n,e,o),C(n,s,o),j(s,r),l&&i(),i=E(e,"change",t[89])},p(t,s){128&s[0]|512&s[1]&&n!==(n=t[40][t[157]])&&(e.checked=n),256&s[1]&&o!==(o=2===t[39])&&(e.disabled=o),128&s[0]&&l!==(l=t[157])&&q(e,"name",l),128&s[0]&&a!==(a=t[157]+"")&&$(r,a)},d(t){t&&w(e),t&&w(s),i()}}}function He(t){let e,n,o,l,s,r,i,a,p,c,d=t[170]+"",u=t[157]+"";return{c(){e=F("input"),s=F("label"),r=z(d),i=z(" кв. "),a=z(u),q(e,"type","checkbox"),q(e,"id","hearths_quarter_Stat"),e.checked=n=t[41][t[157]]&&t[41][t[157]][t[170]],e.disabled=o=1===t[39],q(e,"name",l=t[157]+"_"+t[170]),q(e,"class","svelte-1jsovbn"),q(s,"for",p="hearths_quarter_Stat_"+t[157]+"_"+t[170]),q(s,"class","svelte-1jsovbn")},m(n,o,l){C(n,e,o),C(n,s,o),j(s,r),j(s,i),j(s,a),l&&c(),c=E(e,"change",t[89])},p(t,i){128&i[0]|1024&i[1]&&n!==(n=t[41][t[157]]&&t[41][t[157]][t[170]])&&(e.checked=n),256&i[1]&&o!==(o=1===t[39])&&(e.disabled=o),128&i[0]&&l!==(l=t[157]+"_"+t[170])&&q(e,"name",l),128&i[0]&&d!==(d=t[170]+"")&&$(r,d),128&i[0]&&u!==(u=t[157]+"")&&$(a,u),128&i[0]&&p!==(p="hearths_quarter_Stat_"+t[157]+"_"+t[170])&&q(s,"for",p)},d(t){t&&w(e),t&&w(s),c()}}}function Be(t){let e,n,o=Object.keys(t[7]._opt.years[t[157]]).sort(),l=[];for(let e=0;e<o.length;e+=1)l[e]=He(xe(t,o,e));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=T(),n=F("br")},m(t,o){for(let e=0;e<l.length;e+=1)l[e].m(t,o);C(t,e,o),C(t,n,o)},p(t,n){if(128&n[0]|1280&n[1]|134217728&n[2]){let s;for(o=Object.keys(t[7]._opt.years[t[157]]).sort(),s=0;s<o.length;s+=1){const r=xe(t,o,s);l[s]?l[s].p(r,n):(l[s]=He(r),l[s].c(),l[s].m(e.parentNode,e))}for(;s<l.length;s+=1)l[s].d(1);l.length=o.length}},d(t){D(l,t),t&&w(e),t&&w(n)}}}function Ue(t){let e,n,o,l,s,r,i,a,p=t[64].str_icon_type[t[157]]+"",c=t[157]+"";return{c(){e=F("option"),n=z("("),o=z(p),l=z(") - "),s=z(c),r=T(),e.__value=i=t[157],e.value=e.__value,q(e,"class",a="icon_type_"+t[64].iconType[t[157]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,o),j(e,l),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function Ge(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,z,O,M,P,$,N,B,U,G,A,I,R,Z=Object.keys(t[8]._opt.years).sort(),Y=[];for(let e=0;e<Z.length;e+=1)Y[e]=Ae(ye(t,Z,e));let V=Object.keys(t[8]._opt.years).sort(),W=[];for(let e=0;e<V.length;e+=1)W[e]=Re(ge(t,V,e));let J=t[63],K=[];for(let e=0;e<J.length;e+=1)K[e]=Ze(fe(t,J,e));return{c(){e=F("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (TMP)</b>",n=T(),o=F("div"),l=F("div"),s=F("fieldset"),r=F("legend"),r.textContent="Фильтрация по периодам:",i=T(),a=F("div"),p=F("input"),u=F("label"),u.textContent="Фильтрация по годам",_=T(),h=F("div");for(let t=0;t<Y.length;t+=1)Y[t].c();v=T(),f=F("div"),m=F("input"),b=F("label"),b.textContent="Фильтрация по кварталам",x=T(),k=F("div");for(let t=0;t<W.length;t+=1)W[t].c();L=T(),z=F("div"),O=F("select"),M=F("option"),M.textContent=`\n\t\t\t\t\t\tВсе типы (${t[63].reduce(t[131],0)})\n\t\t\t\t\t`;for(let t=0;t<K.length;t+=1)K[t].c();P=T(),$=F("div"),N=F("select"),B=F("option"),B.textContent="Очаги все",U=F("option"),U.textContent="Только с погибшими",G=F("option"),G.textContent="Только с пострадавшими",A=F("option"),A.textContent="С пострадавшими или погибшими",I=F("option"),I.textContent="С пострадавшими и погибшими",q(e,"class","pLine svelte-1jsovbn"),q(p,"type","radio"),p.__value=c=1,p.value=p.__value,p.checked=d=1===t[44],q(p,"id","hearths_period_type_tmp1"),q(p,"name","hearths_period_type_tmp"),q(p,"class","svelte-1jsovbn"),t[116][1].push(p),q(u,"for","hearths_period_type_tmp1"),q(u,"class","svelte-1jsovbn"),q(h,"class","pLine margin svelte-1jsovbn"),q(a,"class","pLine type svelte-1jsovbn"),q(m,"type","radio"),m.__value=g=2,m.value=m.__value,q(m,"id","hearths_period_type_tmp2"),q(m,"name","hearths_period_type_tmp"),q(m,"class","svelte-1jsovbn"),t[116][1].push(m),q(b,"for","hearths_period_type_tmp2"),q(b,"class","svelte-1jsovbn"),q(k,"class","pLine margin svelte-1jsovbn"),q(f,"class","pLine type svelte-1jsovbn"),q(l,"class","pLine nowrap svelte-1jsovbn"),M.__value="",M.value=M.__value,q(M,"class","svelte-1jsovbn"),q(O,"class","multiple_icon_typeTmp svelte-1jsovbn"),O.multiple=!0,void 0===t[43]&&X(()=>t[132].call(O)),q(z,"class","pLine svelte-1jsovbn"),B.__value="",B.value=B.__value,U.__value="1",U.value=U.__value,G.__value="2",G.value=G.__value,A.__value="3",A.value=A.__value,I.__value="4",I.value=I.__value,q(N,"class","svelte-1jsovbn"),void 0===t[42]&&X(()=>t[133].call(N)),q($,"class","pLine svelte-1jsovbn"),q(o,"class","filtersCont svelte-1jsovbn")},m(c,d,g){C(c,e,d),C(c,n,d),C(c,o,d),j(o,l),j(l,s),j(s,r),j(s,i),j(s,a),j(a,p),p.checked=p.__value===t[44],j(a,u),j(a,_),j(a,h);for(let t=0;t<Y.length;t+=1)Y[t].m(h,null);j(s,v),j(s,f),j(f,m),m.checked=m.__value===t[44],j(f,b),j(f,x),j(f,k);for(let t=0;t<W.length;t+=1)W[t].m(k,null);j(o,L),j(o,z),j(z,O),j(O,M);for(let t=0;t<K.length;t+=1)K[t].m(O,null);H(O,t[43]),j(o,P),j(o,$),j($,N),j(N,B),j(N,U),j(N,G),j(N,A),j(N,I),S(N,t[42]),g&&y(R),R=[E(p,"change",t[90]),E(p,"change",t[129]),E(m,"change",t[90]),E(m,"change",t[130]),E(O,"change",t[132]),E(O,"change",t[90]),E(N,"change",t[133]),E(N,"change",t[90])]},p(t,e){if(8192&e[1]&&d!==(d=1===t[44])&&(p.checked=d),8192&e[1]&&(p.checked=p.__value===t[44]),256&e[0]|24576&e[1]|268435456&e[2]){let n;for(Z=Object.keys(t[8]._opt.years).sort(),n=0;n<Z.length;n+=1){const o=ye(t,Z,n);Y[n]?Y[n].p(o,e):(Y[n]=Ae(o),Y[n].c(),Y[n].m(h,null))}for(;n<Y.length;n+=1)Y[n].d(1);Y.length=Z.length}if(8192&e[1]&&(m.checked=m.__value===t[44]),256&e[0]|40960&e[1]|268435456&e[2]){let n;for(V=Object.keys(t[8]._opt.years).sort(),n=0;n<V.length;n+=1){const o=ge(t,V,n);W[n]?W[n].p(o,e):(W[n]=Re(o),W[n].c(),W[n].m(k,null))}for(;n<W.length;n+=1)W[n].d(1);W.length=V.length}if(3&e[2]){let n;for(J=t[63],n=0;n<J.length;n+=1){const o=fe(t,J,n);K[n]?K[n].p(o,e):(K[n]=Ze(o),K[n].c(),K[n].m(O,null))}for(;n<K.length;n+=1)K[n].d(1);K.length=J.length}4096&e[1]&&H(O,t[43]),2048&e[1]&&S(N,t[42])},d(l){l&&w(e),l&&w(n),l&&w(o),t[116][1].splice(t[116][1].indexOf(p),1),D(Y,l),t[116][1].splice(t[116][1].indexOf(m),1),D(W,l),D(K,l),y(R)}}}function Ae(t){let e,n,o,l,s,r,i,a=t[157]+"";return{c(){e=F("input"),s=F("label"),r=z(a),q(e,"type","checkbox"),q(e,"id","hearths_year_tmp"),e.checked=n=t[45][t[157]],e.disabled=o=2===t[44],q(e,"name",l=t[157]),q(e,"class","svelte-1jsovbn"),q(s,"for","hearths_year_tmp"),q(s,"class","svelte-1jsovbn")},m(n,o,l){C(n,e,o),C(n,s,o),j(s,r),l&&i(),i=E(e,"change",t[90])},p(t,s){256&s[0]|16384&s[1]&&n!==(n=t[45][t[157]])&&(e.checked=n),8192&s[1]&&o!==(o=2===t[44])&&(e.disabled=o),256&s[0]&&l!==(l=t[157])&&q(e,"name",l),256&s[0]&&a!==(a=t[157]+"")&&$(r,a)},d(t){t&&w(e),t&&w(s),i()}}}function Ie(t){let e,n,o,l,s,r,i,a,p,c,d=t[170]+"",u=t[157]+"";return{c(){e=F("input"),s=F("label"),r=z(d),i=z(" кв. "),a=z(u),q(e,"type","checkbox"),q(e,"id","hearths_quarter_tmp"),e.checked=n=t[46][t[157]]&&t[46][t[157]][t[170]],e.disabled=o=1===t[44],q(e,"name",l=t[157]+"_"+t[170]),q(e,"class","svelte-1jsovbn"),q(s,"for",p="hearths_quarter_tmp_"+t[157]+"_"+t[170]),q(s,"class","svelte-1jsovbn")},m(n,o,l){C(n,e,o),C(n,s,o),j(s,r),j(s,i),j(s,a),l&&c(),c=E(e,"change",t[90])},p(t,i){256&i[0]|32768&i[1]&&n!==(n=t[46][t[157]]&&t[46][t[157]][t[170]])&&(e.checked=n),8192&i[1]&&o!==(o=1===t[44])&&(e.disabled=o),256&i[0]&&l!==(l=t[157]+"_"+t[170])&&q(e,"name",l),256&i[0]&&d!==(d=t[170]+"")&&$(r,d),256&i[0]&&u!==(u=t[157]+"")&&$(a,u),256&i[0]&&p!==(p="hearths_quarter_tmp_"+t[157]+"_"+t[170])&&q(s,"for",p)},d(t){t&&w(e),t&&w(s),c()}}}function Re(t){let e,n,o=Object.keys(t[8]._opt.years[t[157]]).sort(),l=[];for(let e=0;e<o.length;e+=1)l[e]=Ie(me(t,o,e));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=T(),n=F("br")},m(t,o){for(let e=0;e<l.length;e+=1)l[e].m(t,o);C(t,e,o),C(t,n,o)},p(t,n){if(256&n[0]|40960&n[1]|268435456&n[2]){let s;for(o=Object.keys(t[8]._opt.years[t[157]]).sort(),s=0;s<o.length;s+=1){const r=me(t,o,s);l[s]?l[s].p(r,n):(l[s]=Ie(r),l[s].c(),l[s].m(e.parentNode,e))}for(;s<l.length;s+=1)l[s].d(1);l.length=o.length}},d(t){D(l,t),t&&w(e),t&&w(n)}}}function Ze(t){let e,n,o,l,s,r,i,a,p=t[62].str_icon_type[t[157]]+"",c=t[157]+"";return{c(){e=F("option"),n=z("("),o=z(p),l=z(") - "),s=z(c),r=T(),e.__value=i=t[157],e.value=e.__value,q(e,"class",a="icon_type_"+t[62].iconType[t[157]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,o),j(e,l),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function Ye(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,z,O,M,P,$,N,B,U,G,A,I,R,Z,Y,V=Object.keys(t[9]._opt.years).sort(),W=[];for(let e=0;e<V.length;e+=1)W[e]=Ve(ve(t,V,e));let J=Object.keys(t[9]._opt.years).sort(),K=[];for(let e=0;e<J.length;e+=1)K[e]=Je(he(t,J,e));let Q=t[61],tt=[];for(let e=0;e<Q.length;e+=1)tt[e]=Ke(ue(t,Q,e));return{c(){e=F("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=F("div"),o.innerHTML="Фильтры - <b>ДТП Очаги</b>",l=T(),s=F("div"),r=F("div"),i=F("fieldset"),a=F("legend"),a.textContent="Фильтрация по периодам:",p=T(),c=F("div"),d=F("input"),h=F("label"),h.textContent="Фильтрация по годам",v=T(),f=F("div");for(let t=0;t<W.length;t+=1)W[t].c();m=T(),g=F("div"),b=F("input"),k=F("label"),k.textContent="Фильтрация по кварталам",L=T(),z=F("div");for(let t=0;t<K.length;t+=1)K[t].c();O=T(),M=F("div"),P=F("select"),$=F("option"),$.textContent=`\n\t\t\t\t\t\tВсе типы (${t[61].reduce(t[136],0)})\n\t\t\t\t\t`;for(let t=0;t<tt.length;t+=1)tt[t].c();N=T(),B=F("div"),U=F("select"),G=F("option"),G.textContent="Очаги все",A=F("option"),A.textContent="Только с погибшими",I=F("option"),I.textContent="Только с пострадавшими",R=F("option"),R.textContent="С пострадавшими или погибшими",Z=F("option"),Z.textContent="С пострадавшими и погибшими",q(e,"class","pLine svelte-1jsovbn"),q(o,"class","pLine svelte-1jsovbn"),q(d,"type","radio"),d.__value=u=1,d.value=d.__value,d.checked=_=1===t[49],q(d,"id","hearths_period_type1"),q(d,"name","hearths_period_type"),q(d,"class","svelte-1jsovbn"),t[116][0].push(d),q(h,"for","hearths_period_type1"),q(h,"class","svelte-1jsovbn"),q(f,"class","pLine margin svelte-1jsovbn"),q(c,"class","pLine type svelte-1jsovbn"),q(b,"type","radio"),b.__value=x=2,b.value=b.__value,q(b,"id","hearths_period_type2"),q(b,"name","hearths_period_type"),q(b,"class","svelte-1jsovbn"),t[116][0].push(b),q(k,"for","hearths_period_type2"),q(k,"class","svelte-1jsovbn"),q(z,"class","pLine margin svelte-1jsovbn"),q(g,"class","pLine type svelte-1jsovbn"),q(r,"class","pLine nowrap svelte-1jsovbn"),$.__value="",$.value=$.__value,q($,"class","svelte-1jsovbn"),q(P,"class","multiple_icon_typeTmp svelte-1jsovbn"),P.multiple=!0,void 0===t[48]&&X(()=>t[137].call(P)),q(M,"class","pLine svelte-1jsovbn"),G.__value="",G.value=G.__value,A.__value="1",A.value=A.__value,I.__value="2",I.value=I.__value,R.__value="3",R.value=R.__value,Z.__value="4",Z.value=Z.__value,q(U,"class","svelte-1jsovbn"),void 0===t[47]&&X(()=>t[138].call(U)),q(B,"class","pLine svelte-1jsovbn"),q(s,"class","filtersCont svelte-1jsovbn")},m(u,_,x){C(u,e,_),C(u,n,_),C(u,o,_),C(u,l,_),C(u,s,_),j(s,r),j(r,i),j(i,a),j(i,p),j(i,c),j(c,d),d.checked=d.__value===t[49],j(c,h),j(c,v),j(c,f);for(let t=0;t<W.length;t+=1)W[t].m(f,null);j(i,m),j(i,g),j(g,b),b.checked=b.__value===t[49],j(g,k),j(g,L),j(g,z);for(let t=0;t<K.length;t+=1)K[t].m(z,null);j(s,O),j(s,M),j(M,P),j(P,$);for(let t=0;t<tt.length;t+=1)tt[t].m(P,null);H(P,t[48]),j(s,N),j(s,B),j(B,U),j(U,G),j(U,A),j(U,I),j(U,R),j(U,Z),S(U,t[47]),x&&y(Y),Y=[E(d,"change",t[91]),E(d,"change",t[134]),E(b,"change",t[91]),E(b,"change",t[135]),E(P,"change",t[137]),E(P,"change",t[91]),E(U,"change",t[138]),E(U,"change",t[91])]},p(t,e){if(262144&e[1]&&_!==(_=1===t[49])&&(d.checked=_),262144&e[1]&&(d.checked=d.__value===t[49]),512&e[0]|786432&e[1]|536870912&e[2]){let n;for(V=Object.keys(t[9]._opt.years).sort(),n=0;n<V.length;n+=1){const o=ve(t,V,n);W[n]?W[n].p(o,e):(W[n]=Ve(o),W[n].c(),W[n].m(f,null))}for(;n<W.length;n+=1)W[n].d(1);W.length=V.length}if(262144&e[1]&&(b.checked=b.__value===t[49]),512&e[0]|1310720&e[1]|536870912&e[2]){let n;for(J=Object.keys(t[9]._opt.years).sort(),n=0;n<J.length;n+=1){const o=he(t,J,n);K[n]?K[n].p(o,e):(K[n]=Je(o),K[n].c(),K[n].m(z,null))}for(;n<K.length;n+=1)K[n].d(1);K.length=J.length}if(1610612736&e[1]){let n;for(Q=t[61],n=0;n<Q.length;n+=1){const o=ue(t,Q,n);tt[n]?tt[n].p(o,e):(tt[n]=Ke(o),tt[n].c(),tt[n].m(P,null))}for(;n<tt.length;n+=1)tt[n].d(1);tt.length=Q.length}131072&e[1]&&H(P,t[48]),65536&e[1]&&S(U,t[47])},d(r){r&&w(e),r&&w(n),r&&w(o),r&&w(l),r&&w(s),t[116][0].splice(t[116][0].indexOf(d),1),D(W,r),t[116][0].splice(t[116][0].indexOf(b),1),D(K,r),D(tt,r),y(Y)}}}function Ve(t){let e,n,o,l,s,r,i,a,p=t[157]+"";return{c(){e=F("input"),s=F("label"),r=z(p),q(e,"type","checkbox"),q(e,"id","hearths_year"),e.checked=n=t[50][t[157]],e.disabled=o=2===t[49],q(e,"name",l=t[157]),q(e,"class","svelte-1jsovbn"),q(s,"for",i="hearths_year"+t[157]),q(s,"class","svelte-1jsovbn")},m(n,o,l){C(n,e,o),C(n,s,o),j(s,r),l&&a(),a=E(e,"change",t[91])},p(t,a){512&a[0]|524288&a[1]&&n!==(n=t[50][t[157]])&&(e.checked=n),262144&a[1]&&o!==(o=2===t[49])&&(e.disabled=o),512&a[0]&&l!==(l=t[157])&&q(e,"name",l),512&a[0]&&p!==(p=t[157]+"")&&$(r,p),512&a[0]&&i!==(i="hearths_year"+t[157])&&q(s,"for",i)},d(t){t&&w(e),t&&w(s),a()}}}function We(t){let e,n,o,l,s,r,i,a,p,c,d=t[170]+"",u=t[157]+"";return{c(){e=F("input"),s=F("label"),r=z(d),i=z(" кв. "),a=z(u),q(e,"type","checkbox"),q(e,"id","hearths_quarter"),e.checked=n=t[51][t[157]]&&t[51][t[157]][t[170]],e.disabled=o=1===t[49],q(e,"name",l=t[157]+"_"+t[170]),q(e,"class","svelte-1jsovbn"),q(s,"for",p="hearths_quarter_"+t[157]+"_"+t[170]),q(s,"class","svelte-1jsovbn")},m(n,o,l){C(n,e,o),C(n,s,o),j(s,r),j(s,i),j(s,a),l&&c(),c=E(e,"change",t[91])},p(t,i){512&i[0]|1048576&i[1]&&n!==(n=t[51][t[157]]&&t[51][t[157]][t[170]])&&(e.checked=n),262144&i[1]&&o!==(o=1===t[49])&&(e.disabled=o),512&i[0]&&l!==(l=t[157]+"_"+t[170])&&q(e,"name",l),512&i[0]&&d!==(d=t[170]+"")&&$(r,d),512&i[0]&&u!==(u=t[157]+"")&&$(a,u),512&i[0]&&p!==(p="hearths_quarter_"+t[157]+"_"+t[170])&&q(s,"for",p)},d(t){t&&w(e),t&&w(s),c()}}}function Je(t){let e,n,o=Object.keys(t[9]._opt.years[t[157]]).sort(),l=[];for(let e=0;e<o.length;e+=1)l[e]=We(_e(t,o,e));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=T(),n=F("br")},m(t,o){for(let e=0;e<l.length;e+=1)l[e].m(t,o);C(t,e,o),C(t,n,o)},p(t,n){if(512&n[0]|1310720&n[1]|536870912&n[2]){let s;for(o=Object.keys(t[9]._opt.years[t[157]]).sort(),s=0;s<o.length;s+=1){const r=_e(t,o,s);l[s]?l[s].p(r,n):(l[s]=We(r),l[s].c(),l[s].m(e.parentNode,e))}for(;s<l.length;s+=1)l[s].d(1);l.length=o.length}},d(t){D(l,t),t&&w(e),t&&w(n)}}}function Ke(t){let e,n,o,l,s,r,i,a,p=t[60].str_icon_type[t[157]]+"",c=t[157]+"";return{c(){e=F("option"),n=z("("),o=z(p),l=z(") - "),s=z(c),r=T(),e.__value=i=t[157],e.value=e.__value,q(e,"class",a="icon_type_"+t[60].iconType[t[157]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,o),j(e,l),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function Qe(t){let e;return{c(){e=F("div"),e.textContent="Нет включенных слоев",q(e,"class","pLine svelte-1jsovbn")},m(t,n){C(t,e,n)},p:f,d(t){t&&w(e)}}}function Xe(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,D,O,M,P,S,H,B,U,G,A,I,R,Z,Y,V,W,J,K,Q,X,tt,et,nt,ot;return{c(){e=F("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=F("div"),l=F("button"),s=T(),r=F("input"),i=T(),a=F("input"),p=T(),c=F("button"),d=T(),u=F("div"),_=F("br"),h=T(),v=F("label"),f=F("input"),g=F("span"),b=z("Мин.яркость ("),x=z(t[23]),k=z(")"),L=T(),D=F("br"),O=T(),M=F("label"),P=F("input"),H=F("span"),B=z("Радиус ("),U=z(t[21]),G=z(")"),A=T(),I=F("br"),R=T(),Z=F("label"),Y=F("input"),W=F("span"),J=z("Размытие ("),K=z(t[22]),Q=z(")"),X=T(),tt=F("div"),et=F("input"),nt=F("label"),nt.textContent="- тепловая карта",q(e,"class","pLine svelte-1jsovbn"),q(l,"class","pika-prev"),q(r,"type","text"),q(r,"class","begDate svelte-1jsovbn"),q(a,"type","text"),q(a,"class","endDate svelte-1jsovbn"),q(c,"class","pika-next"),q(o,"class","pikaday pLine svelte-1jsovbn"),q(f,"type","range"),q(f,"min","0.05"),q(f,"max","1"),q(f,"step","0.01"),f.disabled=m=!t[72],q(f,"class","svelte-1jsovbn"),q(v,"class","svelte-1jsovbn"),q(P,"type","range"),q(P,"min","0"),q(P,"max","100"),q(P,"step","1"),P.disabled=S=!t[72],q(P,"class","svelte-1jsovbn"),q(M,"class","svelte-1jsovbn"),q(Y,"type","range"),q(Y,"min","0"),q(Y,"max","15"),q(Y,"step","0.01"),Y.disabled=V=!t[72],q(Y,"class","svelte-1jsovbn"),q(Z,"class","svelte-1jsovbn"),q(u,"class","pLine svelte-1jsovbn"),q(et,"type","checkbox"),et.checked=!0,q(et,"name","heat"),q(et,"class","svelte-1jsovbn"),q(nt,"for","heat"),q(nt,"class","svelte-1jsovbn"),q(tt,"class","pLine svelte-1jsovbn")},m(m,w,F){C(m,e,w),C(m,n,w),C(m,o,w),j(o,l),j(o,s),j(o,r),t[139](r),j(o,i),j(o,a),t[140](a),j(o,p),j(o,c),C(m,d,w),C(m,u,w),j(u,_),j(u,h),j(u,v),j(v,f),N(f,t[23]),j(v,g),j(g,b),j(g,x),j(g,k),j(u,L),j(u,D),j(u,O),j(u,M),j(M,P),N(P,t[21]),j(M,H),j(H,B),j(H,U),j(H,G),j(u,A),j(u,I),j(u,R),j(u,Z),j(Z,Y),N(Y,t[22]),j(Z,W),j(W,J),j(W,K),j(W,Q),C(m,X,w),C(m,tt,w),j(tt,et),t[144](et),j(tt,nt),F&&y(ot),ot=[E(l,"click",t[85]),E(c,"click",t[86]),E(f,"change",t[141]),E(f,"input",t[141]),E(f,"input",t[79]),E(P,"change",t[142]),E(P,"input",t[142]),E(P,"input",t[79]),E(Y,"change",t[143]),E(Y,"input",t[143]),E(Y,"input",t[79]),E(et,"change",t[78])]},p(t,e){8388608&e[0]&&N(f,t[23]),8388608&e[0]&&$(x,t[23]),2097152&e[0]&&N(P,t[21]),2097152&e[0]&&$(U,t[21]),4194304&e[0]&&N(Y,t[22]),4194304&e[0]&&$(K,t[22])},d(l){l&&w(e),l&&w(n),l&&w(o),t[139](null),t[140](null),l&&w(d),l&&w(u),l&&w(X),l&&w(tt),t[144](null),y(ot)}}}function tn(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v;function f(t,e){return t[0]._arm?nn:en}let m=f(t),g=m(t),b=t[52].collision_type&&function(t){let e,n,o,l,s=t[53],r=[];for(let e=0;e<s.length;e+=1)r[e]=on(de(t,s,e));return{c(){e=F("div"),n=F("select"),o=F("option"),o.textContent=`\n\t\t\t\t\t\tВсе типы (${t[53].reduce(t[145],0)})\n\t\t\t\t\t`;for(let t=0;t<r.length;t+=1)r[t].c();o.__value="",o.value=o.__value,q(o,"class","svelte-1jsovbn"),q(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===t[17]&&X(()=>t[146].call(n)),q(e,"class","pLine svelte-1jsovbn")},m(s,i,a){C(s,e,i),j(e,n),j(n,o);for(let t=0;t<r.length;t+=1)r[t].m(n,null);H(n,t[17]),a&&y(l),l=[E(n,"change",t[146]),E(n,"change",t[80])]},p(t,e){if(6291456&e[1]){let o;for(s=t[53],o=0;o<s.length;o+=1){const l=de(t,s,o);r[o]?r[o].p(l,e):(r[o]=on(l),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=s.length}131072&e[0]&&H(n,t[17])},d(t){t&&w(e),D(r,t),y(l)}}}(t);return{c(){e=F("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=F("div"),o.innerHTML="Фильтры - <b>ДТП Сводный</b>",l=T(),s=F("div"),r=F("div"),i=F("input"),a=F("label"),a.textContent="Все",p=T(),g.c(),c=T(),d=F("div"),u=F("input"),_=F("label"),_.textContent="Только ГИБДД",h=T(),b&&b.c(),q(e,"class","pLine svelte-1jsovbn"),q(o,"class","pLine svelte-1jsovbn"),q(i,"type","radio"),q(i,"id","d0"),q(i,"name","drone"),i.value="0",i.checked=!0,q(i,"class","svelte-1jsovbn"),q(a,"for","d0"),q(a,"class","svelte-1jsovbn"),q(r,"class","pLine svelte-1jsovbn"),q(u,"type","radio"),q(u,"id","d3"),q(u,"name","drone"),u.value="3",q(u,"class","svelte-1jsovbn"),q(_,"for","d3"),q(_,"class","svelte-1jsovbn"),q(d,"class","pLine svelte-1jsovbn"),q(s,"class","filtersCont svelte-1jsovbn")},m(f,m,x){C(f,e,m),C(f,n,m),C(f,o,m),C(f,l,m),C(f,s,m),j(s,r),j(r,i),j(r,a),j(s,p),g.m(s,null),j(s,c),j(s,d),j(d,u),j(d,_),j(s,h),b&&b.m(s,null),x&&y(v),v=[E(i,"click",t[84]),E(u,"click",t[84])]},p(t,e){m===(m=f(t))&&g?g.p(t,e):(g.d(1),g=m(t),g&&(g.c(),g.m(s,c))),t[52].collision_type&&b.p(t,e)},d(t){t&&w(e),t&&w(n),t&&w(o),t&&w(l),t&&w(s),g.d(),b&&b.d(),y(v)}}}function en(t){let e,n,o,l,s,r,i,a;return{c(){e=F("div"),n=F("input"),o=F("label"),o.textContent="Только Пересечения",l=T(),s=F("div"),r=F("input"),i=F("label"),i.textContent="Только СКПДИ",q(n,"type","radio"),q(n,"id","d1"),q(n,"name","drone"),n.value="1",q(n,"class","svelte-1jsovbn"),q(o,"for","d1"),q(o,"class","svelte-1jsovbn"),q(e,"class","pLine svelte-1jsovbn"),q(r,"type","radio"),q(r,"id","d2"),q(r,"name","drone"),r.value="2",q(r,"class","svelte-1jsovbn"),q(i,"for","d2"),q(i,"class","svelte-1jsovbn"),q(s,"class","pLine svelte-1jsovbn")},m(p,c,d){C(p,e,c),j(e,n),j(e,o),C(p,l,c),C(p,s,c),j(s,r),j(s,i),d&&y(a),a=[E(n,"click",t[84]),E(r,"click",t[84])]},p:f,d(t){t&&w(e),t&&w(l),t&&w(s),y(a)}}}function nn(t){let e,n,o,l;return{c(){e=F("div"),n=F("input"),o=F("label"),o.textContent="Только Пересечения ГИБДД и СКПДИ",q(n,"type","radio"),q(n,"id","d1"),q(n,"name","drone"),n.value="1",q(n,"class","svelte-1jsovbn"),q(o,"for","d1"),q(o,"class","svelte-1jsovbn"),q(e,"class","pLine svelte-1jsovbn")},m(s,r,i){C(s,e,r),j(e,n),j(e,o),i&&l(),l=E(n,"click",t[84])},p:f,d(t){t&&w(e),l()}}}function on(t){let e,n,o,l,s,r,i,a,p=t[52].collision_type[t[157]]+"",c=t[157]+"";return{c(){e=F("option"),n=z("("),o=z(p),l=z(") - "),s=z(c),r=T(),e.__value=i=t[157],e.value=e.__value,q(e,"class",a="icon_type_"+t[52].iconType[t[157]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,o),j(e,l),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function ln(t){let e,n,o,l,s,r=t[54].collision_type&&function(t){let e,n,o,l,s=t[55],r=[];for(let e=0;e<s.length;e+=1)r[e]=sn(ce(t,s,e));return{c(){e=F("div"),n=F("select"),o=F("option"),o.textContent=`\n\t\t\t\t\t\tВсе типы (${t[55].reduce(t[147],0)})\n\t\t\t\t\t`;for(let t=0;t<r.length;t+=1)r[t].c();o.__value="",o.value=o.__value,q(o,"class","svelte-1jsovbn"),q(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===t[18]&&X(()=>t[148].call(n)),q(e,"class","pLine svelte-1jsovbn")},m(s,i,a){C(s,e,i),j(e,n),j(n,o);for(let t=0;t<r.length;t+=1)r[t].m(n,null);H(n,t[18]),a&&y(l),l=[E(n,"change",t[148]),E(n,"change",t[83])]},p(t,e){if(25165824&e[1]){let o;for(s=t[55],o=0;o<s.length;o+=1){const l=ce(t,s,o);r[o]?r[o].p(l,e):(r[o]=sn(l),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=s.length}262144&e[0]&&H(n,t[18])},d(t){t&&w(e),D(r,t),y(l)}}}(t);return{c(){e=F("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=F("div"),o.innerHTML="Фильтры - <b>ДТП СКПДИ</b>",l=T(),s=F("div"),r&&r.c(),q(e,"class","pLine svelte-1jsovbn"),q(o,"class","pLine svelte-1jsovbn"),q(s,"class","filtersCont svelte-1jsovbn")},m(t,i){C(t,e,i),C(t,n,i),C(t,o,i),C(t,l,i),C(t,s,i),r&&r.m(s,null)},p(t,e){t[54].collision_type&&r.p(t,e)},d(t){t&&w(e),t&&w(n),t&&w(o),t&&w(l),t&&w(s),r&&r.d()}}}function sn(t){let e,n,o,l,s,r,i,a,p=t[54].collision_type[t[157]]+"",c=t[157]+"";return{c(){e=F("option"),n=z("("),o=z(p),l=z(") - "),s=z(c),r=T(),e.__value=i=t[157],e.value=e.__value,q(e,"class",a="icon_type_"+t[54].iconType[t[157]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,o),j(e,l),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function rn(t){let e,n,o,l,s,r=t[56].collision_type&&function(t){let e,n,o,l,s=t[57],r=[];for(let e=0;e<s.length;e+=1)r[e]=an(pe(t,s,e));return{c(){e=F("div"),n=F("select"),o=F("option"),o.textContent=`\n\t\t\t\t\t\tВсе типы (${t[57].reduce(t[149],0)})\n\t\t\t\t\t`;for(let t=0;t<r.length;t+=1)r[t].c();o.__value="",o.value=o.__value,q(o,"class","svelte-1jsovbn"),q(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===t[19]&&X(()=>t[150].call(n)),q(e,"class","pLine svelte-1jsovbn")},m(s,i,a){C(s,e,i),j(e,n),j(n,o);for(let t=0;t<r.length;t+=1)r[t].m(n,null);H(n,t[19]),a&&y(l),l=[E(n,"change",t[150]),E(n,"change",t[82])]},p(t,e){if(100663296&e[1]){let o;for(s=t[57],o=0;o<s.length;o+=1){const l=pe(t,s,o);r[o]?r[o].p(l,e):(r[o]=an(l),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=s.length}524288&e[0]&&H(n,t[19])},d(t){t&&w(e),D(r,t),y(l)}}}(t);return{c(){e=F("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=F("div"),o.innerHTML="Фильтры - <b>ДТП ГИБДД</b>",l=T(),s=F("div"),r&&r.c(),q(e,"class","pLine svelte-1jsovbn"),q(o,"class","pLine svelte-1jsovbn"),q(s,"class","filtersCont svelte-1jsovbn")},m(t,i){C(t,e,i),C(t,n,i),C(t,o,i),C(t,l,i),C(t,s,i),r&&r.m(s,null)},p(t,e){t[56].collision_type&&r.p(t,e)},d(t){t&&w(e),t&&w(n),t&&w(o),t&&w(l),t&&w(s),r&&r.d()}}}function an(t){let e,n,o,l,s,r,i,a,p=t[56].collision_type[t[157]]+"",c=t[157]+"";return{c(){e=F("option"),n=z("("),o=z(p),l=z(") - "),s=z(c),r=T(),e.__value=i=t[157],e.value=e.__value,q(e,"class",a="icon_type_"+t[56].iconType[t[157]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,o),j(e,l),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function pn(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h=t[58].collision_type&&function(t){let e,n,o,l,s=t[59],r=[];for(let e=0;e<s.length;e+=1)r[e]=cn(ae(t,s,e));return{c(){e=F("div"),n=F("select"),o=F("option"),o.textContent=`\n\t\t\t\t\t\tВсе типы (${t[59].reduce(t[153],0)})\n\t\t\t\t\t`;for(let t=0;t<r.length;t+=1)r[t].c();o.__value="",o.value=o.__value,q(o,"class","svelte-1jsovbn"),q(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===t[20]&&X(()=>t[154].call(n)),q(e,"class","pLine svelte-1jsovbn")},m(s,i,a){C(s,e,i),j(e,n),j(n,o);for(let t=0;t<r.length;t+=1)r[t].m(n,null);H(n,t[20]),a&&y(l),l=[E(n,"change",t[154]),E(n,"change",t[81])]},p(t,e){if(402653184&e[1]){let o;for(s=t[59],o=0;o<s.length;o+=1){const l=ae(t,s,o);r[o]?r[o].p(l,e):(r[o]=cn(l),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=s.length}1048576&e[0]&&H(n,t[20])},d(t){t&&w(e),D(r,t),y(l)}}}(t);return{c(){e=F("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=F("div"),o.innerHTML="Фильтры - <b>ДТП ГИБДД + Рубежи</b>",l=T(),s=F("div"),r=F("input"),i=F("label"),i.textContent="- с рубежами",a=T(),p=F("input"),c=F("label"),c.textContent="- без рубежей",d=z("\n\t\tlist_rub\n\t\t"),u=F("div"),h&&h.c(),q(e,"class","pLine svelte-1jsovbn"),q(o,"class","pLine svelte-1jsovbn"),q(r,"type","checkbox"),q(r,"name","list_rubOn"),q(r,"class","svelte-1jsovbn"),q(i,"for","list_rubOn"),q(i,"class","svelte-1jsovbn"),q(p,"type","checkbox"),q(p,"name","list_rubOff"),q(p,"class","svelte-1jsovbn"),q(c,"for","list_rubOff"),q(c,"class","svelte-1jsovbn"),q(s,"class","pLine svelte-1jsovbn"),q(u,"class","filtersCont svelte-1jsovbn")},m(v,f,m){C(v,e,f),C(v,n,f),C(v,o,f),C(v,l,f),C(v,s,f),j(s,r),r.checked=t[27],j(s,i),j(s,a),j(s,p),p.checked=t[28],j(s,c),C(v,d,f),C(v,u,f),h&&h.m(u,null),m&&y(_),_=[E(r,"change",t[151]),E(r,"change",t[81]),E(p,"change",t[152]),E(p,"change",t[81])]},p(t,e){134217728&e[0]&&(r.checked=t[27]),268435456&e[0]&&(p.checked=t[28]),t[58].collision_type&&h.p(t,e)},d(t){t&&w(e),t&&w(n),t&&w(o),t&&w(l),t&&w(s),t&&w(d),t&&w(u),h&&h.d(),y(_)}}}function cn(t){let e,n,o,l,s,r,i,a,p=t[58].collision_type[t[157]]+"",c=t[157]+"";return{c(){e=F("option"),n=z("("),o=z(p),l=z(") - "),s=z(c),r=T(),e.__value=i=t[157],e.value=e.__value,q(e,"class",a="icon_type_"+t[58].iconType[t[157]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,o),j(e,l),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function dn(t){let e,n,o,l,s,r,i,a,p,c,d,u;return{c(){e=F("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=F("div"),o.innerHTML="Фильтры - <b>Рубежей</b>",l=T(),s=F("div"),r=F("div"),i=F("input"),a=F("label"),a.textContent="- есть комплексы",p=T(),c=F("input"),d=F("label"),d.textContent="-  нет комплексов",q(e,"class","pLine svelte-1jsovbn"),q(o,"class","pLine svelte-1jsovbn"),q(i,"type","checkbox"),q(i,"name","comp1"),q(i,"class","svelte-1jsovbn"),q(a,"for","comp1"),q(a,"class","svelte-1jsovbn"),q(c,"type","checkbox"),q(c,"name","comp"),q(c,"class","svelte-1jsovbn"),q(d,"for","comp"),q(d,"class","svelte-1jsovbn"),q(r,"class","pLine svelte-1jsovbn"),q(s,"class","filtersCont")},m(_,h,v){C(_,e,h),C(_,n,h),C(_,o,h),C(_,l,h),C(_,s,h),j(s,r),j(r,i),i.checked=t[25],j(r,a),j(r,p),j(r,c),c.checked=t[26],j(r,d),v&&y(u),u=[E(i,"change",t[155]),E(i,"change",t[73]),E(c,"change",t[156]),E(c,"change",t[73])]},p(t,e){33554432&e[0]&&(i.checked=t[25]),67108864&e[0]&&(c.checked=t[26])},d(t){t&&w(e),t&&w(n),t&&w(o),t&&w(l),t&&w(s),y(u)}}}function un(t){let e,n,o,l,s,r,i,a,p,c,d,u,_=t[4]._map&&t[4]._opt&&t[4]._opt.years&&ze(t),h=t[5]._map&&t[5]._opt&&t[5]._opt.years&&Oe(t),v=t[6]._map&&t[6]._opt&&t[6]._opt.years&&qe(t),m=t[7]._map&&t[7]._opt&&t[7]._opt.years&&Ne(t),g=t[8]._map&&t[8]._opt&&t[8]._opt.years&&Ge(t),y=t[9]._map&&t[9]._opt&&t[9]._opt.years&&Ye(t);function b(t,e){return t[0]._map||t[1]._map||t[2]._map||t[3]._map?Xe:t[9]._map||t[8]._map||t[4]._map||t[10]._map?void 0:Qe}let x=b(t),k=x&&x(t),L=t[0]._map&&tn(t),D=t[1]._map&&ln(t),z=t[2]._map&&rn(t),O=t[3]._map&&pn(t),E=t[10]._map&&dn(t);return{c(){e=F("div"),_&&_.c(),n=T(),h&&h.c(),o=T(),v&&v.c(),l=T(),m&&m.c(),s=T(),g&&g.c(),r=T(),y&&y.c(),i=T(),k&&k.c(),a=T(),L&&L.c(),p=T(),D&&D.c(),c=T(),z&&z.c(),d=T(),O&&O.c(),u=T(),E&&E.c(),q(e,"class","mvsFilters")},m(t,f){C(t,e,f),_&&_.m(e,null),j(e,n),h&&h.m(e,null),j(e,o),v&&v.m(e,null),j(e,l),m&&m.m(e,null),j(e,s),g&&g.m(e,null),j(e,r),y&&y.m(e,null),j(e,i),k&&k.m(e,null),j(e,a),L&&L.m(e,null),j(e,p),D&&D.m(e,null),j(e,c),z&&z.m(e,null),j(e,d),O&&O.m(e,null),j(e,u),E&&E.m(e,null)},p(t,f){t[4]._map&&t[4]._opt&&t[4]._opt.years?_?_.p(t,f):(_=ze(t),_.c(),_.m(e,n)):_&&(_.d(1),_=null),t[5]._map&&t[5]._opt&&t[5]._opt.years?h?h.p(t,f):(h=Oe(t),h.c(),h.m(e,o)):h&&(h.d(1),h=null),t[6]._map&&t[6]._opt&&t[6]._opt.years?v?v.p(t,f):(v=qe(t),v.c(),v.m(e,l)):v&&(v.d(1),v=null),t[7]._map&&t[7]._opt&&t[7]._opt.years?m?m.p(t,f):(m=Ne(t),m.c(),m.m(e,s)):m&&(m.d(1),m=null),t[8]._map&&t[8]._opt&&t[8]._opt.years?g?g.p(t,f):(g=Ge(t),g.c(),g.m(e,r)):g&&(g.d(1),g=null),t[9]._map&&t[9]._opt&&t[9]._opt.years?y?y.p(t,f):(y=Ye(t),y.c(),y.m(e,i)):y&&(y.d(1),y=null),x===(x=b(t))&&k?k.p(t,f):(k&&k.d(1),k=x&&x(t),k&&(k.c(),k.m(e,a))),t[0]._map?L?L.p(t,f):(L=tn(t),L.c(),L.m(e,p)):L&&(L.d(1),L=null),t[1]._map?D?D.p(t,f):(D=ln(t),D.c(),D.m(e,c)):D&&(D.d(1),D=null),t[2]._map?z?z.p(t,f):(z=rn(t),z.c(),z.m(e,d)):z&&(z.d(1),z=null),t[3]._map?O?O.p(t,f):(O=pn(t),O.c(),O.m(e,u)):O&&(O.d(1),O=null),t[10]._map?E?E.p(t,f):(E=dn(t),E.c(),E.m(e,null)):E&&(E.d(1),E=null)},i:f,o:f,d(t){t&&w(e),_&&_.d(),h&&h.d(),v&&v.d(),m&&m.d(),g&&g.d(),y&&y.d(),k&&k.d(),L&&L.d(),D&&D.d(),z&&z.d(),O&&O.d(),E&&E.d()}}}function _n(t,e,n){let o,l,{DtpHearthsPicket:s}=e,{DtpHearths5:r}=e,{DtpHearths3:i}=e,{DtpHearthsStat:a}=e,{DtpHearthsTmp:p}=e,{DtpHearths:c}=e,{DtpVerifyed:d}=e,{DtpSkpdi:u}=e,{DtpGibdd:_}=e,{DtpGibddRub:h}=e,{Rub:v}=e,f=0;const m=new Date,g=new Date(new Date(m.getFullYear(),m.getMonth(),m.getDate()).getTime()),y=m,b=new Date(2018,0,1);let x,k,j,C=[b.getTime()/1e3,y.getTime()/1e3],w=d._opt||{},D=w.collision_type?Object.keys(w.collision_type).sort((t,e)=>w.collision_type[e]-w.collision_type[t]):[],F=u._opt||{},z=F.collision_type?Object.keys(F.collision_type).sort((t,e)=>F.collision_type[e]-F.collision_type[t]):[],T=_._opt||{},O=T.collision_type?Object.keys(T.collision_type).sort((t,e)=>T.collision_type[e]-T.collision_type[t]):[],E=h._opt||{},M=E.collision_type?Object.keys(E.collision_type).sort((t,e)=>E.collision_type[e]-E.collision_type[t]):[],q=c._opt||{},$=q.str_icon_type?Object.keys(q.str_icon_type).sort((t,e)=>q.str_icon_type[e]-q.str_icon_type[t]):[],N=p._opt||{},S=N.str_icon_type?Object.keys(N.str_icon_type).sort((t,e)=>N.str_icon_type[e]-N.str_icon_type[t]):[],H=a._opt||{},G=H.str_icon_type?Object.keys(H.str_icon_type).sort((t,e)=>H.str_icon_type[e]-H.str_icon_type[t]):[],A=i._opt||{},R=A.str_icon_type?Object.keys(A.str_icon_type).sort((t,e)=>A.str_icon_type[e]-A.str_icon_type[t]):[],Z=r._opt||{},Y=Z.str_icon_type?Object.keys(Z.str_icon_type).sort((t,e)=>Z.str_icon_type[e]-Z.str_icon_type[t]):[],W=s._opt||{},J=W.road?Object.keys(W.road).sort((t,e)=>W.road[e]-W.road[t]):[],K=[""],Q={hearth3:!0,hearth5:!0},X=null,tt=null,et=[""],nt=[""],ot=[""],lt=[""],st={radius:19,blur:11.26,minOpacity:.34},rt=st.radius,it=11.26,at=.34,pt=v._argFilters?v._argFilters[0]:{type:"comp",zn:{on:!0,off:!0}},ct=pt.zn.on,dt=pt.zn.off;const ut=()=>{let t=[];tt&&t.push({type:"id_dtp",zn:tt}),X&&t.push({type:"id_hearth",zn:X}),K&&t.push({type:"roads",zn:K}),t.push({type:"ht",zn:Q}),s.setFilter(t)},_t=()=>{let t=[{type:"itemType",zn:f}];C&&t.push({type:"date",zn:C}),et&&t.push({type:"collision_type",zn:et}),d.setFilter(t)};let ht=h._argFilters?h._argFilters[0]:{type:"list_rub",zn:{on:!0,off:!0}},vt=ht.zn.on,ft=ht.zn.off;const mt=()=>{let t=[{type:"list_rub",zn:{on:vt,off:ft}}];C&&t.push({type:"date",zn:C}),lt&&t.push({type:"collision_type",zn:lt}),h.setFilter(t)},gt=()=>{let t=[];C&&t.push({type:"date",zn:C}),ot&&t.push({type:"collision_type",zn:ot}),_.setFilter(t)},yt=()=>{let t=[];C&&t.push({type:"date",zn:C}),nt&&t.push({type:"collision_type",zn:nt}),u.setFilter(t)};var bt;bt=()=>{let t={onSelect(t){this._o.field.value=this.toString(),C[this._o._dint]=this.getDate().getTime()/1e3+24*this._o._dint*60*60,_t(),yt(),gt()},toString(t,e){let n=t.getDate();n<10&&(n="0"+n);let o=t.getMonth()+1;return o<10&&(o="0"+o),`${n}.${o}.${t.getFullYear()}`},parse(t,e){const n=t.split("."),o=parseInt(n[0],10),l=parseInt(n[1],10)-1,s=parseInt(n[2],10);return new Date(s,l,o)},i18n:{previousMonth:"Предыдущий месяц",nextMonth:"Следующий месяц",months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],weekdays:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],weekdaysShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"]},format:"DD.MM.YYYY",setDefaultDate:!0,yearRange:20,blurFieldOnSelect:!1};x=new Pikaday(L.extend({},t,{_dint:0,field:o,defaultDate:new Date(1e3*C[0])})),k=new Pikaday(L.extend({},t,{_dint:1,field:l,defaultDate:new Date(1e3*C[1])}))},I().$$.on_mount.push(bt);let xt,kt,jt=[""],Lt=1,Ct={},wt={};Object.keys(Z.years||{}).sort().forEach(t=>{n(32,Ct[t]=!0,Ct),Object.keys(Z.years[t]).sort().forEach(e=>{kt={},kt[t]={},kt[t][e]=!0})}),wt=kt||{};let Dt,Ft,zt=[""],Tt=1,Ot={},Et={};Object.keys(A.years||{}).sort().forEach(t=>{n(36,Ot[t]=!0,Ot),Object.keys(A.years[t]).sort().forEach(e=>{Ft={},Ft[t]={},Ft[t][e]=!0})}),Et=Ft||{};let Mt,qt,Pt=[""],$t=1,Nt={},St={};Object.keys(H.years||{}).sort().forEach(t=>{n(40,Nt[t]=!0,Nt),Object.keys(H.years[t]).sort().forEach(e=>{qt={},qt[t]={},qt[t][e]=!0})}),St=qt||{};let Ht,Bt,Ut=[""],Gt=1,At={},It={};Object.keys(N.years||{}).sort().forEach(t=>{n(45,At[t]=!0,At),Object.keys(N.years[t]).sort().forEach(e=>{Bt={},Bt[t]={},Bt[t][e]=!0})}),It=Bt||{};let Rt,Zt,Yt=[""],Vt=1,Wt={},Jt={};Object.keys(q.years||{}).sort().forEach(t=>{n(50,Wt[t]=!0,Wt),Object.keys(q.years[t]).sort().forEach(e=>{Zt={},Zt[t]={},Zt[t][e]=!0})}),Jt=Zt||{};return t.$set=t=>{"DtpHearthsPicket"in t&&n(4,s=t.DtpHearthsPicket),"DtpHearths5"in t&&n(5,r=t.DtpHearths5),"DtpHearths3"in t&&n(6,i=t.DtpHearths3),"DtpHearthsStat"in t&&n(7,a=t.DtpHearthsStat),"DtpHearthsTmp"in t&&n(8,p=t.DtpHearthsTmp),"DtpHearths"in t&&n(9,c=t.DtpHearths),"DtpVerifyed"in t&&n(0,d=t.DtpVerifyed),"DtpSkpdi"in t&&n(1,u=t.DtpSkpdi),"DtpGibdd"in t&&n(2,_=t.DtpGibdd),"DtpGibddRub"in t&&n(3,h=t.DtpGibddRub),"Rub"in t&&n(10,v=t.Rub)},[d,u,_,h,s,r,i,a,p,c,v,o,l,K,Q,X,tt,et,nt,ot,lt,rt,it,at,j,ct,dt,vt,ft,xt,jt,Lt,Ct,Dt,zt,Tt,Ot,Mt,Pt,$t,Nt,St,Ht,Ut,Gt,At,It,Rt,Yt,Vt,Wt,Jt,w,D,F,z,T,O,E,M,q,$,N,S,H,G,A,R,Z,Y,W,J,st,t=>{let e=[{type:"comp",zn:{on:ct,off:dt}}];v.setFilter(e)},ut,t=>{let e=t.target.value;n(16,tt=e||null),ut()},t=>{let e=t.target.value;n(15,X=e||null),ut()},t=>{let e=t.target;n(14,Q[e.name]=e.checked,Q),ut()},t=>{let e=t.target;n(3,h._needHeat=n(2,_._needHeat=n(1,u._needHeat=n(0,d._needHeat=!!e.checked&&st,d),u),_),h),mt(),gt(),yt(),_t()},()=>{let t={radius:rt,blur:it,minOpacity:at};_._heat&&_._heat.setOptions(t),u._heat&&u._heat.setOptions(t),d._heat&&d._heat.setOptions(t)},_t,mt,gt,yt,t=>{let e=t.target;f=Number(e.value),_t()},()=>{let t=k.getDate(),e=x.getDate(),n=t-e;0===n&&(n=864e5),x.setDate(new Date(e.getTime()-n)),k.setDate(new Date(t.getTime()-n)),C=[x.getDate().getTime()/1e3,86400+k.getDate().getTime()/1e3],_t()},()=>{let t=k.getDate(),e=x.getDate(),n=t-e;0===n&&(n=864e5),x.setDate(new Date(e.getTime()+n)),k.setDate(new Date(t.getTime()+n)),C=[x.getDate().getTime()/1e3,86400+k.getDate().getTime()/1e3],_t()},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,i=o.name;if("hearths_period_type_52"===s)n(31,Lt=2);else if("hearths_period_type_51"===s)n(31,Lt=1);else if("hearths_year_5"===s)l?n(32,Ct[i]=!0,Ct):delete Ct[i];else if("hearths_quarter_5"===s){let t=i.split("_");l?(wt[t[0]]||(wt[t[0]]={}),wt[t[0]][t[1]]=!0):(wt[t[0]]&&delete wt[t[0]][t[1]],0===Object.keys(wt[t[0]]).length&&delete wt[t[0]])}1===Lt?e.push({type:"year",zn:Ct}):2===Lt&&e.push({type:"quarter",zn:wt}),xt&&e.push({type:"stricken",zn:Number(xt)}),jt.length>0&&jt[0]&&e.push({type:"str_icon_type",zn:jt}),r.setFilter(e)},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,r=o.name;if("hearths_period_type_32"===s)n(35,Tt=2);else if("hearths_period_type_31"===s)n(35,Tt=1);else if("hearths_year_3"===s)l?n(36,Ot[r]=!0,Ot):delete Ot[r];else if("hearths_quarter_3"===s){let t=r.split("_");l?(Et[t[0]]||(Et[t[0]]={}),Et[t[0]][t[1]]=!0):(Et[t[0]]&&delete Et[t[0]][t[1]],0===Object.keys(Et[t[0]]).length&&delete Et[t[0]])}1===Tt?e.push({type:"year",zn:Ot}):2===Tt&&e.push({type:"quarter",zn:Et}),Dt&&e.push({type:"stricken",zn:Number(Dt)}),zt.length>0&&zt[0]&&e.push({type:"str_icon_type",zn:zt}),i.setFilter(e)},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,r=o.name;if("hearths_period_type_Stat2"===s)n(39,$t=2);else if("hearths_period_type_Stat1"===s)n(39,$t=1);else if("hearths_year_Stat"===s)l?n(40,Nt[r]=!0,Nt):delete Nt[r];else if("hearths_quarter_Stat"===s){let t=r.split("_");l?(St[t[0]]||n(41,St[t[0]]={},St),n(41,St[t[0]][t[1]]=!0,St)):(St[t[0]]&&delete St[t[0]][t[1]],0===Object.keys(St[t[0]]).length&&delete St[t[0]])}1===$t?e.push({type:"year",zn:Nt}):2===$t&&e.push({type:"quarter",zn:St}),Mt&&e.push({type:"stricken",zn:Number(Mt)}),Pt.length>0&&Pt[0]&&e.push({type:"str_icon_type",zn:Pt}),a.setFilter(e)},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,r=o.name;if("hearths_period_type_tmp2"===s)n(44,Gt=2);else if("hearths_period_type_tmp1"===s)n(44,Gt=1);else if("hearths_year_tmp"===s)l?n(45,At[r]=!0,At):delete At[r];else if("hearths_quarter_tmp"===s){let t=r.split("_");l?(It[t[0]]||n(46,It[t[0]]={},It),n(46,It[t[0]][t[1]]=!0,It)):(It[t[0]]&&delete It[t[0]][t[1]],0===Object.keys(It[t[0]]).length&&delete It[t[0]])}1===Gt?e.push({type:"year",zn:At}):2===Gt&&e.push({type:"quarter",zn:It}),Ht&&e.push({type:"stricken",zn:Number(Ht)}),Ut.length>0&&Ut[0]&&e.push({type:"str_icon_type",zn:Ut}),p.setFilter(e)},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,r=o.name;if(console.log("setFilterHearths",l,s,r,t),"hearths_period_type2"===s)n(49,Vt=2);else if("hearths_period_type1"===s)n(49,Vt=1);else if("hearths_year"===s)l?n(50,Wt[r]=!0,Wt):delete Wt[r];else if("hearths_quarter"===s){let t=r.split("_");l?(Jt[t[0]]||n(51,Jt[t[0]]={},Jt),n(51,Jt[t[0]][t[1]]=!0,Jt)):(Jt[t[0]]&&delete Jt[t[0]][t[1]],0===Object.keys(Jt[t[0]]).length&&delete Jt[t[0]])}1===Vt?e.push({type:"year",zn:Wt}):2===Vt&&e.push({type:"quarter",zn:Jt}),Rt&&e.push({type:"stricken",zn:Number(Rt)}),Yt.length>0&&Yt[0]&&e.push({type:"str_icon_type",zn:Yt}),c.setFilter(e)},f,C,x,k,wt,kt,Et,Ft,qt,Bt,Zt,m,g,y,b,void 0,void 0,void 0,void 0,pt,ht,(t,e)=>t+=W.road[e],function(){K=U(this),n(13,K),n(71,J)},function(){Lt=this.__value,n(31,Lt)},[[],[],[],[],[]],(t,e)=>t+=Z.str_icon_type[e],function(){jt=U(this),n(30,jt),n(69,Y)},function(){xt=B(this),n(29,xt)},function(){Tt=this.__value,n(35,Tt)},(t,e)=>t+=A.str_icon_type[e],function(){zt=U(this),n(34,zt),n(67,R)},function(){Dt=B(this),n(33,Dt)},function(){$t=this.__value,n(39,$t)},function(){$t=this.__value,n(39,$t)},(t,e)=>t+=H.str_icon_type[e],function(){Pt=U(this),n(38,Pt),n(65,G)},function(){Mt=B(this),n(37,Mt)},function(){Gt=this.__value,n(44,Gt)},function(){Gt=this.__value,n(44,Gt)},(t,e)=>t+=N.str_icon_type[e],function(){Ut=U(this),n(43,Ut),n(63,S)},function(){Ht=B(this),n(42,Ht)},function(){Vt=this.__value,n(49,Vt)},function(){Vt=this.__value,n(49,Vt)},(t,e)=>t+=q.str_icon_type[e],function(){Yt=U(this),n(48,Yt),n(61,$)},function(){Rt=B(this),n(47,Rt)},function(t){V[t?"unshift":"push"](()=>{n(11,o=t)})},function(t){V[t?"unshift":"push"](()=>{n(12,l=t)})},function(){at=P(this.value),n(23,at)},function(){rt=P(this.value),n(21,rt)},function(){it=P(this.value),n(22,it)},function(t){V[t?"unshift":"push"](()=>{n(24,j=t)})},(t,e)=>t+=w.collision_type[e],function(){et=U(this),n(17,et),n(53,D)},(t,e)=>t+=F.collision_type[e],function(){nt=U(this),n(18,nt),n(55,z)},(t,e)=>t+=T.collision_type[e],function(){ot=U(this),n(19,ot),n(57,O)},function(){vt=this.checked,n(27,vt)},function(){ft=this.checked,n(28,ft)},(t,e)=>t+=E.collision_type[e],function(){lt=U(this),n(20,lt),n(59,M)},function(){ct=this.checked,n(25,ct)},function(){dt=this.checked,n(26,dt)}]}ie._needHeat={radius:19,blur:11.26,minOpacity:.34},ie.checkZoom=t=>{Object.keys(ie._layers).length?t<12&&ie.setFilter(re):t>11&&ie.setFilter(re)},ie.setFilter=t=>{if(!ie._map)return;ie.clearLayers(),re=t||[];let e=[],n=[];ie._group&&(ie._group.getLayers().forEach(t=>{let o=t.options.props,l=0;re.forEach(t=>{"itemType"===t.type?(0===t.zn||1===t.zn&&o.id_stat&&o.id_skpdi||2===t.zn&&o.id_skpdi&&!o.id_stat||3===t.zn&&o.id_stat&&!o.id_skpdi)&&l++:"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===o.collision_type).length)&&l++:"date"===t.type&&o.date>=t.zn[0]&&o.date<t.zn[1]&&l++}),l===re.length&&(e.push(t),n.push(t._latlng))}),ie._needHeat?(ie._map.addLayer(ie._heat),ie._heat.setLatLngs(n),ie._heat.setOptions(ie._needHeat),ie._map._zoom>11&&ie.addLayer(le.layerGroup(e))):(ie.addLayer(le.layerGroup(e)),ie._map.removeLayer(ie._heat)))},ie.on("remove",()=>{ie._map.removeLayer(ie._heat),ie.clearLayers()}).on("add",t=>{ie._heat=le.heatLayer([],{interactive:!1}),fetch("https://dtp.mvs.group/scripts/index.php?request=get_collision",{}).then(t=>t.json()).then(t=>{let e={collision_type:{},iconType:{}},n=[],o=t.map(t=>{let o=t.iconType||0,l=[],s=!1,r="#2F4F4F";o&&(s=o%2==0,o>=1&&o<=6?r="#8B4513":7===o||8===o?r="#228B22":o>=9&&o<=14?r="#8B4513":15===o||16===o?r="#7B68EE":17!==o&&18!==o||(r="#2F4F4F")),t.id_skpdi&&l.push({type:"skpdi",id:t.id_skpdi}),t.id_stat&&l.push({type:"gibdd",id:t.id_stat}),t._cur=l,t.lat&&t.lon||(console.log("_______",t),t.lat=t.lon=0);let i=e.collision_type[t.collision_type];i?i++:i=1,e.collision_type[t.collision_type]=i,e.iconType[t.collision_type]=o;let a=le.latLng(t.lat,t.lon,s?1:.5);return n.push(a),new v(a,{props:t,radius:6,triangle:l.length>1,box:!!t.id_skpdi,stroke:s,fillColor:r}).bindPopup(se).on("popupopen",t=>{!function(t){let e=le.DomUtil.create("div");new oe({target:e,props:{prp:t}}),se.setContent(e)}(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});ie.addLayer(ie._heat),ie._heat.setLatLngs(n),ie._heat.setOptions(ie._needHeat),ie._opt=e,ie._group=le.layerGroup(o),re?ie.setFilter(re):ie.addLayer(ie._group),ie.checkZoom(ie._map._zoom),ie._refreshFilters()})});class hn extends vt{constructor(t){super(),ht(this,t,_n,un,x,{DtpHearthsPicket:4,DtpHearths5:5,DtpHearths3:6,DtpHearthsStat:7,DtpHearthsTmp:8,DtpHearths:9,DtpVerifyed:0,DtpSkpdi:1,DtpGibdd:2,DtpGibddRub:3,Rub:10},[-1,-1,-1,-1,-1,-1,-1])}}function vn(t,e,n){const o=t.slice();return o[7]=e[n],o[9]=n,o}function fn(t){let e,n,o,l,s,r,i,a,p,c,d,u=(t[0].piketaj_start_km||0)+"",_=(t[0].piketaj_finish_km||0)+"";return{c(){e=F("tr"),n=F("td"),n.textContent="Пикетаж:",o=T(),l=F("td"),s=z("От: "),r=F("b"),i=z(u),a=z(" км. до: "),p=F("b"),c=z(_),d=z(" км."),q(n,"class","first svelte-mnr9l0")},m(t,u){C(t,e,u),j(e,n),j(e,o),j(e,l),j(l,s),j(l,r),j(r,i),j(l,a),j(l,p),j(p,c),j(l,d)},p(t,e){1&e&&u!==(u=(t[0].piketaj_start_km||0)+"")&&$(i,u),1&e&&_!==(_=(t[0].piketaj_finish_km||0)+"")&&$(c,_)},d(t){t&&w(e)}}}function mn(t){let e,n;const o=new oe({props:{prp:t[7],closeMe:t[6]}});return{c(){e=F("div"),ct(o.$$.fragment),q(e,"class","win leaflet-popup-content-wrapper  svelte-mnr9l0")},m(t,l){C(t,e,l),dt(o,e,null),n=!0},p(t,e){const n={};1&e&&(n.prp=t[7]),2&e&&(n.closeMe=t[6]),o.$set(n)},i(t){n||(at(o.$$.fragment,t),n=!0)},o(t){pt(o.$$.fragment,t),n=!1},d(t){t&&w(e),ut(o)}}}function gn(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,D,O,M,P,N,S,H,B=Math.floor(t[7].piketaj_m/1e3)+"",U=t[7].piketaj_m%1e3+"",G=new Date(1e3*t[7].date).toLocaleDateString()+"",A=t[7].lost+"",I=t[7].stricken+"",R=t[7].address+"";function Z(...e){return t[4](t[9],...e)}function Y(...e){return t[5](t[9],...e)}let V=t[1]===t[9]&&mn(t);return{c(){e=F("tr"),n=F("td"),o=F("ul"),l=F("li"),s=z("Пикетаж: "),r=z(B),i=z(" км. "),a=z(U),p=z(" м."),c=T(),d=F("li"),u=z(G),_=z(" погибших "),h=z(A),v=z(", раненых "),f=z(I),g=T(),b=F("tr"),x=F("td"),x.textContent="Адрес:",k=T(),L=F("td"),D=z(R),O=F("br"),M=F("span"),M.textContent="подробнее",P=T(),V&&V.c(),N=T(),q(l,"class","svelte-mnr9l0"),q(d,"title",m="id: "+t[7].id),q(d,"class","svelte-mnr9l0"),q(n,"class","first svelte-mnr9l0"),q(n,"colspan","2"),q(x,"class","first svelte-mnr9l0"),q(M,"class","link svelte-mnr9l0")},m(t,m,w){C(t,e,m),j(e,n),j(n,o),j(o,l),j(l,s),j(l,r),j(l,i),j(l,a),j(l,p),j(o,c),j(o,d),j(d,u),j(d,_),j(d,h),j(d,v),j(d,f),C(t,g,m),C(t,b,m),j(b,x),j(b,k),j(b,L),j(L,D),j(L,O),j(L,M),j(L,P),V&&V.m(L,null),j(b,N),S=!0,w&&y(H),H=[E(d,"click",Z),E(M,"click",Y)]},p(e,n){t=e,(!S||1&n)&&B!==(B=Math.floor(t[7].piketaj_m/1e3)+"")&&$(r,B),(!S||1&n)&&U!==(U=t[7].piketaj_m%1e3+"")&&$(a,U),(!S||1&n)&&G!==(G=new Date(1e3*t[7].date).toLocaleDateString()+"")&&$(u,G),(!S||1&n)&&A!==(A=t[7].lost+"")&&$(h,A),(!S||1&n)&&I!==(I=t[7].stricken+"")&&$(f,I),(!S||1&n&&m!==(m="id: "+t[7].id))&&q(d,"title",m),(!S||1&n)&&R!==(R=t[7].address+"")&&$(D,R),t[1]===t[9]?V?(V.p(t,n),at(V,1)):(V=mn(t),V.c(),at(V,1),V.m(L,null)):V&&(rt(),pt(V,1,1,()=>{V=null}),it())},i(t){S||(at(V),S=!0)},o(t){pt(V),S=!1},d(t){t&&w(e),t&&w(g),t&&w(b),V&&V.d(),y(H)}}}function yn(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,m,g,y,b,x,k,L,O,E,M,P,N,S,H,B,U,G,A,I,R,Z,Y,V,W,J,K=(t[0].id||t[0].id_hearth)+"",Q=t[0].quarter?t[0].quarter+" кв.":"",X=t[0].year+"",tt=(t[0].str_icon_type||"")+"",et=t[0].list_dtp.length+"",nt=t[0].count_lost+"",ot=t[0].count_stricken+"",lt=t[0].piketaj_start_km&&fn(t),st=t[0].list_dtp,ct=[];for(let e=0;e<st.length;e+=1)ct[e]=gn(vn(t,st,e));const dt=t=>pt(ct[t],1,1,()=>{ct[t]=null});return{c(){e=F("div"),n=F("div"),o=z("Очаг ДТП (id: "),l=z(K),s=z(")"),r=T(),i=F("div"),a=z(Q),p=T(),c=z(X),d=z("г."),u=T(),_=F("div"),h=F("table"),v=F("tbody"),lt&&lt.c(),f=T(),m=F("tr"),g=F("td"),g.textContent="Тип ДТП:",y=T(),b=F("td"),x=z(tt),k=T(),L=F("tr"),O=F("td"),O.textContent="Всего ДТП:",E=T(),M=F("td"),P=z(et),N=T(),S=F("tr"),H=F("td"),H.textContent="Погибших:",B=T(),U=F("td"),G=z(nt),A=T(),I=F("tr"),R=F("td"),R.textContent="Раненых:",Z=T(),Y=F("td"),V=z(ot),W=T();for(let t=0;t<ct.length;t+=1)ct[t].c();q(n,"class","pLine"),q(i,"class","pLine"),q(g,"class","first svelte-mnr9l0"),q(O,"class","first svelte-mnr9l0"),q(H,"class","first svelte-mnr9l0"),q(R,"class","first svelte-mnr9l0"),q(h,"class","table svelte-mnr9l0"),q(_,"class","featureCont"),q(e,"class","mvsPopup svelte-mnr9l0")},m(t,w){C(t,e,w),j(e,n),j(n,o),j(n,l),j(n,s),j(e,r),j(e,i),j(i,a),j(i,p),j(i,c),j(i,d),j(e,u),j(e,_),j(_,h),j(h,v),lt&&lt.m(v,null),j(v,f),j(v,m),j(m,g),j(m,y),j(m,b),j(b,x),j(v,k),j(v,L),j(L,O),j(L,E),j(L,M),j(M,P),j(v,N),j(v,S),j(S,H),j(S,B),j(S,U),j(U,G),j(v,A),j(v,I),j(I,R),j(I,Z),j(I,Y),j(Y,V),j(v,W);for(let t=0;t<ct.length;t+=1)ct[t].m(v,null);J=!0},p(t,[e]){if((!J||1&e)&&K!==(K=(t[0].id||t[0].id_hearth)+"")&&$(l,K),(!J||1&e)&&Q!==(Q=t[0].quarter?t[0].quarter+" кв.":"")&&$(a,Q),(!J||1&e)&&X!==(X=t[0].year+"")&&$(c,X),t[0].piketaj_start_km?lt?lt.p(t,e):(lt=fn(t),lt.c(),lt.m(v,f)):lt&&(lt.d(1),lt=null),(!J||1&e)&&tt!==(tt=(t[0].str_icon_type||"")+"")&&$(x,tt),(!J||1&e)&&et!==(et=t[0].list_dtp.length+"")&&$(P,et),(!J||1&e)&&nt!==(nt=t[0].count_lost+"")&&$(G,nt),(!J||1&e)&&ot!==(ot=t[0].count_stricken+"")&&$(V,ot),7&e){let n;for(st=t[0].list_dtp,n=0;n<st.length;n+=1){const o=vn(t,st,n);ct[n]?(ct[n].p(o,e),at(ct[n],1)):(ct[n]=gn(o),ct[n].c(),at(ct[n],1),ct[n].m(v,null))}for(rt(),n=st.length;n<ct.length;n+=1)dt(n);it()}},i(t){if(!J){for(let t=0;t<st.length;t+=1)at(ct[t]);J=!0}},o(t){ct=ct.filter(Boolean);for(let t=0;t<ct.length;t+=1)pt(ct[t]);J=!1},d(t){t&&w(e),lt&&lt.d(),D(ct,t)}}}function bn(t,e,n){let o,{prp:l}=e;const s=t=>{let e=l._bounds.options.items[t];e&&e._map&&e._map.panTo(e._latlng)};return t.$set=t=>{"prp"in t&&n(0,l=t.prp)},[l,o,s,t=>{console.log("showDtpInfo ",t)},t=>{s(t)},t=>{n(1,o=t)},()=>{n(1,o=null)}]}class xn extends vt{constructor(t){super(),ht(this,t,bn,yn,x,{prp:0})}}const kn=window.L,jn=kn.popup(),Ln=kn.popup({minWidth:200});let Cn;const wn=function(t){let e=kn.DomUtil.create("div");return new oe({target:e,props:{prp:t}}),jn.setContent(e),e},Dn=kn.featureGroup([]);Dn.setFilter=t=>{Dn.clearLayers(),Cn=t;let e=[];Dn._group&&(Dn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;Cn.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&n.count_lost||2===e&&n.count_stricken||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===Cn.length&&e.push(t)}),Dn.addLayer(kn.layerGroup(e)))},Dn.on("remove",()=>{Dn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearths/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=kn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c=e.str_icon_type[t.str_icon_type];c?c++:c=1,e.str_icon_type[t.str_icon_type]=c,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=kn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new v(kn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(jn).on("popupopen",t=>{wn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=kn.rectangle(l,{items:d,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{kn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._latlng.distanceTo(s);e<o&&(o=e,n=t)}),o<10?(wn(n.options.props),jn.setLatLng(n._latlng).openOn(Dn._map)):(!function(t){let e=kn.DomUtil.create("div");new xn({target:e,props:{prp:t}}),Ln.setContent(e)}(t),Ln.setLatLng(s).openOn(Dn._map))}),n.push(t._bounds),n=n.concat(d)}}),Dn._opt=e,Dn._group=kn.layerGroup(n),Cn?Dn.setFilter(Cn):Dn.addLayer(Dn._group),Dn._refreshFilters()}),console.log("__allJson_____",t,Dn._opt)})});const Fn=window.L,zn=Fn.popup(),Tn=Fn.popup({minWidth:200});let On;const En=function(t){let e=Fn.DomUtil.create("div");return new oe({target:e,props:{prp:t}}),zn.setContent(e),e},Mn=Fn.featureGroup([]);Mn.setFilter=t=>{Mn.clearLayers(),On=t;let e=[];Mn._group&&(Mn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;On.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&n.count_lost||2===e&&n.count_stricken||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===On.length&&e.push(t)}),Mn.addLayer(Fn.layerGroup(e)))},Mn.on("remove",()=>{Mn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearthstmp/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=Fn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c=e.str_icon_type[t.str_icon_type];c?c++:c=1,e.str_icon_type[t.str_icon_type]=c,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=Fn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new v(Fn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(zn).on("popupopen",t=>{En(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=Fn.rectangle(l,{items:d,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{Fn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._latlng.distanceTo(s);e<o&&(o=e,n=t)}),o<10?(En(n.options.props),zn.setLatLng(n._latlng).openOn(Mn._map)):(!function(t){let e=Fn.DomUtil.create("div");new xn({target:e,props:{prp:t}}),Tn.setContent(e)}(t),Tn.setLatLng(s).openOn(Mn._map))}),n.push(t._bounds),n=n.concat(d)}}),Mn._opt=e,Mn._group=Fn.layerGroup(n),On?Mn.setFilter(On):Mn.addLayer(Mn._group),Mn._refreshFilters()}),console.log("__allJson_____",t,Mn._opt)})});const qn=window.L,Pn=qn.popup(),$n=qn.popup({minWidth:200});let Nn;const Sn=function(t){let e=qn.DomUtil.create("div");return new oe({target:e,props:{prp:t}}),Pn.setContent(e),e},Hn=qn.featureGroup([]);Hn.setFilter=t=>{Hn.clearLayers(),Nn=t;let e=[];Hn._group&&(Hn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;Nn.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&n.count_lost||2===e&&n.count_stricken||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===Nn.length&&e.push(t)}),Hn.addLayer(qn.layerGroup(e)))},Hn.on("remove",()=>{Hn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearthsstat/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=qn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c=e.str_icon_type[t.str_icon_type];c?c++:c=1,e.str_icon_type[t.str_icon_type]=c,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=qn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new v(qn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(Pn).on("popupopen",t=>{Sn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=qn.rectangle(l,{items:d,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{qn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<o&&(o=e,n=t)}),o<10?(Sn(n.options.props),Pn.setLatLng(n._latlng).openOn(Hn._map)):(!function(t){let e=qn.DomUtil.create("div");new xn({target:e,props:{prp:t}}),$n.setContent(e)}(t),$n.setLatLng(s).openOn(Hn._map))}),n.push(t._bounds),n=n.concat(d)}}),Hn._opt=e,Hn._group=qn.layerGroup(n),Nn?Hn.setFilter(Nn):Hn.addLayer(Hn._group),Hn._refreshFilters()}),console.log("__allJson_____",t,Hn._opt)})});const Bn=window.L,Un=Bn.popup(),Gn=Bn.popup({minWidth:200});let An;const In=function(t){let e=Bn.DomUtil.create("div");return new oe({target:e,props:{prp:t}}),Un.setContent(e),e},Rn=Bn.featureGroup([]);Rn.setFilter=t=>{Rn.clearLayers(),An=t;let e=[];Rn._group&&(Rn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;An.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&n.count_lost||2===e&&n.count_stricken||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===An.length&&e.push(t)}),Rn.addLayer(Bn.layerGroup(e)))},Rn.on("remove",()=>{Rn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearths3/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=Bn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c,d=e.str_icon_type[t.str_icon_type];d?d++:d=1,e.str_icon_type[t.str_icon_type]=d,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let u=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=Bn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id===t.head&&(c=n),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new v(Bn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(Un).on("popupopen",t=>{In(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=c?Bn.circle(Bn.latLng(c.coords.lat,c.coords.lon),{radius:t.radius||500,items:u,cluster:t,color:i}):Bn.rectangle(l,{items:u,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}),t._bounds.on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{Bn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<o&&(o=e,n=t)}),o<10?(In(n.options.props),Un.setLatLng(n._latlng).openOn(Rn._map)):(!function(t){let e=Bn.DomUtil.create("div");new xn({target:e,props:{prp:t}}),Gn.setContent(e)}(t),Gn.setLatLng(s).openOn(Rn._map))}),n.push(t._bounds),n=n.concat(u)}}),Rn._opt=e,Rn._group=Bn.layerGroup(n),An?Rn.setFilter(An):Rn.addLayer(Rn._group),Rn._refreshFilters()}),console.log("__allJson_____",t,Rn._opt)})});const Zn=window.L,Yn=Zn.popup(),Vn=Zn.popup({minWidth:200});let Wn;const Jn=function(t){let e=Zn.DomUtil.create("div");return new oe({target:e,props:{prp:t}}),Yn.setContent(e),e},Kn=Zn.featureGroup([]);Kn.setFilter=t=>{Kn.clearLayers(),Wn=t;let e=[];Kn._group&&(Kn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;Wn.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&!n.count_stricken&&n.count_lost||2===e&&n.count_stricken&&!n.count_lost||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===Wn.length&&e.push(t)}),Kn.addLayer(Zn.layerGroup(e)))},Kn.on("remove",()=>{Kn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearths5/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=Zn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c,d=e.str_icon_type[t.str_icon_type];d?d++:d=1,e.str_icon_type[t.str_icon_type]=d,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let u=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=Zn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id===t.head&&(c=n),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new v(Zn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(Yn).on("popupopen",t=>{Jn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=c?Zn.circle(Zn.latLng(c.coords.lat,c.coords.lon),{radius:t.radius||500,items:u,cluster:t,color:i}):Zn.rectangle(l,{items:u,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}),t._bounds.on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{Zn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<o&&(o=e,n=t)}),o<10?(Jn(n.options.props),Yn.setLatLng(n._latlng).openOn(Kn._map)):(!function(t){let e=Zn.DomUtil.create("div");new xn({target:e,props:{prp:t}}),Vn.setContent(e)}(t),Vn.setLatLng(s).openOn(Kn._map))}),n.push(t._bounds),n=n.concat(u)}}),Kn._opt=e,Kn._group=Zn.layerGroup(n),Wn?Kn.setFilter(Wn):Kn.addLayer(Kn._group),Kn._refreshFilters()}),console.log("__allJson_____",t,Kn._opt)})});const Qn=window.L,Xn=Qn.popup(),to=Qn.popup({minWidth:200});let eo;const no=function(t){let e=Qn.DomUtil.create("div");return new oe({target:e,props:{prp:t}}),Xn.setContent(e),e},oo=Qn.featureGroup([]);function lo(t,e,n){const o=t.slice();return o[4]=e[n],o[6]=n,o}function so(t,e,n){const o=t.slice();return o[4]=e[n],o[6]=n,o}function ro(t){let e,n,o,l,s=t[4].complexName+"";return{c(){e=F("button"),n=z(s),q(e,"class",o="tab "+t[6]+" "+(0===t[6]?"active":"")+" svelte-h8luxq")},m(o,s,r){C(o,e,s),j(e,n),r&&l(),l=E(e,"click",t[2])},p:f,d(t){t&&w(e),l()}}}function io(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,m,g,y,b,x,k,L,D,O,E,M,P,N,S,H,B,U,G,A,I=t[4].complexName+"",R=t[4].complexSid+"",Z=t[4].complexModelName+"",Y=t[4].complexTypeName+"",V=t[4].complexStageName+"",W=(t[4].kvfStatus||"")+"",J=(t[4].roadName||t[0].roadName||"")+"";return{c(){e=F("table"),n=F("tr"),o=F("td"),o.textContent="Комплекс:",l=F("td"),s=z(I),r=z(" (id: "),i=z(R),a=z(")"),p=T(),c=F("tr"),d=F("td"),d.textContent="Модель:",u=F("td"),_=z(Z),h=T(),v=F("tr"),f=F("td"),f.textContent="Тип:",m=F("td"),g=z(Y),y=T(),b=F("tr"),x=F("td"),x.textContent="Этап:",k=F("td"),L=z(V),D=T(),O=F("tr"),E=F("td"),E.textContent="Работоспособность:",M=F("td"),P=z(W),N=T(),S=F("tr"),H=F("td"),H.textContent="Дорога:",B=F("td"),U=z(J),G=T(),q(o,"class","first svelte-h8luxq"),q(d,"class","first svelte-h8luxq"),q(f,"class","first svelte-h8luxq"),q(x,"class","first svelte-h8luxq"),q(E,"class","first svelte-h8luxq"),q(H,"class","first svelte-h8luxq"),q(e,"class",A="tabCont "+t[6]+" "+(0===t[6]?"":"hidden")+" svelte-h8luxq")},m(t,w){C(t,e,w),j(e,n),j(n,o),j(n,l),j(l,s),j(l,r),j(l,i),j(l,a),j(e,p),j(e,c),j(c,d),j(c,u),j(u,_),j(e,h),j(e,v),j(v,f),j(v,m),j(m,g),j(e,y),j(e,b),j(b,x),j(b,k),j(k,L),j(e,D),j(e,O),j(O,E),j(O,M),j(M,P),j(e,N),j(e,S),j(S,H),j(S,B),j(B,U),j(e,G)},p(t,e){1&e&&J!==(J=(t[4].roadName||t[0].roadName||"")+"")&&$(U,J)},d(t){t&&w(e)}}}function ao(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,m,g,y,b,x,k,L,O,M,P,N,S,H,B,U,G,A,I,R,Z,Y,V,W,J,K,Q=(t[0].id||t[0].lineSid)+"",X=(t[0].roadName||"")+"",tt=t[0].lat+"",et=t[0].lon+"",nt=(t[0].lineAddress||"")+"",ot=t[3],lt=[];for(let e=0;e<ot.length;e+=1)lt[e]=ro(so(t,ot,e));let st=t[3],rt=[];for(let e=0;e<st.length;e+=1)rt[e]=io(lo(t,st,e));return{c(){e=F("div"),n=F("div"),o=z("Рубеж (id: "),l=z(Q),s=z(")"),r=T(),i=F("div"),a=F("table"),p=F("tbody"),c=F("tr"),d=F("td"),d.textContent="Дорога:",u=T(),_=F("td"),h=z(X),v=T(),m=F("tr"),g=F("td"),g.textContent="Координаты:",y=T(),b=F("td"),x=z(tt),k=T(),L=z(et),O=T(),M=F("span"),P=T(),N=F("tr"),S=F("td"),S.textContent="Адрес:",H=T(),B=F("td"),U=z(nt),G=T(),A=F("tr"),I=F("td"),I.textContent="Комплексов:",R=T(),Z=F("td"),Z.textContent=`${t[3].length}`,Y=T(),V=F("tr"),W=F("td");for(let t=0;t<lt.length;t+=1)lt[t].c();J=T();for(let t=0;t<rt.length;t+=1)rt[t].c();q(n,"class","pLine"),q(d,"class","first svelte-h8luxq"),q(g,"class","first svelte-h8luxq"),q(M,"title","Скопировать в буфер обмена"),q(M,"class","leaflet-gmx-icon-copy"),q(S,"class","first svelte-h8luxq"),q(I,"class","first svelte-h8luxq"),q(W,"class","tabs svelte-h8luxq"),q(W,"colspan","2"),q(a,"class","table svelte-h8luxq"),q(i,"class","featureCont"),q(e,"class","mvsPopup svelte-h8luxq")},m(f,w,D){C(f,e,w),j(e,n),j(n,o),j(n,l),j(n,s),j(e,r),j(e,i),j(i,a),j(a,p),j(p,c),j(c,d),j(c,u),j(c,_),j(_,h),j(p,v),j(p,m),j(m,g),j(m,y),j(m,b),j(b,x),j(b,k),j(b,L),j(b,O),j(b,M),j(p,P),j(p,N),j(N,S),j(N,H),j(N,B),j(B,U),j(p,G),j(p,A),j(A,I),j(A,R),j(A,Z),j(p,Y),j(p,V),j(V,W);for(let t=0;t<lt.length;t+=1)lt[t].m(W,null);j(W,J);for(let t=0;t<rt.length;t+=1)rt[t].m(W,null);D&&K(),K=E(M,"click",t[1])},p(t,[e]){if(1&e&&Q!==(Q=(t[0].id||t[0].lineSid)+"")&&$(l,Q),1&e&&X!==(X=(t[0].roadName||"")+"")&&$(h,X),1&e&&tt!==(tt=t[0].lat+"")&&$(x,tt),1&e&&et!==(et=t[0].lon+"")&&$(L,et),1&e&&nt!==(nt=(t[0].lineAddress||"")+"")&&$(U,nt),12&e){let n;for(ot=t[3],n=0;n<ot.length;n+=1){const o=so(t,ot,n);lt[n]?lt[n].p(o,e):(lt[n]=ro(o),lt[n].c(),lt[n].m(W,J))}for(;n<lt.length;n+=1)lt[n].d(1);lt.length=ot.length}if(9&e){let n;for(st=t[3],n=0;n<st.length;n+=1){const o=lo(t,st,n);rt[n]?rt[n].p(o,e):(rt[n]=io(o),rt[n].c(),rt[n].m(W,null))}for(;n<rt.length;n+=1)rt[n].d(1);rt.length=st.length}},i:f,o:f,d(t){t&&w(e),D(lt,t),D(rt,t),K()}}}function po(t,e,n){let{prp:o}=e;let l=o&&o.complexes?o.complexes:[];return console.log("complexes ",l),t.$set=t=>{"prp"in t&&n(0,o=t.prp)},[o,t=>{navigator.clipboard.writeText(t.target.parentNode.textContent).catch(t=>{console.log("Something went wrong",t)})},t=>{let e=t.target,n=/tab (\d)/.exec(e.className),o=n&&2===n.length?n[1]:0,l=e.parentNode;for(let t=0,e=l.childNodes.length;t<e;t++){let e=l.childNodes[t];if(e.classList){let t=e.classList.contains(o);"BUTTON"===e.tagName?e.classList[t?"add":"remove"]("active"):"TABLE"===e.tagName&&e.classList[t?"remove":"add"]("hidden")}}},l]}oo.setFilter=t=>{if(!oo._map)return;oo.clearLayers(),eo=t;let e=[];oo._group&&(oo._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;eo.forEach(t=>{if("ht"===t.type)t.zn[n.ht]&&o++;else if("roads"===t.type)(t.zn.filter(t=>t===n.road).length||1===t.zn.length&&""===t.zn[0])&&o++;else if("id_dtp"===t.type)!n.list_dtp.filter(e=>e.id==t.zn).length&&t.zn.length||o++;else if("id_hearth"===t.type)t.zn==n.id_hearth&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&!n.count_stricken&&n.count_lost||2===e&&n.count_stricken&&!n.count_lost||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===eo.length&&e.push(t)}),oo.addLayer(Qn.layerGroup(e)))},oo.on("remove",()=>{oo.clearLayers()}).on("add",t=>{let e={road:{},str_icon_type:{},iconType:{},years:{},dtps:{}},n=[],o=(t,o)=>{let l=t.icon_type||1,s=Qn.latLngBounds(),r=[],i=t.list_dtp,a=!1,p="#FF0000";if(t.ht=o,i.length){Number(t.year),Number(t.quarter);let o=e.years[t.year];o||(o=e.years[t.year]={}),e.years[t.year]=o;let c=o[t.quarter];t.quarter in o?c++:c=o[t.quarter]=1,o[t.quarter]=c;let d,u=e.str_icon_type[t.str_icon_type];u?u++:u=1,e.str_icon_type[t.str_icon_type]=u,e.iconType[t.str_icon_type]=l,t.road in e.road?e.road[t.road]++:e.road[t.road]=1,l&&(a=l%2==0,1===l||2===l?p="#FFA500":3===l||4===l?p="#B8860B":5===l||6===l?p="#CD853F":7===l||8===l?p="#228B22":9===l||10===l?p="#FF8C00":11===l||12===l?p="#D2691E":13===l||14===l?p="#DEB887":15===l||16===l?p="#7B68EE":17!==l&&18!==l||(p="#2F4F4F"));let _=i.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},l=Qn.latLng(o.lat,o.lon),i=[];s.extend(l),r.push(l),n.id===t.head&&(d=n),n.id_skpdi&&i.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&i.push({type:"gibdd",id:n.id_stat}),n._cur=i;let c=e.dtps[n.id]||{},u=t.id||t.id_hearth;return c?c[u]?c[u]++:c[u]=1:(c={},c[u]=1),e.dtps[n.id]=c,new v(Qn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:a,fillColor:p}).bindPopup(Xn).on("popupopen",t=>{no(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});d?t._bounds=Qn.circle(Qn.latLng(d.coords.lat,d.coords.lon),{radius:t.radius||500,items:_,cluster:t,color:p}):r.length?t._bounds=Qn.polyline(r,{items:_,cluster:t,color:p,weight:4}):t._bounds=Qn.rectangle(s,{items:_,cluster:t,fill:!0,color:p,dashArray:"8 3 1"}),t._bounds.on("mouseover",t=>{let e=t.target;e._weight=e.options.weight,e._color=e.options.color,e.options.weight=8,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.weight=e._weight,e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{Qn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<o&&(o=e,n=t)}),o<10?(no(n.options.props),Xn.setLatLng(n._latlng).openOn(oo._map)):(!function(t){let e=Qn.DomUtil.create("div");new xn({target:e,props:{prp:t}}),to.setContent(e)}(t),to.setLatLng(s).openOn(oo._map))}),n.push(t._bounds),n=n.concat(_)}};Promise.all([2019].map(t=>fetch("https://dtp.mvs.group/scripts/hearths_picket/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{(t.hearth3||[]).forEach(t=>{o(t,"hearth3")}),(t.hearth5||[]).forEach(t=>{o(t,"hearth5")})}),oo._opt=e,oo._group=Qn.layerGroup(n),eo?oo.setFilter(eo):oo.addLayer(oo._group),oo._refreshFilters()}),console.log("__allJson_____",t,oo._opt)})});class co extends vt{constructor(t){super(),ht(this,t,po,ao,x,{prp:0})}}const uo=window.L,_o=uo.popup();uo.popup({minWidth:200});let ho;const vo=uo.featureGroup([]);function fo(t,e,n){const o=t.slice();return o[4]=e[n],o[6]=n,o}function mo(t,e,n){const o=t.slice();return o[4]=e[n],o[6]=n,o}function go(t){let e,n,o,l,s=t[4].complex_name+"";return{c(){e=F("button"),n=z(s),q(e,"class",o="tab "+t[6]+" "+(0===t[6]?"active":"")+" svelte-h8luxq")},m(o,s,r){C(o,e,s),j(e,n),r&&l(),l=E(e,"click",t[2])},p:f,d(t){t&&w(e),l()}}}function yo(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,m,g,y,b,x,k,L,D,O,E,M=t[4].complex_name+"",P=t[4].complex_sid+"",$=t[4].complex_model_name+"",N=t[4].complex_type_name+"",S=(t[4].cafap_status||"")+"";return{c(){e=F("table"),n=F("tr"),o=F("td"),o.textContent="Комплекс:",l=F("td"),s=z(M),r=z(" (id: "),i=z(P),a=z(")"),p=T(),c=F("tr"),d=F("td"),d.textContent="Модель:",u=F("td"),_=z($),h=T(),v=F("tr"),m=F("td"),m.textContent="Тип:",g=F("td"),y=z(N),b=T(),x=F("tr"),k=F("td"),k.textContent="Работоспособность:",L=F("td"),D=z(S),O=T(),q(o,"class","first svelte-h8luxq"),q(d,"class","first svelte-h8luxq"),q(m,"class","first svelte-h8luxq"),q(k,"class","first svelte-h8luxq"),q(e,"class",E="tabCont "+t[6]+" "+(0===t[6]?"":"hidden")+" svelte-h8luxq")},m(t,f){C(t,e,f),j(e,n),j(n,o),j(n,l),j(l,s),j(l,r),j(l,i),j(l,a),j(e,p),j(e,c),j(c,d),j(c,u),j(u,_),j(e,h),j(e,v),j(v,m),j(v,g),j(g,y),j(e,b),j(e,x),j(x,k),j(x,L),j(L,D),j(e,O)},p:f,d(t){t&&w(e)}}}function bo(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,m,g,y,b,x,k,L,O,M,P,N,S,H,B,U,G,A,I,R,Z,Y,V,W,J,K,Q,X,tt,et,nt,ot,lt=(t[0].id||t[0].line_id)+"",st=(t[0].stage_name||"")+"",rt=(t[0].road_name||"")+"",it=t[0].lat+"",at=t[0].lon+"",pt=(t[0].address||"")+"",ct=t[3],dt=[];for(let e=0;e<ct.length;e+=1)dt[e]=go(mo(t,ct,e));let ut=t[3],_t=[];for(let e=0;e<ut.length;e+=1)_t[e]=yo(fo(t,ut,e));return{c(){e=F("div"),n=F("div"),o=z("Рубеж (id: "),l=z(lt),s=z(")"),r=T(),i=F("div"),a=F("table"),p=F("tbody"),c=F("tr"),d=F("td"),d.textContent="Этап:",u=T(),_=F("td"),h=z(st),v=T(),m=F("tr"),g=F("td"),g.textContent="Дорога:",y=T(),b=F("td"),x=z(rt),k=T(),L=F("tr"),O=F("td"),O.textContent="Координаты:",M=T(),P=F("td"),N=z(it),S=T(),H=z(at),B=T(),U=F("span"),G=T(),A=F("tr"),I=F("td"),I.textContent="Адрес:",R=T(),Z=F("td"),Y=z(pt),V=T(),W=F("tr"),J=F("td"),J.textContent="Комплексов:",K=T(),Q=F("td"),Q.textContent=`${t[3].length}`,X=T(),tt=F("tr"),et=F("td");for(let t=0;t<dt.length;t+=1)dt[t].c();nt=T();for(let t=0;t<_t.length;t+=1)_t[t].c();q(n,"class","pLine"),q(d,"class","first svelte-h8luxq"),q(g,"class","first svelte-h8luxq"),q(O,"class","first svelte-h8luxq"),q(U,"title","Скопировать в буфер обмена"),q(U,"class","leaflet-gmx-icon-copy"),q(I,"class","first svelte-h8luxq"),q(J,"class","first svelte-h8luxq"),q(et,"class","tabs svelte-h8luxq"),q(et,"colspan","2"),q(a,"class","table svelte-h8luxq"),q(i,"class","featureCont"),q(e,"class","mvsPopup svelte-h8luxq")},m(f,w,D){C(f,e,w),j(e,n),j(n,o),j(n,l),j(n,s),j(e,r),j(e,i),j(i,a),j(a,p),j(p,c),j(c,d),j(c,u),j(c,_),j(_,h),j(p,v),j(p,m),j(m,g),j(m,y),j(m,b),j(b,x),j(p,k),j(p,L),j(L,O),j(L,M),j(L,P),j(P,N),j(P,S),j(P,H),j(P,B),j(P,U),j(p,G),j(p,A),j(A,I),j(A,R),j(A,Z),j(Z,Y),j(p,V),j(p,W),j(W,J),j(W,K),j(W,Q),j(p,X),j(p,tt),j(tt,et);for(let t=0;t<dt.length;t+=1)dt[t].m(et,null);j(et,nt);for(let t=0;t<_t.length;t+=1)_t[t].m(et,null);D&&ot(),ot=E(U,"click",t[1])},p(t,[e]){if(1&e&&lt!==(lt=(t[0].id||t[0].line_id)+"")&&$(l,lt),1&e&&st!==(st=(t[0].stage_name||"")+"")&&$(h,st),1&e&&rt!==(rt=(t[0].road_name||"")+"")&&$(x,rt),1&e&&it!==(it=t[0].lat+"")&&$(N,it),1&e&&at!==(at=t[0].lon+"")&&$(H,at),1&e&&pt!==(pt=(t[0].address||"")+"")&&$(Y,pt),12&e){let n;for(ct=t[3],n=0;n<ct.length;n+=1){const o=mo(t,ct,n);dt[n]?dt[n].p(o,e):(dt[n]=go(o),dt[n].c(),dt[n].m(et,nt))}for(;n<dt.length;n+=1)dt[n].d(1);dt.length=ct.length}if(8&e){let n;for(ut=t[3],n=0;n<ut.length;n+=1){const o=fo(t,ut,n);_t[n]?_t[n].p(o,e):(_t[n]=yo(o),_t[n].c(),_t[n].m(et,null))}for(;n<_t.length;n+=1)_t[n].d(1);_t.length=ut.length}},i:f,o:f,d(t){t&&w(e),D(dt,t),D(_t,t),ot()}}}function xo(t,e,n){let{prp:o}=e;let l=o&&o.list_complex?o.list_complex:[];return console.log("complexes ",l),t.$set=t=>{"prp"in t&&n(0,o=t.prp)},[o,t=>{navigator.clipboard.writeText(t.target.parentNode.textContent).catch(t=>{console.log("Something went wrong",t)})},t=>{let e=t.target,n=/tab (\d)/.exec(e.className),o=n&&2===n.length?n[1]:0,l=e.parentNode;for(let t=0,e=l.childNodes.length;t<e;t++){let e=l.childNodes[t];if(e.classList){let t=e.classList.contains(o);"BUTTON"===e.tagName?e.classList[t?"add":"remove"]("active"):"TABLE"===e.tagName&&e.classList[t?"remove":"add"]("hidden")}}},l]}vo.setFilter=t=>{if(!vo._map)return;vo.clearLayers(),ho=t;let e=[];vo._group&&(vo._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;ho.forEach(t=>{if("ht"===t.type)t.zn[n.ht]&&o++;else if("roads"===t.type)(t.zn.filter(t=>t===n.road).length||1===t.zn.length&&""===t.zn[0])&&o++;else if("id_dtp"===t.type)!n.list_dtp.filter(e=>e.id==t.zn).length&&t.zn.length||o++;else if("id_hearth"===t.type)t.zn==n.id_hearth&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&!n.count_stricken&&n.count_lost||2===e&&n.count_stricken&&!n.count_lost||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===ho.length&&e.push(t)}),vo.addLayer(uo.layerGroup(e)))},vo.on("remove",()=>{vo.clearLayers()}).on("add",t=>{let e=t=>{let e=uo.latLngBounds(),n="#FF0000";t.complexes&&(1===t.complexes.length?n="#FFA500":t.complexes.length>1&&(n="#0000FF"));let o=t.coords||{lat:t.lat,lon:t.lon},l=uo.latLng(o.lat,o.lon);return e.extend(l),new v(uo.latLng(o.lat,o.lon),{props:t,radius:6,zIndexOffset:5e4,stroke:!1,fillColor:n}).bindPopup(_o).on("popupopen",t=>{!function(t){let e=uo.DomUtil.create("div");new co({target:e,props:{prp:t}}),_o.setContent(e)}(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})};fetch("./static/rub.geojson",{}).then(t=>t.json()).then(t=>{let n=t.map(e);vo._group=uo.layerGroup(n),vo.addLayer(vo._group)})});class ko extends vt{constructor(t){super(),ht(this,t,xo,bo,x,{prp:0})}}const jo=window.L,Lo=jo.popup();jo.popup({minWidth:200});let Co,wo="https://dtp.mvs.group/scripts/rubez/";const Do=jo.featureGroup([]);function Fo(t,e,n){const o=t.slice();return o[9]=e[n],o[11]=n,o}function zo(t,e,n){const o=t.slice();return o[14]=e[n],o}function To(t,e,n){const o=t.slice();return o[9]=e[n],o}function Oo(t){let e,n,o,l=t[14].k_uch&&(t[14].npdd||t[14].sop_npdd)&&function(t){let e,n,o=t[14].k_uch+"";return{c(){e=F("li"),n=z(o)},m(t,o){C(t,e,o),j(e,n)},p:f,d(t){t&&w(e)}}}(t),s=t[14].npdd&&function(t){let e,n,o=t[14].npdd+"";return{c(){e=F("li"),n=z(o)},m(t,o){C(t,e,o),j(e,n)},p:f,d(t){t&&w(e)}}}(t),r=t[14].sop_npdd&&function(t){let e,n,o=t[14].sop_npdd+"";return{c(){e=F("li"),n=z(o)},m(t,o){C(t,e,o),j(e,n)},p:f,d(t){t&&w(e)}}}(t);return{c(){l&&l.c(),e=T(),s&&s.c(),n=T(),r&&r.c(),o=O()},m(t,i){l&&l.m(t,i),C(t,e,i),s&&s.m(t,i),C(t,n,i),r&&r.m(t,i),C(t,o,i)},p(t,e){t[14].k_uch&&(t[14].npdd||t[14].sop_npdd)&&l.p(t,e),t[14].npdd&&s.p(t,e),t[14].sop_npdd&&r.p(t,e)},d(t){l&&l.d(t),t&&w(e),s&&s.d(t),t&&w(n),r&&r.d(t),t&&w(o)}}}function Eo(t){let e,n,o=t[9].ts&&function(t){let e,n,o=t[9].ts+"";return{c(){e=F("li"),n=z(o)},m(t,o){C(t,e,o),j(e,n)},p:f,d(t){t&&w(e)}}}(t),l=t[9].arr,s=[];for(let e=0;e<l.length;e+=1)s[e]=Oo(zo(t,l,e));return{c(){o&&o.c(),e=T();for(let t=0;t<s.length;t+=1)s[t].c();n=O()},m(t,l){o&&o.m(t,l),C(t,e,l);for(let e=0;e<s.length;e+=1)s[e].m(t,l);C(t,n,l)},p(t,e){if(t[9].ts&&o.p(t,e),16&e){let o;for(l=t[9].arr,o=0;o<l.length;o+=1){const r=zo(t,l,o);s[o]?s[o].p(r,e):(s[o]=Oo(r),s[o].c(),s[o].m(n.parentNode,n))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(t){o&&o.d(t),t&&w(e),D(s,t),t&&w(n)}}}function Mo(t){let e,n,o,l,s,r=t[0].spog+"";return{c(){e=F("div"),n=F("div"),n.textContent="Погода:",o=T(),l=F("div"),s=z(r),q(n,"class","stitle"),q(l,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,o),j(e,l),j(l,s)},p(t,e){1&e&&r!==(r=t[0].spog+"")&&$(s,r)},d(t){t&&w(e)}}}function qo(t){let e,n,o,l,s,r=t[0].s_pch+"";return{c(){e=F("div"),n=F("div"),n.textContent="Покрытие:",o=T(),l=F("div"),s=z(r),q(n,"class","stitle"),q(l,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,o),j(e,l),j(l,s)},p(t,e){1&e&&r!==(r=t[0].s_pch+"")&&$(s,r)},d(t){t&&w(e)}}}function Po(t){let e,n,o,l,s,r=t[0].osv+"";return{c(){e=F("div"),n=F("div"),n.textContent="Освещенность:",o=T(),l=F("div"),s=z(r),q(n,"class","stitle"),q(l,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,o),j(e,l),j(l,s)},p(t,e){1&e&&r!==(r=t[0].osv+"")&&$(s,r)},d(t){t&&w(e)}}}function $o(t){let e,n,o,l,s,r=t[0].ndu+"";return{c(){e=F("div"),n=F("div"),n.textContent="Иные условия:",o=T(),l=F("div"),s=z(r),q(n,"class","stitle"),q(l,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,o),j(e,l),j(l,s)},p(t,e){1&e&&r!==(r=t[0].ndu+"")&&$(s,r)},d(t){t&&w(e)}}}function No(t){let e,n,o,l,s,r,i,a=t[9].line_id+"",p=t[9].range+"";return{c(){e=F("li"),n=z(a),o=z(" ("),l=z(p),s=z(" м.)"),q(e,"class","link svelte-vw4d3d"),e.value=r=t[9].line_id},m(r,a,p){C(r,e,a),j(e,n),j(e,o),j(e,l),j(e,s),p&&i(),i=E(e,"click",t[2])},p(t,o){1&o&&a!==(a=t[9].line_id+"")&&$(n,a),1&o&&p!==(p=t[9].range+"")&&$(l,p),1&o&&r!==(r=t[9].line_id)&&(e.value=r)},d(t){t&&w(e),i()}}}function So(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,m,g,y,b,x,k,L,O,M,P,N,S,H,B,U,G,A,I,R,Z,Y,V,W,J,K,Q,X,tt,et,nt,ot,lt,st,rt,it,at,pt,ct,dt,ut,_t,ht,vt,ft,mt,gt,yt,bt,xt,kt,jt,Lt,Ct,wt,Dt,Ft,zt,Tt,Ot,Et,Mt,qt,Pt,$t,Nt,St,Ht,Bt,Ut,Gt,At,It=(t[0].name||t[0].dtvp||"")+"",Rt=(t[0].sid||t[0].id_stat||t[0].id_skpdi||"")+"",Zt=(t[0].district||"")+"",Yt=(t[0].dor||"")+"",Vt=(t[0].km||0)+"",Wt=(t[0].m||0)+"",Jt=t[0].lat+"",Kt=t[0].lon+"",Qt=(t[0].collision_date||t[0].dtp_date||"")+"",Xt=(t[0].dtvp||"")+"",te=t[0].pog+"",ee=t[0].ran+"",ne=t[4],oe=[];for(let e=0;e<ne.length;e+=1)oe[e]=Eo(To(t,ne,e));let le=t[0].spog&&Mo(t),se=t[0].s_pch&&qo(t),re=t[0].osv&&Po(t),ie=t[0].ndu&&$o(t),ae=t[0].list_rub,pe=[];for(let e=0;e<ae.length;e+=1)pe[e]=No(Fo(t,ae,e));return{c(){e=F("div"),n=F("div"),o=F("b"),l=z(It),s=T(),r=F("div"),i=F("table"),a=F("tbody"),p=F("tr"),c=F("td"),c.textContent="ID:",d=T(),u=F("td"),_=z(Rt),h=T(),v=F("tr"),m=F("td"),m.textContent="Адрес:",g=T(),y=F("td"),b=z(Zt),x=T(),k=z(Yt),L=T(),O=F("tr"),M=F("td"),M.textContent="Пикетаж:",P=T(),N=F("td"),S=F("b"),H=z(Vt),B=z(" км. "),U=F("b"),G=z(Wt),A=z(" м."),I=T(),R=F("tr"),Z=F("td"),Z.textContent="Координаты:",Y=T(),V=F("td"),W=z(Jt),J=T(),K=z(Kt),Q=T(),X=F("span"),tt=T(),et=F("tr"),nt=F("td"),nt.textContent="Дата/время:",ot=T(),lt=F("td"),st=z(Qt),rt=T(),it=F("tr"),at=F("td"),at.textContent="Вид ДТП:",pt=T(),ct=F("td"),dt=z(Xt),ut=T(),_t=F("tr"),ht=F("td"),ht.textContent="Нарушения:",vt=T(),ft=F("td"),mt=F("ul");for(let t=0;t<oe.length;t+=1)oe[t].c();gt=T(),yt=F("tr"),bt=F("td"),bt.textContent="Условия:",xt=T(),kt=F("td"),le&&le.c(),jt=T(),se&&se.c(),Lt=T(),re&&re.c(),Ct=T(),ie&&ie.c(),wt=T(),Dt=F("tr"),Ft=F("td"),Ft.textContent="Количество погибших/раненых:",zt=T(),Tt=F("td"),Ot=F("b"),Et=z(te),Mt=z("/"),qt=z(ee),Pt=T(),$t=F("tr"),Nt=F("td"),Nt.textContent="Рубежи:",St=T(),Ht=F("td"),Bt=F("div"),Ut=T(),Gt=F("ul");for(let t=0;t<pe.length;t+=1)pe[t].c();q(n,"class","pLine"),q(c,"class","first svelte-vw4d3d"),q(m,"class","first svelte-vw4d3d"),q(M,"class","first svelte-vw4d3d"),q(Z,"class","first svelte-vw4d3d"),q(X,"title","Скопировать в буфер обмена"),q(X,"class","leaflet-gmx-icon-copy"),q(nt,"class","first svelte-vw4d3d"),q(at,"class","first svelte-vw4d3d"),q(ht,"class","first svelte-vw4d3d"),q(bt,"class","first svelte-vw4d3d"),q(Ft,"class","first svelte-vw4d3d"),q(Nt,"class","first svelte-vw4d3d"),q(Bt,"class","win leaflet-popup-content-wrapper  svelte-vw4d3d"),q(i,"class","table"),q(r,"class","featureCont"),q(e,"class","mvsPopup svelte-vw4d3d")},m(f,w,D){C(f,e,w),j(e,n),j(n,o),j(o,l),j(e,s),j(e,r),j(r,i),j(i,a),j(a,p),j(p,c),j(p,d),j(p,u),j(u,_),j(a,h),j(a,v),j(v,m),j(v,g),j(v,y),j(y,b),j(y,x),j(y,k),j(a,L),j(a,O),j(O,M),j(O,P),j(O,N),j(N,S),j(S,H),j(N,B),j(N,U),j(U,G),j(N,A),j(a,I),j(a,R),j(R,Z),j(R,Y),j(R,V),j(V,W),j(V,J),j(V,K),j(V,Q),j(V,X),j(a,tt),j(a,et),j(et,nt),j(et,ot),j(et,lt),j(lt,st),j(a,rt),j(a,it),j(it,at),j(it,pt),j(it,ct),j(ct,dt),j(a,ut),j(a,_t),j(_t,ht),j(_t,vt),j(_t,ft),j(ft,mt);for(let t=0;t<oe.length;t+=1)oe[t].m(mt,null);j(a,gt),j(a,yt),j(yt,bt),j(yt,xt),j(yt,kt),le&&le.m(kt,null),j(kt,jt),se&&se.m(kt,null),j(kt,Lt),re&&re.m(kt,null),j(kt,Ct),ie&&ie.m(kt,null),j(a,wt),j(a,Dt),j(Dt,Ft),j(Dt,zt),j(Dt,Tt),j(Tt,Ot),j(Ot,Et),j(Ot,Mt),j(Ot,qt),j(a,Pt),j(a,$t),j($t,Nt),j($t,St),j($t,Ht),j(Ht,Bt),t[8](Bt),j(Ht,Ut),j(Ht,Gt);for(let t=0;t<pe.length;t+=1)pe[t].m(Gt,null);D&&At(),At=E(X,"click",t[3])},p(t,[e]){if(1&e&&It!==(It=(t[0].name||t[0].dtvp||"")+"")&&$(l,It),1&e&&Rt!==(Rt=(t[0].sid||t[0].id_stat||t[0].id_skpdi||"")+"")&&$(_,Rt),1&e&&Zt!==(Zt=(t[0].district||"")+"")&&$(b,Zt),1&e&&Yt!==(Yt=(t[0].dor||"")+"")&&$(k,Yt),1&e&&Vt!==(Vt=(t[0].km||0)+"")&&$(H,Vt),1&e&&Wt!==(Wt=(t[0].m||0)+"")&&$(G,Wt),1&e&&Jt!==(Jt=t[0].lat+"")&&$(W,Jt),1&e&&Kt!==(Kt=t[0].lon+"")&&$(K,Kt),1&e&&Qt!==(Qt=(t[0].collision_date||t[0].dtp_date||"")+"")&&$(st,Qt),1&e&&Xt!==(Xt=(t[0].dtvp||"")+"")&&$(dt,Xt),16&e){let n;for(ne=t[4],n=0;n<ne.length;n+=1){const o=To(t,ne,n);oe[n]?oe[n].p(o,e):(oe[n]=Eo(o),oe[n].c(),oe[n].m(mt,null))}for(;n<oe.length;n+=1)oe[n].d(1);oe.length=ne.length}if(t[0].spog?le?le.p(t,e):(le=Mo(t),le.c(),le.m(kt,jt)):le&&(le.d(1),le=null),t[0].s_pch?se?se.p(t,e):(se=qo(t),se.c(),se.m(kt,Lt)):se&&(se.d(1),se=null),t[0].osv?re?re.p(t,e):(re=Po(t),re.c(),re.m(kt,Ct)):re&&(re.d(1),re=null),t[0].ndu?ie?ie.p(t,e):(ie=$o(t),ie.c(),ie.m(kt,null)):ie&&(ie.d(1),ie=null),1&e&&te!==(te=t[0].pog+"")&&$(Et,te),1&e&&ee!==(ee=t[0].ran+"")&&$(qt,ee),5&e){let n;for(ae=t[0].list_rub,n=0;n<ae.length;n+=1){const o=Fo(t,ae,n);pe[n]?pe[n].p(o,e):(pe[n]=No(o),pe[n].c(),pe[n].m(Gt,null))}for(;n<pe.length;n+=1)pe[n].d(1);pe.length=ae.length}},i:f,o:f,d(n){n&&w(e),D(oe,n),le&&le.d(),se&&se.d(),re&&re.d(),ie&&ie.d(),t[8](null),D(pe,n),At()}}}function Ho(t,e,n){let o,l,{showModal:s=!1}=e,{prp:r}=e,i=r.skpdiFiles?"":"disabled";R(()=>{s&&(o=new kt({target:document.body,props:{data:r.skpdiFiles}}),o.$on("close",t=>{o.$destroy(),n(5,s=!1)}))});const a=(r.tsInfo||[]).map(t=>{let e=t.ts_uch||[];return{ts:"Осталось на месте ДТП"!==t.ts?t.ts:"",arr:e.map(t=>({k_uch:t.k_uch||"",npdd:"Нет нарушений"!==t.npdd?t.npdd:"",sop_npdd:"Нет нарушений"!==t.sop_npdd?t.sop_npdd:""}))}});return console.log("ddddd",r),t.$set=t=>{"showModal"in t&&n(5,s=t.showModal),"prp"in t&&n(0,r=t.prp)},[r,l,t=>{let e=t.target.value;console.log("showRub",t.target.value),n(1,l.innerHTML="",l),fetch("https://dtp.mvs.group/scripts/rubez/rubez-complex-"+e+".txt",{}).then(t=>t.json()).then(t=>{new ko({target:l,props:{prp:t[0]}})})},t=>{navigator.clipboard.writeText(t.target.parentNode.textContent).catch(t=>{console.log("Something went wrong",t)})},a,s,o,i,function(t){V[t?"unshift":"push"](()=>{n(1,l=t)})}]}Do.setFilter=t=>{if(!Do._map)return;Do.clearLayers(),Co=t,Do._argFilters=Co;let e=[];Do._group&&(Do._group.getLayers().forEach(t=>{let n=t.options.props,o=0;Co.forEach(t=>{"comp"===t.type&&(n.rub_flag?t.zn.on&&o++:t.zn.off&&o++)}),o===Co.length&&e.push(t)}),Do.addLayer(jo.layerGroup(e)))},Do.on("remove",()=>{Do.clearLayers()}).on("add",t=>{let e={road:{},bad:[]},n=[],o={},l=t=>{let l=jo.latLngBounds(),s="gray";if(t.rub_flag&&(s="#00FF00"),o[t.line_sid]?console.log("___Дубль____",t):o[t.line_sid]=t,!t.lat||!t.lon)return void e.bad.push(t);let r=t.coords||{lat:t.lat,lon:t.lon},i=jo.latLng(r.lat,r.lon);l.extend(i),n.push(new v(jo.latLng(r.lat,r.lon),{props:t,radius:6,zIndexOffset:5e4,path:"camera",stroke:!1,fillColor:s}).bindPopup(Lo).on("popupopen",t=>{!function(t){let e=jo.DomUtil.create("div"),n=t.line_sid;fetch(wo+"rubez-complex-"+n+".txt",{}).then(t=>t.json()).then(t=>{new ko({target:e,props:{prp:t[0]}}),Lo.setContent(e)}),Lo.setContent(e)}(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)}))};fetch(wo+"rubez.txt",{}).then(t=>t.json()).then(t=>{t.forEach(l),Do._group=jo.layerGroup(n),Do.addLayer(Do._group),console.log("opt",e)})});class Bo extends vt{constructor(t){super(),ht(this,t,Ho,So,x,{showModal:5,prp:0})}}const Uo=window.L,Go=Uo.popup();let Ao;const Io=Uo.featureGroup([]);Io._needHeat={radius:19,blur:11.26,minOpacity:.34},Io.checkZoom=t=>{Object.keys(Io._layers).length?t<12&&Io.setFilter(Ao):t>11&&Io.setFilter(Ao)},Io.setFilter=t=>{if(!Io._map)return;Io.clearLayers(),Ao=t||[],Io._argFilters=Ao;let e=[],n=[];Io._group&&(Io._group.getLayers().forEach(t=>{let o=t.options.props,l=0;Ao.forEach(t=>{"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===o.collision_type).length)&&l++:"list_rub"===t.type?o.list_rub.length?t.zn.on&&l++:t.zn.off&&l++:"date"===t.type&&o.date>=t.zn[0]&&o.date<t.zn[1]&&l++}),l===Ao.length&&(e.push(t),n.push(t._latlng))}),Io._needHeat?(Io._map.addLayer(Io._heat),Io._heat.setLatLngs(n),Io._heat.setOptions(Io._needHeat),Io._map._zoom>11&&Io.addLayer(Uo.layerGroup(e))):(Io.addLayer(Uo.layerGroup(e)),Io._map.removeLayer(Io._heat)))},Io.on("remove",t=>{Io._map.removeLayer(Io._heat),Io.clearLayers()}).on("add",t=>{Io._heat=Uo.heatLayer([],{gradient:{.1:"blue",.4:"lime",1:"red"}}),fetch("https://dtp.mvs.group/scripts/dtprubez/get_stat_gipdd_with_rub.txt",{}).then(t=>t.json()).then(t=>{let e={collision_type:{},iconType:{}},n=[],o=t.map(t=>{let o=t.iconType||0,l=!1,s="#2F4F4F";o&&(l=o%2==0,o>=1&&o<=6?s="#8B4513":7===o||8===o?s="#228B22":o>=9&&o<=14?s="#8B4513":15===o||16===o?s="#7B68EE":17!==o&&18!==o||(s="#2F4F4F")),t.list_rub||(t.list_rub=[]),t.lat&&t.lon||(console.log("_______",t),t.lat=t.lon=0);let r=e.collision_type[t.collision_type];r?r++:r=1,e.collision_type[t.collision_type]=r,e.iconType[t.collision_type]=o;let i=Uo.latLng(t.lat,t.lon,l?1:.5);return n.push(i),new v(i,{props:t,radius:6,stroke:l,fillColor:s}).bindPopup(Go).on("popupopen",t=>{var e;e=t.target.options.props.id,fetch("https://dtp.mvs.group/scripts/dtprubez/get_stat_gipdd_with_rub_"+e+".txt",{}).then(t=>t.json()).then(t=>{let e=Uo.DomUtil.create("div");const n=new Bo({target:e,props:{prp:t}});Go._svObj=n,Go.setContent(e)})}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});Io.addLayer(Io._heat),Io._heat.setLatLngs(n),Io._heat.setOptions(Io._needHeat),Io._opt=e,Io._group=Uo.layerGroup(o),Ao?Io.setFilter(Ao):Io._map._zoom>11&&Io.addLayer(Io._group),Io._refreshFilters()})});const Ro=window.L;Ro.popup();let Zo;const Yo=Ro.featureGroup([]);Yo._needHeat={radius:19,blur:11.26,minOpacity:.34},Yo.checkZoom=t=>{Object.keys(Yo._layers).length?t<12&&Yo.setFilter(Zo):t>11&&Yo.setFilter(Zo)},Yo.setFilter=t=>{if(!Yo._map)return;Yo.clearLayers(),Zo=t||[],Yo._argFilters=Zo;let e=[],n=[];Yo._group&&(Yo._group.getLayers().forEach(t=>{let o=t.options.props,l=0;Zo.forEach(t=>{"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===o.collision_type).length)&&l++:"list_rub"===t.type?o.list_rub.length?t.zn.on&&l++:t.zn.off&&l++:"date"===t.type&&o.date>=t.zn[0]&&o.date<t.zn[1]&&l++}),l===Zo.length&&(e.push(t),n.push(t._latlng))}),Yo.addLayer(Ro.layerGroup(e)))},Yo.on("remove",t=>{Yo.clearLayers()}).on("add",t=>{fetch("https://dtp.mvs.group/static/proxy.php?url=https://graphql.dev.mvs.group/graphql",{body:'{"operationName":null,"variables":{},"query":"{\\n  allVMapLineInfos(filter: {lon: {isNull: false}, lat: {isNull: false}}) {\\n    totalCount\\n    nodes {\\n      lineSid: sid\\n      lineName: name\\n      lineAddress: address\\n      roadName\\n      stage\\n      lat\\n      lon\\n      yield\\n      complexes\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n"}',method:"POST",mode:"cors"}).then(t=>t.json()).then(t=>{console.log("json",t)})});const Vo=window.L,Wo=Vo.map(document.body,{center:[55.758031,37.611694],minZoom:1,zoom:8,maxZoom:21,attributionControl:!1,trackResize:!0,fadeAnimation:!0,zoomAnimation:!0,distanceUnit:"auto",squareUnit:"auto"});var Jo=Wo._controlCorners,Ko=Wo._controlContainer,Qo="leaflet-top leaflet-bottom",Xo="leaflet-left leaflet-right",tl={bottom:"leaflet-bottom "+Xo,gmxbottomleft:"leaflet-bottom leaflet-left",gmxbottomcenter:"leaflet-bottom "+Xo,gmxbottomright:"leaflet-bottom leaflet-right",center:Qo+" "+Xo,right:"leaflet-right "+Qo,left:"leaflet-left "+Qo,top:"leaflet-top "+Xo};for(var el in tl)Jo[el]||(Jo[el]=Vo.DomUtil.create("div",tl[el],Ko));Wo.addControl(Vo.control.gmxCenter()).addControl(Vo.control.fitCenter());var nl=Vo.TileLayer.extend({options:{tilesCRS:Vo.CRS.EPSG3395},_getTiledPixelBounds:function(t){var e=Vo.TileLayer.prototype._getTiledPixelBounds.call(this,t);return this._shiftY=this._getShiftY(this._tileZoom),e.min.y+=this._shiftY,e.max.y+=this._shiftY,e},_tileOnError:function(t,e,n){var o=e.getAttribute("src"),l=o.indexOf("/mapcache/");if(l>-1){var s=new URL("http:"+o).searchParams,r=o.substr(l+1).split("/"),i=a[r[1]];e.src=Vo.Util.template(i.errorTileUrlPrefix+i.postfix,{z:s.get("z"),x:s.get("x"),y:s.get("y")})}t(n,e)},_getTilePos:function(t){return Vo.TileLayer.prototype._getTilePos.call(this,t).subtract([0,this._shiftY])},_getShiftY:function(t){var e=this._map,n=e.getCenter(),o=e.options.crs.project(n).y-this.options.tilesCRS.project(n).y;return Math.floor(Vo.CRS.scale(t)*o/40075016.685578495)}});Vo.TileLayer.Mercator=nl,Vo.tileLayer.Mercator=function(t,e){return new nl(t,e)};let ol={};p.b||(p.b="m2"),["m2","m3"].forEach(t=>{let e=a[t],n=Vo.tileLayer.Mercator(e.prefix+e.postfix,e.options);ol[e.title]=n,p.b===e.options.key&&n.addTo(Wo)}),ol.OpenStreetMap=Vo.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:21,maxNativeZoom:18});let ll={TestGraphQl:Yo,"Рубежи":Do,"Рубежи (test)":vo,"Очаги ГИБДД по пикетажу":oo,"Очаги ГИБДД разные типы, геометрия":Kn,"Очаги ГИБДД одного типа, геометрия":Rn,"ДТП Очаги(Stat)":Hn,"ДТП Очаги(tmp)":Mn,"Очаги ГИБДД+СКПДИ по кварталам геометрия":Dn,"ДТП  ГИБДД+СКПДИ (объединение)":ie,"ДТП СКПДИ + тепловая карта":Jt,"ДТП ГИБДД + тепловая карта":Nt,"ДТП ГИБДД + тепловая карта + Рубежи":Io},sl=p.o?p.o.split(",").reduce((t,e)=>(t[e]=!0,t),{}):{};["m1","m4","m5"].forEach(t=>{let e=a[t],n=Vo.tileLayer.Mercator(e.prefix+e.postfix,e.options);ll[e.title]=n,sl[e.options.key]&&n.addTo(Wo)}),Vo.control.layers(ol,ll).addTo(Wo);let rl=Vo.control.gmxIcon({id:"filters",className:"leaflet-bar",togglable:!0,title:"Фильтры"}).on("statechange",(function(t){let e=t.target,n=e._container,o=e._win;e.options.isActive?o||(o=e._win=Vo.DomUtil.create("div","win leaflet-control-layers",n),Vo.DomEvent.disableScrollPropagation(o),o._Filters=new hn({target:o,props:{DtpGibddRub:Io,DtpGibdd:Nt,DtpSkpdi:Jt,Rub:Do,DtpHearthsPicket:oo,DtpHearths5:Kn,DtpHearths3:Rn,DtpHearthsStat:Hn,DtpHearthsTmp:Mn,DtpHearths:Dn,DtpVerifyed:ie}})):(e._win.parentNode.removeChild(e._win),e._win=null)})).addTo(Wo);const il=(t,e)=>{for(var n=Math.PI/180,o={lon:n*t.lng,lat:n*t.lat},l={lon:n*e.lng,lat:n*e.lat},s=6378137,r=6356752.3142,i=1/298.257223563,a=l.lon-o.lon,p=Math.atan((1-i)*Math.tan(o.lat)),c=Math.atan((1-i)*Math.tan(l.lat)),d=Math.sin(p),u=Math.cos(p),_=Math.sin(c),h=Math.cos(c),v=a,f=2*Math.PI,m=20;Math.abs(v-f)>1e-12&&--m>0;){var g=Math.sin(v),y=Math.cos(v),b=Math.sqrt(h*g*(h*g)+(u*_-d*h*y)*(u*_-d*h*y));if(0===b)return 0;var x=d*_+u*h*y,k=Math.atan2(b,x),j=u*h*g/b,L=1-j*j,C=x-2*d*_/L;isNaN(C)&&(C=0);var w=i/16*L*(4+i*(4-3*L));f=v,v=a+(1-w)*i*j*(k+w*b*(C+w*x*(2*C*C-1)))}if(0===m)return NaN;var D=L*(s*s/(r*r)-1),F=D/1024*(256+D*(D*(74-47*D)-128));return r*(1+D/16384*(4096+D*(D*(320-175*D)-768)))*(k-F*b*(C+F/4*(x*(2*C*C-1)-F/6*C*(4*b*b-3)*(4*C*C-3))))};let al,pl;Wo.pm.setLang("customName",{tooltips:{finishLine:"Щелкните любой существующий маркер для завершения"}},"ru"),Wo.pm.setLang("ru"),Wo.on("pm:create",t=>{Wo.removeLayer(t.layer),cl.setActive(!1)}).on("pm:drawstart",t=>{let e=t.workingLayer;if("Line"===t.shape){let n=Wo.pm.Draw.Line._hintMarker;n&&n.on("move",(function(t){var o=e.getLatLngs();if(o.length){var l=(t=>{let e=0,n=(t=t||[])[0];return t.forEach(t=>{e+=il(t,n),n=t}),e})(o),s=il(o[o.length-1],t.latlng),r=(l+=s)>1e3?(l/1e3).toFixed(2)+" км":Math.ceil(l)+" м",i=s>1e3?(s/1e3).toFixed(2)+" км":Math.ceil(s)+" м";n._tooltip.setContent("Отрезок <b>("+i+")</b>участка <b>("+r+")</b>")}})),al&&t.target.pm.Toolbar.buttons.drawPolyline.buttonsDomNode&&(pl=t.target.pm.Toolbar.buttons.drawPolyline.buttonsDomNode.children[1],pl.style.display="none")}});let cl=Vo.control.gmxIcon({id:"measure",className:"leaflet-bar",togglable:!0,title:"Включить/Отключить режим измерения расстояний"}).on("statechange",(function(t){al=t.target.options.isActive,al?Wo.pm.enableDraw("Line",{finishOn:"dblclick"}):(Wo.pm.disableDraw("Line"),pl&&(pl.style.display=""))})).addTo(Wo);const dl=()=>{setTimeout(()=>{rl.options.isActive&&(rl.setActive(!1),rl._win=null,rl.setActive(!0))})};Io._refreshFilters=Nt._refreshFilters=Jt._refreshFilters=ie._refreshFilters=Dn._refreshFilters=Hn._refreshFilters=Rn._refreshFilters=Kn._refreshFilters=oo._refreshFilters=Do._refreshFilters=Mn._refreshFilters=dl;return Io.on("remove",dl),Nt.on("remove",dl),Jt.on("remove",dl),ie.on("remove",dl),Dn.on("remove",dl),Mn.on("remove",dl),Hn.on("remove",dl),Rn.on("remove",dl),Kn.on("remove",dl),oo.on("remove",dl),Do.on("remove",dl),Wo.on("zoomend",t=>{Wo._crpx=0,ie._map&&ie.checkZoom(Wo._zoom),Jt._map&&Jt.checkZoom(Wo._zoom),Nt._map&&Nt.checkZoom(Wo._zoom)}),window._map=Wo,Wo}();
//# sourceMappingURL=main.js.map
