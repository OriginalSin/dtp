var dtp=function(){"use strict";const t=window.L;t.Control.GmxIcon=t.Control.extend({includes:t.Evented?t.Evented.prototype:t.Mixin.Events,options:{position:"topleft",id:"defaultIcon",isActive:!1},setActive:function(e,n,o){var l=this.options,s=this._container;if(l.togglable||l.toggle){var r=l.isActive,i=this._prefix,a=i+"-"+l.id;l.isActive=e,this._img&&(e&&l.activeImageUrl?this._img.src=l.activeImageUrl:!e&&l.regularImageUrl&&(this._img.src=l.regularImageUrl)),e?(t.DomUtil.addClass(s,i+"-active"),t.DomUtil.addClass(s,a+"-active"),s.children.length&&t.DomUtil.addClass(s,i+"-externalImage-active"),l.styleActive&&this.setStyle(l.styleActive)):(t.DomUtil.removeClass(s,i+"-active"),t.DomUtil.removeClass(s,a+"-active"),s.children.length&&t.DomUtil.removeClass(s,i+"-externalImage-active"),l.style&&this.setStyle(l.style)),n||r===e||this.fire("statechange",o)}if(t.gmxUtil&&t.gmxUtil.isIEOrEdge){var c=s.getElementsByTagName("use");if(c.length){var p=c[0],d=p.getAttribute("href")||p.getAttribute("xlink:href");p.setAttribute("href",d)}}},onAdd:function(e){var n=null,o=this.options,l=o.svgSprite||e.options.svgSprite,s="leaflet-gmx-icon"+(!l||o.regularImageUrl||o.text?"":"Svg"),r=s+"-"+o.id;this._prefix=s;var i=t.DomUtil.create("div",s+" "+r);if(i._id=o.id,this._container=i,o.title&&(i.title=o.title),this.setStyle=function(t){for(var e in t)i.style[e]=t[e]},o.className&&t.DomUtil.addClass(i,o.className),o.regularImageUrl)(n=t.DomUtil.create("img","",i)).src=o.regularImageUrl,this._img=n,t.DomUtil.addClass(i,s+"-img"),t.DomUtil.addClass(i,s+"-externalImage");else if(o.text)t.DomUtil.addClass(i,s+"-text"),t.DomUtil.create("span","",i).innerHTML=o.text;else if(l){t.DomUtil.addClass(i,"svgIcon");var a="#"+o.id.toLowerCase();i.innerHTML='<svg role="img" class="svgIcon"><use xlink:href="'+a+'" href="'+a+'"></use></svg>'}else t.DomUtil.addClass(i,s+"-img "+s+"-sprite");o.style&&this.setStyle(o.style),this._iconClick=function(t){i.parentNode&&i===t.toElement&&(this.setActive(!this.options.isActive,!1,t),this.fire("click",t),this.options.stateChange&&this.options.stateChange(this,t))};var c=t.DomEvent.stopPropagation;t.DomEvent.preventDefault;return t.DomEvent.on(i,"mousemove",c).on(i,"touchstart",c).on(i,"mousedown",c).on(i,"dblclick",c).on(i,"click",c).on(i,"click",this._iconClick,this),o.onAdd&&o.onAdd(this),this.fire("controladd"),e.fire("controladd",this),o.notHide&&(i._notHide=!0),e.gmxControlsManager&&e.gmxControlsManager.add(this),i},onRemove:function(e){e.gmxControlsManager&&e.gmxControlsManager.remove(this),this.fire("controlremove"),e.fire("controlremove",this);var n=this._container,o=t.DomEvent.stopPropagation;t.DomEvent.off(n,"mousemove",o).off(n,"touchstart",o).off(n,"mousedown",o).off(n,"dblclick",o).off(n,"click",o).off(n,"click",this._iconClick,this)},addTo:function(e){return t.Control.prototype.addTo.call(this,e),this.options.addBefore&&this.addBefore(this.options.addBefore),this},addBefore:function(t){var e=this._parent&&this._parent._container;if(e||(e=this._map&&this._map._controlCorners[this.getPosition()]),e)for(var n=0,o=e.childNodes.length;n<o;n++){var l=e.childNodes[n];if(t===l._id){e.insertBefore(this._container,l);break}}else this.options.addBefore=t;return this}}),t.Control.gmxIcon=t.Control.GmxIcon,t.control.gmxIcon=function(e){return new t.Control.GmxIcon(e)};const e=window.L;e.Control.GmxCenter=e.Control.extend({options:{position:"center",id:"center",notHide:!0,color:"red"},onRemove:function(t){t.gmxControlsManager&&t.gmxControlsManager.remove(this),t.fire("controlremove",this)},onAdd:function(t){var n="http://www.w3.org/2000/svg",o=e.DomUtil.create("div","leaflet-gmx-center"),l=e.DomUtil.create("div","leaflet-gmx-center"),s=document.createElementNS(n,"svg"),r=document.createElementNS(n,"g"),i=document.createElementNS(n,"path");return this._container=o,o._id=this.options.id,this.options.notHide&&(o._notHide=!0),i.setAttribute("stroke-width",2),i.setAttribute("stroke-opacity",2),i.setAttribute("d","M9 0L9 18M0 9L18 9"),this._path=i,r.appendChild(i),s.appendChild(r),s.setAttribute("width",18),s.setAttribute("height",18),l.appendChild(s),o.appendChild(l),this.setColor(this.options.color),t.fire("controladd",this),t.gmxControlsManager&&t.gmxControlsManager.add(this),o},setColor:function(t){return this.options.color=t,this._map&&this._path.setAttribute("stroke",t),this}}),e.Control.gmxCenter=e.Control.GmxCenter,e.control.gmxCenter=function(t){return new e.Control.GmxCenter(t)};const n=window.L;n.Control.FitCenter=n.Control.extend({options:{position:"topright",id:"fitcenter",notHide:!0,color:"#216b9c"},onRemove:function(t){t.gmxControlsManager&&t.gmxControlsManager.remove(this),t.off("moveend",this._update,this).fire("controlremove",this)},onAdd:function(t){var e=this.options.id,o="leaflet-gmx-"+e,l=n.DomUtil.create("div",o),s=n.DomUtil.create("input","",l),r=n.DomUtil.create("button","",l),i=n.DomUtil.create("div","results",l);return r.title="Переместить центр карты",s.placeholder="Поиск по адресам, координатам",this._input=s,this._container=l,this._results=i,l._id=e,t.on("mousemove",t=>{this._results.style.display="none"},this),n.DomEvent.on(s,"input",this._getSuggestions,this),n.DomEvent.on(s,"contextmenu",n.DomEvent.stopPropagation,this),n.DomEvent.on(l,"mousemove",n.DomEvent.stop),n.DomEvent.on(l,"mouseover",t=>{"block"!==this._results.style.display&&(this._results.style.display="block")},this),n.DomEvent.on(r,"click",(function(){let e=s.value.match(/[+-]?([0-9]*[.])?[0-9]+/g);e&&e.length>1&&t.setView([Number(e[0]),Number(e[1])])})),n.DomEvent.disableClickPropagation(l),t.on("moveend",this._update,this).fire("controladd",this),t.gmxControlsManager&&t.gmxControlsManager.add(this),l},_parseSearch:function(t){if((t=t||[]).length){this._results;let e=document.createDocumentFragment();t.forEach(t=>{let o=t.display_name,l=t.boundingbox,s=n.DomUtil.create("div","",e);s.innerHTML=o,n.DomEvent.on(s,"click",t=>{this._map.fitBounds([[l[0],l[2]],[l[1],l[3]]])},this)}),this._results.innerText="",this._results.appendChild(e),this._results.classList.add("active")}},_getSuggestions:function(t){const e=t.target.value||"калужское шоссе",n=["format=json","limit=10","polygon_text=1","bounded=1","viewbox=34,53,41,57"].join("&"),o="&q="+encodeURI(e);fetch(`//nominatim.openstreetmap.org/search?${n}${o}`,{}).then(t=>t.json()).then(this._parseSearch.bind(this))},_update:function(t){this._map&&this.setCoords(this._map.getCenter())},_trunc:function(t){return(""+(Math.round(1e7*t)/1e7+1e-8)).substring(0,9)},setCoords:function(t){return this}}),n.control.fitCenter=function(t){return new n.Control.FitCenter(t)};const o='&copy; <a href="https://n.maps.yandex.ru/?oid=1900133#!/?z=18&ll=36.860478%2C55.429679&l=nk%23map">Yandex</a> contributors',l="//inv.mvs.group/mapcache/",s=new Date,r=s.getMonth()+1,i=s.getDate(),a=(s.getFullYear(),{m1:{title:"Дороги",prefix:l+"m1/",postfix:"?x={x}&y={y}&z={z}&l=mrcss",errorTileUrlPrefix:"//core-nmaps-mrc-browser.maps.yandex.ru/tiles",options:{key:"m1",minZoom:10,maxZoom:19,attribution:o}},m2:{title:"Карта(Яндекс)",prefix:l+"m2/tiles",postfix:"?l=map&v=18.01.10-2&x={x}&y={y}&z={z}&scale=1&lang=ru_RU",errorTileUrlPrefix:"//vec01.maps.yandex.net/tiles",options:{key:"m2",maxNativeZoom:19,maxZoom:21,attribution:o}},m3:{title:"Снимки(Яндекс)",prefix:l+"m3/tiles",postfix:"?l=sat&v=3.462.0&x={x}&y={y}&z={z}&lang=ru_RU",errorTileUrlPrefix:"//sat04.maps.yandex.net/tiles",options:{key:"m3",maxNativeZoom:19,maxZoom:21,attribution:o}},m4:{title:"Скорость(Народная карта)",prefix:l+"m4/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=104,301135,302526,302827,5300026,5400046,70300236,70300638",errorTileUrlPrefix:"//04.core-nmaps-renderer-nmaps.maps.yandex.net/tile",options:{key:"m4",minZoom:8,maxZoom:19,attribution:o}},m5:{title:"Светофоры",prefix:l+"m5/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=301750",errorTileUrlPrefix:"//04.core-nmaps-renderer-nmaps.maps.yandex.net/tile",options:{key:"m4",minZoom:12,maxZoom:19,attribution:o}},m6:{title:"Дороги в стадии строительства",prefix:"//03.core-nmaps-renderer-nmaps.maps.yandex.net/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=70300289",errorTileUrlPrefix:"//03.core-nmaps-renderer-nmaps.maps.yandex.net/",options:{key:"m6",minZoom:10,maxZoom:19,attribution:o}}}),c={};window.URLSearchParams&&new URLSearchParams(window.location.search).forEach((t,e)=>{c[e]=t});const p=window.L;let d=p.canvas();const u=function(t,e){var n=p.Projection.Mercator.project(e),o=p.Projection.Mercator.unproject(new p.Point(n.x+40,n.y+30));return 156543.033928041*Math.pow(2,-t)*((t,e)=>{for(var n=Math.PI/180,o={lon:n*t.lng,lat:n*t.lat},l={lon:n*e.lng,lat:n*e.lat},s=6378137,r=6356752.3142,i=1/298.257223563,a=l.lon-o.lon,c=Math.atan((1-i)*Math.tan(o.lat)),p=Math.atan((1-i)*Math.tan(l.lat)),d=Math.sin(c),u=Math.cos(c),_=Math.sin(p),h=Math.cos(p),v=a,f=2*Math.PI,m=20;Math.abs(v-f)>1e-12&&--m>0;){var g=Math.sin(v),y=Math.cos(v),b=Math.sqrt(h*g*(h*g)+(u*_-d*h*y)*(u*_-d*h*y));if(0===b)return 0;var x=d*_+u*h*y,k=Math.atan2(b,x),j=u*h*g/b,C=1-j*j,L=x-2*d*_/C;isNaN(L)&&(L=0);var D=i/16*C*(4+i*(4-3*C));f=v,v=a+(1-D)*i*j*(k+D*b*(L+D*x*(2*L*L-1)))}if(0===m)return NaN;var w=C*(s*s/(r*r)-1),T=w/1024*(256+w*(w*(74-47*w)-128));return r*(1+w/16384*(4096+w*(w*(320-175*w)-768)))*(k-T*b*(L+T/4*(x*(2*L*L-1)-T/6*L*(4*b*b-3)*(4*L*L-3))))})(e,o)/50};p.canvas({padding:.5});p.Canvas.include({_updateMarkerPoint:function(t){if(!(!this._drawing||t._empty()||t.feature&&t.feature.properties._isHidden)){var e=t._point,n=t.options._radiusM,o=t.options.image,l=t._map,s=this._ctx,r=t.options.iconName||"border";if(l){if(o){let n=t.options.w||20,l=t.options.h||20;return void s.drawImage(o,e.x-n/2,e.y-l/2,n,l)}let i=l._zoom;n&&!l._rpx&&l._needRound&&(l._rpx=l._needRound*n/u(i,l.getCenter())),l._rpx>20&&l._needRound&&(s.save(),s.beginPath(),s.globalAlpha=.2,s.fillStyle="gray",s.arc(e.x,e.y,l._rpx,0,2*Math.PI),s.fill(),s.stroke(),s.closePath(),s.restore()),i>12&&(s.save(),s.beginPath(),s.globalAlpha=1,s.fillStyle="white",s.arc(e.x,e.y,14,0,2*Math.PI),s.fill(),s.closePath(),s.restore()),s.save(),s.beginPath(),s.translate(e.x-0,e.y-0),this._fillStroke(s,t),s.stroke(iconPaths[r].path),s.globalAlpha=t.options.fillOpacity,s.fill(iconPaths[r].path),s.closePath(),s.restore()}}},_updateCirclePoint:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=t.options,o=n.radius||14,l=2*o,s=(t._map,this._ctx);s.save(),s.beginPath(),s.globalAlpha=1,s.fillStyle=n.fillColor||"red",n.triangle?(s.moveTo(e.x,e.y+o),s.lineTo(e.x+o,e.y-o),s.lineTo(e.x-o,e.y-o),s.lineTo(e.x,e.y+o)):n.rhomb?(s.moveTo(e.x+o,e.y),s.lineTo(e.x,e.y+o),s.lineTo(e.x-o,e.y),s.lineTo(e.x,e.y-o),s.lineTo(e.x+o,e.y)):n.box?s.fillRect(e.x-o,e.y-o,l,l):s.arc(e.x,e.y,o,0,2*Math.PI),s.fill(),n.stroke&&(s.stroke(),n.triangle?(s.moveTo(e.x,e.y+o),s.lineTo(e.x+o,e.y-o),s.lineTo(e.x-o,e.y-o),s.lineTo(e.x,e.y+o)):n.box?s.strokeRect(e.x-o,e.y-o,l,l):s.arc(e.x,e.y,o,0,2*Math.PI)),s.closePath(),s.restore()}}});p.CircleMarker.extend({_updatePath:function(){this._renderer._updateMarkerPoint(this)}});const _=p.CircleMarker.extend({options:{renderer:d},_updatePath:function(){this._renderer._updateCirclePoint(this)}});p.Rectangle.extend({options:{renderer:d}});function h(){}function v(t){return t()}function f(){return Object.create(null)}function m(t){t.forEach(v)}function g(t){return"function"==typeof t}function y(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function b(t){return null==t?"":t}function x(t,e){t.appendChild(e)}function k(t,e,n){t.insertBefore(e,n||null)}function j(t){t.parentNode.removeChild(t)}function C(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function D(t){return document.createElement(t)}function w(t){return document.createTextNode(t)}function T(){return w(" ")}function F(){return w("")}function E(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function M(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function O(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function z(t,e){e=""+e,t.data!==e&&(t.data=e)}function $(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}}function P(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];o.selected=~e.indexOf(o.__value)}}function S(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function q(t){return[].map.call(t.querySelectorAll(":checked"),t=>t.__value)}let U;function B(t){U=t}function N(){if(!U)throw new Error("Function called outside component initialization");return U}function A(t){N().$$.after_update.push(t)}function H(){const t=N();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const l=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);o.slice().forEach(e=>{e.call(t,l)})}}}const I=[],G=[],R=[],Z=[],Y=Promise.resolve();let V=!1;function J(t){R.push(t)}let K=!1;const W=new Set;function Q(){if(!K){K=!0;do{for(let t=0;t<I.length;t+=1){const e=I[t];B(e),X(e.$$)}for(I.length=0;G.length;)G.pop()();for(let t=0;t<R.length;t+=1){const e=R[t];W.has(e)||(W.add(e),e())}R.length=0}while(I.length);for(;Z.length;)Z.pop()();V=!1,K=!1,W.clear()}}function X(t){if(null!==t.fragment){t.update(),m(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(J)}}const tt=new Set;let et;function nt(){et={r:0,c:[],p:et}}function ot(){et.r||m(et.c),et=et.p}function lt(t,e){t&&t.i&&(tt.delete(t),t.i(e))}function st(t,e,n,o){if(t&&t.o){if(tt.has(t))return;tt.add(t),et.c.push(()=>{tt.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}function rt(t){t&&t.c()}function it(t,e,n){const{fragment:o,on_mount:l,on_destroy:s,after_update:r}=t.$$;o&&o.m(e,n),J(()=>{const e=l.map(v).filter(g);s?s.push(...e):m(e),t.$$.on_mount=[]}),r.forEach(J)}function at(t,e){const n=t.$$;null!==n.fragment&&(m(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ct(t,e){-1===t.$$.dirty[0]&&(I.push(t),V||(V=!0,Y.then(Q)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function pt(t,e,n,o,l,s,r=[-1]){const i=U;B(t);const a=e.props||{},c=t.$$={fragment:null,ctx:null,props:s,update:h,not_equal:l,bound:f(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(i?i.$$.context:[]),callbacks:f(),dirty:r};let p=!1;if(c.ctx=n?n(t,a,(e,n,...o)=>{const s=o.length?o[0]:n;return c.ctx&&l(c.ctx[e],c.ctx[e]=s)&&(c.bound[e]&&c.bound[e](s),p&&ct(t,e)),n}):[],c.update(),p=!0,m(c.before_update),c.fragment=!!o&&o(c.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);c.fragment&&c.fragment.l(t),t.forEach(j)}else c.fragment&&c.fragment.c();e.intro&&lt(t.$$.fragment),it(t,e.target,e.anchor),Q()}B(i)}class dt{$destroy(){at(this,1),this.$destroy=h}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function ut(t,e,n){const o=t.slice();return o[7]=e[n],o[9]=n,o}function _t(t){let e,n,o,l,s;function r(...e){return t[6](t[9],...e)}return{c(){e=D("li"),O(e,"class",n="dot"+(t[9]===t[1]?" selected":"")+" svelte-jjp3es"),e.value=o=t[9],O(e,"role","button"),O(e,"tabindex","0"),O(e,"aria-label",l="slide item "+t[9])},m(t,n,o){k(t,e,n),o&&s(),s=E(e,"click",M(r))},p(o,l){t=o,2&l&&n!==(n="dot"+(t[9]===t[1]?" selected":"")+" svelte-jjp3es")&&O(e,"class",n)},d(t){t&&j(e),s()}}}function ht(t){let e,n,o,l,s,r,i,a,c,p,d,u,_,v,f,g,y,b,L,F,$,P,S,q,U,B,N,A,H,I,G=(t[0][t[1]].kindName||"Фото и схемы ДТП")+"",R=t[1]+1+"",Z=t[0].length+"",Y=t[0],V=[];for(let e=0;e<Y.length;e+=1)V[e]=_t(ut(t,Y,e));return{c(){e=D("div"),n=T(),o=D("div"),l=D("div"),s=T(),r=D("div"),i=D("div"),a=D("div"),c=w(G),p=T(),d=D("div"),u=D("div"),_=D("div"),v=D("button"),f=T(),g=D("div"),y=D("a"),b=D("img"),$=T(),P=D("button"),S=T(),q=D("ul");for(let t=0;t<V.length;t+=1)V[t].c();U=T(),B=D("p"),N=w(R),A=w(" из "),H=w(Z),O(e,"class","modal-background svelte-jjp3es"),O(l,"title","Закрыть"),O(l,"class","ant-modal-close svelte-jjp3es"),O(a,"class","ant-modal-title"),O(a,"id","rcDialogTitle1"),O(i,"class","ant-modal-header svelte-jjp3es"),O(v,"type","button"),O(v,"aria-label","previous slide / item"),O(v,"class","control-arrow control-prev svelte-jjp3es"),b.src!==(L=""+(vt+t[0][t[1]].guid))&&O(b,"src",L),O(b,"alt",""),O(b,"class","svelte-jjp3es"),O(y,"target","_blank"),O(y,"href",F=""+(vt+t[0][t[1]].guid)),O(y,"title","Открыть на весь экран"),O(y,"class","svelte-jjp3es"),O(g,"class","slider-wrapper axis-horizontal svelte-jjp3es"),O(P,"type","button"),O(P,"aria-label","next slide / item"),O(P,"class","control-arrow control-next svelte-jjp3es"),O(q,"class","control-dots svelte-jjp3es"),O(B,"class","carousel-status svelte-jjp3es"),O(_,"class","carousel carousel-slider svelte-jjp3es"),function(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}(_,"width","100%"),O(d,"class","ant-modal-body svelte-jjp3es"),O(r,"class","ant-modal-content svelte-jjp3es"),O(o,"class","modal svelte-jjp3es"),O(o,"role","dialog"),O(o,"aria-modal","true")},m(h,j,C){k(h,e,j),k(h,n,j),k(h,o,j),x(o,l),x(o,s),x(o,r),x(r,i),x(i,a),x(a,c),x(r,p),x(r,d),x(d,u),x(u,_),x(_,v),x(_,f),x(_,g),x(g,y),x(y,b),x(_,$),x(_,P),x(_,S),x(_,q);for(let t=0;t<V.length;t+=1)V[t].m(q,null);x(_,U),x(_,B),x(B,N),x(B,A),x(B,H),C&&m(I),I=[E(e,"click",M(t[2])),E(l,"click",M(t[2])),E(v,"click",M(t[3])),E(P,"click",M(t[4])),E(o,"click",M(ft))]},p(t,[e]){if(3&e&&G!==(G=(t[0][t[1]].kindName||"Фото и схемы ДТП")+"")&&z(c,G),3&e&&b.src!==(L=""+(vt+t[0][t[1]].guid))&&O(b,"src",L),3&e&&F!==(F=""+(vt+t[0][t[1]].guid))&&O(y,"href",F),3&e){let n;for(Y=t[0],n=0;n<Y.length;n+=1){const o=ut(t,Y,n);V[n]?V[n].p(o,e):(V[n]=_t(o),V[n].c(),V[n].m(q,null))}for(;n<V.length;n+=1)V[n].d(1);V.length=Y.length}2&e&&R!==(R=t[1]+1+"")&&z(N,R),1&e&&Z!==(Z=t[0].length+"")&&z(H,Z)},i:h,o:h,d(t){t&&j(e),t&&j(n),t&&j(o),C(V,t),m(I)}}}const vt="//map.mvs.group/skpdi/proxy.php?guid=",ft=()=>{};function mt(t,e,n){const o=H();let{data:l}=e,s=0;return t.$set=t=>{"data"in t&&n(0,l=t.data)},[l,s,()=>{o("close")},()=>{s&&n(1,s--,s)},()=>{s<l.length-1&&n(1,s++,s)},o,t=>{n(1,s=t)}]}class gt extends dt{constructor(t){super(),pt(this,t,mt,ht,y,{data:0})}}function yt(t,e,n){const o=t.slice();return o[9]=e[n],o}function bt(t,e,n){const o=t.slice();return o[6]=e[n],o}function xt(t){let e,n,o,l=t[9].k_uch&&(t[9].npdd||t[9].sop_npdd)&&function(t){let e,n,o=t[9].k_uch+"";return{c(){e=D("li"),n=w(o)},m(t,o){k(t,e,o),x(e,n)},p:h,d(t){t&&j(e)}}}(t),s=t[9].npdd&&function(t){let e,n,o=t[9].npdd+"";return{c(){e=D("li"),n=w(o)},m(t,o){k(t,e,o),x(e,n)},p:h,d(t){t&&j(e)}}}(t),r=t[9].sop_npdd&&function(t){let e,n,o=t[9].sop_npdd+"";return{c(){e=D("li"),n=w(o)},m(t,o){k(t,e,o),x(e,n)},p:h,d(t){t&&j(e)}}}(t);return{c(){l&&l.c(),e=T(),s&&s.c(),n=T(),r&&r.c(),o=F()},m(t,i){l&&l.m(t,i),k(t,e,i),s&&s.m(t,i),k(t,n,i),r&&r.m(t,i),k(t,o,i)},p(t,e){t[9].k_uch&&(t[9].npdd||t[9].sop_npdd)&&l.p(t,e),t[9].npdd&&s.p(t,e),t[9].sop_npdd&&r.p(t,e)},d(t){l&&l.d(t),t&&j(e),s&&s.d(t),t&&j(n),r&&r.d(t),t&&j(o)}}}function kt(t){let e,n,o=t[6].ts&&function(t){let e,n,o=t[6].ts+"";return{c(){e=D("li"),n=w(o)},m(t,o){k(t,e,o),x(e,n)},p:h,d(t){t&&j(e)}}}(t),l=t[6].arr,s=[];for(let e=0;e<l.length;e+=1)s[e]=xt(yt(t,l,e));return{c(){o&&o.c(),e=T();for(let t=0;t<s.length;t+=1)s[t].c();n=F()},m(t,l){o&&o.m(t,l),k(t,e,l);for(let e=0;e<s.length;e+=1)s[e].m(t,l);k(t,n,l)},p(t,e){if(t[6].ts&&o.p(t,e),4&e){let o;for(l=t[6].arr,o=0;o<l.length;o+=1){const r=yt(t,l,o);s[o]?s[o].p(r,e):(s[o]=xt(r),s[o].c(),s[o].m(n.parentNode,n))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(t){o&&o.d(t),t&&j(e),C(s,t),t&&j(n)}}}function jt(t){let e,n,o,l,s,r=t[0].spog+"";return{c(){e=D("div"),n=D("div"),n.textContent="Погода:",o=T(),l=D("div"),s=w(r),O(n,"class","stitle"),O(l,"class","sval")},m(t,r){k(t,e,r),x(e,n),x(e,o),x(e,l),x(l,s)},p(t,e){1&e&&r!==(r=t[0].spog+"")&&z(s,r)},d(t){t&&j(e)}}}function Ct(t){let e,n,o,l,s,r=t[0].s_pch+"";return{c(){e=D("div"),n=D("div"),n.textContent="Покрытие:",o=T(),l=D("div"),s=w(r),O(n,"class","stitle"),O(l,"class","sval")},m(t,r){k(t,e,r),x(e,n),x(e,o),x(e,l),x(l,s)},p(t,e){1&e&&r!==(r=t[0].s_pch+"")&&z(s,r)},d(t){t&&j(e)}}}function Lt(t){let e,n,o,l,s,r=t[0].osv+"";return{c(){e=D("div"),n=D("div"),n.textContent="Освещенность:",o=T(),l=D("div"),s=w(r),O(n,"class","stitle"),O(l,"class","sval")},m(t,r){k(t,e,r),x(e,n),x(e,o),x(e,l),x(l,s)},p(t,e){1&e&&r!==(r=t[0].osv+"")&&z(s,r)},d(t){t&&j(e)}}}function Dt(t){let e,n,o,l,s,r=t[0].ndu+"";return{c(){e=D("div"),n=D("div"),n.textContent="Иные условия:",o=T(),l=D("div"),s=w(r),O(n,"class","stitle"),O(l,"class","sval")},m(t,r){k(t,e,r),x(e,n),x(e,o),x(e,l),x(l,s)},p(t,e){1&e&&r!==(r=t[0].ndu+"")&&z(s,r)},d(t){t&&j(e)}}}function wt(t){let e,n,o,l,s,r,i,a,c,p,d,u,_,v,f,m,g,y,b,L,F,M,$,P,S,q,U,B,N,A,H,I,G,R,Z,Y,V,J,K,W,Q,X,tt,et,nt,ot,lt,st,rt,it,at,ct,pt,dt,ut,_t,ht,vt,ft,mt,gt,yt=(t[0].name||t[0].dtvp||"")+"",xt=(t[0].district||"")+"",wt=(t[0].dor||"")+"",Tt=t[0].lat+"",Ft=t[0].lon+"",Et=(t[0].collision_date||t[0].dtp_date||"")+"",Mt=(t[0].dtvp||"")+"",Ot=t[0].pog+"",zt=t[0].ran+"",$t=t[2],Pt=[];for(let e=0;e<$t.length;e+=1)Pt[e]=kt(bt(t,$t,e));let St=t[0].spog&&jt(t),qt=t[0].s_pch&&Ct(t),Ut=t[0].osv&&Lt(t),Bt=t[0].ndu&&Dt(t);return{c(){e=D("div"),n=D("div"),o=D("b"),l=w(yt),s=T(),r=D("div"),i=D("table"),a=D("tbody"),c=D("tr"),p=D("td"),p.textContent="Адрес:",d=T(),u=D("td"),_=w(xt),v=T(),f=w(wt),m=T(),g=D("tr"),y=D("td"),y.textContent="Координаты:",b=T(),L=D("td"),F=w(Tt),M=T(),$=w(Ft),P=T(),S=D("span"),q=T(),U=D("tr"),B=D("td"),B.textContent="Дата/время:",N=T(),A=D("td"),H=w(Et),I=T(),G=D("tr"),R=D("td"),R.textContent="Вид ДТП:",Z=T(),Y=D("td"),V=w(Mt),J=T(),K=D("tr"),W=D("td"),W.textContent="Нарушения:",Q=T(),X=D("td"),tt=D("ul");for(let t=0;t<Pt.length;t+=1)Pt[t].c();et=T(),nt=D("tr"),ot=D("td"),ot.textContent="Условия:",lt=T(),st=D("td"),St&&St.c(),rt=T(),qt&&qt.c(),it=T(),Ut&&Ut.c(),at=T(),Bt&&Bt.c(),ct=T(),pt=D("tr"),dt=D("td"),dt.textContent="Количество погибших/раненых:",ut=T(),_t=D("td"),ht=D("b"),vt=w(Ot),ft=w("/"),mt=w(zt),O(n,"class","pLine"),O(p,"class","first svelte-ipyqnf"),O(y,"class","first svelte-ipyqnf"),O(S,"title","Скопировать в буфер обмена"),O(S,"class","leaflet-gmx-icon-copy"),O(B,"class","first svelte-ipyqnf"),O(R,"class","first svelte-ipyqnf"),O(W,"class","first svelte-ipyqnf"),O(ot,"class","first svelte-ipyqnf"),O(dt,"class","first svelte-ipyqnf"),O(i,"class","table"),O(r,"class","featureCont"),O(e,"class","mvsPopup svelte-ipyqnf")},m(h,j,C){k(h,e,j),x(e,n),x(n,o),x(o,l),x(e,s),x(e,r),x(r,i),x(i,a),x(a,c),x(c,p),x(c,d),x(c,u),x(u,_),x(u,v),x(u,f),x(a,m),x(a,g),x(g,y),x(g,b),x(g,L),x(L,F),x(L,M),x(L,$),x(L,P),x(L,S),x(a,q),x(a,U),x(U,B),x(U,N),x(U,A),x(A,H),x(a,I),x(a,G),x(G,R),x(G,Z),x(G,Y),x(Y,V),x(a,J),x(a,K),x(K,W),x(K,Q),x(K,X),x(X,tt);for(let t=0;t<Pt.length;t+=1)Pt[t].m(tt,null);x(a,et),x(a,nt),x(nt,ot),x(nt,lt),x(nt,st),St&&St.m(st,null),x(st,rt),qt&&qt.m(st,null),x(st,it),Ut&&Ut.m(st,null),x(st,at),Bt&&Bt.m(st,null),x(a,ct),x(a,pt),x(pt,dt),x(pt,ut),x(pt,_t),x(_t,ht),x(ht,vt),x(ht,ft),x(ht,mt),C&&gt(),gt=E(S,"click",t[1])},p(t,[e]){if(1&e&&yt!==(yt=(t[0].name||t[0].dtvp||"")+"")&&z(l,yt),1&e&&xt!==(xt=(t[0].district||"")+"")&&z(_,xt),1&e&&wt!==(wt=(t[0].dor||"")+"")&&z(f,wt),1&e&&Tt!==(Tt=t[0].lat+"")&&z(F,Tt),1&e&&Ft!==(Ft=t[0].lon+"")&&z($,Ft),1&e&&Et!==(Et=(t[0].collision_date||t[0].dtp_date||"")+"")&&z(H,Et),1&e&&Mt!==(Mt=(t[0].dtvp||"")+"")&&z(V,Mt),4&e){let n;for($t=t[2],n=0;n<$t.length;n+=1){const o=bt(t,$t,n);Pt[n]?Pt[n].p(o,e):(Pt[n]=kt(o),Pt[n].c(),Pt[n].m(tt,null))}for(;n<Pt.length;n+=1)Pt[n].d(1);Pt.length=$t.length}t[0].spog?St?St.p(t,e):(St=jt(t),St.c(),St.m(st,rt)):St&&(St.d(1),St=null),t[0].s_pch?qt?qt.p(t,e):(qt=Ct(t),qt.c(),qt.m(st,it)):qt&&(qt.d(1),qt=null),t[0].osv?Ut?Ut.p(t,e):(Ut=Lt(t),Ut.c(),Ut.m(st,at)):Ut&&(Ut.d(1),Ut=null),t[0].ndu?Bt?Bt.p(t,e):(Bt=Dt(t),Bt.c(),Bt.m(st,null)):Bt&&(Bt.d(1),Bt=null),1&e&&Ot!==(Ot=t[0].pog+"")&&z(vt,Ot),1&e&&zt!==(zt=t[0].ran+"")&&z(mt,zt)},i:h,o:h,d(t){t&&j(e),C(Pt,t),St&&St.d(),qt&&qt.d(),Ut&&Ut.d(),Bt&&Bt.d(),gt()}}}function Tt(t,e,n){let o,{showModal:l=!1}=e,{prp:s}=e;s.skpdiFiles;A(()=>{l&&(o=new gt({target:document.body,props:{data:s.skpdiFiles}}),o.$on("close",t=>{o.$destroy(),n(3,l=!1)}))});const r=(s.tsInfo||[]).map(t=>{let e=t.ts_uch||[];return{ts:"Осталось на месте ДТП"!==t.ts?t.ts:"",arr:e.map(t=>({k_uch:t.k_uch||"",npdd:"Нет нарушений"!==t.npdd?t.npdd:"",sop_npdd:"Нет нарушений"!==t.sop_npdd?t.sop_npdd:""}))}});return t.$set=t=>{"showModal"in t&&n(3,l=t.showModal),"prp"in t&&n(0,s=t.prp)},[s,t=>{navigator.clipboard.writeText(t.target.parentNode.textContent).catch(t=>{console.log("Something went wrong",t)})},r,l]}class Ft extends dt{constructor(t){super(),pt(this,t,Tt,wt,y,{showModal:3,prp:0})}}const Et=window.L,Mt=Et.popup();let Ot;const zt=Et.featureGroup([]);function $t(t,e,n){const o=t.slice();return o[6]=e[n],o}function Pt(t,e,n){const o=t.slice();return o[6]=e[n],o}function St(t){let e,n=t[1].collisionTypes,o=[];for(let e=0;e<n.length;e+=1)o[e]=qt(Pt(t,n,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=F()},m(t,n){for(let e=0;e<o.length;e+=1)o[e].m(t,n);k(t,e,n)},p(t,l){if(2&l){let s;for(n=t[1].collisionTypes,s=0;s<n.length;s+=1){const r=Pt(t,n,s);o[s]?o[s].p(r,l):(o[s]=qt(r),o[s].c(),o[s].m(e.parentNode,e))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(t){C(o,t),t&&j(e)}}}function qt(t){let e,n,o=(t[6].collisionType||"")+"";return{c(){e=D("li"),n=w(o)},m(t,o){k(t,e,o),x(e,n)},p(t,e){2&e&&o!==(o=(t[6].collisionType||"")+"")&&z(n,o)},d(t){t&&j(e)}}}function Ut(t){let e,n=t[1].uchs,o=[];for(let e=0;e<n.length;e+=1)o[e]=Bt($t(t,n,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=F()},m(t,n){for(let e=0;e<o.length;e+=1)o[e].m(t,n);k(t,e,n)},p(t,l){if(2&l){let s;for(n=t[1].uchs,s=0;s<n.length;s+=1){const r=$t(t,n,s);o[s]?o[s].p(r,l):(o[s]=Bt(r),o[s].c(),o[s].m(e.parentNode,e))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(t){C(o,t),t&&j(e)}}}function Bt(t){let e,n,o,l,s,r,i,a,c=(t[6].collisionPartyCategory||"")+"",p=(t[6].collisionPartyCond||"")+"";return{c(){e=D("li"),n=w(c),o=T(),l=D("b"),s=D("i"),r=w("("),i=w(p),a=w(")")},m(t,c){k(t,e,c),x(e,n),x(e,o),x(e,l),x(l,s),x(s,r),x(s,i),x(s,a)},p(t,e){2&e&&c!==(c=(t[6].collisionPartyCategory||"")+"")&&z(n,c),2&e&&p!==(p=(t[6].collisionPartyCond||"")+"")&&z(i,p)},d(t){t&&j(e)}}}function Nt(t){let e,n,o,l,s,r,i,a,c,p,d,u,_,v,f,g,y,b,C,L,F,M,$,P,S,q,U,B,N,A,H,I,G,R,Z,Y,V,J,K,W,Q,X,tt,et,nt,ot,lt,st,rt=(t[1].name||t[1].dtvp||"")+"",it=t[1].lat+"",at=t[1].lon+"",ct=(t[1].collision_date||t[1].dtp_date||"")+"",pt=(t[1].collision_context||t[1].dtp_date||"")+"",dt=t[1].collisionTypes&&t[1].collisionTypes.length&&St(t),ut=t[1].uchs&&t[1].uchs.length&&Ut(t);return{c(){e=D("div"),n=D("div"),o=D("b"),l=w(rt),s=T(),r=D("div"),i=D("table"),a=D("tbody"),c=D("tr"),p=D("td"),p.textContent="Координаты:",d=T(),u=D("td"),_=w(it),v=T(),f=w(at),g=T(),y=D("span"),b=T(),C=D("tr"),L=D("td"),L.textContent="Дата/время:",F=T(),M=D("td"),$=w(ct),P=T(),S=D("tr"),q=D("td"),U=D("div"),U.textContent="Условия ДТП:",B=T(),N=D("div"),A=w(pt),H=T(),I=D("tr"),G=D("td"),G.textContent="Нарушения:",R=T(),Z=D("td"),Y=D("ul"),dt&&dt.c(),V=T(),J=D("tr"),K=D("td"),K.textContent="Участники:",W=T(),Q=D("td"),X=D("ul"),ut&&ut.c(),tt=T(),et=D("tr"),nt=D("td"),ot=D("button"),lt=w("Фото и схемы"),O(n,"class","pLine"),O(p,"class","first"),O(y,"title","Скопировать в буфер обмена"),O(y,"class","leaflet-gmx-icon-copy"),O(L,"class","first"),O(U,"class","first"),O(q,"colspan","2"),O(G,"class","first"),O(K,"class","first"),O(ot,"class","primary svelte-1aipaym"),ot.disabled=t[2],O(nt,"class","center"),O(nt,"colspan","2"),O(i,"class","table"),O(r,"class","featureCont"),O(e,"class","mvsPopup")},m(h,j,D){k(h,e,j),x(e,n),x(n,o),x(o,l),x(e,s),x(e,r),x(r,i),x(i,a),x(a,c),x(c,p),x(c,d),x(c,u),x(u,_),x(u,v),x(u,f),x(u,g),x(u,y),x(a,b),x(a,C),x(C,L),x(C,F),x(C,M),x(M,$),x(a,P),x(a,S),x(S,q),x(q,U),x(q,B),x(q,N),x(N,A),x(a,H),x(a,I),x(I,G),x(I,R),x(I,Z),x(Z,Y),dt&&dt.m(Y,null),x(a,V),x(a,J),x(J,K),x(J,W),x(J,Q),x(Q,X),ut&&ut.m(X,null),x(a,tt),x(a,et),x(et,nt),x(nt,ot),x(ot,lt),D&&m(st),st=[E(y,"click",t[3]),E(ot,"click",t[5])]},p(t,[e]){2&e&&rt!==(rt=(t[1].name||t[1].dtvp||"")+"")&&z(l,rt),2&e&&it!==(it=t[1].lat+"")&&z(_,it),2&e&&at!==(at=t[1].lon+"")&&z(f,at),2&e&&ct!==(ct=(t[1].collision_date||t[1].dtp_date||"")+"")&&z($,ct),2&e&&pt!==(pt=(t[1].collision_context||t[1].dtp_date||"")+"")&&z(A,pt),t[1].collisionTypes&&t[1].collisionTypes.length?dt?dt.p(t,e):(dt=St(t),dt.c(),dt.m(Y,null)):dt&&(dt.d(1),dt=null),t[1].uchs&&t[1].uchs.length?ut?ut.p(t,e):(ut=Ut(t),ut.c(),ut.m(X,null)):ut&&(ut.d(1),ut=null),4&e&&(ot.disabled=t[2])},i:h,o:h,d(t){t&&j(e),dt&&dt.d(),ut&&ut.d(),m(st)}}}function At(t,e,n){let o,{showModal:l=!1}=e,{prp:s}=e,r=s.files&&s.files.length?"":"disabled";A(()=>{n(2,r=s.files&&s.files.length?"":"disabled"),l&&(o=new gt({target:document.body,props:{data:s.files}}),o.$on("close",t=>{o.$destroy(),n(0,l=!1)}))});return t.$set=t=>{"showModal"in t&&n(0,l=t.showModal),"prp"in t&&n(1,s=t.prp)},[l,s,r,t=>{navigator.clipboard.writeText(t.target.parentNode.textContent).catch(t=>{console.log("Something went wrong",t)})},o,()=>n(0,l=!0)]}zt.setFilter=t=>{zt.clearLayers(),Ot=t;let e=[];zt._group&&(zt._group.getLayers().forEach(t=>{let n=t.options.props,o=0;Ot.forEach(t=>{"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===n.collision_type).length)&&o++:"date"===t.type&&n.date>=t.zn[0]&&n.date<t.zn[1]&&o++}),o===Ot.length&&e.push(t)}),zt.addLayer(Et.layerGroup(e)))},zt.on("remove",()=>{zt.clearLayers()}).on("add",t=>{fetch("https://dtp.mvs.group/scripts/index.php?request=get_stat_gipdd",{}).then(t=>t.json()).then(t=>{let e={collision_type:{},iconType:{}},n=t.map(t=>{let n=t.iconType||0,o=!1,l="#2F4F4F";n&&(o=n%2==0,n>=1&&n<=6?l="#8B4513":7===n||8===n?l="#228B22":n>=9&&n<=14?l="#8B4513":15===n||16===n?l="#7B68EE":17!==n&&18!==n||(l="#2F4F4F")),t.lat&&t.lon||(console.log("_______",t),t.lat=t.lon=0);let s=e.collision_type[t.collision_type];return s?s++:s=1,e.collision_type[t.collision_type]=s,e.iconType[t.collision_type]=n,new _(Et.latLng(t.lat,t.lon),{props:t,radius:6,stroke:o,fillColor:l}).bindPopup(Mt).on("popupopen",t=>{var e;e=t.target.options.props.id,fetch("https://dtp.mvs.group/scripts/index.php?request=get_dtp_id&id="+e+"&type=gibdd",{}).then(t=>t.json()).then(t=>{let e=Et.DomUtil.create("div");const n=new Ft({target:e,props:{prp:t}});Mt._svObj=n,Mt.setContent(e)})}).on("popupclose",t=>{console.log("popupclose",t),t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});zt._opt=e,zt._group=Et.layerGroup(n),Ot?zt.setFilter(Ot):zt.addLayer(zt._group),zt._refreshFilters()})});class Ht extends dt{constructor(t){super(),pt(this,t,At,Nt,y,{showModal:0,prp:1})}}const It=window.L,Gt=It.popup();let Rt;const Zt=It.featureGroup([]);function Yt(t,e,n){const o=t.slice();return o[6]=e[n],o[8]=n,o}function Vt(t){let e,n,o,l,s,r="gibdd"===t[6].type?"ГИБДД":"СКПДИ";return{c(){e=D("button"),n=w(r),O(e,"class",o=b(t[2]===t[8]?"current":"")+" svelte-txaali"),e.value=l=t[8]},m(o,l,r){k(o,e,l),x(e,n),r&&s(),s=E(e,"click",t[4])},p(t,l){1&l&&r!==(r="gibdd"===t[6].type?"ГИБДД":"СКПДИ")&&z(n,r),4&l&&o!==(o=b(t[2]===t[8]?"current":"")+" svelte-txaali")&&O(e,"class",o)},d(t){t&&j(e),s()}}}function Jt(t){let e;const n=new Ht({props:{prp:t[3]}});return{c(){rt(n.$$.fragment)},m(t,o){it(n,t,o),e=!0},p(t,e){const o={};8&e&&(o.prp=t[3]),n.$set(o)},i(t){e||(lt(n.$$.fragment,t),e=!0)},o(t){st(n.$$.fragment,t),e=!1},d(t){at(n,t)}}}function Kt(t){let e;const n=new Ft({props:{prp:t[3]}});return{c(){rt(n.$$.fragment)},m(t,o){it(n,t,o),e=!0},p(t,e){const o={};8&e&&(o.prp=t[3]),n.$set(o)},i(t){e||(lt(n.$$.fragment,t),e=!0)},o(t){st(n.$$.fragment,t),e=!1},d(t){at(n,t)}}}function Wt(t){let e,n,o,l,s,r,i,a,c,p,d=t[0]._cur,u=[];for(let e=0;e<d.length;e+=1)u[e]=Vt(Yt(t,d,e));const _=[Kt,Jt],h=[];function v(t,e){return"gibdd"===t[0]._cur[t[2]].type?0:1}return i=v(t),a=h[i]=_[i](t),{c(){e=D("div"),n=D("div"),o=D("a"),o.textContent="×",l=T(),s=D("div");for(let t=0;t<u.length;t+=1)u[t].c();r=T(),a.c(),O(o,"class","leaflet-popup-close-button"),O(o,"href","#close"),O(n,"class","close"),O(s,"class","pLine"),O(e,"class","mvsPopup")},m(a,d,_){k(a,e,d),x(e,n),x(n,o),x(e,l),x(e,s);for(let t=0;t<u.length;t+=1)u[t].m(s,null);var v;x(e,r),h[i].m(e,null),c=!0,_&&p(),p=E(o,"click",(v=function(){g(t[1])&&t[1].apply(this,arguments)},function(t){return t.preventDefault(),v.call(this,t)}))},p(n,[o]){if(t=n,21&o){let e;for(d=t[0]._cur,e=0;e<d.length;e+=1){const n=Yt(t,d,e);u[e]?u[e].p(n,o):(u[e]=Vt(n),u[e].c(),u[e].m(s,null))}for(;e<u.length;e+=1)u[e].d(1);u.length=d.length}let l=i;i=v(t),i===l?h[i].p(t,o):(nt(),st(h[l],1,1,()=>{h[l]=null}),ot(),a=h[i],a||(a=h[i]=_[i](t),a.c()),lt(a,1),a.m(e,null))},i(t){c||(lt(a),c=!0)},o(t){st(a),c=!1},d(t){t&&j(e),C(u,t),h[i].d(),p()}}}function Qt(t,e,n){let{prp:o}=e,{closeMe:l=(()=>{})}=e,s=0,r={};const i=t=>{let e=o._cur[t],l=e.type,s="https://dtp.mvs.group/scripts/index.php?request=get_dtp_id&id="+e.id+"&type="+l;fetch(s,{}).then(t=>t.json()).then(t=>{n(3,r=t)})};return i(s),t.$set=t=>{"prp"in t&&n(0,o=t.prp),"closeMe"in t&&n(1,l=t.closeMe)},[o,l,s,r,t=>{let e=t.target,o=Number(e.value);s!==o&&(n(2,s=o),i(s))}]}Zt.setFilter=t=>{Zt.clearLayers(),Rt=t;let e=[];Zt._group&&(Zt._group.getLayers().forEach(t=>{let n=t.options.props,o=0;Rt.forEach(t=>{"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===n.collision_type).length)&&o++:"date"===t.type&&n.date>=t.zn[0]&&n.date<t.zn[1]&&o++}),o===Rt.length&&e.push(t)}),Zt.addLayer(It.layerGroup(e)))},Zt.on("remove",()=>{Zt.clearLayers()}).on("add",t=>{fetch("https://dtp.mvs.group/scripts/index.php?request=get_skpdi",{}).then(t=>t.json()).then(t=>{let e={collision_type:{},iconType:{}},n=t.map(t=>{let n=t.iconType||0,o=!1,l="#2F4F4F";n&&(o=n%2==0,n>=1&&n<=6?l="#8B4513":7===n||8===n?l="#228B22":n>=9&&n<=14?l="#8B4513":15===n||16===n?l="#7B68EE":17!==n&&18!==n||(l="#2F4F4F")),t.lat&&t.lon||(console.log("_______",t),t.lat=t.lon=0);let s=e.collision_type[t.collision_type];return s?s++:s=1,e.collision_type[t.collision_type]=s,e.iconType[t.collision_type]=n,new _(It.latLng(t.lat,t.lon),{props:t,radius:6,box:!0,stroke:o,fillColor:l}).bindPopup(Gt).on("popupopen",t=>{var e;e=t.target.options.props.id,fetch("https://dtp.mvs.group/scripts/index.php?request=get_dtp_id&id="+e+"&type=skpdi",{}).then(t=>t.json()).then(t=>{let e=It.DomUtil.create("div");const n=new Ht({target:e,props:{prp:t}});Gt._svObj=n,Gt.setContent(e)})}).on("popupclose",t=>{console.log("popupclose",t),t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});Zt._opt=e,Zt._group=It.layerGroup(n),Rt?Zt.setFilter(Rt):Zt.addLayer(Zt._group),Zt._refreshFilters()})});class Xt extends dt{constructor(t){super(),pt(this,t,Qt,Wt,y,{prp:0,closeMe:1})}}const te=window.L,ee=te.popup();let ne;const oe=te.featureGroup([]);function le(t,e,n){const o=t.slice();return o[110]=e[n],o}function se(t,e,n){const o=t.slice();return o[110]=e[n],o}function re(t,e,n){const o=t.slice();return o[110]=e[n],o}function ie(t,e,n){const o=t.slice();return o[110]=e[n],o}function ae(t,e,n){const o=t.slice();return o[121]=e[n],o}function ce(t,e,n){const o=t.slice();return o[110]=e[n],o}function pe(t,e,n){const o=t.slice();return o[110]=e[n],o}function de(t,e,n){const o=t.slice();return o[110]=e[n],o}function ue(t,e,n){const o=t.slice();return o[121]=e[n],o}function _e(t,e,n){const o=t.slice();return o[110]=e[n],o}function he(t,e,n){const o=t.slice();return o[110]=e[n],o}function ve(t,e,n){const o=t.slice();return o[110]=e[n],o}function fe(t,e,n){const o=t.slice();return o[121]=e[n],o}function me(t,e,n){const o=t.slice();return o[110]=e[n],o}function ge(t,e,n){const o=t.slice();return o[110]=e[n],o}function ye(t,e,n){const o=t.slice();return o[110]=e[n],o}function be(t,e,n){const o=t.slice();return o[110]=e[n],o}function xe(t,e,n){const o=t.slice();return o[110]=e[n],o}function ke(t,e,n){const o=t.slice();return o[110]=e[n],o}function je(t){let e,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,g,y,b,L,w,F,M,z,S,q,U,B=Object.keys(t[1]._opt.years).sort(),N=[];for(let e=0;e<B.length;e+=1)N[e]=Ce(ke(t,B,e));let A=t[51],H=[];for(let e=0;e<A.length;e+=1)H[e]=Le(xe(t,A,e));return{c(){e=D("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (5)</b>",n=T(),o=D("div"),l=D("div"),s=D("fieldset"),r=D("legend"),r.textContent="Фильтрация по периодам:",i=T(),a=D("div"),c=D("input"),u=D("label"),u.textContent="Фильтрация по годам",_=T(),h=D("div");for(let t=0;t<N.length;t+=1)N[t].c();v=T(),f=D("div"),g=D("select"),y=D("option"),y.textContent=`\n\t\t\t\t\t\tВсе типы (${t[51].reduce(t[80],0)})\n\t\t\t\t\t`;for(let t=0;t<H.length;t+=1)H[t].c();b=T(),L=D("div"),w=D("select"),F=D("option"),F.textContent="Очаги все",M=D("option"),M.textContent="Только с погибшими",z=D("option"),z.textContent="Только с пострадавшими",S=D("option"),S.textContent="С пострадавшими или погибшими",q=D("option"),q.textContent="С пострадавшими и погибшими",O(e,"class","pLine svelte-1jsovbn"),O(c,"type","radio"),c.__value=p=1,c.value=c.__value,c.checked=d=1===t[15],O(c,"id","hearths_period_type_51"),O(c,"name","hearths_period_type_5"),O(c,"class","svelte-1jsovbn"),t[79][4].push(c),O(u,"for","hearths_period_type_51"),O(u,"class","svelte-1jsovbn"),O(h,"class","pLine margin svelte-1jsovbn"),O(a,"class","pLine type svelte-1jsovbn"),O(l,"class","pLine nowrap svelte-1jsovbn"),y.__value="",y.value=y.__value,O(y,"class","svelte-1jsovbn"),O(g,"class","multiple_icon_typeTmp svelte-1jsovbn"),g.multiple=!0,void 0===t[14]&&J(()=>t[81].call(g)),O(f,"class","pLine svelte-1jsovbn"),F.__value="",F.value=F.__value,M.__value="1",M.value=M.__value,z.__value="2",z.value=z.__value,S.__value="3",S.value=S.__value,q.__value="4",q.value=q.__value,O(w,"class","svelte-1jsovbn"),void 0===t[13]&&J(()=>t[82].call(w)),O(L,"class","pLine svelte-1jsovbn"),O(o,"class","filtersCont svelte-1jsovbn")},m(p,d,j){k(p,e,d),k(p,n,d),k(p,o,d),x(o,l),x(l,s),x(s,r),x(s,i),x(s,a),x(a,c),c.checked=c.__value===t[15],x(a,u),x(a,_),x(a,h);for(let t=0;t<N.length;t+=1)N[t].m(h,null);x(o,v),x(o,f),x(f,g),x(g,y);for(let t=0;t<H.length;t+=1)H[t].m(g,null);P(g,t[14]),x(o,b),x(o,L),x(L,w),x(w,F),x(w,M),x(w,z),x(w,S),x(w,q),$(w,t[13]),j&&m(U),U=[E(c,"change",t[58]),E(c,"change",t[78]),E(g,"change",t[81]),E(g,"change",t[58]),E(w,"change",t[82]),E(w,"change",t[58])]},p(t,e){if(32768&e[0]&&d!==(d=1===t[15])&&(c.checked=d),32768&e[0]&&(c.checked=c.__value===t[15]),98306&e[0]|134217728&e[1]){let n;for(B=Object.keys(t[1]._opt.years).sort(),n=0;n<B.length;n+=1){const o=ke(t,B,n);N[n]?N[n].p(o,e):(N[n]=Ce(o),N[n].c(),N[n].m(h,null))}for(;n<N.length;n+=1)N[n].d(1);N.length=B.length}if(1572864&e[1]){let n;for(A=t[51],n=0;n<A.length;n+=1){const o=xe(t,A,n);H[n]?H[n].p(o,e):(H[n]=Le(o),H[n].c(),H[n].m(g,null))}for(;n<H.length;n+=1)H[n].d(1);H.length=A.length}16384&e[0]&&P(g,t[14]),8192&e[0]&&$(w,t[13])},d(l){l&&j(e),l&&j(n),l&&j(o),t[79][4].splice(t[79][4].indexOf(c),1),C(N,l),C(H,l),m(U)}}}function Ce(t){let e,n,o,l,s,r,i,a=t[110]+"";return{c(){e=D("input"),s=D("label"),r=w(a),O(e,"type","checkbox"),O(e,"id","hearths_year_5"),e.checked=n=t[16][t[110]],e.disabled=o=2===t[15],O(e,"name",l=t[110]),O(e,"class","svelte-1jsovbn"),O(s,"for","hearths_year_5"),O(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,e,o),k(n,s,o),x(s,r),l&&i(),i=E(e,"change",t[58])},p(t,s){65538&s[0]&&n!==(n=t[16][t[110]])&&(e.checked=n),32768&s[0]&&o!==(o=2===t[15])&&(e.disabled=o),2&s[0]&&l!==(l=t[110])&&O(e,"name",l),2&s[0]&&a!==(a=t[110]+"")&&z(r,a)},d(t){t&&j(e),t&&j(s),i()}}}function Le(t){let e,n,o,l,s,r,i,a=t[110]+"",c=t[50].str_icon_type[t[110]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[110],e.value=e.__value,O(e,"class",i="icon_type_"+t[50].iconType[t[110]]+" svelte-1jsovbn")},m(t,r){k(t,e,r),x(e,n),x(e,o),x(e,l),x(e,s)},p:h,d(t){t&&j(e)}}}function De(t){let e,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,g,y,b,L,w,F,M,z,S,q,U,B=Object.keys(t[2]._opt.years).sort(),N=[];for(let e=0;e<B.length;e+=1)N[e]=we(be(t,B,e));let A=t[49],H=[];for(let e=0;e<A.length;e+=1)H[e]=Te(ye(t,A,e));return{c(){e=D("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (3)</b>",n=T(),o=D("div"),l=D("div"),s=D("fieldset"),r=D("legend"),r.textContent="Фильтрация по периодам:",i=T(),a=D("div"),c=D("input"),u=D("label"),u.textContent="Фильтрация по годам",_=T(),h=D("div");for(let t=0;t<N.length;t+=1)N[t].c();v=T(),f=D("div"),g=D("select"),y=D("option"),y.textContent=`\n\t\t\t\t\t\tВсе типы (${t[49].reduce(t[84],0)})\n\t\t\t\t\t`;for(let t=0;t<H.length;t+=1)H[t].c();b=T(),L=D("div"),w=D("select"),F=D("option"),F.textContent="Очаги все",M=D("option"),M.textContent="Только с погибшими",z=D("option"),z.textContent="Только с пострадавшими",S=D("option"),S.textContent="С пострадавшими или погибшими",q=D("option"),q.textContent="С пострадавшими и погибшими",O(e,"class","pLine svelte-1jsovbn"),O(c,"type","radio"),c.__value=p=1,c.value=c.__value,c.checked=d=1===t[19],O(c,"id","hearths_period_type_31"),O(c,"name","hearths_period_type_3"),O(c,"class","svelte-1jsovbn"),t[79][3].push(c),O(u,"for","hearths_period_type_31"),O(u,"class","svelte-1jsovbn"),O(h,"class","pLine margin svelte-1jsovbn"),O(a,"class","pLine type svelte-1jsovbn"),O(l,"class","pLine nowrap svelte-1jsovbn"),y.__value="",y.value=y.__value,O(y,"class","svelte-1jsovbn"),O(g,"class","multiple_icon_typeTmp svelte-1jsovbn"),g.multiple=!0,void 0===t[18]&&J(()=>t[85].call(g)),O(f,"class","pLine svelte-1jsovbn"),F.__value="",F.value=F.__value,M.__value="1",M.value=M.__value,z.__value="2",z.value=z.__value,S.__value="3",S.value=S.__value,q.__value="4",q.value=q.__value,O(w,"class","svelte-1jsovbn"),void 0===t[17]&&J(()=>t[86].call(w)),O(L,"class","pLine svelte-1jsovbn"),O(o,"class","filtersCont svelte-1jsovbn")},m(p,d,j){k(p,e,d),k(p,n,d),k(p,o,d),x(o,l),x(l,s),x(s,r),x(s,i),x(s,a),x(a,c),c.checked=c.__value===t[19],x(a,u),x(a,_),x(a,h);for(let t=0;t<N.length;t+=1)N[t].m(h,null);x(o,v),x(o,f),x(f,g),x(g,y);for(let t=0;t<H.length;t+=1)H[t].m(g,null);P(g,t[18]),x(o,b),x(o,L),x(L,w),x(w,F),x(w,M),x(w,z),x(w,S),x(w,q),$(w,t[17]),j&&m(U),U=[E(c,"change",t[59]),E(c,"change",t[83]),E(g,"change",t[85]),E(g,"change",t[59]),E(w,"change",t[86]),E(w,"change",t[59])]},p(t,e){if(524288&e[0]&&d!==(d=1===t[19])&&(c.checked=d),524288&e[0]&&(c.checked=c.__value===t[19]),1572868&e[0]|268435456&e[1]){let n;for(B=Object.keys(t[2]._opt.years).sort(),n=0;n<B.length;n+=1){const o=be(t,B,n);N[n]?N[n].p(o,e):(N[n]=we(o),N[n].c(),N[n].m(h,null))}for(;n<N.length;n+=1)N[n].d(1);N.length=B.length}if(393216&e[1]){let n;for(A=t[49],n=0;n<A.length;n+=1){const o=ye(t,A,n);H[n]?H[n].p(o,e):(H[n]=Te(o),H[n].c(),H[n].m(g,null))}for(;n<H.length;n+=1)H[n].d(1);H.length=A.length}262144&e[0]&&P(g,t[18]),131072&e[0]&&$(w,t[17])},d(l){l&&j(e),l&&j(n),l&&j(o),t[79][3].splice(t[79][3].indexOf(c),1),C(N,l),C(H,l),m(U)}}}function we(t){let e,n,o,l,s,r,i,a=t[110]+"";return{c(){e=D("input"),s=D("label"),r=w(a),O(e,"type","checkbox"),O(e,"id","hearths_year_3"),e.checked=n=t[20][t[110]],e.disabled=o=2===t[19],O(e,"name",l=t[110]),O(e,"class","svelte-1jsovbn"),O(s,"for","hearths_year_3"),O(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,e,o),k(n,s,o),x(s,r),l&&i(),i=E(e,"change",t[59])},p(t,s){1048580&s[0]&&n!==(n=t[20][t[110]])&&(e.checked=n),524288&s[0]&&o!==(o=2===t[19])&&(e.disabled=o),4&s[0]&&l!==(l=t[110])&&O(e,"name",l),4&s[0]&&a!==(a=t[110]+"")&&z(r,a)},d(t){t&&j(e),t&&j(s),i()}}}function Te(t){let e,n,o,l,s,r,i,a=t[110]+"",c=t[48].str_icon_type[t[110]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[110],e.value=e.__value,O(e,"class",i="icon_type_"+t[48].iconType[t[110]]+" svelte-1jsovbn")},m(t,r){k(t,e,r),x(e,n),x(e,o),x(e,l),x(e,s)},p:h,d(t){t&&j(e)}}}function Fe(t){let e,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,g,y,b,L,w,F,M,z,S,q,U,B,N,A,H,I,G,R,Z=Object.keys(t[3]._opt.years).sort(),Y=[];for(let e=0;e<Z.length;e+=1)Y[e]=Ee(ge(t,Z,e));let V=Object.keys(t[3]._opt.years).sort(),K=[];for(let e=0;e<V.length;e+=1)K[e]=Oe(me(t,V,e));let W=t[47],Q=[];for(let e=0;e<W.length;e+=1)Q[e]=ze(ve(t,W,e));return{c(){e=D("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (Stat)</b>",n=T(),o=D("div"),l=D("div"),s=D("fieldset"),r=D("legend"),r.textContent="Фильтрация по периодам:",i=T(),a=D("div"),c=D("input"),u=D("label"),u.textContent="Фильтрация по годам",_=T(),h=D("div");for(let t=0;t<Y.length;t+=1)Y[t].c();v=T(),f=D("div"),g=D("input"),b=D("label"),b.textContent="Фильтрация по кварталам",L=T(),w=D("div");for(let t=0;t<K.length;t+=1)K[t].c();F=T(),M=D("div"),z=D("select"),S=D("option"),S.textContent=`\n\t\t\t\t\t\tВсе типы (${t[47].reduce(t[89],0)})\n\t\t\t\t\t`;for(let t=0;t<Q.length;t+=1)Q[t].c();q=T(),U=D("div"),B=D("select"),N=D("option"),N.textContent="Очаги все",A=D("option"),A.textContent="Только с погибшими",H=D("option"),H.textContent="Только с пострадавшими",I=D("option"),I.textContent="С пострадавшими или погибшими",G=D("option"),G.textContent="С пострадавшими и погибшими",O(e,"class","pLine svelte-1jsovbn"),O(c,"type","radio"),c.__value=p=1,c.value=c.__value,c.checked=d=1===t[23],O(c,"id","hearths_period_type_Stat1"),O(c,"name","hearths_period_type_Stat"),O(c,"class","svelte-1jsovbn"),t[79][2].push(c),O(u,"for","hearths_period_type_Stat1"),O(u,"class","svelte-1jsovbn"),O(h,"class","pLine margin svelte-1jsovbn"),O(a,"class","pLine type svelte-1jsovbn"),O(g,"type","radio"),g.__value=y=2,g.value=g.__value,O(g,"id","hearths_period_type_Stat2"),O(g,"name","hearths_period_type_Stat"),O(g,"class","svelte-1jsovbn"),t[79][2].push(g),O(b,"for","hearths_period_type_Stat2"),O(b,"class","svelte-1jsovbn"),O(w,"class","pLine margin svelte-1jsovbn"),O(f,"class","pLine type svelte-1jsovbn"),O(l,"class","pLine nowrap svelte-1jsovbn"),S.__value="",S.value=S.__value,O(S,"class","svelte-1jsovbn"),O(z,"class","multiple_icon_typeTmp svelte-1jsovbn"),z.multiple=!0,void 0===t[22]&&J(()=>t[90].call(z)),O(M,"class","pLine svelte-1jsovbn"),N.__value="",N.value=N.__value,A.__value="1",A.value=A.__value,H.__value="2",H.value=H.__value,I.__value="3",I.value=I.__value,G.__value="4",G.value=G.__value,O(B,"class","svelte-1jsovbn"),void 0===t[21]&&J(()=>t[91].call(B)),O(U,"class","pLine svelte-1jsovbn"),O(o,"class","filtersCont svelte-1jsovbn")},m(p,d,y){k(p,e,d),k(p,n,d),k(p,o,d),x(o,l),x(l,s),x(s,r),x(s,i),x(s,a),x(a,c),c.checked=c.__value===t[23],x(a,u),x(a,_),x(a,h);for(let t=0;t<Y.length;t+=1)Y[t].m(h,null);x(s,v),x(s,f),x(f,g),g.checked=g.__value===t[23],x(f,b),x(f,L),x(f,w);for(let t=0;t<K.length;t+=1)K[t].m(w,null);x(o,F),x(o,M),x(M,z),x(z,S);for(let t=0;t<Q.length;t+=1)Q[t].m(z,null);P(z,t[22]),x(o,q),x(o,U),x(U,B),x(B,N),x(B,A),x(B,H),x(B,I),x(B,G),$(B,t[21]),y&&m(R),R=[E(c,"change",t[60]),E(c,"change",t[87]),E(g,"change",t[60]),E(g,"change",t[88]),E(z,"change",t[90]),E(z,"change",t[60]),E(B,"change",t[91]),E(B,"change",t[60])]},p(t,e){if(8388608&e[0]&&d!==(d=1===t[23])&&(c.checked=d),8388608&e[0]&&(c.checked=c.__value===t[23]),25165832&e[0]|536870912&e[1]){let n;for(Z=Object.keys(t[3]._opt.years).sort(),n=0;n<Z.length;n+=1){const o=ge(t,Z,n);Y[n]?Y[n].p(o,e):(Y[n]=Ee(o),Y[n].c(),Y[n].m(h,null))}for(;n<Y.length;n+=1)Y[n].d(1);Y.length=Z.length}if(8388608&e[0]&&(g.checked=g.__value===t[23]),41943048&e[0]|536870912&e[1]){let n;for(V=Object.keys(t[3]._opt.years).sort(),n=0;n<V.length;n+=1){const o=me(t,V,n);K[n]?K[n].p(o,e):(K[n]=Oe(o),K[n].c(),K[n].m(w,null))}for(;n<K.length;n+=1)K[n].d(1);K.length=V.length}if(98304&e[1]){let n;for(W=t[47],n=0;n<W.length;n+=1){const o=ve(t,W,n);Q[n]?Q[n].p(o,e):(Q[n]=ze(o),Q[n].c(),Q[n].m(z,null))}for(;n<Q.length;n+=1)Q[n].d(1);Q.length=W.length}4194304&e[0]&&P(z,t[22]),2097152&e[0]&&$(B,t[21])},d(l){l&&j(e),l&&j(n),l&&j(o),t[79][2].splice(t[79][2].indexOf(c),1),C(Y,l),t[79][2].splice(t[79][2].indexOf(g),1),C(K,l),C(Q,l),m(R)}}}function Ee(t){let e,n,o,l,s,r,i,a=t[110]+"";return{c(){e=D("input"),s=D("label"),r=w(a),O(e,"type","checkbox"),O(e,"id","hearths_year_Stat"),e.checked=n=t[24][t[110]],e.disabled=o=2===t[23],O(e,"name",l=t[110]),O(e,"class","svelte-1jsovbn"),O(s,"for","hearths_year_Stat"),O(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,e,o),k(n,s,o),x(s,r),l&&i(),i=E(e,"change",t[60])},p(t,s){16777224&s[0]&&n!==(n=t[24][t[110]])&&(e.checked=n),8388608&s[0]&&o!==(o=2===t[23])&&(e.disabled=o),8&s[0]&&l!==(l=t[110])&&O(e,"name",l),8&s[0]&&a!==(a=t[110]+"")&&z(r,a)},d(t){t&&j(e),t&&j(s),i()}}}function Me(t){let e,n,o,l,s,r,i,a,c,p,d=t[121]+"",u=t[110]+"";return{c(){e=D("input"),s=D("label"),r=w(d),i=w(" кв. "),a=w(u),O(e,"type","checkbox"),O(e,"id","hearths_quarter_Stat"),e.checked=n=t[25][t[110]]&&t[25][t[110]][t[121]],e.disabled=o=1===t[23],O(e,"name",l=t[110]+"_"+t[121]),O(e,"class","svelte-1jsovbn"),O(s,"for",c="hearths_quarter_Stat_"+t[110]+"_"+t[121]),O(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,e,o),k(n,s,o),x(s,r),x(s,i),x(s,a),l&&p(),p=E(e,"change",t[60])},p(t,i){33554440&i[0]&&n!==(n=t[25][t[110]]&&t[25][t[110]][t[121]])&&(e.checked=n),8388608&i[0]&&o!==(o=1===t[23])&&(e.disabled=o),8&i[0]&&l!==(l=t[110]+"_"+t[121])&&O(e,"name",l),8&i[0]&&d!==(d=t[121]+"")&&z(r,d),8&i[0]&&u!==(u=t[110]+"")&&z(a,u),8&i[0]&&c!==(c="hearths_quarter_Stat_"+t[110]+"_"+t[121])&&O(s,"for",c)},d(t){t&&j(e),t&&j(s),p()}}}function Oe(t){let e,n,o=Object.keys(t[3]._opt.years[t[110]]).sort(),l=[];for(let e=0;e<o.length;e+=1)l[e]=Me(fe(t,o,e));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=T(),n=D("br")},m(t,o){for(let e=0;e<l.length;e+=1)l[e].m(t,o);k(t,e,o),k(t,n,o)},p(t,n){if(41943048&n[0]|536870912&n[1]){let s;for(o=Object.keys(t[3]._opt.years[t[110]]).sort(),s=0;s<o.length;s+=1){const r=fe(t,o,s);l[s]?l[s].p(r,n):(l[s]=Me(r),l[s].c(),l[s].m(e.parentNode,e))}for(;s<l.length;s+=1)l[s].d(1);l.length=o.length}},d(t){C(l,t),t&&j(e),t&&j(n)}}}function ze(t){let e,n,o,l,s,r,i,a=t[110]+"",c=t[46].str_icon_type[t[110]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[110],e.value=e.__value,O(e,"class",i="icon_type_"+t[46].iconType[t[110]]+" svelte-1jsovbn")},m(t,r){k(t,e,r),x(e,n),x(e,o),x(e,l),x(e,s)},p:h,d(t){t&&j(e)}}}function $e(t){let e,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,g,y,b,L,w,F,M,z,S,q,U,B,N,A,H,I,G,R,Z=Object.keys(t[4]._opt.years).sort(),Y=[];for(let e=0;e<Z.length;e+=1)Y[e]=Pe(he(t,Z,e));let V=Object.keys(t[4]._opt.years).sort(),K=[];for(let e=0;e<V.length;e+=1)K[e]=qe(_e(t,V,e));let W=t[45],Q=[];for(let e=0;e<W.length;e+=1)Q[e]=Ue(de(t,W,e));return{c(){e=D("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (TMP)</b>",n=T(),o=D("div"),l=D("div"),s=D("fieldset"),r=D("legend"),r.textContent="Фильтрация по периодам:",i=T(),a=D("div"),c=D("input"),u=D("label"),u.textContent="Фильтрация по годам",_=T(),h=D("div");for(let t=0;t<Y.length;t+=1)Y[t].c();v=T(),f=D("div"),g=D("input"),b=D("label"),b.textContent="Фильтрация по кварталам",L=T(),w=D("div");for(let t=0;t<K.length;t+=1)K[t].c();F=T(),M=D("div"),z=D("select"),S=D("option"),S.textContent=`\n\t\t\t\t\t\tВсе типы (${t[45].reduce(t[94],0)})\n\t\t\t\t\t`;for(let t=0;t<Q.length;t+=1)Q[t].c();q=T(),U=D("div"),B=D("select"),N=D("option"),N.textContent="Очаги все",A=D("option"),A.textContent="Только с погибшими",H=D("option"),H.textContent="Только с пострадавшими",I=D("option"),I.textContent="С пострадавшими или погибшими",G=D("option"),G.textContent="С пострадавшими и погибшими",O(e,"class","pLine svelte-1jsovbn"),O(c,"type","radio"),c.__value=p=1,c.value=c.__value,c.checked=d=1===t[28],O(c,"id","hearths_period_type_tmp1"),O(c,"name","hearths_period_type_tmp"),O(c,"class","svelte-1jsovbn"),t[79][1].push(c),O(u,"for","hearths_period_type_tmp1"),O(u,"class","svelte-1jsovbn"),O(h,"class","pLine margin svelte-1jsovbn"),O(a,"class","pLine type svelte-1jsovbn"),O(g,"type","radio"),g.__value=y=2,g.value=g.__value,O(g,"id","hearths_period_type_tmp2"),O(g,"name","hearths_period_type_tmp"),O(g,"class","svelte-1jsovbn"),t[79][1].push(g),O(b,"for","hearths_period_type_tmp2"),O(b,"class","svelte-1jsovbn"),O(w,"class","pLine margin svelte-1jsovbn"),O(f,"class","pLine type svelte-1jsovbn"),O(l,"class","pLine nowrap svelte-1jsovbn"),S.__value="",S.value=S.__value,O(S,"class","svelte-1jsovbn"),O(z,"class","multiple_icon_typeTmp svelte-1jsovbn"),z.multiple=!0,void 0===t[27]&&J(()=>t[95].call(z)),O(M,"class","pLine svelte-1jsovbn"),N.__value="",N.value=N.__value,A.__value="1",A.value=A.__value,H.__value="2",H.value=H.__value,I.__value="3",I.value=I.__value,G.__value="4",G.value=G.__value,O(B,"class","svelte-1jsovbn"),void 0===t[26]&&J(()=>t[96].call(B)),O(U,"class","pLine svelte-1jsovbn"),O(o,"class","filtersCont svelte-1jsovbn")},m(p,d,y){k(p,e,d),k(p,n,d),k(p,o,d),x(o,l),x(l,s),x(s,r),x(s,i),x(s,a),x(a,c),c.checked=c.__value===t[28],x(a,u),x(a,_),x(a,h);for(let t=0;t<Y.length;t+=1)Y[t].m(h,null);x(s,v),x(s,f),x(f,g),g.checked=g.__value===t[28],x(f,b),x(f,L),x(f,w);for(let t=0;t<K.length;t+=1)K[t].m(w,null);x(o,F),x(o,M),x(M,z),x(z,S);for(let t=0;t<Q.length;t+=1)Q[t].m(z,null);P(z,t[27]),x(o,q),x(o,U),x(U,B),x(B,N),x(B,A),x(B,H),x(B,I),x(B,G),$(B,t[26]),y&&m(R),R=[E(c,"change",t[61]),E(c,"change",t[92]),E(g,"change",t[61]),E(g,"change",t[93]),E(z,"change",t[95]),E(z,"change",t[61]),E(B,"change",t[96]),E(B,"change",t[61])]},p(t,e){if(268435456&e[0]&&d!==(d=1===t[28])&&(c.checked=d),268435456&e[0]&&(c.checked=c.__value===t[28]),805306384&e[0]|1073741824&e[1]){let n;for(Z=Object.keys(t[4]._opt.years).sort(),n=0;n<Z.length;n+=1){const o=he(t,Z,n);Y[n]?Y[n].p(o,e):(Y[n]=Pe(o),Y[n].c(),Y[n].m(h,null))}for(;n<Y.length;n+=1)Y[n].d(1);Y.length=Z.length}if(268435456&e[0]&&(g.checked=g.__value===t[28]),1342177296&e[0]|1073741824&e[1]){let n;for(V=Object.keys(t[4]._opt.years).sort(),n=0;n<V.length;n+=1){const o=_e(t,V,n);K[n]?K[n].p(o,e):(K[n]=qe(o),K[n].c(),K[n].m(w,null))}for(;n<K.length;n+=1)K[n].d(1);K.length=V.length}if(24576&e[1]){let n;for(W=t[45],n=0;n<W.length;n+=1){const o=de(t,W,n);Q[n]?Q[n].p(o,e):(Q[n]=Ue(o),Q[n].c(),Q[n].m(z,null))}for(;n<Q.length;n+=1)Q[n].d(1);Q.length=W.length}134217728&e[0]&&P(z,t[27]),67108864&e[0]&&$(B,t[26])},d(l){l&&j(e),l&&j(n),l&&j(o),t[79][1].splice(t[79][1].indexOf(c),1),C(Y,l),t[79][1].splice(t[79][1].indexOf(g),1),C(K,l),C(Q,l),m(R)}}}function Pe(t){let e,n,o,l,s,r,i,a=t[110]+"";return{c(){e=D("input"),s=D("label"),r=w(a),O(e,"type","checkbox"),O(e,"id","hearths_year_tmp"),e.checked=n=t[29][t[110]],e.disabled=o=2===t[28],O(e,"name",l=t[110]),O(e,"class","svelte-1jsovbn"),O(s,"for","hearths_year_tmp"),O(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,e,o),k(n,s,o),x(s,r),l&&i(),i=E(e,"change",t[61])},p(t,s){536870928&s[0]&&n!==(n=t[29][t[110]])&&(e.checked=n),268435456&s[0]&&o!==(o=2===t[28])&&(e.disabled=o),16&s[0]&&l!==(l=t[110])&&O(e,"name",l),16&s[0]&&a!==(a=t[110]+"")&&z(r,a)},d(t){t&&j(e),t&&j(s),i()}}}function Se(t){let e,n,o,l,s,r,i,a,c,p,d=t[121]+"",u=t[110]+"";return{c(){e=D("input"),s=D("label"),r=w(d),i=w(" кв. "),a=w(u),O(e,"type","checkbox"),O(e,"id","hearths_quarter_tmp"),e.checked=n=t[30][t[110]]&&t[30][t[110]][t[121]],e.disabled=o=1===t[28],O(e,"name",l=t[110]+"_"+t[121]),O(e,"class","svelte-1jsovbn"),O(s,"for",c="hearths_quarter_tmp_"+t[110]+"_"+t[121]),O(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,e,o),k(n,s,o),x(s,r),x(s,i),x(s,a),l&&p(),p=E(e,"change",t[61])},p(t,i){1073741840&i[0]&&n!==(n=t[30][t[110]]&&t[30][t[110]][t[121]])&&(e.checked=n),268435456&i[0]&&o!==(o=1===t[28])&&(e.disabled=o),16&i[0]&&l!==(l=t[110]+"_"+t[121])&&O(e,"name",l),16&i[0]&&d!==(d=t[121]+"")&&z(r,d),16&i[0]&&u!==(u=t[110]+"")&&z(a,u),16&i[0]&&c!==(c="hearths_quarter_tmp_"+t[110]+"_"+t[121])&&O(s,"for",c)},d(t){t&&j(e),t&&j(s),p()}}}function qe(t){let e,n,o=Object.keys(t[4]._opt.years[t[110]]).sort(),l=[];for(let e=0;e<o.length;e+=1)l[e]=Se(ue(t,o,e));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=T(),n=D("br")},m(t,o){for(let e=0;e<l.length;e+=1)l[e].m(t,o);k(t,e,o),k(t,n,o)},p(t,n){if(1342177296&n[0]|1073741824&n[1]){let s;for(o=Object.keys(t[4]._opt.years[t[110]]).sort(),s=0;s<o.length;s+=1){const r=ue(t,o,s);l[s]?l[s].p(r,n):(l[s]=Se(r),l[s].c(),l[s].m(e.parentNode,e))}for(;s<l.length;s+=1)l[s].d(1);l.length=o.length}},d(t){C(l,t),t&&j(e),t&&j(n)}}}function Ue(t){let e,n,o,l,s,r,i,a=t[110]+"",c=t[44].str_icon_type[t[110]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[110],e.value=e.__value,O(e,"class",i="icon_type_"+t[44].iconType[t[110]]+" svelte-1jsovbn")},m(t,r){k(t,e,r),x(e,n),x(e,o),x(e,l),x(e,s)},p:h,d(t){t&&j(e)}}}function Be(t){let e,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,g,y,b,L,w,F,M,z,S,q,U,B,N,A,H,I,G,R,Z,Y,V=Object.keys(t[5]._opt.years).sort(),K=[];for(let e=0;e<V.length;e+=1)K[e]=Ne(pe(t,V,e));let W=Object.keys(t[5]._opt.years).sort(),Q=[];for(let e=0;e<W.length;e+=1)Q[e]=He(ce(t,W,e));let X=t[43],tt=[];for(let e=0;e<X.length;e+=1)tt[e]=Ie(ie(t,X,e));return{c(){e=D("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=D("div"),o.innerHTML="Фильтры - <b>ДТП Очаги</b>",l=T(),s=D("div"),r=D("div"),i=D("fieldset"),a=D("legend"),a.textContent="Фильтрация по периодам:",c=T(),p=D("div"),d=D("input"),h=D("label"),h.textContent="Фильтрация по годам",v=T(),f=D("div");for(let t=0;t<K.length;t+=1)K[t].c();g=T(),y=D("div"),b=D("input"),w=D("label"),w.textContent="Фильтрация по кварталам",F=T(),M=D("div");for(let t=0;t<Q.length;t+=1)Q[t].c();z=T(),S=D("div"),q=D("select"),U=D("option"),U.textContent=`\n\t\t\t\t\t\tВсе типы (${t[43].reduce(t[99],0)})\n\t\t\t\t\t`;for(let t=0;t<tt.length;t+=1)tt[t].c();B=T(),N=D("div"),A=D("select"),H=D("option"),H.textContent="Очаги все",I=D("option"),I.textContent="Только с погибшими",G=D("option"),G.textContent="Только с пострадавшими",R=D("option"),R.textContent="С пострадавшими или погибшими",Z=D("option"),Z.textContent="С пострадавшими и погибшими",O(e,"class","pLine svelte-1jsovbn"),O(o,"class","pLine svelte-1jsovbn"),O(d,"type","radio"),d.__value=u=1,d.value=d.__value,d.checked=_=1===t[33],O(d,"id","hearths_period_type1"),O(d,"name","hearths_period_type"),O(d,"class","svelte-1jsovbn"),t[79][0].push(d),O(h,"for","hearths_period_type1"),O(h,"class","svelte-1jsovbn"),O(f,"class","pLine margin svelte-1jsovbn"),O(p,"class","pLine type svelte-1jsovbn"),O(b,"type","radio"),b.__value=L=2,b.value=b.__value,O(b,"id","hearths_period_type2"),O(b,"name","hearths_period_type"),O(b,"class","svelte-1jsovbn"),t[79][0].push(b),O(w,"for","hearths_period_type2"),O(w,"class","svelte-1jsovbn"),O(M,"class","pLine margin svelte-1jsovbn"),O(y,"class","pLine type svelte-1jsovbn"),O(r,"class","pLine nowrap svelte-1jsovbn"),U.__value="",U.value=U.__value,O(U,"class","svelte-1jsovbn"),O(q,"class","multiple_icon_typeTmp svelte-1jsovbn"),q.multiple=!0,void 0===t[32]&&J(()=>t[100].call(q)),O(S,"class","pLine svelte-1jsovbn"),H.__value="",H.value=H.__value,I.__value="1",I.value=I.__value,G.__value="2",G.value=G.__value,R.__value="3",R.value=R.__value,Z.__value="4",Z.value=Z.__value,O(A,"class","svelte-1jsovbn"),void 0===t[31]&&J(()=>t[101].call(A)),O(N,"class","pLine svelte-1jsovbn"),O(s,"class","filtersCont svelte-1jsovbn")},m(u,_,j){k(u,e,_),k(u,n,_),k(u,o,_),k(u,l,_),k(u,s,_),x(s,r),x(r,i),x(i,a),x(i,c),x(i,p),x(p,d),d.checked=d.__value===t[33],x(p,h),x(p,v),x(p,f);for(let t=0;t<K.length;t+=1)K[t].m(f,null);x(i,g),x(i,y),x(y,b),b.checked=b.__value===t[33],x(y,w),x(y,F),x(y,M);for(let t=0;t<Q.length;t+=1)Q[t].m(M,null);x(s,z),x(s,S),x(S,q),x(q,U);for(let t=0;t<tt.length;t+=1)tt[t].m(q,null);P(q,t[32]),x(s,B),x(s,N),x(N,A),x(A,H),x(A,I),x(A,G),x(A,R),x(A,Z),$(A,t[31]),j&&m(Y),Y=[E(d,"change",t[62]),E(d,"change",t[97]),E(b,"change",t[62]),E(b,"change",t[98]),E(q,"change",t[100]),E(q,"change",t[62]),E(A,"change",t[101]),E(A,"change",t[62])]},p(t,e){if(4&e[1]&&_!==(_=1===t[33])&&(d.checked=_),4&e[1]&&(d.checked=d.__value===t[33]),32&e[0]|12&e[1]|1&e[2]){let n;for(V=Object.keys(t[5]._opt.years).sort(),n=0;n<V.length;n+=1){const o=pe(t,V,n);K[n]?K[n].p(o,e):(K[n]=Ne(o),K[n].c(),K[n].m(f,null))}for(;n<K.length;n+=1)K[n].d(1);K.length=V.length}if(4&e[1]&&(b.checked=b.__value===t[33]),32&e[0]|20&e[1]|1&e[2]){let n;for(W=Object.keys(t[5]._opt.years).sort(),n=0;n<W.length;n+=1){const o=ce(t,W,n);Q[n]?Q[n].p(o,e):(Q[n]=He(o),Q[n].c(),Q[n].m(M,null))}for(;n<Q.length;n+=1)Q[n].d(1);Q.length=W.length}if(6144&e[1]){let n;for(X=t[43],n=0;n<X.length;n+=1){const o=ie(t,X,n);tt[n]?tt[n].p(o,e):(tt[n]=Ie(o),tt[n].c(),tt[n].m(q,null))}for(;n<tt.length;n+=1)tt[n].d(1);tt.length=X.length}2&e[1]&&P(q,t[32]),1&e[1]&&$(A,t[31])},d(r){r&&j(e),r&&j(n),r&&j(o),r&&j(l),r&&j(s),t[79][0].splice(t[79][0].indexOf(d),1),C(K,r),t[79][0].splice(t[79][0].indexOf(b),1),C(Q,r),C(tt,r),m(Y)}}}function Ne(t){let e,n,o,l,s,r,i,a,c=t[110]+"";return{c(){e=D("input"),s=D("label"),r=w(c),O(e,"type","checkbox"),O(e,"id","hearths_year"),e.checked=n=t[34][t[110]],e.disabled=o=2===t[33],O(e,"name",l=t[110]),O(e,"class","svelte-1jsovbn"),O(s,"for",i="hearths_year"+t[110]),O(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,e,o),k(n,s,o),x(s,r),l&&a(),a=E(e,"change",t[62])},p(t,a){32&a[0]|8&a[1]&&n!==(n=t[34][t[110]])&&(e.checked=n),4&a[1]&&o!==(o=2===t[33])&&(e.disabled=o),32&a[0]&&l!==(l=t[110])&&O(e,"name",l),32&a[0]&&c!==(c=t[110]+"")&&z(r,c),32&a[0]&&i!==(i="hearths_year"+t[110])&&O(s,"for",i)},d(t){t&&j(e),t&&j(s),a()}}}function Ae(t){let e,n,o,l,s,r,i,a,c,p,d=t[121]+"",u=t[110]+"";return{c(){e=D("input"),s=D("label"),r=w(d),i=w(" кв. "),a=w(u),O(e,"type","checkbox"),O(e,"id","hearths_quarter"),e.checked=n=t[35][t[110]]&&t[35][t[110]][t[121]],e.disabled=o=1===t[33],O(e,"name",l=t[110]+"_"+t[121]),O(e,"class","svelte-1jsovbn"),O(s,"for",c="hearths_quarter_"+t[110]+"_"+t[121]),O(s,"class","svelte-1jsovbn")},m(n,o,l){k(n,e,o),k(n,s,o),x(s,r),x(s,i),x(s,a),l&&p(),p=E(e,"change",t[62])},p(t,i){32&i[0]|16&i[1]&&n!==(n=t[35][t[110]]&&t[35][t[110]][t[121]])&&(e.checked=n),4&i[1]&&o!==(o=1===t[33])&&(e.disabled=o),32&i[0]&&l!==(l=t[110]+"_"+t[121])&&O(e,"name",l),32&i[0]&&d!==(d=t[121]+"")&&z(r,d),32&i[0]&&u!==(u=t[110]+"")&&z(a,u),32&i[0]&&c!==(c="hearths_quarter_"+t[110]+"_"+t[121])&&O(s,"for",c)},d(t){t&&j(e),t&&j(s),p()}}}function He(t){let e,n,o=Object.keys(t[5]._opt.years[t[110]]).sort(),l=[];for(let e=0;e<o.length;e+=1)l[e]=Ae(ae(t,o,e));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=T(),n=D("br")},m(t,o){for(let e=0;e<l.length;e+=1)l[e].m(t,o);k(t,e,o),k(t,n,o)},p(t,n){if(32&n[0]|20&n[1]|1&n[2]){let s;for(o=Object.keys(t[5]._opt.years[t[110]]).sort(),s=0;s<o.length;s+=1){const r=ae(t,o,s);l[s]?l[s].p(r,n):(l[s]=Ae(r),l[s].c(),l[s].m(e.parentNode,e))}for(;s<l.length;s+=1)l[s].d(1);l.length=o.length}},d(t){C(l,t),t&&j(e),t&&j(n)}}}function Ie(t){let e,n,o,l,s,r,i,a=t[110]+"",c=t[42].str_icon_type[t[110]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[110],e.value=e.__value,O(e,"class",i="icon_type_"+t[42].iconType[t[110]]+" svelte-1jsovbn")},m(t,r){k(t,e,r),x(e,n),x(e,o),x(e,l),x(e,s)},p:h,d(t){t&&j(e)}}}function Ge(t){let e;return{c(){e=D("div"),e.textContent="Нет включенных слоев",O(e,"class","pLine svelte-1jsovbn")},m(t,n){k(t,e,n)},p:h,d(t){t&&j(e)}}}function Re(t){let e,n,o,l,s,r,i,a,c,p,d;return{c(){e=D("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=D("div"),l=D("button"),s=T(),r=D("input"),i=T(),a=D("input"),c=T(),p=D("button"),O(e,"class","pLine svelte-1jsovbn"),O(l,"class","pika-prev"),O(r,"type","text"),O(r,"class","begDate svelte-1jsovbn"),O(a,"type","text"),O(a,"class","endDate svelte-1jsovbn"),O(p,"class","pika-next"),O(o,"class","pikaday pLine svelte-1jsovbn")},m(u,_,h){k(u,e,_),k(u,n,_),k(u,o,_),x(o,l),x(o,s),x(o,r),t[102](r),x(o,i),x(o,a),t[103](a),x(o,c),x(o,p),h&&m(d),d=[E(l,"click",t[56]),E(p,"click",t[57])]},p:h,d(l){l&&j(e),l&&j(n),l&&j(o),t[102](null),t[103](null),m(d)}}}function Ze(t){let e,n,o,l,s,r,i,a,c,p,d,u,_,h,v;function f(t,e){return t[0]._arm?Ve:Ye}let g=f(t),y=g(t),b=t[36].collision_type&&function(t){let e,n,o,l,s=t[37],r=[];for(let e=0;e<s.length;e+=1)r[e]=Je(re(t,s,e));return{c(){e=D("div"),n=D("select"),o=D("option"),o.textContent=`\n\t\t\t\t\t\tВсе типы (${t[37].reduce(t[104],0)})\n\t\t\t\t\t`;for(let t=0;t<r.length;t+=1)r[t].c();o.__value="",o.value=o.__value,O(o,"class","svelte-1jsovbn"),O(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===t[10]&&J(()=>t[105].call(n)),O(e,"class","pLine svelte-1jsovbn")},m(s,i,a){k(s,e,i),x(e,n),x(n,o);for(let t=0;t<r.length;t+=1)r[t].m(n,null);P(n,t[10]),a&&m(l),l=[E(n,"change",t[105]),E(n,"change",t[52])]},p(t,e){if(96&e[1]){let o;for(s=t[37],o=0;o<s.length;o+=1){const l=re(t,s,o);r[o]?r[o].p(l,e):(r[o]=Je(l),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=s.length}1024&e[0]&&P(n,t[10])},d(t){t&&j(e),C(r,t),m(l)}}}(t);return{c(){e=D("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=D("div"),o.innerHTML="Фильтры - <b>ДТП Сводный</b>",l=T(),s=D("div"),r=D("div"),i=D("input"),a=D("label"),a.textContent="Все",c=T(),y.c(),p=T(),d=D("div"),u=D("input"),_=D("label"),_.textContent="Только ГИБДД",h=T(),b&&b.c(),O(e,"class","pLine svelte-1jsovbn"),O(o,"class","pLine svelte-1jsovbn"),O(i,"type","radio"),O(i,"id","d0"),O(i,"name","drone"),i.value="0",i.checked=!0,O(i,"class","svelte-1jsovbn"),O(a,"for","d0"),O(a,"class","svelte-1jsovbn"),O(r,"class","pLine svelte-1jsovbn"),O(u,"type","radio"),O(u,"id","d3"),O(u,"name","drone"),u.value="3",O(u,"class","svelte-1jsovbn"),O(_,"for","d3"),O(_,"class","svelte-1jsovbn"),O(d,"class","pLine svelte-1jsovbn"),O(s,"class","filtersCont svelte-1jsovbn")},m(f,g,j){k(f,e,g),k(f,n,g),k(f,o,g),k(f,l,g),k(f,s,g),x(s,r),x(r,i),x(r,a),x(s,c),y.m(s,null),x(s,p),x(s,d),x(d,u),x(d,_),x(s,h),b&&b.m(s,null),j&&m(v),v=[E(i,"click",t[55]),E(u,"click",t[55])]},p(t,e){g===(g=f(t))&&y?y.p(t,e):(y.d(1),y=g(t),y&&(y.c(),y.m(s,p))),t[36].collision_type&&b.p(t,e)},d(t){t&&j(e),t&&j(n),t&&j(o),t&&j(l),t&&j(s),y.d(),b&&b.d(),m(v)}}}function Ye(t){let e,n,o,l,s,r,i,a;return{c(){e=D("div"),n=D("input"),o=D("label"),o.textContent="Только Пересечения",l=T(),s=D("div"),r=D("input"),i=D("label"),i.textContent="Только СКПДИ",O(n,"type","radio"),O(n,"id","d1"),O(n,"name","drone"),n.value="1",O(n,"class","svelte-1jsovbn"),O(o,"for","d1"),O(o,"class","svelte-1jsovbn"),O(e,"class","pLine svelte-1jsovbn"),O(r,"type","radio"),O(r,"id","d2"),O(r,"name","drone"),r.value="2",O(r,"class","svelte-1jsovbn"),O(i,"for","d2"),O(i,"class","svelte-1jsovbn"),O(s,"class","pLine svelte-1jsovbn")},m(c,p,d){k(c,e,p),x(e,n),x(e,o),k(c,l,p),k(c,s,p),x(s,r),x(s,i),d&&m(a),a=[E(n,"click",t[55]),E(r,"click",t[55])]},p:h,d(t){t&&j(e),t&&j(l),t&&j(s),m(a)}}}function Ve(t){let e,n,o,l;return{c(){e=D("div"),n=D("input"),o=D("label"),o.textContent="Только Пересечения ГИБДД и СКПДИ",O(n,"type","radio"),O(n,"id","d1"),O(n,"name","drone"),n.value="1",O(n,"class","svelte-1jsovbn"),O(o,"for","d1"),O(o,"class","svelte-1jsovbn"),O(e,"class","pLine svelte-1jsovbn")},m(s,r,i){k(s,e,r),x(e,n),x(e,o),i&&l(),l=E(n,"click",t[55])},p:h,d(t){t&&j(e),l()}}}function Je(t){let e,n,o,l,s,r,i,a=t[110]+"",c=t[36].collision_type[t[110]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[110],e.value=e.__value,O(e,"class",i="icon_type_"+t[36].iconType[t[110]]+" svelte-1jsovbn")},m(t,r){k(t,e,r),x(e,n),x(e,o),x(e,l),x(e,s)},p:h,d(t){t&&j(e)}}}function Ke(t){let e,n,o,l,s,r=t[38].collision_type&&function(t){let e,n,o,l,s=t[39],r=[];for(let e=0;e<s.length;e+=1)r[e]=We(se(t,s,e));return{c(){e=D("div"),n=D("select"),o=D("option"),o.textContent=`\n\t\t\t\t\t\tВсе типы (${t[39].reduce(t[106],0)})\n\t\t\t\t\t`;for(let t=0;t<r.length;t+=1)r[t].c();o.__value="",o.value=o.__value,O(o,"class","svelte-1jsovbn"),O(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===t[11]&&J(()=>t[107].call(n)),O(e,"class","pLine svelte-1jsovbn")},m(s,i,a){k(s,e,i),x(e,n),x(n,o);for(let t=0;t<r.length;t+=1)r[t].m(n,null);P(n,t[11]),a&&m(l),l=[E(n,"change",t[107]),E(n,"change",t[54])]},p(t,e){if(384&e[1]){let o;for(s=t[39],o=0;o<s.length;o+=1){const l=se(t,s,o);r[o]?r[o].p(l,e):(r[o]=We(l),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=s.length}2048&e[0]&&P(n,t[11])},d(t){t&&j(e),C(r,t),m(l)}}}(t);return{c(){e=D("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=D("div"),o.innerHTML="Фильтры - <b>ДТП СКПДИ</b>",l=T(),s=D("div"),r&&r.c(),O(e,"class","pLine svelte-1jsovbn"),O(o,"class","pLine svelte-1jsovbn"),O(s,"class","filtersCont svelte-1jsovbn")},m(t,i){k(t,e,i),k(t,n,i),k(t,o,i),k(t,l,i),k(t,s,i),r&&r.m(s,null)},p(t,e){t[38].collision_type&&r.p(t,e)},d(t){t&&j(e),t&&j(n),t&&j(o),t&&j(l),t&&j(s),r&&r.d()}}}function We(t){let e,n,o,l,s,r,i,a=t[110]+"",c=t[38].collision_type[t[110]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[110],e.value=e.__value,O(e,"class",i="icon_type_"+t[38].iconType[t[110]]+" svelte-1jsovbn")},m(t,r){k(t,e,r),x(e,n),x(e,o),x(e,l),x(e,s)},p:h,d(t){t&&j(e)}}}function Qe(t){let e,n,o,l,s,r=t[40].collision_type&&function(t){let e,n,o,l,s=t[41],r=[];for(let e=0;e<s.length;e+=1)r[e]=Xe(le(t,s,e));return{c(){e=D("div"),n=D("select"),o=D("option"),o.textContent=`\n\t\t\t\t\t\tВсе типы (${t[41].reduce(t[108],0)})\n\t\t\t\t\t`;for(let t=0;t<r.length;t+=1)r[t].c();o.__value="",o.value=o.__value,O(o,"class","svelte-1jsovbn"),O(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===t[12]&&J(()=>t[109].call(n)),O(e,"class","pLine svelte-1jsovbn")},m(s,i,a){k(s,e,i),x(e,n),x(n,o);for(let t=0;t<r.length;t+=1)r[t].m(n,null);P(n,t[12]),a&&m(l),l=[E(n,"change",t[109]),E(n,"change",t[53])]},p(t,e){if(1536&e[1]){let o;for(s=t[41],o=0;o<s.length;o+=1){const l=le(t,s,o);r[o]?r[o].p(l,e):(r[o]=Xe(l),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=s.length}4096&e[0]&&P(n,t[12])},d(t){t&&j(e),C(r,t),m(l)}}}(t);return{c(){e=D("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),o=D("div"),o.innerHTML="Фильтры - <b>ДТП ГИБДД</b>",l=T(),s=D("div"),r&&r.c(),O(e,"class","pLine svelte-1jsovbn"),O(o,"class","pLine svelte-1jsovbn"),O(s,"class","filtersCont svelte-1jsovbn")},m(t,i){k(t,e,i),k(t,n,i),k(t,o,i),k(t,l,i),k(t,s,i),r&&r.m(s,null)},p(t,e){t[40].collision_type&&r.p(t,e)},d(t){t&&j(e),t&&j(n),t&&j(o),t&&j(l),t&&j(s),r&&r.d()}}}function Xe(t){let e,n,o,l,s,r,i,a=t[110]+"",c=t[40].collision_type[t[110]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(c),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[110],e.value=e.__value,O(e,"class",i="icon_type_"+t[40].iconType[t[110]]+" svelte-1jsovbn")},m(t,r){k(t,e,r),x(e,n),x(e,o),x(e,l),x(e,s)},p:h,d(t){t&&j(e)}}}function tn(t){let e,n,o,l,s,r,i,a,c,p=t[1]._map&&t[1]._opt&&t[1]._opt.years&&je(t),d=t[2]._map&&t[2]._opt&&t[2]._opt.years&&De(t),u=t[3]._map&&t[3]._opt&&t[3]._opt.years&&Fe(t),_=t[4]._map&&t[4]._opt&&t[4]._opt.years&&$e(t),v=t[5]._map&&t[5]._opt&&t[5]._opt.years&&Be(t);function f(t,e){return t[0]._map||t[6]._map||t[7]._map?Re:t[5]._map||t[4]._map?void 0:Ge}let m=f(t),g=m&&m(t),y=t[0]._map&&Ze(t),b=t[6]._map&&Ke(t),C=t[7]._map&&Qe(t);return{c(){e=D("div"),p&&p.c(),n=T(),d&&d.c(),o=T(),u&&u.c(),l=T(),_&&_.c(),s=T(),v&&v.c(),r=T(),g&&g.c(),i=T(),y&&y.c(),a=T(),b&&b.c(),c=T(),C&&C.c(),O(e,"class","mvsFilters")},m(t,h){k(t,e,h),p&&p.m(e,null),x(e,n),d&&d.m(e,null),x(e,o),u&&u.m(e,null),x(e,l),_&&_.m(e,null),x(e,s),v&&v.m(e,null),x(e,r),g&&g.m(e,null),x(e,i),y&&y.m(e,null),x(e,a),b&&b.m(e,null),x(e,c),C&&C.m(e,null)},p(t,h){t[1]._map&&t[1]._opt&&t[1]._opt.years?p?p.p(t,h):(p=je(t),p.c(),p.m(e,n)):p&&(p.d(1),p=null),t[2]._map&&t[2]._opt&&t[2]._opt.years?d?d.p(t,h):(d=De(t),d.c(),d.m(e,o)):d&&(d.d(1),d=null),t[3]._map&&t[3]._opt&&t[3]._opt.years?u?u.p(t,h):(u=Fe(t),u.c(),u.m(e,l)):u&&(u.d(1),u=null),t[4]._map&&t[4]._opt&&t[4]._opt.years?_?_.p(t,h):(_=$e(t),_.c(),_.m(e,s)):_&&(_.d(1),_=null),t[5]._map&&t[5]._opt&&t[5]._opt.years?v?v.p(t,h):(v=Be(t),v.c(),v.m(e,r)):v&&(v.d(1),v=null),m===(m=f(t))&&g?g.p(t,h):(g&&g.d(1),g=m&&m(t),g&&(g.c(),g.m(e,i))),t[0]._map?y?y.p(t,h):(y=Ze(t),y.c(),y.m(e,a)):y&&(y.d(1),y=null),t[6]._map?b?b.p(t,h):(b=Ke(t),b.c(),b.m(e,c)):b&&(b.d(1),b=null),t[7]._map?C?C.p(t,h):(C=Qe(t),C.c(),C.m(e,null)):C&&(C.d(1),C=null)},i:h,o:h,d(t){t&&j(e),p&&p.d(),d&&d.d(),u&&u.d(),_&&_.d(),v&&v.d(),g&&g.d(),y&&y.d(),b&&b.d(),C&&C.d()}}}function en(t,e,n){let o,l,{DtpVerifyed:s}=e,{DtpHearths5:r}=e,{DtpHearths3:i}=e,{DtpHearthsStat:a}=e,{DtpHearthsTmp:c}=e,{DtpHearths:p}=e,{DtpSkpdi:d}=e,{DtpGibdd:u}=e,_=0;const h=new Date,v=new Date(new Date(h.getFullYear(),h.getMonth(),h.getDate()).getTime()),f=h,m=new Date(2018,0,1);let g=[m.getTime()/1e3,f.getTime()/1e3],y=s._opt||{},b=y.collision_type?Object.keys(y.collision_type).sort((t,e)=>y.collision_type[e]-y.collision_type[t]):[];console.log("optData",y);let x,k,j=d._opt||{},C=j.collision_type?Object.keys(j.collision_type).sort((t,e)=>j.collision_type[e]-j.collision_type[t]):[],D=u._opt||{},w=D.collision_type?Object.keys(D.collision_type).sort((t,e)=>D.collision_type[e]-D.collision_type[t]):[],T=p._opt||{},F=T.str_icon_type?Object.keys(T.str_icon_type).sort((t,e)=>T.str_icon_type[e]-T.str_icon_type[t]):[],E=c._opt||{},M=E.str_icon_type?Object.keys(E.str_icon_type).sort((t,e)=>E.str_icon_type[e]-E.str_icon_type[t]):[],O=a._opt||{},z=O.str_icon_type?Object.keys(O.str_icon_type).sort((t,e)=>O.str_icon_type[e]-O.str_icon_type[t]):[],$=i._opt||{},P=$.str_icon_type?Object.keys($.str_icon_type).sort((t,e)=>$.str_icon_type[e]-$.str_icon_type[t]):[],U=r._opt||{},B=U.str_icon_type?Object.keys(U.str_icon_type).sort((t,e)=>U.str_icon_type[e]-U.str_icon_type[t]):[],A=[""],H=[""],I=[""];const R=()=>{let t=[{type:"itemType",zn:_}];g&&t.push({type:"date",zn:g}),A&&t.push({type:"collision_type",zn:A}),s.setFilter(t)},Z=()=>{let t=[];g&&t.push({type:"date",zn:g}),I&&t.push({type:"collision_type",zn:I}),u.setFilter(t)},Y=()=>{let t=[];g&&t.push({type:"date",zn:g}),H&&t.push({type:"collision_type",zn:H}),d.setFilter(t)};var V;V=()=>{let t={onSelect(t){this._o.field.value=this.toString(),g[this._o._dint]=this.getDate().getTime()/1e3+24*this._o._dint*60*60,R(),Y(),Z()},toString(t,e){let n=t.getDate();n<10&&(n="0"+n);let o=t.getMonth()+1;return o<10&&(o="0"+o),`${n}.${o}.${t.getFullYear()}`},parse(t,e){const n=t.split("."),o=parseInt(n[0],10),l=parseInt(n[1],10)-1,s=parseInt(n[2],10);return new Date(s,l,o)},i18n:{previousMonth:"Предыдущий месяц",nextMonth:"Следующий месяц",months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],weekdays:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],weekdaysShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"]},format:"DD.MM.YYYY",setDefaultDate:!0,yearRange:20,blurFieldOnSelect:!1};x=new Pikaday(L.extend({},t,{_dint:0,field:o,defaultDate:new Date(1e3*g[0])})),k=new Pikaday(L.extend({},t,{_dint:1,field:l,defaultDate:new Date(1e3*g[1])}))},N().$$.on_mount.push(V);let J,K,W=[""],Q=1,X={},tt={};Object.keys(U.years||{}).sort().forEach(t=>{n(16,X[t]=!0,X),Object.keys(U.years[t]).sort().forEach(e=>{K={},K[t]={},K[t][e]=!0})}),tt=K||{};let et,nt,ot=[""],lt=1,st={},rt={};Object.keys($.years||{}).sort().forEach(t=>{n(20,st[t]=!0,st),Object.keys($.years[t]).sort().forEach(e=>{nt={},nt[t]={},nt[t][e]=!0})}),rt=nt||{};let it,at,ct=[""],pt=1,dt={},ut={};Object.keys(O.years||{}).sort().forEach(t=>{n(24,dt[t]=!0,dt),Object.keys(O.years[t]).sort().forEach(e=>{at={},at[t]={},at[t][e]=!0})}),ut=at||{};let _t,ht,vt=[""],ft=1,mt={},gt={};Object.keys(E.years||{}).sort().forEach(t=>{n(29,mt[t]=!0,mt),Object.keys(E.years[t]).sort().forEach(e=>{ht={},ht[t]={},ht[t][e]=!0})}),gt=ht||{};let yt,bt,xt=[""],kt=1,jt={},Ct={};Object.keys(T.years||{}).sort().forEach(t=>{n(34,jt[t]=!0,jt),Object.keys(T.years[t]).sort().forEach(e=>{bt={},bt[t]={},bt[t][e]=!0})}),Ct=bt||{};return t.$set=t=>{"DtpVerifyed"in t&&n(0,s=t.DtpVerifyed),"DtpHearths5"in t&&n(1,r=t.DtpHearths5),"DtpHearths3"in t&&n(2,i=t.DtpHearths3),"DtpHearthsStat"in t&&n(3,a=t.DtpHearthsStat),"DtpHearthsTmp"in t&&n(4,c=t.DtpHearthsTmp),"DtpHearths"in t&&n(5,p=t.DtpHearths),"DtpSkpdi"in t&&n(6,d=t.DtpSkpdi),"DtpGibdd"in t&&n(7,u=t.DtpGibdd)},[s,r,i,a,c,p,d,u,o,l,A,H,I,J,W,Q,X,et,ot,lt,st,it,ct,pt,dt,ut,_t,vt,ft,mt,gt,yt,xt,kt,jt,Ct,y,b,j,C,D,w,T,F,E,M,O,z,$,P,U,B,R,Z,Y,t=>{let e=t.target;_=Number(e.value),R()},()=>{let t=k.getDate(),e=x.getDate(),n=t-e;0===n&&(n=864e5),x.setDate(new Date(e.getTime()-n)),k.setDate(new Date(t.getTime()-n)),g=[x.getDate().getTime()/1e3,86400+k.getDate().getTime()/1e3],R()},()=>{let t=k.getDate(),e=x.getDate(),n=t-e;0===n&&(n=864e5),x.setDate(new Date(e.getTime()+n)),k.setDate(new Date(t.getTime()+n)),g=[x.getDate().getTime()/1e3,86400+k.getDate().getTime()/1e3],R()},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,i=o.name;if("hearths_period_type_52"===s)n(15,Q=2);else if("hearths_period_type_51"===s)n(15,Q=1);else if("hearths_year_5"===s)l?n(16,X[i]=!0,X):delete X[i];else if("hearths_quarter_5"===s){let t=i.split("_");l?(tt[t[0]]||(tt[t[0]]={}),tt[t[0]][t[1]]=!0):(tt[t[0]]&&delete tt[t[0]][t[1]],0===Object.keys(tt[t[0]]).length&&delete tt[t[0]])}1===Q?e.push({type:"year",zn:X}):2===Q&&e.push({type:"quarter",zn:tt}),J&&e.push({type:"stricken",zn:Number(J)}),W.length>0&&W[0]&&e.push({type:"str_icon_type",zn:W}),r.setFilter(e)},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,r=o.name;if("hearths_period_type_32"===s)n(19,lt=2);else if("hearths_period_type_31"===s)n(19,lt=1);else if("hearths_year_3"===s)l?n(20,st[r]=!0,st):delete st[r];else if("hearths_quarter_3"===s){let t=r.split("_");l?(rt[t[0]]||(rt[t[0]]={}),rt[t[0]][t[1]]=!0):(rt[t[0]]&&delete rt[t[0]][t[1]],0===Object.keys(rt[t[0]]).length&&delete rt[t[0]])}1===lt?e.push({type:"year",zn:st}):2===lt&&e.push({type:"quarter",zn:rt}),et&&e.push({type:"stricken",zn:Number(et)}),ot.length>0&&ot[0]&&e.push({type:"str_icon_type",zn:ot}),i.setFilter(e)},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,r=o.name;if("hearths_period_type_Stat2"===s)n(23,pt=2);else if("hearths_period_type_Stat1"===s)n(23,pt=1);else if("hearths_year_Stat"===s)l?n(24,dt[r]=!0,dt):delete dt[r];else if("hearths_quarter_Stat"===s){let t=r.split("_");l?(ut[t[0]]||n(25,ut[t[0]]={},ut),n(25,ut[t[0]][t[1]]=!0,ut)):(ut[t[0]]&&delete ut[t[0]][t[1]],0===Object.keys(ut[t[0]]).length&&delete ut[t[0]])}1===pt?e.push({type:"year",zn:dt}):2===pt&&e.push({type:"quarter",zn:ut}),it&&e.push({type:"stricken",zn:Number(it)}),ct.length>0&&ct[0]&&e.push({type:"str_icon_type",zn:ct}),a.setFilter(e)},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,r=o.name;if("hearths_period_type_tmp2"===s)n(28,ft=2);else if("hearths_period_type_tmp1"===s)n(28,ft=1);else if("hearths_year_tmp"===s)l?n(29,mt[r]=!0,mt):delete mt[r];else if("hearths_quarter_tmp"===s){let t=r.split("_");l?(gt[t[0]]||n(30,gt[t[0]]={},gt),n(30,gt[t[0]][t[1]]=!0,gt)):(gt[t[0]]&&delete gt[t[0]][t[1]],0===Object.keys(gt[t[0]]).length&&delete gt[t[0]])}1===ft?e.push({type:"year",zn:mt}):2===ft&&e.push({type:"quarter",zn:gt}),_t&&e.push({type:"stricken",zn:Number(_t)}),vt.length>0&&vt[0]&&e.push({type:"str_icon_type",zn:vt}),c.setFilter(e)},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,r=o.name;if(console.log("setFilterHearths",l,s,r,t),"hearths_period_type2"===s)n(33,kt=2);else if("hearths_period_type1"===s)n(33,kt=1);else if("hearths_year"===s)l?n(34,jt[r]=!0,jt):delete jt[r];else if("hearths_quarter"===s){let t=r.split("_");l?(Ct[t[0]]||n(35,Ct[t[0]]={},Ct),n(35,Ct[t[0]][t[1]]=!0,Ct)):(Ct[t[0]]&&delete Ct[t[0]][t[1]],0===Object.keys(Ct[t[0]]).length&&delete Ct[t[0]])}1===kt?e.push({type:"year",zn:jt}):2===kt&&e.push({type:"quarter",zn:Ct}),yt&&e.push({type:"stricken",zn:Number(yt)}),xt.length>0&&xt[0]&&e.push({type:"str_icon_type",zn:xt}),p.setFilter(e)},_,g,x,k,tt,K,rt,nt,at,ht,bt,h,v,f,m,function(){Q=this.__value,n(15,Q)},[[],[],[],[],[]],(t,e)=>t+=U.str_icon_type[e],function(){W=q(this),n(14,W),n(51,B)},function(){J=S(this),n(13,J)},function(){lt=this.__value,n(19,lt)},(t,e)=>t+=$.str_icon_type[e],function(){ot=q(this),n(18,ot),n(49,P)},function(){et=S(this),n(17,et)},function(){pt=this.__value,n(23,pt)},function(){pt=this.__value,n(23,pt)},(t,e)=>t+=O.str_icon_type[e],function(){ct=q(this),n(22,ct),n(47,z)},function(){it=S(this),n(21,it)},function(){ft=this.__value,n(28,ft)},function(){ft=this.__value,n(28,ft)},(t,e)=>t+=E.str_icon_type[e],function(){vt=q(this),n(27,vt),n(45,M)},function(){_t=S(this),n(26,_t)},function(){kt=this.__value,n(33,kt)},function(){kt=this.__value,n(33,kt)},(t,e)=>t+=T.str_icon_type[e],function(){xt=q(this),n(32,xt),n(43,F)},function(){yt=S(this),n(31,yt)},function(t){G[t?"unshift":"push"](()=>{n(8,o=t)})},function(t){G[t?"unshift":"push"](()=>{n(9,l=t)})},(t,e)=>t+=y.collision_type[e],function(){A=q(this),n(10,A),n(37,b)},(t,e)=>t+=j.collision_type[e],function(){H=q(this),n(11,H),n(39,C)},(t,e)=>t+=D.collision_type[e],function(){I=q(this),n(12,I),n(41,w)}]}oe.setFilter=t=>{oe.clearLayers(),ne=t;let e=[];oe._group&&(oe._group.getLayers().forEach(t=>{let n=t.options.props,o=0;ne.forEach(t=>{"itemType"===t.type?(0===t.zn||1===t.zn&&n.id_stat&&n.id_skpdi||2===t.zn&&n.id_skpdi&&!n.id_stat||3===t.zn&&n.id_stat&&!n.id_skpdi)&&o++:"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===n.collision_type).length)&&o++:"date"===t.type&&n.date>=t.zn[0]&&n.date<t.zn[1]&&o++}),o===ne.length&&e.push(t)}),oe.addLayer(te.layerGroup(e)))},oe.on("remove",()=>{oe.clearLayers()}).on("add",t=>{fetch("https://dtp.mvs.group/scripts/index.php?request=get_collision",{}).then(t=>t.json()).then(t=>{let e={collision_type:{},iconType:{}},n=t.map(t=>{let n=t.iconType||0,o=[],l=!1,s="#2F4F4F";n&&(l=n%2==0,n>=1&&n<=6?s="#8B4513":7===n||8===n?s="#228B22":n>=9&&n<=14?s="#8B4513":15===n||16===n?s="#7B68EE":17!==n&&18!==n||(s="#2F4F4F")),t.id_skpdi&&o.push({type:"skpdi",id:t.id_skpdi}),t.id_stat&&o.push({type:"gibdd",id:t.id_stat}),t._cur=o,t.lat&&t.lon||(console.log("_______",t),t.lat=t.lon=0);let r=e.collision_type[t.collision_type];return r?r++:r=1,e.collision_type[t.collision_type]=r,e.iconType[t.collision_type]=n,new _(te.latLng(t.lat,t.lon),{props:t,radius:6,triangle:o.length>1,box:!!t.id_skpdi,stroke:l,fillColor:s}).bindPopup(ee).on("popupopen",t=>{!function(t){let e=te.DomUtil.create("div");new Xt({target:e,props:{prp:t}}),ee.setContent(e)}(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});oe._opt=e,oe._group=te.layerGroup(n),ne?oe.setFilter(ne):oe.addLayer(oe._group),oe._refreshFilters()})});class nn extends dt{constructor(t){super(),pt(this,t,en,tn,y,{DtpVerifyed:0,DtpHearths5:1,DtpHearths3:2,DtpHearthsStat:3,DtpHearthsTmp:4,DtpHearths:5,DtpSkpdi:6,DtpGibdd:7},[-1,-1,-1,-1,-1])}}function on(t,e,n){const o=t.slice();return o[7]=e[n],o[9]=n,o}function ln(t){let e,n;const o=new Xt({props:{prp:t[7],closeMe:t[6]}});return{c(){e=D("div"),rt(o.$$.fragment),O(e,"class","win leaflet-popup-content-wrapper  svelte-mnr9l0")},m(t,l){k(t,e,l),it(o,e,null),n=!0},p(t,e){const n={};1&e&&(n.prp=t[7]),2&e&&(n.closeMe=t[6]),o.$set(n)},i(t){n||(lt(o.$$.fragment,t),n=!0)},o(t){st(o.$$.fragment,t),n=!1},d(t){t&&j(e),at(o)}}}function sn(t){let e,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,g,y,b,C,L,F,M=new Date(1e3*t[7].date).toLocaleDateString()+"",$=t[7].lost+"",P=t[7].stricken+"",S=t[7].address+"";function q(...e){return t[4](t[9],...e)}function U(...e){return t[5](t[9],...e)}let B=t[1]===t[9]&&ln(t);return{c(){e=D("tr"),n=D("td"),o=D("ul"),l=D("li"),s=w(M),r=w(" погибших "),i=w($),a=w(", раненых "),c=w(P),d=T(),u=D("tr"),_=D("td"),_.textContent="Адрес:",h=T(),v=D("td"),f=w(S),g=D("br"),y=D("span"),y.textContent="подробнее",b=T(),B&&B.c(),C=T(),O(l,"title",p="id: "+t[7].id),O(l,"class","svelte-mnr9l0"),O(n,"class","first svelte-mnr9l0"),O(n,"colspan","2"),O(_,"class","first svelte-mnr9l0"),O(y,"class","link svelte-mnr9l0")},m(t,p,j){k(t,e,p),x(e,n),x(n,o),x(o,l),x(l,s),x(l,r),x(l,i),x(l,a),x(l,c),k(t,d,p),k(t,u,p),x(u,_),x(u,h),x(u,v),x(v,f),x(v,g),x(v,y),x(v,b),B&&B.m(v,null),x(u,C),L=!0,j&&m(F),F=[E(l,"click",q),E(y,"click",U)]},p(e,n){t=e,(!L||1&n)&&M!==(M=new Date(1e3*t[7].date).toLocaleDateString()+"")&&z(s,M),(!L||1&n)&&$!==($=t[7].lost+"")&&z(i,$),(!L||1&n)&&P!==(P=t[7].stricken+"")&&z(c,P),(!L||1&n&&p!==(p="id: "+t[7].id))&&O(l,"title",p),(!L||1&n)&&S!==(S=t[7].address+"")&&z(f,S),t[1]===t[9]?B?(B.p(t,n),lt(B,1)):(B=ln(t),B.c(),lt(B,1),B.m(v,null)):B&&(nt(),st(B,1,1,()=>{B=null}),ot())},i(t){L||(lt(B),L=!0)},o(t){st(B),L=!1},d(t){t&&j(e),t&&j(d),t&&j(u),B&&B.d(),m(F)}}}function rn(t){let e,n,o,l,s,r,i,a,c,p,d,u,_,h,v,f,m,g,y,b,L,F,E,M,$,P,S,q,U,B,N,A,H,I,G,R,Z,Y,V,J,K=t[0].id+"",W=t[0].quarter?t[0].quarter+" кв.":"",Q=t[0].year+"",X=(t[0].str_icon_type||"")+"",tt=t[0].list_dtp.length+"",et=t[0].count_lost+"",rt=t[0].count_stricken+"",it=t[0].list_dtp,at=[];for(let e=0;e<it.length;e+=1)at[e]=sn(on(t,it,e));const ct=t=>st(at[t],1,1,()=>{at[t]=null});return{c(){e=D("div"),n=D("div"),o=w("Очаг ДТП (id: "),l=w(K),s=w(")"),r=T(),i=D("div"),a=w(W),c=T(),p=w(Q),d=w("г."),u=T(),_=D("div"),h=D("table"),v=D("tbody"),f=D("tr"),m=D("td"),m.textContent="Тип ДТП:",g=T(),y=D("td"),b=w(X),L=T(),F=D("tr"),E=D("td"),E.textContent="Всего ДТП:",M=T(),$=D("td"),P=w(tt),S=T(),q=D("tr"),U=D("td"),U.textContent="Погибших:",B=T(),N=D("td"),A=w(et),H=T(),I=D("tr"),G=D("td"),G.textContent="Раненых:",R=T(),Z=D("td"),Y=w(rt),V=T();for(let t=0;t<at.length;t+=1)at[t].c();O(n,"class","pLine"),O(i,"class","pLine"),O(m,"class","first svelte-mnr9l0"),O(E,"class","first svelte-mnr9l0"),O(U,"class","first svelte-mnr9l0"),O(G,"class","first svelte-mnr9l0"),O(h,"class","table svelte-mnr9l0"),O(_,"class","featureCont"),O(e,"class","mvsPopup svelte-mnr9l0")},m(t,j){k(t,e,j),x(e,n),x(n,o),x(n,l),x(n,s),x(e,r),x(e,i),x(i,a),x(i,c),x(i,p),x(i,d),x(e,u),x(e,_),x(_,h),x(h,v),x(v,f),x(f,m),x(f,g),x(f,y),x(y,b),x(v,L),x(v,F),x(F,E),x(F,M),x(F,$),x($,P),x(v,S),x(v,q),x(q,U),x(q,B),x(q,N),x(N,A),x(v,H),x(v,I),x(I,G),x(I,R),x(I,Z),x(Z,Y),x(v,V);for(let t=0;t<at.length;t+=1)at[t].m(v,null);J=!0},p(t,[e]){if((!J||1&e)&&K!==(K=t[0].id+"")&&z(l,K),(!J||1&e)&&W!==(W=t[0].quarter?t[0].quarter+" кв.":"")&&z(a,W),(!J||1&e)&&Q!==(Q=t[0].year+"")&&z(p,Q),(!J||1&e)&&X!==(X=(t[0].str_icon_type||"")+"")&&z(b,X),(!J||1&e)&&tt!==(tt=t[0].list_dtp.length+"")&&z(P,tt),(!J||1&e)&&et!==(et=t[0].count_lost+"")&&z(A,et),(!J||1&e)&&rt!==(rt=t[0].count_stricken+"")&&z(Y,rt),7&e){let n;for(it=t[0].list_dtp,n=0;n<it.length;n+=1){const o=on(t,it,n);at[n]?(at[n].p(o,e),lt(at[n],1)):(at[n]=sn(o),at[n].c(),lt(at[n],1),at[n].m(v,null))}for(nt(),n=it.length;n<at.length;n+=1)ct(n);ot()}},i(t){if(!J){for(let t=0;t<it.length;t+=1)lt(at[t]);J=!0}},o(t){at=at.filter(Boolean);for(let t=0;t<at.length;t+=1)st(at[t]);J=!1},d(t){t&&j(e),C(at,t)}}}function an(t,e,n){let o,{prp:l}=e;const s=t=>{let e=l._bounds.options.items[t];e&&e._map&&e._map.panTo(e._latlng)};return t.$set=t=>{"prp"in t&&n(0,l=t.prp)},[l,o,s,t=>{console.log("showDtpInfo ",t)},t=>{s(t)},t=>{n(1,o=t)},()=>{n(1,o=null)}]}class cn extends dt{constructor(t){super(),pt(this,t,an,rn,y,{prp:0})}}const pn=window.L,dn=pn.popup(),un=pn.popup({minWidth:200});let _n;const hn=function(t){let e=pn.DomUtil.create("div");return new Xt({target:e,props:{prp:t}}),dn.setContent(e),e},vn=pn.featureGroup([]);vn.setFilter=t=>{vn.clearLayers(),_n=t;let e=[];vn._group&&(vn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;_n.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&n.count_lost||2===e&&n.count_stricken||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===_n.length&&e.push(t)}),vn.addLayer(pn.layerGroup(e)))},vn.on("remove",()=>{vn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearths/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=pn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let c=a[t.quarter];t.quarter in a?c++:c=a[t.quarter]=1,a[t.quarter]=c;let p=e.str_icon_type[t.str_icon_type];p?p++:p=1,e.str_icon_type[t.str_icon_type]=p,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=pn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let c=e.dtps[n.id];return c?c[t.id]?c[t.id]++:c[t.id]=1:(c={},c[t.id]=1),e.dtps[n.id]=c,new _(pn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(dn).on("popupopen",t=>{hn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=pn.rectangle(l,{items:d,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{pn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._latlng.distanceTo(s);e<o&&(o=e,n=t)}),o<10?(hn(n.options.props),dn.setLatLng(n._latlng).openOn(vn._map)):(!function(t){let e=pn.DomUtil.create("div");new cn({target:e,props:{prp:t}}),un.setContent(e)}(t),un.setLatLng(s).openOn(vn._map))}),n.push(t._bounds),n=n.concat(d)}}),vn._opt=e,vn._group=pn.layerGroup(n),_n?vn.setFilter(_n):vn.addLayer(vn._group),vn._refreshFilters()}),console.log("__allJson_____",t,vn._opt)})});const fn=window.L,mn=fn.popup(),gn=fn.popup({minWidth:200});let yn;const bn=function(t){let e=fn.DomUtil.create("div");return new Xt({target:e,props:{prp:t}}),mn.setContent(e),e},xn=fn.featureGroup([]);xn.setFilter=t=>{xn.clearLayers(),yn=t;let e=[];xn._group&&(xn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;yn.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&n.count_lost||2===e&&n.count_stricken||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===yn.length&&e.push(t)}),xn.addLayer(fn.layerGroup(e)))},xn.on("remove",()=>{xn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearthstmp/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=fn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let c=a[t.quarter];t.quarter in a?c++:c=a[t.quarter]=1,a[t.quarter]=c;let p=e.str_icon_type[t.str_icon_type];p?p++:p=1,e.str_icon_type[t.str_icon_type]=p,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=fn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let c=e.dtps[n.id];return c?c[t.id]?c[t.id]++:c[t.id]=1:(c={},c[t.id]=1),e.dtps[n.id]=c,new _(fn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(mn).on("popupopen",t=>{bn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=fn.rectangle(l,{items:d,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{fn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._latlng.distanceTo(s);e<o&&(o=e,n=t)}),o<10?(bn(n.options.props),mn.setLatLng(n._latlng).openOn(xn._map)):(!function(t){let e=fn.DomUtil.create("div");new cn({target:e,props:{prp:t}}),gn.setContent(e)}(t),gn.setLatLng(s).openOn(xn._map))}),n.push(t._bounds),n=n.concat(d)}}),xn._opt=e,xn._group=fn.layerGroup(n),yn?xn.setFilter(yn):xn.addLayer(xn._group),xn._refreshFilters()}),console.log("__allJson_____",t,xn._opt)})});const kn=window.L,jn=kn.popup(),Cn=kn.popup({minWidth:200});let Ln;const Dn=function(t){let e=kn.DomUtil.create("div");return new Xt({target:e,props:{prp:t}}),jn.setContent(e),e},wn=kn.featureGroup([]);wn.setFilter=t=>{wn.clearLayers(),Ln=t;let e=[];wn._group&&(wn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;Ln.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&n.count_lost||2===e&&n.count_stricken||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===Ln.length&&e.push(t)}),wn.addLayer(kn.layerGroup(e)))},wn.on("remove",()=>{wn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearthsstat/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=kn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let c=a[t.quarter];t.quarter in a?c++:c=a[t.quarter]=1,a[t.quarter]=c;let p=e.str_icon_type[t.str_icon_type];p?p++:p=1,e.str_icon_type[t.str_icon_type]=p,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=kn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let c=e.dtps[n.id];return c?c[t.id]?c[t.id]++:c[t.id]=1:(c={},c[t.id]=1),e.dtps[n.id]=c,new _(kn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(jn).on("popupopen",t=>{Dn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=kn.rectangle(l,{items:d,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{kn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<o&&(o=e,n=t)}),o<10?(Dn(n.options.props),jn.setLatLng(n._latlng).openOn(wn._map)):(!function(t){let e=kn.DomUtil.create("div");new cn({target:e,props:{prp:t}}),Cn.setContent(e)}(t),Cn.setLatLng(s).openOn(wn._map))}),n.push(t._bounds),n=n.concat(d)}}),wn._opt=e,wn._group=kn.layerGroup(n),Ln?wn.setFilter(Ln):wn.addLayer(wn._group),wn._refreshFilters()}),console.log("__allJson_____",t,wn._opt)})});const Tn=window.L,Fn=Tn.popup(),En=Tn.popup({minWidth:200});let Mn;const On=function(t){let e=Tn.DomUtil.create("div");return new Xt({target:e,props:{prp:t}}),Fn.setContent(e),e},zn=Tn.featureGroup([]);zn.setFilter=t=>{zn.clearLayers(),Mn=t;let e=[];zn._group&&(zn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;Mn.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&n.count_lost||2===e&&n.count_stricken||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===Mn.length&&e.push(t)}),zn.addLayer(Tn.layerGroup(e)))},zn.on("remove",()=>{zn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearths3/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=Tn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let c=a[t.quarter];t.quarter in a?c++:c=a[t.quarter]=1,a[t.quarter]=c;let p,d=e.str_icon_type[t.str_icon_type];d?d++:d=1,e.str_icon_type[t.str_icon_type]=d,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let u=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=Tn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id===t.head&&(p=n),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let c=e.dtps[n.id];return c?c[t.id]?c[t.id]++:c[t.id]=1:(c={},c[t.id]=1),e.dtps[n.id]=c,new _(Tn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(Fn).on("popupopen",t=>{On(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=p?Tn.circle(Tn.latLng(p.coords.lat,p.coords.lon),{radius:t.radius||500,items:u,cluster:t,color:i}):Tn.rectangle(l,{items:u,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}),t._bounds.on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{Tn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<o&&(o=e,n=t)}),o<10?(On(n.options.props),Fn.setLatLng(n._latlng).openOn(zn._map)):(!function(t){let e=Tn.DomUtil.create("div");new cn({target:e,props:{prp:t}}),En.setContent(e)}(t),En.setLatLng(s).openOn(zn._map))}),n.push(t._bounds),n=n.concat(u)}}),zn._opt=e,zn._group=Tn.layerGroup(n),Mn?zn.setFilter(Mn):zn.addLayer(zn._group),zn._refreshFilters()}),console.log("__allJson_____",t,zn._opt)})});const $n=window.L,Pn=$n.popup(),Sn=$n.popup({minWidth:200});let qn;const Un=function(t){let e=$n.DomUtil.create("div");return new Xt({target:e,props:{prp:t}}),Pn.setContent(e),e},Bn=$n.featureGroup([]);Bn.setFilter=t=>{Bn.clearLayers(),qn=t;let e=[];Bn._group&&(Bn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;qn.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&!n.count_stricken&&n.count_lost||2===e&&n.count_stricken&&!n.count_lost||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===qn.length&&e.push(t)}),Bn.addLayer($n.layerGroup(e)))},Bn.on("remove",()=>{Bn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearths5/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=$n.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let c=a[t.quarter];t.quarter in a?c++:c=a[t.quarter]=1,a[t.quarter]=c;let p,d=e.str_icon_type[t.str_icon_type];d?d++:d=1,e.str_icon_type[t.str_icon_type]=d,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let u=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=$n.latLng(o.lat,o.lon),a=[];l.extend(s),n.id===t.head&&(p=n),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let c=e.dtps[n.id];return c?c[t.id]?c[t.id]++:c[t.id]=1:(c={},c[t.id]=1),e.dtps[n.id]=c,new _($n.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(Pn).on("popupopen",t=>{Un(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=p?$n.circle($n.latLng(p.coords.lat,p.coords.lon),{radius:t.radius||500,items:u,cluster:t,color:i}):$n.rectangle(l,{items:u,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}),t._bounds.on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{$n.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<o&&(o=e,n=t)}),o<10?(Un(n.options.props),Pn.setLatLng(n._latlng).openOn(Bn._map)):(!function(t){let e=$n.DomUtil.create("div");new cn({target:e,props:{prp:t}}),Sn.setContent(e)}(t),Sn.setLatLng(s).openOn(Bn._map))}),n.push(t._bounds),n=n.concat(u)}}),Bn._opt=e,Bn._group=$n.layerGroup(n),qn?Bn.setFilter(qn):Bn.addLayer(Bn._group),Bn._refreshFilters()}),console.log("__allJson_____",t,Bn._opt)})});const Nn=window.L,An=Nn.map(document.body,{center:[55.758031,37.611694],minZoom:1,zoom:8,maxZoom:21,attributionControl:!1,trackResize:!0,fadeAnimation:!0,zoomAnimation:!0,distanceUnit:"auto",squareUnit:"auto"});An.on("zoomend",()=>{An._crpx=0});var Hn=An._controlCorners,In=An._controlContainer,Gn="leaflet-top leaflet-bottom",Rn="leaflet-left leaflet-right",Zn={bottom:"leaflet-bottom "+Rn,gmxbottomleft:"leaflet-bottom leaflet-left",gmxbottomcenter:"leaflet-bottom "+Rn,gmxbottomright:"leaflet-bottom leaflet-right",center:Gn+" "+Rn,right:"leaflet-right "+Gn,left:"leaflet-left "+Gn,top:"leaflet-top "+Rn};for(var Yn in Zn)Hn[Yn]||(Hn[Yn]=Nn.DomUtil.create("div",Zn[Yn],In));An.addControl(Nn.control.gmxCenter()).addControl(Nn.control.fitCenter());var Vn=Nn.TileLayer.extend({options:{tilesCRS:Nn.CRS.EPSG3395},_getTiledPixelBounds:function(t){var e=Nn.TileLayer.prototype._getTiledPixelBounds.call(this,t);return this._shiftY=this._getShiftY(this._tileZoom),e.min.y+=this._shiftY,e.max.y+=this._shiftY,e},_tileOnError:function(t,e,n){var o=e.getAttribute("src"),l=o.indexOf("/mapcache/");if(l>-1){var s=new URL("http:"+o).searchParams,r=o.substr(l+1).split("/"),i=a[r[1]];e.src=Nn.Util.template(i.errorTileUrlPrefix+i.postfix,{z:s.get("z"),x:s.get("x"),y:s.get("y")})}t(n,e)},_getTilePos:function(t){return Nn.TileLayer.prototype._getTilePos.call(this,t).subtract([0,this._shiftY])},_getShiftY:function(t){var e=this._map,n=e.getCenter(),o=e.options.crs.project(n).y-this.options.tilesCRS.project(n).y;return Math.floor(Nn.CRS.scale(t)*o/40075016.685578495)}});Nn.TileLayer.Mercator=Vn,Nn.tileLayer.Mercator=function(t,e){return new Vn(t,e)};let Jn={};c.b||(c.b="m2"),["m2","m3"].forEach(t=>{let e=a[t],n=Nn.tileLayer.Mercator(e.prefix+e.postfix,e.options);Jn[e.title]=n,c.b===e.options.key&&n.addTo(An)}),Jn.OpenStreetMap=Nn.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:21,maxNativeZoom:18});let Kn={"ДТП Очаги(5)":Bn,"ДТП Очаги(3)":zn,"ДТП Очаги(Stat)":wn,"ДТП Очаги(tmp)":xn,"ДТП Очаги":vn,"ДТП Сводный":oe,"ДТП СКПДИ":Zt,"ДТП ГИБДД":zt},Wn=c.o?c.o.split(",").reduce((t,e)=>(t[e]=!0,t),{}):{};["m1","m4","m5"].forEach(t=>{let e=a[t],n=Nn.tileLayer.Mercator(e.prefix+e.postfix,e.options);Kn[e.title]=n,Wn[e.options.key]&&n.addTo(An)}),Nn.control.layers(Jn,Kn).addTo(An);let Qn=Nn.control.gmxIcon({id:"filters",className:"leaflet-bar",togglable:!0,title:"Фильтры"}).on("statechange",(function(t){console.log({filtersIcon:t.target.options.isActive});let e=t.target,n=e._container,o=e._win;e.options.isActive?o||(o=e._win=Nn.DomUtil.create("div","win leaflet-control-layers",n),Nn.DomEvent.disableScrollPropagation(o),o._Filters=new nn({target:o,props:{DtpGibdd:zt,DtpSkpdi:Zt,DtpHearths5:Bn,DtpHearths3:zn,DtpHearthsStat:wn,DtpHearthsTmp:xn,DtpHearths:vn,DtpVerifyed:oe}})):(e._win.parentNode.removeChild(e._win),e._win=null)})).addTo(An);const Xn=(t,e)=>{for(var n=Math.PI/180,o={lon:n*t.lng,lat:n*t.lat},l={lon:n*e.lng,lat:n*e.lat},s=6378137,r=6356752.3142,i=1/298.257223563,a=l.lon-o.lon,c=Math.atan((1-i)*Math.tan(o.lat)),p=Math.atan((1-i)*Math.tan(l.lat)),d=Math.sin(c),u=Math.cos(c),_=Math.sin(p),h=Math.cos(p),v=a,f=2*Math.PI,m=20;Math.abs(v-f)>1e-12&&--m>0;){var g=Math.sin(v),y=Math.cos(v),b=Math.sqrt(h*g*(h*g)+(u*_-d*h*y)*(u*_-d*h*y));if(0===b)return 0;var x=d*_+u*h*y,k=Math.atan2(b,x),j=u*h*g/b,C=1-j*j,L=x-2*d*_/C;isNaN(L)&&(L=0);var D=i/16*C*(4+i*(4-3*C));f=v,v=a+(1-D)*i*j*(k+D*b*(L+D*x*(2*L*L-1)))}if(0===m)return NaN;var w=C*(s*s/(r*r)-1),T=w/1024*(256+w*(w*(74-47*w)-128));return r*(1+w/16384*(4096+w*(w*(320-175*w)-768)))*(k-T*b*(L+T/4*(x*(2*L*L-1)-T/6*L*(4*b*b-3)*(4*L*L-3))))};let to,eo;An.pm.setLang("customName",{tooltips:{finishLine:"Щелкните любой существующий маркер для завершения"}},"ru"),An.pm.setLang("ru"),An.on("pm:create",t=>{An.removeLayer(t.layer),no.setActive(!1)}).on("pm:drawstart",t=>{let e=t.workingLayer;if("Line"===t.shape){let n=An.pm.Draw.Line._hintMarker;n&&n.on("move",(function(t){var o=e.getLatLngs();if(o.length){var l=(t=>{let e=0,n=(t=t||[])[0];return t.forEach(t=>{e+=Xn(t,n),n=t}),e})(o),s=Xn(o[o.length-1],t.latlng),r=(l+=s)>1e3?(l/1e3).toFixed(2)+" км":Math.ceil(l)+" м",i=s>1e3?(s/1e3).toFixed(2)+" км":Math.ceil(s)+" м";n._tooltip.setContent("Отрезок <b>("+i+")</b>участка <b>("+r+")</b>")}})),to&&t.target.pm.Toolbar.buttons.drawPolyline.buttonsDomNode&&(eo=t.target.pm.Toolbar.buttons.drawPolyline.buttonsDomNode.children[1],eo.style.display="none")}});let no=Nn.control.gmxIcon({id:"measure",className:"leaflet-bar",togglable:!0,title:"Включить/Отключить режим измерения расстояний"}).on("statechange",(function(t){to=t.target.options.isActive,to?An.pm.enableDraw("Line",{finishOn:"dblclick"}):(An.pm.disableDraw("Line"),eo&&(eo.style.display=""))})).addTo(An);const oo=()=>{setTimeout(()=>{Qn.options.isActive&&(Qn.setActive(!1),Qn._win=null,Qn.setActive(!0))})};zt._refreshFilters=Zt._refreshFilters=oe._refreshFilters=vn._refreshFilters=wn._refreshFilters=zn._refreshFilters=Bn._refreshFilters=xn._refreshFilters=oo;return zt.on("remove",oo),Zt.on("remove",oo),oe.on("remove",oo),vn.on("remove",oo),xn.on("remove",oo),wn.on("remove",oo),zn.on("remove",oo),Bn.on("remove",oo),An}();
//# sourceMappingURL=main.js.map
