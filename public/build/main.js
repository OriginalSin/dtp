var dtp=function(){"use strict";const t=window.L;t.Control.GmxIcon=t.Control.extend({includes:t.Evented?t.Evented.prototype:t.Mixin.Events,options:{position:"topleft",id:"defaultIcon",isActive:!1},setActive:function(e,n,l){var o=this.options,s=this._container;if(o.togglable||o.toggle){var r=o.isActive,i=this._prefix,a=i+"-"+o.id;o.isActive=e,this._img&&(e&&o.activeImageUrl?this._img.src=o.activeImageUrl:!e&&o.regularImageUrl&&(this._img.src=o.regularImageUrl)),e?(t.DomUtil.addClass(s,i+"-active"),t.DomUtil.addClass(s,a+"-active"),s.children.length&&t.DomUtil.addClass(s,i+"-externalImage-active"),o.styleActive&&this.setStyle(o.styleActive)):(t.DomUtil.removeClass(s,i+"-active"),t.DomUtil.removeClass(s,a+"-active"),s.children.length&&t.DomUtil.removeClass(s,i+"-externalImage-active"),o.style&&this.setStyle(o.style)),n||r===e||this.fire("statechange",l)}if(t.gmxUtil&&t.gmxUtil.isIEOrEdge){var p=s.getElementsByTagName("use");if(p.length){var c=p[0],d=c.getAttribute("href")||c.getAttribute("xlink:href");c.setAttribute("href",d)}}},onAdd:function(e){var n=null,l=this.options,o=l.svgSprite||e.options.svgSprite,s="leaflet-gmx-icon"+(!o||l.regularImageUrl||l.text?"":"Svg"),r=s+"-"+l.id;this._prefix=s;var i=t.DomUtil.create("div",s+" "+r);if(i._id=l.id,this._container=i,l.title&&(i.title=l.title),this.setStyle=function(t){for(var e in t)i.style[e]=t[e]},l.className&&t.DomUtil.addClass(i,l.className),l.regularImageUrl)(n=t.DomUtil.create("img","",i)).src=l.regularImageUrl,this._img=n,t.DomUtil.addClass(i,s+"-img"),t.DomUtil.addClass(i,s+"-externalImage");else if(l.text)t.DomUtil.addClass(i,s+"-text"),t.DomUtil.create("span","",i).innerHTML=l.text;else if(o){t.DomUtil.addClass(i,"svgIcon");var a="#"+l.id.toLowerCase();i.innerHTML='<svg role="img" class="svgIcon"><use xlink:href="'+a+'" href="'+a+'"></use></svg>'}else t.DomUtil.addClass(i,s+"-img "+s+"-sprite");l.style&&this.setStyle(l.style),this._iconClick=function(t){i.parentNode&&i===t.toElement&&(this.setActive(!this.options.isActive,!1,t),this.fire("click",t),this.options.stateChange&&this.options.stateChange(this,t))};var p=t.DomEvent.stopPropagation;t.DomEvent.preventDefault;return t.DomEvent.on(i,"mousemove",p).on(i,"touchstart",p).on(i,"mousedown",p).on(i,"dblclick",p).on(i,"click",p).on(i,"click",this._iconClick,this),l.onAdd&&l.onAdd(this),this.fire("controladd"),e.fire("controladd",this),l.notHide&&(i._notHide=!0),e.gmxControlsManager&&e.gmxControlsManager.add(this),i},onRemove:function(e){e.gmxControlsManager&&e.gmxControlsManager.remove(this),this.fire("controlremove"),e.fire("controlremove",this);var n=this._container,l=t.DomEvent.stopPropagation;t.DomEvent.off(n,"mousemove",l).off(n,"touchstart",l).off(n,"mousedown",l).off(n,"dblclick",l).off(n,"click",l).off(n,"click",this._iconClick,this)},addTo:function(e){return t.Control.prototype.addTo.call(this,e),this.options.addBefore&&this.addBefore(this.options.addBefore),this},addBefore:function(t){var e=this._parent&&this._parent._container;if(e||(e=this._map&&this._map._controlCorners[this.getPosition()]),e)for(var n=0,l=e.childNodes.length;n<l;n++){var o=e.childNodes[n];if(t===o._id){e.insertBefore(this._container,o);break}}else this.options.addBefore=t;return this}}),t.Control.gmxIcon=t.Control.GmxIcon,t.control.gmxIcon=function(e){return new t.Control.GmxIcon(e)};const e=window.L;e.Control.GmxCenter=e.Control.extend({options:{position:"center",id:"center",notHide:!0,color:"red"},onRemove:function(t){t.gmxControlsManager&&t.gmxControlsManager.remove(this),t.fire("controlremove",this)},onAdd:function(t){var n="http://www.w3.org/2000/svg",l=e.DomUtil.create("div","leaflet-gmx-center"),o=e.DomUtil.create("div","leaflet-gmx-center"),s=document.createElementNS(n,"svg"),r=document.createElementNS(n,"g"),i=document.createElementNS(n,"path");return this._container=l,l._id=this.options.id,this.options.notHide&&(l._notHide=!0),i.setAttribute("stroke-width",2),i.setAttribute("stroke-opacity",2),i.setAttribute("d","M9 0L9 18M0 9L18 9"),this._path=i,r.appendChild(i),s.appendChild(r),s.setAttribute("width",18),s.setAttribute("height",18),o.appendChild(s),l.appendChild(o),this.setColor(this.options.color),t.fire("controladd",this),t.gmxControlsManager&&t.gmxControlsManager.add(this),l},setColor:function(t){return this.options.color=t,this._map&&this._path.setAttribute("stroke",t),this}}),e.Control.gmxCenter=e.Control.GmxCenter,e.control.gmxCenter=function(t){return new e.Control.GmxCenter(t)};const n=window.L;n.Control.FitCenter=n.Control.extend({options:{position:"topright",id:"fitcenter",notHide:!0,color:"#216b9c"},onRemove:function(t){t.gmxControlsManager&&t.gmxControlsManager.remove(this),t.off("moveend",this._update,this).fire("controlremove",this)},onAdd:function(t){var e=this.options.id,l="leaflet-gmx-"+e,o=n.DomUtil.create("div",l),s=n.DomUtil.create("input","",o),r=n.DomUtil.create("button","",o),i=n.DomUtil.create("div","results",o);return r.title="Переместить центр карты",s.placeholder="Поиск по адресам, координатам",this._input=s,this._container=o,this._results=i,o._id=e,t.on("mousemove",t=>{this._results.style.display="none"},this),n.DomEvent.on(s,"input",this._getSuggestions,this),n.DomEvent.on(s,"contextmenu",n.DomEvent.stopPropagation,this),n.DomEvent.on(o,"mousemove",n.DomEvent.stop),n.DomEvent.on(o,"mouseover",t=>{"block"!==this._results.style.display&&(this._results.style.display="block")},this),n.DomEvent.on(r,"click",(function(){let e=s.value.match(/[+-]?([0-9]*[.])?[0-9]+/g);e&&e.length>1&&t.setView([Number(e[0]),Number(e[1])])})),n.DomEvent.disableClickPropagation(o),t.on("moveend",this._update,this).fire("controladd",this),t.gmxControlsManager&&t.gmxControlsManager.add(this),o},_parseSearch:function(t){if((t=t||[]).length){this._results;let e=document.createDocumentFragment();t.forEach(t=>{let l=t.display_name,o=t.boundingbox,s=n.DomUtil.create("div","",e);s.innerHTML=l,n.DomEvent.on(s,"click",t=>{this._map.fitBounds([[o[0],o[2]],[o[1],o[3]]])},this)}),this._results.innerText="",this._results.appendChild(e),this._results.classList.add("active")}},_getSuggestions:function(t){const e=t.target.value||"калужское шоссе",n=["format=json","limit=10","polygon_text=1","bounded=1","viewbox=34,53,41,57"].join("&"),l="&q="+encodeURI(e);fetch(`//nominatim.openstreetmap.org/search?${n}${l}`,{}).then(t=>t.json()).then(this._parseSearch.bind(this))},_update:function(t){this._map&&this.setCoords(this._map.getCenter())},_trunc:function(t){return(""+(Math.round(1e7*t)/1e7+1e-8)).substring(0,9)},setCoords:function(t){return this}}),n.control.fitCenter=function(t){return new n.Control.FitCenter(t)};const l='&copy; <a href="https://n.maps.yandex.ru/?oid=1900133#!/?z=18&ll=36.860478%2C55.429679&l=nk%23map">Yandex</a> contributors',o="//inv.mvs.group/mapcache/",s=new Date,r=s.getMonth()+1,i=s.getDate(),a=(s.getFullYear(),{m1:{title:"Дороги",prefix:o+"m1/",postfix:"?x={x}&y={y}&z={z}&l=mrcss",errorTileUrlPrefix:"//core-nmaps-mrc-browser.maps.yandex.ru/tiles",options:{key:"m1",minZoom:10,maxZoom:19,attribution:l}},m2:{title:"Карта(Яндекс)",prefix:o+"m2/tiles",postfix:"?l=map&v=18.01.10-2&x={x}&y={y}&z={z}&scale=1&lang=ru_RU",errorTileUrlPrefix:"//vec01.maps.yandex.net/tiles",options:{key:"m2",maxNativeZoom:19,maxZoom:21,attribution:l}},m3:{title:"Снимки(Яндекс)",prefix:o+"m3/tiles",postfix:"?l=sat&v=3.462.0&x={x}&y={y}&z={z}&lang=ru_RU",errorTileUrlPrefix:"//sat04.maps.yandex.net/tiles",options:{key:"m3",maxNativeZoom:19,maxZoom:21,attribution:l}},m4:{title:"Скорость(Народная карта)",prefix:o+"m4/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=104,301135,302526,302827,5300026,5400046,70300236,70300638",errorTileUrlPrefix:"//04.core-nmaps-renderer-nmaps.maps.yandex.net/tile",options:{key:"m4",minZoom:8,maxZoom:19,attribution:l}},m5:{title:"Светофоры",prefix:o+"m5/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=301750",errorTileUrlPrefix:"//04.core-nmaps-renderer-nmaps.maps.yandex.net/tile",options:{key:"m4",minZoom:12,maxZoom:19,attribution:l}},m6:{title:"Дороги в стадии строительства",prefix:"//03.core-nmaps-renderer-nmaps.maps.yandex.net/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=70300289",errorTileUrlPrefix:"//03.core-nmaps-renderer-nmaps.maps.yandex.net/",options:{key:"m6",minZoom:10,maxZoom:19,attribution:l}}}),p={};window.URLSearchParams&&new URLSearchParams(window.location.search).forEach((t,e)=>{p[e]=t});const c=window.L;let d=c.canvas();const u=function(t,e){var n=c.Projection.Mercator.project(e),l=c.Projection.Mercator.unproject(new c.Point(n.x+40,n.y+30));return 156543.033928041*Math.pow(2,-t)*((t,e)=>{for(var n=Math.PI/180,l={lon:n*t.lng,lat:n*t.lat},o={lon:n*e.lng,lat:n*e.lat},s=6378137,r=6356752.3142,i=1/298.257223563,a=o.lon-l.lon,p=Math.atan((1-i)*Math.tan(l.lat)),c=Math.atan((1-i)*Math.tan(o.lat)),d=Math.sin(p),u=Math.cos(p),_=Math.sin(c),h=Math.cos(c),v=a,f=2*Math.PI,m=20;Math.abs(v-f)>1e-12&&--m>0;){var g=Math.sin(v),y=Math.cos(v),b=Math.sqrt(h*g*(h*g)+(u*_-d*h*y)*(u*_-d*h*y));if(0===b)return 0;var x=d*_+u*h*y,k=Math.atan2(b,x),j=u*h*g/b,L=1-j*j,C=x-2*d*_/L;isNaN(C)&&(C=0);var w=i/16*L*(4+i*(4-3*L));f=v,v=a+(1-w)*i*j*(k+w*b*(C+w*x*(2*C*C-1)))}if(0===m)return NaN;var D=L*(s*s/(r*r)-1),z=D/1024*(256+D*(D*(74-47*D)-128));return r*(1+D/16384*(4096+D*(D*(320-175*D)-768)))*(k-z*b*(C+z/4*(x*(2*C*C-1)-z/6*C*(4*b*b-3)*(4*C*C-3))))})(e,l)/50},_=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),h={camera:((t,e,n)=>{let l=new Path2D(t),o=new Path2D;return o.addPath(l,_.translate(e,n).rotate(180).scale(-20/832,-20/832)),o})("M864 260H728l-32.4-90.8a32.07 32.07 0 0 0-30.2-21.2H358.6c-13.5 0-25.6 8.5-30.1 21.2L296 260H160c-44.2 0-80 35.8-80 80v456c0 44.2 35.8 80 80 80h704c44.2 0 80-35.8 80-80V340c0-44.2-35.8-80-80-80zM512 716c-88.4 0-160-71.6-160-160s71.6-160 160-160 160 71.6 160 160-71.6 160-160 160zm-96-160a96 96 0 1 0 192 0 96 96 0 1 0-192 0z",-12,-13)};c.canvas({padding:.5});c.Canvas.include({_updateMarkerPoint:function(t){if(!(!this._drawing||t._empty()||t.feature&&t.feature.properties._isHidden)){var e=t._point,n=t.options._radiusM,l=t.options.image,o=t._map,s=this._ctx,r=t.options.iconName||"border";if(o){if(l){let n=t.options.w||20,o=t.options.h||20;return void s.drawImage(l,e.x-n/2,e.y-o/2,n,o)}let i=o._zoom;n&&!o._rpx&&o._needRound&&(o._rpx=o._needRound*n/u(i,o.getCenter())),o._rpx>20&&o._needRound&&(s.save(),s.beginPath(),s.globalAlpha=.2,s.fillStyle="gray",s.arc(e.x,e.y,o._rpx,0,2*Math.PI),s.fill(),s.stroke(),s.closePath(),s.restore()),i>12&&(s.save(),s.beginPath(),s.globalAlpha=1,s.fillStyle="white",s.arc(e.x,e.y,14,0,2*Math.PI),s.fill(),s.closePath(),s.restore()),s.save(),s.beginPath(),s.translate(e.x-0,e.y-0),this._fillStroke(s,t),s.stroke(iconPaths[r].path),s.globalAlpha=t.options.fillOpacity,s.fill(iconPaths[r].path),s.closePath(),s.restore()}}},_updateCirclePoint:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=t.options,l=n.radius||14,o=2*l,s=(t._map,this._ctx);if(s.save(),s.beginPath(),s.globalAlpha=1,s.fillStyle=n.fillColor||"red",n.triangle)s.moveTo(e.x,e.y+l),s.lineTo(e.x+l,e.y-l),s.lineTo(e.x-l,e.y-l),s.lineTo(e.x,e.y+l);else if(n.rhomb)s.moveTo(e.x+l,e.y),s.lineTo(e.x,e.y+l),s.lineTo(e.x-l,e.y),s.lineTo(e.x,e.y-l),s.lineTo(e.x+l,e.y);else if(n.box)s.fillRect(e.x-l,e.y-l,o,o);else if(n.path){let t=h[n.path];s.translate(e.x,e.y),s.fill(t),s.stroke(t)}else s.arc(e.x,e.y,l,0,2*Math.PI);s.fill(),n.stroke&&(s.stroke(),n.triangle?(s.moveTo(e.x,e.y+l),s.lineTo(e.x+l,e.y-l),s.lineTo(e.x-l,e.y-l),s.lineTo(e.x,e.y+l)):n.box?s.strokeRect(e.x-l,e.y-l,o,o):s.arc(e.x,e.y,l,0,2*Math.PI)),s.closePath(),s.restore()}}});c.CircleMarker.extend({_updatePath:function(){this._renderer._updateMarkerPoint(this)}});const v=c.CircleMarker.extend({options:{renderer:d},_updatePath:function(){this._renderer._updateCirclePoint(this)}});c.Rectangle.extend({options:{renderer:d}});function f(){}function m(t){return t()}function g(){return Object.create(null)}function y(t){t.forEach(m)}function b(t){return"function"==typeof t}function x(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function k(t){return null==t?"":t}function j(t,e){t.appendChild(e)}function C(t,e,n){t.insertBefore(e,n||null)}function w(t){t.parentNode.removeChild(t)}function D(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function z(t){return document.createElement(t)}function F(t){return document.createTextNode(t)}function T(){return F(" ")}function O(){return F("")}function E(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function M(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function $(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function q(t){return""===t?void 0:+t}function P(t,e){e=""+e,t.data!==e&&(t.data=e)}function N(t,e){(null!=e||t.value)&&(t.value=e)}function S(t,e){for(let n=0;n<t.options.length;n+=1){const l=t.options[n];if(l.__value===e)return void(l.selected=!0)}}function H(t,e){for(let n=0;n<t.options.length;n+=1){const l=t.options[n];l.selected=~e.indexOf(l.__value)}}function B(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function U(t){return[].map.call(t.querySelectorAll(":checked"),t=>t.__value)}let I;function G(t){I=t}function A(){if(!I)throw new Error("Function called outside component initialization");return I}function R(t){A().$$.after_update.push(t)}function Z(){const t=A();return(e,n)=>{const l=t.$$.callbacks[e];if(l){const o=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);l.slice().forEach(e=>{e.call(t,o)})}}}const Y=[],V=[],W=[],K=[],J=Promise.resolve();let Q=!1;function X(t){W.push(t)}let tt=!1;const et=new Set;function nt(){if(!tt){tt=!0;do{for(let t=0;t<Y.length;t+=1){const e=Y[t];G(e),lt(e.$$)}for(Y.length=0;V.length;)V.pop()();for(let t=0;t<W.length;t+=1){const e=W[t];et.has(e)||(et.add(e),e())}W.length=0}while(Y.length);for(;K.length;)K.pop()();Q=!1,tt=!1,et.clear()}}function lt(t){if(null!==t.fragment){t.update(),y(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(X)}}const ot=new Set;let st;function rt(){st={r:0,c:[],p:st}}function it(){st.r||y(st.c),st=st.p}function at(t,e){t&&t.i&&(ot.delete(t),t.i(e))}function pt(t,e,n,l){if(t&&t.o){if(ot.has(t))return;ot.add(t),st.c.push(()=>{ot.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}}function ct(t){t&&t.c()}function dt(t,e,n){const{fragment:l,on_mount:o,on_destroy:s,after_update:r}=t.$$;l&&l.m(e,n),X(()=>{const e=o.map(m).filter(b);s?s.push(...e):y(e),t.$$.on_mount=[]}),r.forEach(X)}function ut(t,e){const n=t.$$;null!==n.fragment&&(y(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function _t(t,e){-1===t.$$.dirty[0]&&(Y.push(t),Q||(Q=!0,J.then(nt)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ht(t,e,n,l,o,s,r=[-1]){const i=I;G(t);const a=e.props||{},p=t.$$={fragment:null,ctx:null,props:s,update:f,not_equal:o,bound:g(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(i?i.$$.context:[]),callbacks:g(),dirty:r};let c=!1;if(p.ctx=n?n(t,a,(e,n,...l)=>{const s=l.length?l[0]:n;return p.ctx&&o(p.ctx[e],p.ctx[e]=s)&&(p.bound[e]&&p.bound[e](s),c&&_t(t,e)),n}):[],p.update(),c=!0,y(p.before_update),p.fragment=!!l&&l(p.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);p.fragment&&p.fragment.l(t),t.forEach(w)}else p.fragment&&p.fragment.c();e.intro&&at(t.$$.fragment),dt(t,e.target,e.anchor),nt()}G(i)}class vt{$destroy(){ut(this,1),this.$destroy=f}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function ft(t,e,n){const l=t.slice();return l[7]=e[n],l[9]=n,l}function mt(t){let e,n,l,o,s;function r(...e){return t[6](t[9],...e)}return{c(){e=z("li"),$(e,"class",n="dot"+(t[9]===t[1]?" selected":"")+" svelte-jjp3es"),e.value=l=t[9],$(e,"role","button"),$(e,"tabindex","0"),$(e,"aria-label",o="slide item "+t[9])},m(t,n,l){C(t,e,n),l&&s(),s=E(e,"click",M(r))},p(l,o){t=l,2&o&&n!==(n="dot"+(t[9]===t[1]?" selected":"")+" svelte-jjp3es")&&$(e,"class",n)},d(t){t&&w(e),s()}}}function gt(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,m,g,b,x,k,L,O,q,N,S,H,B,U,I,G,A=(t[0][t[1]].kindName||"Фото и схемы ДТП")+"",R=t[1]+1+"",Z=t[0].length+"",Y=t[0],V=[];for(let e=0;e<Y.length;e+=1)V[e]=mt(ft(t,Y,e));return{c(){e=z("div"),n=T(),l=z("div"),o=z("div"),s=T(),r=z("div"),i=z("div"),a=z("div"),p=F(A),c=T(),d=z("div"),u=z("div"),_=z("div"),h=z("button"),v=T(),m=z("div"),g=z("a"),b=z("img"),L=T(),O=z("button"),q=T(),N=z("ul");for(let t=0;t<V.length;t+=1)V[t].c();S=T(),H=z("p"),B=F(R),U=F(" из "),I=F(Z),$(e,"class","modal-background svelte-jjp3es"),$(o,"title","Закрыть"),$(o,"class","ant-modal-close svelte-jjp3es"),$(a,"class","ant-modal-title"),$(a,"id","rcDialogTitle1"),$(i,"class","ant-modal-header svelte-jjp3es"),$(h,"type","button"),$(h,"aria-label","previous slide / item"),$(h,"class","control-arrow control-prev svelte-jjp3es"),b.src!==(x=""+(yt+t[0][t[1]].guid))&&$(b,"src",x),$(b,"alt",""),$(b,"class","svelte-jjp3es"),$(g,"target","_blank"),$(g,"href",k=""+(yt+t[0][t[1]].guid)),$(g,"title","Открыть на весь экран"),$(g,"class","svelte-jjp3es"),$(m,"class","slider-wrapper axis-horizontal svelte-jjp3es"),$(O,"type","button"),$(O,"aria-label","next slide / item"),$(O,"class","control-arrow control-next svelte-jjp3es"),$(N,"class","control-dots svelte-jjp3es"),$(H,"class","carousel-status svelte-jjp3es"),$(_,"class","carousel carousel-slider svelte-jjp3es"),function(t,e,n,l){t.style.setProperty(e,n,l?"important":"")}(_,"width","100%"),$(d,"class","ant-modal-body svelte-jjp3es"),$(r,"class","ant-modal-content svelte-jjp3es"),$(l,"class","modal svelte-jjp3es"),$(l,"role","dialog"),$(l,"aria-modal","true")},m(f,x,k){C(f,e,x),C(f,n,x),C(f,l,x),j(l,o),j(l,s),j(l,r),j(r,i),j(i,a),j(a,p),j(r,c),j(r,d),j(d,u),j(u,_),j(_,h),j(_,v),j(_,m),j(m,g),j(g,b),j(_,L),j(_,O),j(_,q),j(_,N);for(let t=0;t<V.length;t+=1)V[t].m(N,null);j(_,S),j(_,H),j(H,B),j(H,U),j(H,I),k&&y(G),G=[E(e,"click",M(t[2])),E(o,"click",M(t[2])),E(h,"click",M(t[3])),E(O,"click",M(t[4])),E(l,"click",M(bt))]},p(t,[e]){if(3&e&&A!==(A=(t[0][t[1]].kindName||"Фото и схемы ДТП")+"")&&P(p,A),3&e&&b.src!==(x=""+(yt+t[0][t[1]].guid))&&$(b,"src",x),3&e&&k!==(k=""+(yt+t[0][t[1]].guid))&&$(g,"href",k),3&e){let n;for(Y=t[0],n=0;n<Y.length;n+=1){const l=ft(t,Y,n);V[n]?V[n].p(l,e):(V[n]=mt(l),V[n].c(),V[n].m(N,null))}for(;n<V.length;n+=1)V[n].d(1);V.length=Y.length}2&e&&R!==(R=t[1]+1+"")&&P(B,R),1&e&&Z!==(Z=t[0].length+"")&&P(I,Z)},i:f,o:f,d(t){t&&w(e),t&&w(n),t&&w(l),D(V,t),y(G)}}}const yt="//map.mvs.group/skpdi/proxy.php?guid=",bt=()=>{};function xt(t,e,n){const l=Z();let{data:o}=e,s=0;return t.$set=t=>{"data"in t&&n(0,o=t.data)},[o,s,()=>{l("close")},()=>{s&&n(1,s--,s)},()=>{s<o.length-1&&n(1,s++,s)},l,t=>{n(1,s=t)}]}class kt extends vt{constructor(t){super(),ht(this,t,xt,gt,x,{data:0})}}function jt(t,e,n){const l=t.slice();return l[9]=e[n],l}function Lt(t,e,n){const l=t.slice();return l[6]=e[n],l}function Ct(t){let e,n,l,o=t[9].k_uch&&(t[9].npdd||t[9].sop_npdd)&&function(t){let e,n,l=t[9].k_uch+"";return{c(){e=z("li"),n=F(l)},m(t,l){C(t,e,l),j(e,n)},p:f,d(t){t&&w(e)}}}(t),s=t[9].npdd&&function(t){let e,n,l=t[9].npdd+"";return{c(){e=z("li"),n=F(l)},m(t,l){C(t,e,l),j(e,n)},p:f,d(t){t&&w(e)}}}(t),r=t[9].sop_npdd&&function(t){let e,n,l=t[9].sop_npdd+"";return{c(){e=z("li"),n=F(l)},m(t,l){C(t,e,l),j(e,n)},p:f,d(t){t&&w(e)}}}(t);return{c(){o&&o.c(),e=T(),s&&s.c(),n=T(),r&&r.c(),l=O()},m(t,i){o&&o.m(t,i),C(t,e,i),s&&s.m(t,i),C(t,n,i),r&&r.m(t,i),C(t,l,i)},p(t,e){t[9].k_uch&&(t[9].npdd||t[9].sop_npdd)&&o.p(t,e),t[9].npdd&&s.p(t,e),t[9].sop_npdd&&r.p(t,e)},d(t){o&&o.d(t),t&&w(e),s&&s.d(t),t&&w(n),r&&r.d(t),t&&w(l)}}}function wt(t){let e,n,l=t[6].ts&&function(t){let e,n,l=t[6].ts+"";return{c(){e=z("li"),n=F(l)},m(t,l){C(t,e,l),j(e,n)},p:f,d(t){t&&w(e)}}}(t),o=t[6].arr,s=[];for(let e=0;e<o.length;e+=1)s[e]=Ct(jt(t,o,e));return{c(){l&&l.c(),e=T();for(let t=0;t<s.length;t+=1)s[t].c();n=O()},m(t,o){l&&l.m(t,o),C(t,e,o);for(let e=0;e<s.length;e+=1)s[e].m(t,o);C(t,n,o)},p(t,e){if(t[6].ts&&l.p(t,e),4&e){let l;for(o=t[6].arr,l=0;l<o.length;l+=1){const r=jt(t,o,l);s[l]?s[l].p(r,e):(s[l]=Ct(r),s[l].c(),s[l].m(n.parentNode,n))}for(;l<s.length;l+=1)s[l].d(1);s.length=o.length}},d(t){l&&l.d(t),t&&w(e),D(s,t),t&&w(n)}}}function Dt(t){let e,n,l,o,s,r=t[0].spog+"";return{c(){e=z("div"),n=z("div"),n.textContent="Погода:",l=T(),o=z("div"),s=F(r),$(n,"class","stitle"),$(o,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,l),j(e,o),j(o,s)},p(t,e){1&e&&r!==(r=t[0].spog+"")&&P(s,r)},d(t){t&&w(e)}}}function zt(t){let e,n,l,o,s,r=t[0].s_pch+"";return{c(){e=z("div"),n=z("div"),n.textContent="Покрытие:",l=T(),o=z("div"),s=F(r),$(n,"class","stitle"),$(o,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,l),j(e,o),j(o,s)},p(t,e){1&e&&r!==(r=t[0].s_pch+"")&&P(s,r)},d(t){t&&w(e)}}}function Ft(t){let e,n,l,o,s,r=t[0].osv+"";return{c(){e=z("div"),n=z("div"),n.textContent="Освещенность:",l=T(),o=z("div"),s=F(r),$(n,"class","stitle"),$(o,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,l),j(e,o),j(o,s)},p(t,e){1&e&&r!==(r=t[0].osv+"")&&P(s,r)},d(t){t&&w(e)}}}function Tt(t){let e,n,l,o,s,r=t[0].ndu+"";return{c(){e=z("div"),n=z("div"),n.textContent="Иные условия:",l=T(),o=z("div"),s=F(r),$(n,"class","stitle"),$(o,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,l),j(e,o),j(o,s)},p(t,e){1&e&&r!==(r=t[0].ndu+"")&&P(s,r)},d(t){t&&w(e)}}}function Ot(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,m,g,y,b,x,k,L,O,M,q,N,S,H,B,U,I,G,A,R,Z,Y,V,W,K,J,Q,X,tt,et,nt,lt,ot,st,rt,it,at,pt,ct,dt,ut,_t,ht,vt,ft,mt,gt,yt,bt,xt,kt,jt,Ct,Ot,Et,Mt,$t,qt,Pt,Nt,St,Ht,Bt,Ut,It=(t[0].name||t[0].dtvp||"")+"",Gt=(t[0].sid||t[0].id_stat||t[0].id_skpdi||"")+"",At=(t[0].district||"")+"",Rt=(t[0].dor||"")+"",Zt=(t[0].km||0)+"",Yt=(t[0].m||0)+"",Vt=t[0].lat+"",Wt=t[0].lon+"",Kt=(t[0].collision_date||t[0].dtp_date||"")+"",Jt=(t[0].dtvp||"")+"",Qt=t[0].pog+"",Xt=t[0].ran+"",te=t[2],ee=[];for(let e=0;e<te.length;e+=1)ee[e]=wt(Lt(t,te,e));let ne=t[0].spog&&Dt(t),le=t[0].s_pch&&zt(t),oe=t[0].osv&&Ft(t),se=t[0].ndu&&Tt(t);return{c(){e=z("div"),n=z("div"),l=z("b"),o=F(It),s=T(),r=z("div"),i=z("table"),a=z("tbody"),p=z("tr"),c=z("td"),c.textContent="ID:",d=T(),u=z("td"),_=F(Gt),h=T(),v=z("tr"),m=z("td"),m.textContent="Адрес:",g=T(),y=z("td"),b=F(At),x=T(),k=F(Rt),L=T(),O=z("tr"),M=z("td"),M.textContent="Пикетаж:",q=T(),N=z("td"),S=z("b"),H=F(Zt),B=F(" км. "),U=z("b"),I=F(Yt),G=F(" м."),A=T(),R=z("tr"),Z=z("td"),Z.textContent="Координаты:",Y=T(),V=z("td"),W=F(Vt),K=T(),J=F(Wt),Q=T(),X=z("span"),tt=T(),et=z("tr"),nt=z("td"),nt.textContent="Дата/время:",lt=T(),ot=z("td"),st=F(Kt),rt=T(),it=z("tr"),at=z("td"),at.textContent="Вид ДТП:",pt=T(),ct=z("td"),dt=F(Jt),ut=T(),_t=z("tr"),ht=z("td"),ht.textContent="Нарушения:",vt=T(),ft=z("td"),mt=z("ul");for(let t=0;t<ee.length;t+=1)ee[t].c();gt=T(),yt=z("tr"),bt=z("td"),bt.textContent="Условия:",xt=T(),kt=z("td"),ne&&ne.c(),jt=T(),le&&le.c(),Ct=T(),oe&&oe.c(),Ot=T(),se&&se.c(),Et=T(),Mt=z("tr"),$t=z("td"),$t.textContent="Количество погибших/раненых:",qt=T(),Pt=z("td"),Nt=z("b"),St=F(Qt),Ht=F("/"),Bt=F(Xt),$(n,"class","pLine"),$(c,"class","first svelte-ipyqnf"),$(m,"class","first svelte-ipyqnf"),$(M,"class","first svelte-ipyqnf"),$(Z,"class","first svelte-ipyqnf"),$(X,"title","Скопировать в буфер обмена"),$(X,"class","leaflet-gmx-icon-copy"),$(nt,"class","first svelte-ipyqnf"),$(at,"class","first svelte-ipyqnf"),$(ht,"class","first svelte-ipyqnf"),$(bt,"class","first svelte-ipyqnf"),$($t,"class","first svelte-ipyqnf"),$(i,"class","table"),$(r,"class","featureCont"),$(e,"class","mvsPopup svelte-ipyqnf")},m(f,w,D){C(f,e,w),j(e,n),j(n,l),j(l,o),j(e,s),j(e,r),j(r,i),j(i,a),j(a,p),j(p,c),j(p,d),j(p,u),j(u,_),j(a,h),j(a,v),j(v,m),j(v,g),j(v,y),j(y,b),j(y,x),j(y,k),j(a,L),j(a,O),j(O,M),j(O,q),j(O,N),j(N,S),j(S,H),j(N,B),j(N,U),j(U,I),j(N,G),j(a,A),j(a,R),j(R,Z),j(R,Y),j(R,V),j(V,W),j(V,K),j(V,J),j(V,Q),j(V,X),j(a,tt),j(a,et),j(et,nt),j(et,lt),j(et,ot),j(ot,st),j(a,rt),j(a,it),j(it,at),j(it,pt),j(it,ct),j(ct,dt),j(a,ut),j(a,_t),j(_t,ht),j(_t,vt),j(_t,ft),j(ft,mt);for(let t=0;t<ee.length;t+=1)ee[t].m(mt,null);j(a,gt),j(a,yt),j(yt,bt),j(yt,xt),j(yt,kt),ne&&ne.m(kt,null),j(kt,jt),le&&le.m(kt,null),j(kt,Ct),oe&&oe.m(kt,null),j(kt,Ot),se&&se.m(kt,null),j(a,Et),j(a,Mt),j(Mt,$t),j(Mt,qt),j(Mt,Pt),j(Pt,Nt),j(Nt,St),j(Nt,Ht),j(Nt,Bt),D&&Ut(),Ut=E(X,"click",t[1])},p(t,[e]){if(1&e&&It!==(It=(t[0].name||t[0].dtvp||"")+"")&&P(o,It),1&e&&Gt!==(Gt=(t[0].sid||t[0].id_stat||t[0].id_skpdi||"")+"")&&P(_,Gt),1&e&&At!==(At=(t[0].district||"")+"")&&P(b,At),1&e&&Rt!==(Rt=(t[0].dor||"")+"")&&P(k,Rt),1&e&&Zt!==(Zt=(t[0].km||0)+"")&&P(H,Zt),1&e&&Yt!==(Yt=(t[0].m||0)+"")&&P(I,Yt),1&e&&Vt!==(Vt=t[0].lat+"")&&P(W,Vt),1&e&&Wt!==(Wt=t[0].lon+"")&&P(J,Wt),1&e&&Kt!==(Kt=(t[0].collision_date||t[0].dtp_date||"")+"")&&P(st,Kt),1&e&&Jt!==(Jt=(t[0].dtvp||"")+"")&&P(dt,Jt),4&e){let n;for(te=t[2],n=0;n<te.length;n+=1){const l=Lt(t,te,n);ee[n]?ee[n].p(l,e):(ee[n]=wt(l),ee[n].c(),ee[n].m(mt,null))}for(;n<ee.length;n+=1)ee[n].d(1);ee.length=te.length}t[0].spog?ne?ne.p(t,e):(ne=Dt(t),ne.c(),ne.m(kt,jt)):ne&&(ne.d(1),ne=null),t[0].s_pch?le?le.p(t,e):(le=zt(t),le.c(),le.m(kt,Ct)):le&&(le.d(1),le=null),t[0].osv?oe?oe.p(t,e):(oe=Ft(t),oe.c(),oe.m(kt,Ot)):oe&&(oe.d(1),oe=null),t[0].ndu?se?se.p(t,e):(se=Tt(t),se.c(),se.m(kt,null)):se&&(se.d(1),se=null),1&e&&Qt!==(Qt=t[0].pog+"")&&P(St,Qt),1&e&&Xt!==(Xt=t[0].ran+"")&&P(Bt,Xt)},i:f,o:f,d(t){t&&w(e),D(ee,t),ne&&ne.d(),le&&le.d(),oe&&oe.d(),se&&se.d(),Ut()}}}function Et(t,e,n){let l,{showModal:o=!1}=e,{prp:s}=e;s.skpdiFiles;R(()=>{o&&(l=new kt({target:document.body,props:{data:s.skpdiFiles}}),l.$on("close",t=>{l.$destroy(),n(3,o=!1)}))});const r=(s.tsInfo||[]).map(t=>{let e=t.ts_uch||[];return{ts:"Осталось на месте ДТП"!==t.ts?t.ts:"",arr:e.map(t=>({k_uch:t.k_uch||"",npdd:"Нет нарушений"!==t.npdd?t.npdd:"",sop_npdd:"Нет нарушений"!==t.sop_npdd?t.sop_npdd:""}))}});return t.$set=t=>{"showModal"in t&&n(3,o=t.showModal),"prp"in t&&n(0,s=t.prp)},[s,t=>{navigator.clipboard.writeText(t.target.parentNode.textContent).catch(t=>{console.log("Something went wrong",t)})},r,o]}class Mt extends vt{constructor(t){super(),ht(this,t,Et,Ot,x,{showModal:3,prp:0})}}const $t=window.L,qt=$t.popup();let Pt;const Nt=$t.featureGroup([]);function St(t,e,n){const l=t.slice();return l[6]=e[n],l}function Ht(t,e,n){const l=t.slice();return l[6]=e[n],l}function Bt(t){let e,n=t[1].collisionTypes,l=[];for(let e=0;e<n.length;e+=1)l[e]=Ut(Ht(t,n,e));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=O()},m(t,n){for(let e=0;e<l.length;e+=1)l[e].m(t,n);C(t,e,n)},p(t,o){if(2&o){let s;for(n=t[1].collisionTypes,s=0;s<n.length;s+=1){const r=Ht(t,n,s);l[s]?l[s].p(r,o):(l[s]=Ut(r),l[s].c(),l[s].m(e.parentNode,e))}for(;s<l.length;s+=1)l[s].d(1);l.length=n.length}},d(t){D(l,t),t&&w(e)}}}function Ut(t){let e,n,l=(t[6].collisionType||"")+"";return{c(){e=z("li"),n=F(l)},m(t,l){C(t,e,l),j(e,n)},p(t,e){2&e&&l!==(l=(t[6].collisionType||"")+"")&&P(n,l)},d(t){t&&w(e)}}}function It(t){let e,n=t[1].uchs,l=[];for(let e=0;e<n.length;e+=1)l[e]=Gt(St(t,n,e));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=O()},m(t,n){for(let e=0;e<l.length;e+=1)l[e].m(t,n);C(t,e,n)},p(t,o){if(2&o){let s;for(n=t[1].uchs,s=0;s<n.length;s+=1){const r=St(t,n,s);l[s]?l[s].p(r,o):(l[s]=Gt(r),l[s].c(),l[s].m(e.parentNode,e))}for(;s<l.length;s+=1)l[s].d(1);l.length=n.length}},d(t){D(l,t),t&&w(e)}}}function Gt(t){let e,n,l,o,s,r,i,a,p=(t[6].collisionPartyCategory||"")+"",c=(t[6].collisionPartyCond||"")+"";return{c(){e=z("li"),n=F(p),l=T(),o=z("b"),s=z("i"),r=F("("),i=F(c),a=F(")")},m(t,p){C(t,e,p),j(e,n),j(e,l),j(e,o),j(o,s),j(s,r),j(s,i),j(s,a)},p(t,e){2&e&&p!==(p=(t[6].collisionPartyCategory||"")+"")&&P(n,p),2&e&&c!==(c=(t[6].collisionPartyCond||"")+"")&&P(i,c)},d(t){t&&w(e)}}}function At(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,m,g,b,x,k,L,D,O,M,q,N,S,H,B,U,I,G,A,R,Z,Y,V,W,K,J,Q,X,tt,et,nt,lt,ot,st,rt,it,at,pt,ct,dt,ut,_t,ht,vt,ft,mt,gt,yt,bt,xt,kt,jt=(t[1].name||t[1].dtvp||"")+"",Lt=(t[1].id||t[1].id_stat||t[1].id_skpdi||"")+"",Ct=(t[1].km||0)+"",wt=(t[1].m||0)+"",Dt=t[1].lat+"",zt=t[1].lon+"",Ft=(t[1].collision_date||t[1].dtp_date||"")+"",Tt=(t[1].collision_context||t[1].dtp_date||"")+"",Ot=t[1].collisionTypes&&t[1].collisionTypes.length&&Bt(t),Et=t[1].uchs&&t[1].uchs.length&&It(t);return{c(){e=z("div"),n=z("div"),l=z("b"),o=F(jt),s=T(),r=z("div"),i=z("table"),a=z("tbody"),p=z("tr"),c=z("td"),c.textContent="ID:",d=T(),u=z("td"),_=F(Lt),h=T(),v=z("tr"),m=z("td"),m.textContent="Пикетаж:",g=T(),b=z("td"),x=z("b"),k=F(Ct),L=F(" км. "),D=z("b"),O=F(wt),M=F(" м."),q=T(),N=z("tr"),S=z("td"),S.textContent="Координаты:",H=T(),B=z("td"),U=F(Dt),I=T(),G=F(zt),A=T(),R=z("span"),Z=T(),Y=z("tr"),V=z("td"),V.textContent="Дата/время:",W=T(),K=z("td"),J=F(Ft),Q=T(),X=z("tr"),tt=z("td"),et=z("div"),et.textContent="Условия ДТП:",nt=T(),lt=z("div"),ot=F(Tt),st=T(),rt=z("tr"),it=z("td"),it.textContent="Нарушения:",at=T(),pt=z("td"),ct=z("ul"),Ot&&Ot.c(),dt=T(),ut=z("tr"),_t=z("td"),_t.textContent="Участники:",ht=T(),vt=z("td"),ft=z("ul"),Et&&Et.c(),mt=T(),gt=z("tr"),yt=z("td"),bt=z("button"),xt=F("Фото и схемы"),$(n,"class","pLine"),$(c,"class","first"),$(m,"class","first"),$(S,"class","first"),$(R,"title","Скопировать в буфер обмена"),$(R,"class","leaflet-gmx-icon-copy"),$(V,"class","first"),$(et,"class","first"),$(tt,"colspan","2"),$(it,"class","first"),$(_t,"class","first"),$(bt,"class","primary svelte-1aipaym"),bt.disabled=t[2],$(yt,"class","center"),$(yt,"colspan","2"),$(i,"class","table"),$(r,"class","featureCont"),$(e,"class","mvsPopup")},m(f,w,z){C(f,e,w),j(e,n),j(n,l),j(l,o),j(e,s),j(e,r),j(r,i),j(i,a),j(a,p),j(p,c),j(p,d),j(p,u),j(u,_),j(a,h),j(a,v),j(v,m),j(v,g),j(v,b),j(b,x),j(x,k),j(b,L),j(b,D),j(D,O),j(b,M),j(a,q),j(a,N),j(N,S),j(N,H),j(N,B),j(B,U),j(B,I),j(B,G),j(B,A),j(B,R),j(a,Z),j(a,Y),j(Y,V),j(Y,W),j(Y,K),j(K,J),j(a,Q),j(a,X),j(X,tt),j(tt,et),j(tt,nt),j(tt,lt),j(lt,ot),j(a,st),j(a,rt),j(rt,it),j(rt,at),j(rt,pt),j(pt,ct),Ot&&Ot.m(ct,null),j(a,dt),j(a,ut),j(ut,_t),j(ut,ht),j(ut,vt),j(vt,ft),Et&&Et.m(ft,null),j(a,mt),j(a,gt),j(gt,yt),j(yt,bt),j(bt,xt),z&&y(kt),kt=[E(R,"click",t[3]),E(bt,"click",t[5])]},p(t,[e]){2&e&&jt!==(jt=(t[1].name||t[1].dtvp||"")+"")&&P(o,jt),2&e&&Lt!==(Lt=(t[1].id||t[1].id_stat||t[1].id_skpdi||"")+"")&&P(_,Lt),2&e&&Ct!==(Ct=(t[1].km||0)+"")&&P(k,Ct),2&e&&wt!==(wt=(t[1].m||0)+"")&&P(O,wt),2&e&&Dt!==(Dt=t[1].lat+"")&&P(U,Dt),2&e&&zt!==(zt=t[1].lon+"")&&P(G,zt),2&e&&Ft!==(Ft=(t[1].collision_date||t[1].dtp_date||"")+"")&&P(J,Ft),2&e&&Tt!==(Tt=(t[1].collision_context||t[1].dtp_date||"")+"")&&P(ot,Tt),t[1].collisionTypes&&t[1].collisionTypes.length?Ot?Ot.p(t,e):(Ot=Bt(t),Ot.c(),Ot.m(ct,null)):Ot&&(Ot.d(1),Ot=null),t[1].uchs&&t[1].uchs.length?Et?Et.p(t,e):(Et=It(t),Et.c(),Et.m(ft,null)):Et&&(Et.d(1),Et=null),4&e&&(bt.disabled=t[2])},i:f,o:f,d(t){t&&w(e),Ot&&Ot.d(),Et&&Et.d(),y(kt)}}}function Rt(t,e,n){let l,{showModal:o=!1}=e,{prp:s}=e,r=s.files&&s.files.length?"":"disabled";R(()=>{n(2,r=s.files&&s.files.length?"":"disabled"),o&&(l=new kt({target:document.body,props:{data:s.files}}),l.$on("close",t=>{l.$destroy(),n(0,o=!1)}))});return t.$set=t=>{"showModal"in t&&n(0,o=t.showModal),"prp"in t&&n(1,s=t.prp)},[o,s,r,t=>{navigator.clipboard.writeText(t.target.parentNode.textContent).catch(t=>{console.log("Something went wrong",t)})},l,()=>n(0,o=!0)]}Nt._needHeat={radius:19,blur:11.26,minOpacity:.34},Nt.checkZoom=t=>{Object.keys(Nt._layers).length?t<12&&Nt.setFilter(Pt):t>11&&Nt.setFilter(Pt)},Nt.setFilter=t=>{if(!Nt._map)return;Nt.clearLayers(),Pt=t||[];let e=[],n=[];Nt._group&&Nt._map&&(Nt._group.getLayers().forEach(t=>{let l=t.options.props,o=0;Pt.forEach(t=>{"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===l.collision_type).length)&&o++:"id_dtp"===t.type?l.id==t.zn&&o++:"date"===t.type&&l.date>=t.zn[0]&&l.date<t.zn[1]&&o++}),o===Pt.length&&(e.push(t),n.push(t._latlng))}),Nt._needHeat?(Nt._map.addLayer(Nt._heat),Nt._heat.setLatLngs(n),Nt._heat.setOptions(Nt._needHeat),Nt._map._zoom>11&&Nt.addLayer($t.layerGroup(e))):(Nt.addLayer($t.layerGroup(e)),Nt._map.removeLayer(Nt._heat)))},Nt.on("remove",t=>{Nt._map.removeLayer(Nt._heat),Nt.clearLayers()}).on("add",t=>{Nt._heat=$t.heatLayer([],{gradient:{.1:"blue",.4:"lime",1:"red"}}),Pt=[],fetch("https://dtp.mvs.group/scripts/index_dev.php?request=get_stat_gipdd",{}).then(t=>t.json()).then(t=>{let e={collision_type:{},iconType:{}},n=[],l=t.map(t=>{let l=t.iconType||0,o=!1,s="#2F4F4F";l&&(o=l%2==0,l>=1&&l<=6?s="#8B4513":7===l||8===l?s="#228B22":l>=9&&l<=14?s="#8B4513":15===l||16===l?s="#7B68EE":17!==l&&18!==l||(s="#2F4F4F")),t.lat&&t.lon||(console.log("_______",t),t.lat=t.lon=0);let r=e.collision_type[t.collision_type];r?r++:r=1,e.collision_type[t.collision_type]=r,e.iconType[t.collision_type]=l;let i=$t.latLng(t.lat,t.lon,o?1:.5);return n.push(i),new v(i,{props:t,radius:6,stroke:o,fillColor:s}).bindPopup(qt).on("popupopen",t=>{var e;e=t.target.options.props.id,fetch("https://dtp.mvs.group/scripts/index_dev.php?request=get_dtp_id&id="+e+"&type=gibdd",{}).then(t=>t.json()).then(t=>{let e=$t.DomUtil.create("div");const n=new Mt({target:e,props:{prp:t}});qt._svObj=n,qt.setContent(e)})}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});Nt.addLayer(Nt._heat),Nt._heat.setLatLngs(n),Nt._heat.setOptions(Nt._needHeat),Nt._opt=e,Nt._group=$t.layerGroup(l),Pt?Nt.setFilter(Pt):Nt._map._zoom>11&&Nt.addLayer(Nt._group),Nt._refreshFilters()})});class Zt extends vt{constructor(t){super(),ht(this,t,Rt,At,x,{showModal:0,prp:1})}}const Yt=window.L,Vt=Yt.popup();let Wt;const Kt=Yt.featureGroup([]);function Jt(t,e,n){const l=t.slice();return l[6]=e[n],l[8]=n,l}function Qt(t){let e,n,l,o,s,r="gibdd"===t[6].type?"ГИБДД":"СКПДИ";return{c(){e=z("button"),n=F(r),$(e,"class",l=k(t[2]===t[8]?"current":"")+" svelte-txaali"),e.value=o=t[8]},m(l,o,r){C(l,e,o),j(e,n),r&&s(),s=E(e,"click",t[4])},p(t,o){1&o&&r!==(r="gibdd"===t[6].type?"ГИБДД":"СКПДИ")&&P(n,r),4&o&&l!==(l=k(t[2]===t[8]?"current":"")+" svelte-txaali")&&$(e,"class",l)},d(t){t&&w(e),s()}}}function Xt(t){let e;const n=new Zt({props:{prp:t[3]}});return{c(){ct(n.$$.fragment)},m(t,l){dt(n,t,l),e=!0},p(t,e){const l={};8&e&&(l.prp=t[3]),n.$set(l)},i(t){e||(at(n.$$.fragment,t),e=!0)},o(t){pt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function te(t){let e;const n=new Mt({props:{prp:t[3]}});return{c(){ct(n.$$.fragment)},m(t,l){dt(n,t,l),e=!0},p(t,e){const l={};8&e&&(l.prp=t[3]),n.$set(l)},i(t){e||(at(n.$$.fragment,t),e=!0)},o(t){pt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function ee(t){let e,n,l,o,s,r,i,a,p,c,d=t[0]._cur,u=[];for(let e=0;e<d.length;e+=1)u[e]=Qt(Jt(t,d,e));const _=[te,Xt],h=[];function v(t,e){return"gibdd"===t[0]._cur[t[2]].type?0:1}return i=v(t),a=h[i]=_[i](t),{c(){e=z("div"),n=z("div"),l=z("a"),l.textContent="×",o=T(),s=z("div");for(let t=0;t<u.length;t+=1)u[t].c();r=T(),a.c(),$(l,"class","leaflet-popup-close-button"),$(l,"href","#close"),$(n,"class","close"),$(s,"class","pLine"),$(e,"class","mvsPopup")},m(a,d,_){C(a,e,d),j(e,n),j(n,l),j(e,o),j(e,s);for(let t=0;t<u.length;t+=1)u[t].m(s,null);var v;j(e,r),h[i].m(e,null),p=!0,_&&c(),c=E(l,"click",(v=function(){b(t[1])&&t[1].apply(this,arguments)},function(t){return t.preventDefault(),v.call(this,t)}))},p(n,[l]){if(t=n,21&l){let e;for(d=t[0]._cur,e=0;e<d.length;e+=1){const n=Jt(t,d,e);u[e]?u[e].p(n,l):(u[e]=Qt(n),u[e].c(),u[e].m(s,null))}for(;e<u.length;e+=1)u[e].d(1);u.length=d.length}let o=i;i=v(t),i===o?h[i].p(t,l):(rt(),pt(h[o],1,1,()=>{h[o]=null}),it(),a=h[i],a||(a=h[i]=_[i](t),a.c()),at(a,1),a.m(e,null))},i(t){p||(at(a),p=!0)},o(t){pt(a),p=!1},d(t){t&&w(e),D(u,t),h[i].d(),c()}}}function ne(t,e,n){let{prp:l}=e,{closeMe:o=(()=>{})}=e,s=0,r={};const i=t=>{let e=l._cur[t],o=e.type,s="https://dtp.mvs.group/scripts/index_dev.php?request=get_dtp_id&id="+e.id+"&type="+o;fetch(s,{}).then(t=>t.json()).then(t=>{n(3,r=t)})};return i(s),t.$set=t=>{"prp"in t&&n(0,l=t.prp),"closeMe"in t&&n(1,o=t.closeMe)},[l,o,s,r,t=>{let e=t.target,l=Number(e.value);s!==l&&(n(2,s=l),i(s))}]}Kt._needHeat={radius:19,blur:11.26,minOpacity:.34},Kt.checkZoom=t=>{Object.keys(Kt._layers).length?t<12&&Kt.setFilter(Wt):t>11&&Kt.setFilter(Wt)},Kt.setFilter=t=>{if(!Kt._map)return;Kt.clearLayers(),Wt=t||[];let e=[],n=[];Kt._group&&Kt._map&&(Kt._group.getLayers().forEach(t=>{let l=t.options.props,o=0;Wt.forEach(t=>{"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===l.collision_type).length)&&o++:"id_dtp"===t.type?l.id==t.zn&&o++:"date"===t.type&&l.date>=t.zn[0]&&l.date<t.zn[1]&&o++}),o===Wt.length&&(e.push(t),n.push(t._latlng))}),Kt._needHeat?(Kt._map.addLayer(Kt._heat),Kt._heat.setLatLngs(n),Kt._heat.setOptions(Kt._needHeat),Kt._map._zoom>11&&Kt.addLayer(Yt.layerGroup(e))):(Kt.addLayer(Yt.layerGroup(e)),Kt._map.removeLayer(Kt._heat)))},Kt.on("remove",()=>{Kt._map.removeLayer(Kt._heat),Kt.clearLayers()}).on("add",t=>{Kt._heat=Yt.heatLayer([]),Wt=[],fetch("https://dtp.mvs.group/scripts/index_dev.php?request=get_skpdi",{}).then(t=>t.json()).then(t=>{let e={collision_type:{},iconType:{}},n=[],l=t.map(t=>{let l=t.iconType||0,o=!1,s="#2F4F4F";l&&(o=l%2==0,l>=1&&l<=6?s="#8B4513":7===l||8===l?s="#228B22":l>=9&&l<=14?s="#8B4513":15===l||16===l?s="#7B68EE":17!==l&&18!==l||(s="#2F4F4F")),t.lat&&t.lon||(console.log("_______",t),t.lat=t.lon=0);let r=e.collision_type[t.collision_type];r?r++:r=1,e.collision_type[t.collision_type]=r,e.iconType[t.collision_type]=l;let i=Yt.latLng(t.lat,t.lon,o?1:.5);return n.push(i),new v(i,{props:t,radius:6,box:!0,stroke:o,fillColor:s}).bindPopup(Vt).on("popupopen",t=>{var e;e=t.target.options.props.id,fetch("https://dtp.mvs.group/scripts/index_dev.php?request=get_dtp_id&id="+e+"&type=skpdi",{}).then(t=>t.json()).then(t=>{let e=Yt.DomUtil.create("div");const n=new Zt({target:e,props:{prp:t}});Vt._svObj=n,Vt.setContent(e)})}).on("popupclose",t=>{console.log("popupclose",t),t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});Kt.addLayer(Kt._heat),Kt._heat.setLatLngs(n),Kt._heat.setOptions(Kt._needHeat),Kt._opt=e,Kt._group=Yt.layerGroup(l),Wt?Kt.setFilter(Wt):Kt.addLayer(Kt._group),Kt.checkZoom(Kt._map._zoom),Kt._refreshFilters()})});class le extends vt{constructor(t){super(),ht(this,t,ne,ee,x,{prp:0,closeMe:1})}}const oe=window.L,se=oe.popup();let re;const ie=oe.featureGroup([]);function ae(t,e,n){const l=t.slice();return l[159]=e[n],l}function pe(t,e,n){const l=t.slice();return l[159]=e[n],l}function ce(t,e,n){const l=t.slice();return l[159]=e[n],l}function de(t,e,n){const l=t.slice();return l[159]=e[n],l}function ue(t,e,n){const l=t.slice();return l[159]=e[n],l}function _e(t,e,n){const l=t.slice();return l[172]=e[n],l}function he(t,e,n){const l=t.slice();return l[159]=e[n],l}function ve(t,e,n){const l=t.slice();return l[159]=e[n],l}function fe(t,e,n){const l=t.slice();return l[159]=e[n],l}function me(t,e,n){const l=t.slice();return l[172]=e[n],l}function ge(t,e,n){const l=t.slice();return l[159]=e[n],l}function ye(t,e,n){const l=t.slice();return l[159]=e[n],l}function be(t,e,n){const l=t.slice();return l[159]=e[n],l}function xe(t,e,n){const l=t.slice();return l[172]=e[n],l}function ke(t,e,n){const l=t.slice();return l[159]=e[n],l}function je(t,e,n){const l=t.slice();return l[159]=e[n],l}function Le(t,e,n){const l=t.slice();return l[159]=e[n],l}function Ce(t,e,n){const l=t.slice();return l[159]=e[n],l}function we(t,e,n){const l=t.slice();return l[159]=e[n],l}function De(t,e,n){const l=t.slice();return l[159]=e[n],l}function ze(t,e,n){const l=t.slice();return l[159]=e[n],l}function Fe(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,O,M,q=t[71],P=[];for(let e=0;e<q.length;e+=1)P[e]=Te(ze(t,q,e));return{c(){e=z("div"),e.innerHTML="Фильтры - <b>ДТП Очаги(Picket)</b>",n=T(),l=z("div"),o=z("div"),s=F("ID Очага: "),r=z("input"),i=T(),a=z("div"),p=F("ID ДТП: "),c=z("input"),d=T(),u=z("div"),_=z("input"),v=z("label"),v.textContent="одного типа",f=T(),m=z("input"),b=z("label"),b.textContent="разного типа",x=T(),k=z("div"),L=z("select"),O=z("option"),O.textContent=`\n\t\t\t\t\t\tВсе дороги (${t[71].reduce(t[115],0)})\n\t\t\t\t\t`;for(let t=0;t<P.length;t+=1)P[t].c();$(e,"class","pLine svelte-1jsovbn"),$(r,"type","text"),r.value=t[16],$(r,"class","svelte-1jsovbn"),$(o,"class","pLine svelte-1jsovbn"),$(c,"type","text"),c.value=t[13],$(c,"class","svelte-1jsovbn"),$(a,"class","pLine svelte-1jsovbn"),$(_,"type","checkbox"),$(_,"id","ht_3"),_.checked=h=t[15].hearth3,$(_,"name","hearth3"),$(_,"class","svelte-1jsovbn"),$(v,"for","ht_3"),$(v,"class","svelte-1jsovbn"),$(m,"type","checkbox"),$(m,"id","ht_5"),m.checked=g=t[15].hearth5,$(m,"name","hearth5"),$(m,"class","svelte-1jsovbn"),$(b,"for","ht_5"),$(b,"class","svelte-1jsovbn"),$(u,"class","pLine svelte-1jsovbn"),O.__value="",O.value=O.__value,$(O,"class","svelte-1jsovbn"),$(L,"class","multiple_icon_typeTmp svelte-1jsovbn"),L.multiple=!0,void 0===t[14]&&X(()=>t[116].call(L)),$(k,"class","pLine svelte-1jsovbn"),$(l,"class","filtersCont svelte-1jsovbn")},m(h,g,w){C(h,e,g),C(h,n,g),C(h,l,g),j(l,o),j(o,s),j(o,r),j(l,i),j(l,a),j(a,p),j(a,c),j(l,d),j(l,u),j(u,_),j(u,v),j(u,f),j(u,m),j(u,b),j(l,x),j(l,k),j(k,L),j(L,O);for(let t=0;t<P.length;t+=1)P[t].m(L,null);H(L,t[14]),w&&y(M),M=[E(r,"input",t[76]),E(c,"input",t[75]),E(_,"change",t[77]),E(m,"change",t[77]),E(L,"change",t[116]),E(L,"change",t[74])]},p(t,e){if(65536&e[0]&&r.value!==t[16]&&(r.value=t[16]),8192&e[0]&&c.value!==t[13]&&(c.value=t[13]),32768&e[0]&&h!==(h=t[15].hearth3)&&(_.checked=h),32768&e[0]&&g!==(g=t[15].hearth5)&&(m.checked=g),768&e[2]){let n;for(q=t[71],n=0;n<q.length;n+=1){const l=ze(t,q,n);P[n]?P[n].p(l,e):(P[n]=Te(l),P[n].c(),P[n].m(L,null))}for(;n<P.length;n+=1)P[n].d(1);P.length=q.length}16384&e[0]&&H(L,t[14])},d(t){t&&w(e),t&&w(n),t&&w(l),D(P,t),y(M)}}}function Te(t){let e,n,l,o,s,r,i,a,p=t[70].road[t[159]]+"",c=t[159]+"";return{c(){e=z("option"),n=F("("),l=F(p),o=F(") - "),s=F(c),r=T(),e.__value=i=t[159],e.value=e.__value,$(e,"class",a="road_"+t[159]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,l),j(e,o),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function Oe(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,O,M,q,P,N,B,U,I,G,A=Object.keys(t[1]._opt.years).sort(),R=[];for(let e=0;e<A.length;e+=1)R[e]=Ee(De(t,A,e));let Z=t[69],Y=[];for(let e=0;e<Z.length;e+=1)Y[e]=Me(we(t,Z,e));return{c(){e=z("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (5)</b>",n=T(),l=z("div"),o=z("div"),s=F("ID ДТП: "),r=z("input"),i=T(),a=z("div"),p=z("fieldset"),c=z("legend"),c.textContent="Фильтрация по периодам:",d=T(),u=z("div"),_=z("input"),f=z("label"),f.textContent="Фильтрация по годам",m=T(),g=z("div");for(let t=0;t<R.length;t+=1)R[t].c();b=T(),x=z("div"),k=z("select"),L=z("option"),L.textContent=`\n\t\t\t\t\t\tВсе типы (${t[69].reduce(t[119],0)})\n\t\t\t\t\t`;for(let t=0;t<Y.length;t+=1)Y[t].c();O=T(),M=z("div"),q=z("select"),P=z("option"),P.textContent=`(${t[68].stricken[0]||0}) Очаги все`,N=z("option"),N.textContent=`(${t[68].stricken[1]||0}) Только с погибшими`,B=z("option"),B.textContent=`(${t[68].stricken[2]||0}) Только с пострадавшими`,U=z("option"),U.textContent=`(${t[68].stricken[3]||0}) С пострадавшими или погибшими`,I=z("option"),I.textContent=`(${t[68].stricken[4]||0}) С пострадавшими и погибшими`,$(e,"class","pLine svelte-1jsovbn"),$(r,"type","text"),r.value=t[13],$(r,"class","svelte-1jsovbn"),$(o,"class","pLine svelte-1jsovbn"),$(_,"type","radio"),_.__value=h=1,_.value=_.__value,_.checked=v=1===t[31],$(_,"id","hearths_period_type_51"),$(_,"name","hearths_period_type_5"),$(_,"class","svelte-1jsovbn"),t[118][4].push(_),$(f,"for","hearths_period_type_51"),$(f,"class","svelte-1jsovbn"),$(g,"class","pLine margin svelte-1jsovbn"),$(u,"class","pLine type svelte-1jsovbn"),$(a,"class","pLine nowrap svelte-1jsovbn"),L.__value="",L.value=L.__value,$(L,"class","svelte-1jsovbn"),$(k,"class","multiple_icon_typeTmp svelte-1jsovbn"),k.multiple=!0,void 0===t[30]&&X(()=>t[120].call(k)),$(x,"class","pLine svelte-1jsovbn"),P.__value="",P.value=P.__value,N.__value="1",N.value=N.__value,B.__value="2",B.value=B.__value,U.__value="3",U.value=U.__value,I.__value="4",I.value=I.__value,$(q,"class","svelte-1jsovbn"),void 0===t[29]&&X(()=>t[121].call(q)),$(M,"class","pLine svelte-1jsovbn"),$(l,"class","filtersCont svelte-1jsovbn")},m(h,v,w){C(h,e,v),C(h,n,v),C(h,l,v),j(l,o),j(o,s),j(o,r),j(l,i),j(l,a),j(a,p),j(p,c),j(p,d),j(p,u),j(u,_),_.checked=_.__value===t[31],j(u,f),j(u,m),j(u,g);for(let t=0;t<R.length;t+=1)R[t].m(g,null);j(l,b),j(l,x),j(x,k),j(k,L);for(let t=0;t<Y.length;t+=1)Y[t].m(k,null);H(k,t[30]),j(l,O),j(l,M),j(M,q),j(q,P),j(q,N),j(q,B),j(q,U),j(q,I),S(q,t[29]),w&&y(G),G=[E(r,"input",t[75]),E(_,"change",t[87]),E(_,"change",t[117]),E(k,"change",t[120]),E(k,"change",t[87]),E(q,"change",t[121]),E(q,"change",t[87])]},p(t,e){if(8192&e[0]&&r.value!==t[13]&&(r.value=t[13]),1&e[1]&&v!==(v=1===t[31])&&(_.checked=v),1&e[1]&&(_.checked=_.__value===t[31]),2&e[0]|3&e[1]|33554432&e[2]){let n;for(A=Object.keys(t[1]._opt.years).sort(),n=0;n<A.length;n+=1){const l=De(t,A,n);R[n]?R[n].p(l,e):(R[n]=Ee(l),R[n].c(),R[n].m(g,null))}for(;n<R.length;n+=1)R[n].d(1);R.length=A.length}if(192&e[2]){let n;for(Z=t[69],n=0;n<Z.length;n+=1){const l=we(t,Z,n);Y[n]?Y[n].p(l,e):(Y[n]=Me(l),Y[n].c(),Y[n].m(k,null))}for(;n<Y.length;n+=1)Y[n].d(1);Y.length=Z.length}1073741824&e[0]&&H(k,t[30]),536870912&e[0]&&S(q,t[29])},d(o){o&&w(e),o&&w(n),o&&w(l),t[118][4].splice(t[118][4].indexOf(_),1),D(R,o),D(Y,o),y(G)}}}function Ee(t){let e,n,l,o,s,r,i,a=t[159]+"";return{c(){e=z("input"),s=z("label"),r=F(a),$(e,"type","checkbox"),$(e,"id","hearths_year_5"),e.checked=n=t[32][t[159]],e.disabled=l=2===t[31],$(e,"name",o=t[159]),$(e,"class","svelte-1jsovbn"),$(s,"for","hearths_year_5"),$(s,"class","svelte-1jsovbn")},m(n,l,o){C(n,e,l),C(n,s,l),j(s,r),o&&i(),i=E(e,"change",t[87])},p(t,s){2&s[0]|2&s[1]&&n!==(n=t[32][t[159]])&&(e.checked=n),1&s[1]&&l!==(l=2===t[31])&&(e.disabled=l),2&s[0]&&o!==(o=t[159])&&$(e,"name",o),2&s[0]&&a!==(a=t[159]+"")&&P(r,a)},d(t){t&&w(e),t&&w(s),i()}}}function Me(t){let e,n,l,o,s,r,i,a,p=t[68].str_icon_type[t[159]]+"",c=t[159]+"";return{c(){e=z("option"),n=F("("),l=F(p),o=F(") - "),s=F(c),r=T(),e.__value=i=t[159],e.value=e.__value,$(e,"class",a="icon_type_"+t[68].iconType[t[159]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,l),j(e,o),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function $e(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,O,M,q,P,N,B,U,I,G,A=Object.keys(t[2]._opt.years).sort(),R=[];for(let e=0;e<A.length;e+=1)R[e]=qe(Ce(t,A,e));let Z=t[67],Y=[];for(let e=0;e<Z.length;e+=1)Y[e]=Pe(Le(t,Z,e));return{c(){e=z("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (3)</b>",n=T(),l=z("div"),o=z("div"),s=F("ID ДТП: "),r=z("input"),i=T(),a=z("div"),p=z("fieldset"),c=z("legend"),c.textContent="Фильтрация по периодам:",d=T(),u=z("div"),_=z("input"),f=z("label"),f.textContent="Фильтрация по годам",m=T(),g=z("div");for(let t=0;t<R.length;t+=1)R[t].c();b=T(),x=z("div"),k=z("select"),L=z("option"),L.textContent=`\n\t\t\t\t\t\tВсе типы (${t[67].reduce(t[123],0)})\n\t\t\t\t\t`;for(let t=0;t<Y.length;t+=1)Y[t].c();O=T(),M=z("div"),q=z("select"),P=z("option"),P.textContent=`(${t[66].stricken[0]||0}) Очаги все`,N=z("option"),N.textContent=`(${t[66].stricken[1]||0}) Только с погибшими`,B=z("option"),B.textContent=`(${t[66].stricken[2]||0}) Только с пострадавшими`,U=z("option"),U.textContent=`(${t[66].stricken[3]||0}) С пострадавшими или погибшими`,I=z("option"),I.textContent=`(${t[66].stricken[4]||0}) С пострадавшими и погибшими`,$(e,"class","pLine svelte-1jsovbn"),$(r,"type","text"),r.value=t[13],$(r,"class","svelte-1jsovbn"),$(o,"class","pLine svelte-1jsovbn"),$(_,"type","radio"),_.__value=h=1,_.value=_.__value,_.checked=v=1===t[35],$(_,"id","hearths_period_type_31"),$(_,"name","hearths_period_type_3"),$(_,"class","svelte-1jsovbn"),t[118][3].push(_),$(f,"for","hearths_period_type_31"),$(f,"class","svelte-1jsovbn"),$(g,"class","pLine margin svelte-1jsovbn"),$(u,"class","pLine type svelte-1jsovbn"),$(a,"class","pLine nowrap svelte-1jsovbn"),L.__value="",L.value=L.__value,$(L,"class","svelte-1jsovbn"),$(k,"class","multiple_icon_typeTmp svelte-1jsovbn"),k.multiple=!0,void 0===t[34]&&X(()=>t[124].call(k)),$(x,"class","pLine svelte-1jsovbn"),P.__value="",P.value=P.__value,N.__value="1",N.value=N.__value,B.__value="2",B.value=B.__value,U.__value="3",U.value=U.__value,I.__value="4",I.value=I.__value,$(q,"class","svelte-1jsovbn"),void 0===t[33]&&X(()=>t[125].call(q)),$(M,"class","pLine svelte-1jsovbn"),$(l,"class","filtersCont svelte-1jsovbn")},m(h,v,w){C(h,e,v),C(h,n,v),C(h,l,v),j(l,o),j(o,s),j(o,r),j(l,i),j(l,a),j(a,p),j(p,c),j(p,d),j(p,u),j(u,_),_.checked=_.__value===t[35],j(u,f),j(u,m),j(u,g);for(let t=0;t<R.length;t+=1)R[t].m(g,null);j(l,b),j(l,x),j(x,k),j(k,L);for(let t=0;t<Y.length;t+=1)Y[t].m(k,null);H(k,t[34]),j(l,O),j(l,M),j(M,q),j(q,P),j(q,N),j(q,B),j(q,U),j(q,I),S(q,t[33]),w&&y(G),G=[E(r,"input",t[75]),E(_,"change",t[88]),E(_,"change",t[122]),E(k,"change",t[124]),E(k,"change",t[88]),E(q,"change",t[125]),E(q,"change",t[88])]},p(t,e){if(8192&e[0]&&r.value!==t[13]&&(r.value=t[13]),16&e[1]&&v!==(v=1===t[35])&&(_.checked=v),16&e[1]&&(_.checked=_.__value===t[35]),4&e[0]|48&e[1]|67108864&e[2]){let n;for(A=Object.keys(t[2]._opt.years).sort(),n=0;n<A.length;n+=1){const l=Ce(t,A,n);R[n]?R[n].p(l,e):(R[n]=qe(l),R[n].c(),R[n].m(g,null))}for(;n<R.length;n+=1)R[n].d(1);R.length=A.length}if(48&e[2]){let n;for(Z=t[67],n=0;n<Z.length;n+=1){const l=Le(t,Z,n);Y[n]?Y[n].p(l,e):(Y[n]=Pe(l),Y[n].c(),Y[n].m(k,null))}for(;n<Y.length;n+=1)Y[n].d(1);Y.length=Z.length}8&e[1]&&H(k,t[34]),4&e[1]&&S(q,t[33])},d(o){o&&w(e),o&&w(n),o&&w(l),t[118][3].splice(t[118][3].indexOf(_),1),D(R,o),D(Y,o),y(G)}}}function qe(t){let e,n,l,o,s,r,i,a=t[159]+"";return{c(){e=z("input"),s=z("label"),r=F(a),$(e,"type","checkbox"),$(e,"id","hearths_year_3"),e.checked=n=t[36][t[159]],e.disabled=l=2===t[35],$(e,"name",o=t[159]),$(e,"class","svelte-1jsovbn"),$(s,"for","hearths_year_3"),$(s,"class","svelte-1jsovbn")},m(n,l,o){C(n,e,l),C(n,s,l),j(s,r),o&&i(),i=E(e,"change",t[88])},p(t,s){4&s[0]|32&s[1]&&n!==(n=t[36][t[159]])&&(e.checked=n),16&s[1]&&l!==(l=2===t[35])&&(e.disabled=l),4&s[0]&&o!==(o=t[159])&&$(e,"name",o),4&s[0]&&a!==(a=t[159]+"")&&P(r,a)},d(t){t&&w(e),t&&w(s),i()}}}function Pe(t){let e,n,l,o,s,r,i,a,p=t[66].str_icon_type[t[159]]+"",c=t[159]+"";return{c(){e=z("option"),n=F("("),l=F(p),o=F(") - "),s=F(c),r=T(),e.__value=i=t[159],e.value=e.__value,$(e,"class",a="icon_type_"+t[66].iconType[t[159]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,l),j(e,o),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function Ne(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,O,M,q,P,N,B,U,I,G,A,R,Z,Y,V,W,K,J=Object.keys(t[8]._opt.years).sort(),Q=[];for(let e=0;e<J.length;e+=1)Q[e]=Se(je(t,J,e));let tt=Object.keys(t[8]._opt.years).sort(),et=[];for(let e=0;e<tt.length;e+=1)et[e]=Be(ke(t,tt,e));let nt=t[65],lt=[];for(let e=0;e<nt.length;e+=1)lt[e]=Ue(be(t,nt,e));return{c(){e=z("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (Stat)</b>",n=T(),l=z("div"),o=z("div"),s=F("ID ДТП: "),r=z("input"),i=T(),a=z("div"),p=z("fieldset"),c=z("legend"),c.textContent="Фильтрация по периодам:",d=T(),u=z("div"),_=z("input"),f=z("label"),f.textContent="Фильтрация по годам",m=T(),g=z("div");for(let t=0;t<Q.length;t+=1)Q[t].c();b=T(),x=z("div"),k=z("input"),O=z("label"),O.textContent="Фильтрация по кварталам",M=T(),q=z("div");for(let t=0;t<et.length;t+=1)et[t].c();P=T(),N=z("div"),B=z("select"),U=z("option"),U.textContent=`\n\t\t\t\t\t\tВсе типы (${t[65].reduce(t[128],0)})\n\t\t\t\t\t`;for(let t=0;t<lt.length;t+=1)lt[t].c();I=T(),G=z("div"),A=z("select"),R=z("option"),R.textContent=`(${t[64].stricken[0]||0}) Очаги все`,Z=z("option"),Z.textContent=`(${t[64].stricken[1]||0}) Только с погибшими`,Y=z("option"),Y.textContent=`(${t[64].stricken[2]||0}) Только с пострадавшими`,V=z("option"),V.textContent=`(${t[64].stricken[3]||0}) С пострадавшими или погибшими`,W=z("option"),W.textContent=`(${t[64].stricken[4]||0}) С пострадавшими и погибшими`,$(e,"class","pLine svelte-1jsovbn"),$(r,"type","text"),r.value=t[13],$(r,"class","svelte-1jsovbn"),$(o,"class","pLine svelte-1jsovbn"),$(_,"type","radio"),_.__value=h=1,_.value=_.__value,_.checked=v=1===t[39],$(_,"id","hearths_period_type_Stat1"),$(_,"name","hearths_period_type_Stat"),$(_,"class","svelte-1jsovbn"),t[118][2].push(_),$(f,"for","hearths_period_type_Stat1"),$(f,"class","svelte-1jsovbn"),$(g,"class","pLine margin svelte-1jsovbn"),$(u,"class","pLine type svelte-1jsovbn"),$(k,"type","radio"),k.__value=L=2,k.value=k.__value,$(k,"id","hearths_period_type_Stat2"),$(k,"name","hearths_period_type_Stat"),$(k,"class","svelte-1jsovbn"),t[118][2].push(k),$(O,"for","hearths_period_type_Stat2"),$(O,"class","svelte-1jsovbn"),$(q,"class","pLine margin svelte-1jsovbn"),$(x,"class","pLine type svelte-1jsovbn"),$(a,"class","pLine nowrap svelte-1jsovbn"),U.__value="",U.value=U.__value,$(U,"class","svelte-1jsovbn"),$(B,"class","multiple_icon_typeTmp svelte-1jsovbn"),B.multiple=!0,void 0===t[38]&&X(()=>t[129].call(B)),$(N,"class","pLine svelte-1jsovbn"),R.__value="",R.value=R.__value,Z.__value="1",Z.value=Z.__value,Y.__value="2",Y.value=Y.__value,V.__value="3",V.value=V.__value,W.__value="4",W.value=W.__value,$(A,"class","svelte-1jsovbn"),void 0===t[37]&&X(()=>t[130].call(A)),$(G,"class","pLine svelte-1jsovbn"),$(l,"class","filtersCont svelte-1jsovbn")},m(h,v,L){C(h,e,v),C(h,n,v),C(h,l,v),j(l,o),j(o,s),j(o,r),j(l,i),j(l,a),j(a,p),j(p,c),j(p,d),j(p,u),j(u,_),_.checked=_.__value===t[39],j(u,f),j(u,m),j(u,g);for(let t=0;t<Q.length;t+=1)Q[t].m(g,null);j(p,b),j(p,x),j(x,k),k.checked=k.__value===t[39],j(x,O),j(x,M),j(x,q);for(let t=0;t<et.length;t+=1)et[t].m(q,null);j(l,P),j(l,N),j(N,B),j(B,U);for(let t=0;t<lt.length;t+=1)lt[t].m(B,null);H(B,t[38]),j(l,I),j(l,G),j(G,A),j(A,R),j(A,Z),j(A,Y),j(A,V),j(A,W),S(A,t[37]),L&&y(K),K=[E(r,"input",t[75]),E(_,"change",t[89]),E(_,"change",t[126]),E(k,"change",t[89]),E(k,"change",t[127]),E(B,"change",t[129]),E(B,"change",t[89]),E(A,"change",t[130]),E(A,"change",t[89])]},p(t,e){if(8192&e[0]&&r.value!==t[13]&&(r.value=t[13]),256&e[1]&&v!==(v=1===t[39])&&(_.checked=v),256&e[1]&&(_.checked=_.__value===t[39]),256&e[0]|768&e[1]|134217728&e[2]){let n;for(J=Object.keys(t[8]._opt.years).sort(),n=0;n<J.length;n+=1){const l=je(t,J,n);Q[n]?Q[n].p(l,e):(Q[n]=Se(l),Q[n].c(),Q[n].m(g,null))}for(;n<Q.length;n+=1)Q[n].d(1);Q.length=J.length}if(256&e[1]&&(k.checked=k.__value===t[39]),256&e[0]|1280&e[1]|134217728&e[2]){let n;for(tt=Object.keys(t[8]._opt.years).sort(),n=0;n<tt.length;n+=1){const l=ke(t,tt,n);et[n]?et[n].p(l,e):(et[n]=Be(l),et[n].c(),et[n].m(q,null))}for(;n<et.length;n+=1)et[n].d(1);et.length=tt.length}if(12&e[2]){let n;for(nt=t[65],n=0;n<nt.length;n+=1){const l=be(t,nt,n);lt[n]?lt[n].p(l,e):(lt[n]=Ue(l),lt[n].c(),lt[n].m(B,null))}for(;n<lt.length;n+=1)lt[n].d(1);lt.length=nt.length}128&e[1]&&H(B,t[38]),64&e[1]&&S(A,t[37])},d(o){o&&w(e),o&&w(n),o&&w(l),t[118][2].splice(t[118][2].indexOf(_),1),D(Q,o),t[118][2].splice(t[118][2].indexOf(k),1),D(et,o),D(lt,o),y(K)}}}function Se(t){let e,n,l,o,s,r,i,a=t[159]+"";return{c(){e=z("input"),s=z("label"),r=F(a),$(e,"type","checkbox"),$(e,"id","hearths_year_Stat"),e.checked=n=t[40][t[159]],e.disabled=l=2===t[39],$(e,"name",o=t[159]),$(e,"class","svelte-1jsovbn"),$(s,"for","hearths_year_Stat"),$(s,"class","svelte-1jsovbn")},m(n,l,o){C(n,e,l),C(n,s,l),j(s,r),o&&i(),i=E(e,"change",t[89])},p(t,s){256&s[0]|512&s[1]&&n!==(n=t[40][t[159]])&&(e.checked=n),256&s[1]&&l!==(l=2===t[39])&&(e.disabled=l),256&s[0]&&o!==(o=t[159])&&$(e,"name",o),256&s[0]&&a!==(a=t[159]+"")&&P(r,a)},d(t){t&&w(e),t&&w(s),i()}}}function He(t){let e,n,l,o,s,r,i,a,p,c,d=t[172]+"",u=t[159]+"";return{c(){e=z("input"),s=z("label"),r=F(d),i=F(" кв. "),a=F(u),$(e,"type","checkbox"),$(e,"id","hearths_quarter_Stat"),e.checked=n=t[41][t[159]]&&t[41][t[159]][t[172]],e.disabled=l=1===t[39],$(e,"name",o=t[159]+"_"+t[172]),$(e,"class","svelte-1jsovbn"),$(s,"for",p="hearths_quarter_Stat_"+t[159]+"_"+t[172]),$(s,"class","svelte-1jsovbn")},m(n,l,o){C(n,e,l),C(n,s,l),j(s,r),j(s,i),j(s,a),o&&c(),c=E(e,"change",t[89])},p(t,i){256&i[0]|1024&i[1]&&n!==(n=t[41][t[159]]&&t[41][t[159]][t[172]])&&(e.checked=n),256&i[1]&&l!==(l=1===t[39])&&(e.disabled=l),256&i[0]&&o!==(o=t[159]+"_"+t[172])&&$(e,"name",o),256&i[0]&&d!==(d=t[172]+"")&&P(r,d),256&i[0]&&u!==(u=t[159]+"")&&P(a,u),256&i[0]&&p!==(p="hearths_quarter_Stat_"+t[159]+"_"+t[172])&&$(s,"for",p)},d(t){t&&w(e),t&&w(s),c()}}}function Be(t){let e,n,l=Object.keys(t[8]._opt.years[t[159]]).sort(),o=[];for(let e=0;e<l.length;e+=1)o[e]=He(xe(t,l,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=T(),n=z("br")},m(t,l){for(let e=0;e<o.length;e+=1)o[e].m(t,l);C(t,e,l),C(t,n,l)},p(t,n){if(256&n[0]|1280&n[1]|134217728&n[2]){let s;for(l=Object.keys(t[8]._opt.years[t[159]]).sort(),s=0;s<l.length;s+=1){const r=xe(t,l,s);o[s]?o[s].p(r,n):(o[s]=He(r),o[s].c(),o[s].m(e.parentNode,e))}for(;s<o.length;s+=1)o[s].d(1);o.length=l.length}},d(t){D(o,t),t&&w(e),t&&w(n)}}}function Ue(t){let e,n,l,o,s,r,i,a,p=t[64].str_icon_type[t[159]]+"",c=t[159]+"";return{c(){e=z("option"),n=F("("),l=F(p),o=F(") - "),s=F(c),r=T(),e.__value=i=t[159],e.value=e.__value,$(e,"class",a="icon_type_"+t[64].iconType[t[159]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,l),j(e,o),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function Ie(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,O,M,q,P,N,B,U,I,G,A,R,Z,Y,V,W,K,J=Object.keys(t[9]._opt.years).sort(),Q=[];for(let e=0;e<J.length;e+=1)Q[e]=Ge(ye(t,J,e));let tt=Object.keys(t[9]._opt.years).sort(),et=[];for(let e=0;e<tt.length;e+=1)et[e]=Re(ge(t,tt,e));let nt=t[63],lt=[];for(let e=0;e<nt.length;e+=1)lt[e]=Ze(fe(t,nt,e));return{c(){e=z("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (TMP)</b>",n=T(),l=z("div"),o=z("div"),s=F("ID ДТП: "),r=z("input"),i=T(),a=z("div"),p=z("fieldset"),c=z("legend"),c.textContent="Фильтрация по периодам:",d=T(),u=z("div"),_=z("input"),f=z("label"),f.textContent="Фильтрация по годам",m=T(),g=z("div");for(let t=0;t<Q.length;t+=1)Q[t].c();b=T(),x=z("div"),k=z("input"),O=z("label"),O.textContent="Фильтрация по кварталам",M=T(),q=z("div");for(let t=0;t<et.length;t+=1)et[t].c();P=T(),N=z("div"),B=z("select"),U=z("option"),U.textContent=`\n\t\t\t\t\t\tВсе типы (${t[63].reduce(t[133],0)})\n\t\t\t\t\t`;for(let t=0;t<lt.length;t+=1)lt[t].c();I=T(),G=z("div"),A=z("select"),R=z("option"),R.textContent=`(${t[62].stricken[0]||0}) Очаги все`,Z=z("option"),Z.textContent=`(${t[62].stricken[1]||0}) Только с погибшими`,Y=z("option"),Y.textContent=`(${t[62].stricken[2]||0}) Только с пострадавшими`,V=z("option"),V.textContent=`(${t[62].stricken[3]||0}) С пострадавшими или погибшими`,W=z("option"),W.textContent=`(${t[62].stricken[4]||0}) С пострадавшими и погибшими`,$(e,"class","pLine svelte-1jsovbn"),$(r,"type","text"),r.value=t[13],$(r,"class","svelte-1jsovbn"),$(o,"class","pLine svelte-1jsovbn"),$(_,"type","radio"),_.__value=h=1,_.value=_.__value,_.checked=v=1===t[44],$(_,"id","hearths_period_type_tmp1"),$(_,"name","hearths_period_type_tmp"),$(_,"class","svelte-1jsovbn"),t[118][1].push(_),$(f,"for","hearths_period_type_tmp1"),$(f,"class","svelte-1jsovbn"),$(g,"class","pLine margin svelte-1jsovbn"),$(u,"class","pLine type svelte-1jsovbn"),$(k,"type","radio"),k.__value=L=2,k.value=k.__value,$(k,"id","hearths_period_type_tmp2"),$(k,"name","hearths_period_type_tmp"),$(k,"class","svelte-1jsovbn"),t[118][1].push(k),$(O,"for","hearths_period_type_tmp2"),$(O,"class","svelte-1jsovbn"),$(q,"class","pLine margin svelte-1jsovbn"),$(x,"class","pLine type svelte-1jsovbn"),$(a,"class","pLine nowrap svelte-1jsovbn"),U.__value="",U.value=U.__value,$(U,"class","svelte-1jsovbn"),$(B,"class","multiple_icon_typeTmp svelte-1jsovbn"),B.multiple=!0,void 0===t[43]&&X(()=>t[134].call(B)),$(N,"class","pLine svelte-1jsovbn"),R.__value="",R.value=R.__value,Z.__value="1",Z.value=Z.__value,Y.__value="2",Y.value=Y.__value,V.__value="3",V.value=V.__value,W.__value="4",W.value=W.__value,$(A,"class","svelte-1jsovbn"),void 0===t[42]&&X(()=>t[135].call(A)),$(G,"class","pLine svelte-1jsovbn"),$(l,"class","filtersCont svelte-1jsovbn")},m(h,v,L){C(h,e,v),C(h,n,v),C(h,l,v),j(l,o),j(o,s),j(o,r),j(l,i),j(l,a),j(a,p),j(p,c),j(p,d),j(p,u),j(u,_),_.checked=_.__value===t[44],j(u,f),j(u,m),j(u,g);for(let t=0;t<Q.length;t+=1)Q[t].m(g,null);j(p,b),j(p,x),j(x,k),k.checked=k.__value===t[44],j(x,O),j(x,M),j(x,q);for(let t=0;t<et.length;t+=1)et[t].m(q,null);j(l,P),j(l,N),j(N,B),j(B,U);for(let t=0;t<lt.length;t+=1)lt[t].m(B,null);H(B,t[43]),j(l,I),j(l,G),j(G,A),j(A,R),j(A,Z),j(A,Y),j(A,V),j(A,W),S(A,t[42]),L&&y(K),K=[E(r,"input",t[75]),E(_,"change",t[90]),E(_,"change",t[131]),E(k,"change",t[90]),E(k,"change",t[132]),E(B,"change",t[134]),E(B,"change",t[90]),E(A,"change",t[135]),E(A,"change",t[90])]},p(t,e){if(8192&e[0]&&r.value!==t[13]&&(r.value=t[13]),8192&e[1]&&v!==(v=1===t[44])&&(_.checked=v),8192&e[1]&&(_.checked=_.__value===t[44]),512&e[0]|24576&e[1]|268435456&e[2]){let n;for(J=Object.keys(t[9]._opt.years).sort(),n=0;n<J.length;n+=1){const l=ye(t,J,n);Q[n]?Q[n].p(l,e):(Q[n]=Ge(l),Q[n].c(),Q[n].m(g,null))}for(;n<Q.length;n+=1)Q[n].d(1);Q.length=J.length}if(8192&e[1]&&(k.checked=k.__value===t[44]),512&e[0]|40960&e[1]|268435456&e[2]){let n;for(tt=Object.keys(t[9]._opt.years).sort(),n=0;n<tt.length;n+=1){const l=ge(t,tt,n);et[n]?et[n].p(l,e):(et[n]=Re(l),et[n].c(),et[n].m(q,null))}for(;n<et.length;n+=1)et[n].d(1);et.length=tt.length}if(3&e[2]){let n;for(nt=t[63],n=0;n<nt.length;n+=1){const l=fe(t,nt,n);lt[n]?lt[n].p(l,e):(lt[n]=Ze(l),lt[n].c(),lt[n].m(B,null))}for(;n<lt.length;n+=1)lt[n].d(1);lt.length=nt.length}4096&e[1]&&H(B,t[43]),2048&e[1]&&S(A,t[42])},d(o){o&&w(e),o&&w(n),o&&w(l),t[118][1].splice(t[118][1].indexOf(_),1),D(Q,o),t[118][1].splice(t[118][1].indexOf(k),1),D(et,o),D(lt,o),y(K)}}}function Ge(t){let e,n,l,o,s,r,i,a=t[159]+"";return{c(){e=z("input"),s=z("label"),r=F(a),$(e,"type","checkbox"),$(e,"id","hearths_year_tmp"),e.checked=n=t[45][t[159]],e.disabled=l=2===t[44],$(e,"name",o=t[159]),$(e,"class","svelte-1jsovbn"),$(s,"for","hearths_year_tmp"),$(s,"class","svelte-1jsovbn")},m(n,l,o){C(n,e,l),C(n,s,l),j(s,r),o&&i(),i=E(e,"change",t[90])},p(t,s){512&s[0]|16384&s[1]&&n!==(n=t[45][t[159]])&&(e.checked=n),8192&s[1]&&l!==(l=2===t[44])&&(e.disabled=l),512&s[0]&&o!==(o=t[159])&&$(e,"name",o),512&s[0]&&a!==(a=t[159]+"")&&P(r,a)},d(t){t&&w(e),t&&w(s),i()}}}function Ae(t){let e,n,l,o,s,r,i,a,p,c,d=t[172]+"",u=t[159]+"";return{c(){e=z("input"),s=z("label"),r=F(d),i=F(" кв. "),a=F(u),$(e,"type","checkbox"),$(e,"id","hearths_quarter_tmp"),e.checked=n=t[46][t[159]]&&t[46][t[159]][t[172]],e.disabled=l=1===t[44],$(e,"name",o=t[159]+"_"+t[172]),$(e,"class","svelte-1jsovbn"),$(s,"for",p="hearths_quarter_tmp_"+t[159]+"_"+t[172]),$(s,"class","svelte-1jsovbn")},m(n,l,o){C(n,e,l),C(n,s,l),j(s,r),j(s,i),j(s,a),o&&c(),c=E(e,"change",t[90])},p(t,i){512&i[0]|32768&i[1]&&n!==(n=t[46][t[159]]&&t[46][t[159]][t[172]])&&(e.checked=n),8192&i[1]&&l!==(l=1===t[44])&&(e.disabled=l),512&i[0]&&o!==(o=t[159]+"_"+t[172])&&$(e,"name",o),512&i[0]&&d!==(d=t[172]+"")&&P(r,d),512&i[0]&&u!==(u=t[159]+"")&&P(a,u),512&i[0]&&p!==(p="hearths_quarter_tmp_"+t[159]+"_"+t[172])&&$(s,"for",p)},d(t){t&&w(e),t&&w(s),c()}}}function Re(t){let e,n,l=Object.keys(t[9]._opt.years[t[159]]).sort(),o=[];for(let e=0;e<l.length;e+=1)o[e]=Ae(me(t,l,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=T(),n=z("br")},m(t,l){for(let e=0;e<o.length;e+=1)o[e].m(t,l);C(t,e,l),C(t,n,l)},p(t,n){if(512&n[0]|40960&n[1]|268435456&n[2]){let s;for(l=Object.keys(t[9]._opt.years[t[159]]).sort(),s=0;s<l.length;s+=1){const r=me(t,l,s);o[s]?o[s].p(r,n):(o[s]=Ae(r),o[s].c(),o[s].m(e.parentNode,e))}for(;s<o.length;s+=1)o[s].d(1);o.length=l.length}},d(t){D(o,t),t&&w(e),t&&w(n)}}}function Ze(t){let e,n,l,o,s,r,i,a,p=t[62].str_icon_type[t[159]]+"",c=t[159]+"";return{c(){e=z("option"),n=F("("),l=F(p),o=F(") - "),s=F(c),r=T(),e.__value=i=t[159],e.value=e.__value,$(e,"class",a="icon_type_"+t[62].iconType[t[159]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,l),j(e,o),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function Ye(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,O,M,q,P,N,B,U,I,G,A,R,Z,Y,V,W,K,J,Q,tt=Object.keys(t[10]._opt.years).sort(),et=[];for(let e=0;e<tt.length;e+=1)et[e]=Ve(ve(t,tt,e));let nt=Object.keys(t[10]._opt.years).sort(),lt=[];for(let e=0;e<nt.length;e+=1)lt[e]=Ke(he(t,nt,e));let ot=t[61],st=[];for(let e=0;e<ot.length;e+=1)st[e]=Je(ue(t,ot,e));return{c(){e=z("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),l=z("div"),l.innerHTML="Фильтры - <b>ДТП Очаги</b>",o=T(),s=z("div"),r=z("div"),i=F("ID ДТП: "),a=z("input"),p=T(),c=z("div"),d=z("fieldset"),u=z("legend"),u.textContent="Фильтрация по периодам:",_=T(),h=z("div"),v=z("input"),g=z("label"),g.textContent="Фильтрация по годам",b=T(),x=z("div");for(let t=0;t<et.length;t+=1)et[t].c();k=T(),L=z("div"),O=z("input"),q=z("label"),q.textContent="Фильтрация по кварталам",P=T(),N=z("div");for(let t=0;t<lt.length;t+=1)lt[t].c();B=T(),U=z("div"),I=z("select"),G=z("option"),G.textContent=`\n\t\t\t\t\t\tВсе типы (${t[61].reduce(t[138],0)})\n\t\t\t\t\t`;for(let t=0;t<st.length;t+=1)st[t].c();A=T(),R=z("div"),Z=z("select"),Y=z("option"),Y.textContent=`(${t[60].stricken[0]||0}) Очаги все`,V=z("option"),V.textContent=`(${t[60].stricken[1]||0}) Только с погибшими`,W=z("option"),W.textContent=`(${t[60].stricken[2]||0}) Только с пострадавшими`,K=z("option"),K.textContent=`(${t[60].stricken[3]||0}) С пострадавшими или погибшими`,J=z("option"),J.textContent=`(${t[60].stricken[4]||0}) С пострадавшими и погибшими`,$(e,"class","pLine svelte-1jsovbn"),$(l,"class","pLine svelte-1jsovbn"),$(a,"type","text"),a.value=t[13],$(a,"class","svelte-1jsovbn"),$(r,"class","pLine svelte-1jsovbn"),$(v,"type","radio"),v.__value=f=1,v.value=v.__value,v.checked=m=1===t[49],$(v,"id","hearths_period_type1"),$(v,"name","hearths_period_type"),$(v,"class","svelte-1jsovbn"),t[118][0].push(v),$(g,"for","hearths_period_type1"),$(g,"class","svelte-1jsovbn"),$(x,"class","pLine margin svelte-1jsovbn"),$(h,"class","pLine type svelte-1jsovbn"),$(O,"type","radio"),O.__value=M=2,O.value=O.__value,$(O,"id","hearths_period_type2"),$(O,"name","hearths_period_type"),$(O,"class","svelte-1jsovbn"),t[118][0].push(O),$(q,"for","hearths_period_type2"),$(q,"class","svelte-1jsovbn"),$(N,"class","pLine margin svelte-1jsovbn"),$(L,"class","pLine type svelte-1jsovbn"),$(c,"class","pLine nowrap svelte-1jsovbn"),G.__value="",G.value=G.__value,$(G,"class","svelte-1jsovbn"),$(I,"class","multiple_icon_typeTmp svelte-1jsovbn"),I.multiple=!0,void 0===t[48]&&X(()=>t[139].call(I)),$(U,"class","pLine svelte-1jsovbn"),Y.__value="",Y.value=Y.__value,V.__value="1",V.value=V.__value,W.__value="2",W.value=W.__value,K.__value="3",K.value=K.__value,J.__value="4",J.value=J.__value,$(Z,"class","svelte-1jsovbn"),void 0===t[47]&&X(()=>t[140].call(Z)),$(R,"class","pLine svelte-1jsovbn"),$(s,"class","filtersCont svelte-1jsovbn")},m(f,m,w){C(f,e,m),C(f,n,m),C(f,l,m),C(f,o,m),C(f,s,m),j(s,r),j(r,i),j(r,a),j(s,p),j(s,c),j(c,d),j(d,u),j(d,_),j(d,h),j(h,v),v.checked=v.__value===t[49],j(h,g),j(h,b),j(h,x);for(let t=0;t<et.length;t+=1)et[t].m(x,null);j(d,k),j(d,L),j(L,O),O.checked=O.__value===t[49],j(L,q),j(L,P),j(L,N);for(let t=0;t<lt.length;t+=1)lt[t].m(N,null);j(s,B),j(s,U),j(U,I),j(I,G);for(let t=0;t<st.length;t+=1)st[t].m(I,null);H(I,t[48]),j(s,A),j(s,R),j(R,Z),j(Z,Y),j(Z,V),j(Z,W),j(Z,K),j(Z,J),S(Z,t[47]),w&&y(Q),Q=[E(a,"input",t[75]),E(v,"change",t[91]),E(v,"change",t[136]),E(O,"change",t[91]),E(O,"change",t[137]),E(I,"change",t[139]),E(I,"change",t[91]),E(Z,"change",t[140]),E(Z,"change",t[91])]},p(t,e){if(8192&e[0]&&a.value!==t[13]&&(a.value=t[13]),262144&e[1]&&m!==(m=1===t[49])&&(v.checked=m),262144&e[1]&&(v.checked=v.__value===t[49]),1024&e[0]|786432&e[1]|536870912&e[2]){let n;for(tt=Object.keys(t[10]._opt.years).sort(),n=0;n<tt.length;n+=1){const l=ve(t,tt,n);et[n]?et[n].p(l,e):(et[n]=Ve(l),et[n].c(),et[n].m(x,null))}for(;n<et.length;n+=1)et[n].d(1);et.length=tt.length}if(262144&e[1]&&(O.checked=O.__value===t[49]),1024&e[0]|1310720&e[1]|536870912&e[2]){let n;for(nt=Object.keys(t[10]._opt.years).sort(),n=0;n<nt.length;n+=1){const l=he(t,nt,n);lt[n]?lt[n].p(l,e):(lt[n]=Ke(l),lt[n].c(),lt[n].m(N,null))}for(;n<lt.length;n+=1)lt[n].d(1);lt.length=nt.length}if(1610612736&e[1]){let n;for(ot=t[61],n=0;n<ot.length;n+=1){const l=ue(t,ot,n);st[n]?st[n].p(l,e):(st[n]=Je(l),st[n].c(),st[n].m(I,null))}for(;n<st.length;n+=1)st[n].d(1);st.length=ot.length}131072&e[1]&&H(I,t[48]),65536&e[1]&&S(Z,t[47])},d(r){r&&w(e),r&&w(n),r&&w(l),r&&w(o),r&&w(s),t[118][0].splice(t[118][0].indexOf(v),1),D(et,r),t[118][0].splice(t[118][0].indexOf(O),1),D(lt,r),D(st,r),y(Q)}}}function Ve(t){let e,n,l,o,s,r,i,a,p=t[159]+"";return{c(){e=z("input"),s=z("label"),r=F(p),$(e,"type","checkbox"),$(e,"id","hearths_year"),e.checked=n=t[50][t[159]],e.disabled=l=2===t[49],$(e,"name",o=t[159]),$(e,"class","svelte-1jsovbn"),$(s,"for",i="hearths_year"+t[159]),$(s,"class","svelte-1jsovbn")},m(n,l,o){C(n,e,l),C(n,s,l),j(s,r),o&&a(),a=E(e,"change",t[91])},p(t,a){1024&a[0]|524288&a[1]&&n!==(n=t[50][t[159]])&&(e.checked=n),262144&a[1]&&l!==(l=2===t[49])&&(e.disabled=l),1024&a[0]&&o!==(o=t[159])&&$(e,"name",o),1024&a[0]&&p!==(p=t[159]+"")&&P(r,p),1024&a[0]&&i!==(i="hearths_year"+t[159])&&$(s,"for",i)},d(t){t&&w(e),t&&w(s),a()}}}function We(t){let e,n,l,o,s,r,i,a,p,c,d=t[172]+"",u=t[159]+"";return{c(){e=z("input"),s=z("label"),r=F(d),i=F(" кв. "),a=F(u),$(e,"type","checkbox"),$(e,"id","hearths_quarter"),e.checked=n=t[51][t[159]]&&t[51][t[159]][t[172]],e.disabled=l=1===t[49],$(e,"name",o=t[159]+"_"+t[172]),$(e,"class","svelte-1jsovbn"),$(s,"for",p="hearths_quarter_"+t[159]+"_"+t[172]),$(s,"class","svelte-1jsovbn")},m(n,l,o){C(n,e,l),C(n,s,l),j(s,r),j(s,i),j(s,a),o&&c(),c=E(e,"change",t[91])},p(t,i){1024&i[0]|1048576&i[1]&&n!==(n=t[51][t[159]]&&t[51][t[159]][t[172]])&&(e.checked=n),262144&i[1]&&l!==(l=1===t[49])&&(e.disabled=l),1024&i[0]&&o!==(o=t[159]+"_"+t[172])&&$(e,"name",o),1024&i[0]&&d!==(d=t[172]+"")&&P(r,d),1024&i[0]&&u!==(u=t[159]+"")&&P(a,u),1024&i[0]&&p!==(p="hearths_quarter_"+t[159]+"_"+t[172])&&$(s,"for",p)},d(t){t&&w(e),t&&w(s),c()}}}function Ke(t){let e,n,l=Object.keys(t[10]._opt.years[t[159]]).sort(),o=[];for(let e=0;e<l.length;e+=1)o[e]=We(_e(t,l,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=T(),n=z("br")},m(t,l){for(let e=0;e<o.length;e+=1)o[e].m(t,l);C(t,e,l),C(t,n,l)},p(t,n){if(1024&n[0]|1310720&n[1]|536870912&n[2]){let s;for(l=Object.keys(t[10]._opt.years[t[159]]).sort(),s=0;s<l.length;s+=1){const r=_e(t,l,s);o[s]?o[s].p(r,n):(o[s]=We(r),o[s].c(),o[s].m(e.parentNode,e))}for(;s<o.length;s+=1)o[s].d(1);o.length=l.length}},d(t){D(o,t),t&&w(e),t&&w(n)}}}function Je(t){let e,n,l,o,s,r,i,a,p=t[60].str_icon_type[t[159]]+"",c=t[159]+"";return{c(){e=z("option"),n=F("("),l=F(p),o=F(") - "),s=F(c),r=T(),e.__value=i=t[159],e.value=e.__value,$(e,"class",a="icon_type_"+t[60].iconType[t[159]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,l),j(e,o),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function Qe(t){let e;return{c(){e=z("div"),e.textContent="Нет включенных слоев",$(e,"class","pLine svelte-1jsovbn")},m(t,n){C(t,e,n)},p:f,d(t){t&&w(e)}}}function Xe(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,D,O,M,q,S,H,B,U,I,G,A,R,Z,Y,V,W,K,J,Q,X,tt,et,nt,lt,ot;return{c(){e=z("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),l=z("div"),o=z("button"),s=T(),r=z("input"),i=T(),a=z("input"),p=T(),c=z("button"),d=T(),u=z("div"),_=z("br"),h=T(),v=z("label"),f=z("input"),g=z("span"),b=F("Мин.яркость ("),x=F(t[23]),k=F(")"),L=T(),D=z("br"),O=T(),M=z("label"),q=z("input"),H=z("span"),B=F("Радиус ("),U=F(t[21]),I=F(")"),G=T(),A=z("br"),R=T(),Z=z("label"),Y=z("input"),W=z("span"),K=F("Размытие ("),J=F(t[22]),Q=F(")"),X=T(),tt=z("div"),et=z("input"),lt=z("label"),lt.textContent="- тепловая карта",$(e,"class","pLine svelte-1jsovbn"),$(o,"class","pika-prev"),$(r,"type","text"),$(r,"class","begDate svelte-1jsovbn"),$(a,"type","text"),$(a,"class","endDate svelte-1jsovbn"),$(c,"class","pika-next"),$(l,"class","pikaday pLine svelte-1jsovbn"),$(f,"type","range"),$(f,"min","0.05"),$(f,"max","1"),$(f,"step","0.01"),f.disabled=m=!t[72],$(f,"class","svelte-1jsovbn"),$(v,"class","svelte-1jsovbn"),$(q,"type","range"),$(q,"min","0"),$(q,"max","100"),$(q,"step","1"),q.disabled=S=!t[72],$(q,"class","svelte-1jsovbn"),$(M,"class","svelte-1jsovbn"),$(Y,"type","range"),$(Y,"min","0"),$(Y,"max","15"),$(Y,"step","0.01"),Y.disabled=V=!t[72],$(Y,"class","svelte-1jsovbn"),$(Z,"class","svelte-1jsovbn"),$(u,"class","pLine svelte-1jsovbn"),$(et,"type","checkbox"),et.checked=nt=t[6]._needHeat||t[5]._needHeat||t[4]._needHeat||t[3]._needHeat,$(et,"name","heat"),$(et,"class","svelte-1jsovbn"),$(lt,"for","heat"),$(lt,"class","svelte-1jsovbn"),$(tt,"class","pLine svelte-1jsovbn")},m(m,w,z){C(m,e,w),C(m,n,w),C(m,l,w),j(l,o),j(l,s),j(l,r),t[141](r),j(l,i),j(l,a),t[142](a),j(l,p),j(l,c),C(m,d,w),C(m,u,w),j(u,_),j(u,h),j(u,v),j(v,f),N(f,t[23]),j(v,g),j(g,b),j(g,x),j(g,k),j(u,L),j(u,D),j(u,O),j(u,M),j(M,q),N(q,t[21]),j(M,H),j(H,B),j(H,U),j(H,I),j(u,G),j(u,A),j(u,R),j(u,Z),j(Z,Y),N(Y,t[22]),j(Z,W),j(W,K),j(W,J),j(W,Q),C(m,X,w),C(m,tt,w),j(tt,et),t[146](et),j(tt,lt),z&&y(ot),ot=[E(o,"click",t[85]),E(c,"click",t[86]),E(f,"change",t[143]),E(f,"input",t[143]),E(f,"input",t[79]),E(q,"change",t[144]),E(q,"input",t[144]),E(q,"input",t[79]),E(Y,"change",t[145]),E(Y,"input",t[145]),E(Y,"input",t[79]),E(et,"change",t[78])]},p(t,e){8388608&e[0]&&N(f,t[23]),8388608&e[0]&&P(x,t[23]),2097152&e[0]&&N(q,t[21]),2097152&e[0]&&P(U,t[21]),4194304&e[0]&&N(Y,t[22]),4194304&e[0]&&P(J,t[22]),120&e[0]&&nt!==(nt=t[6]._needHeat||t[5]._needHeat||t[4]._needHeat||t[3]._needHeat)&&(et.checked=nt)},d(o){o&&w(e),o&&w(n),o&&w(l),t[141](null),t[142](null),o&&w(d),o&&w(u),o&&w(X),o&&w(tt),t[146](null),y(ot)}}}function tn(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b;function x(t,e){return t[3]._arm?nn:en}let k=x(t),L=k(t),O=t[52].collision_type&&function(t){let e,n,l,o,s=t[53],r=[];for(let e=0;e<s.length;e+=1)r[e]=ln(de(t,s,e));return{c(){e=z("div"),n=z("select"),l=z("option"),l.textContent=`\n\t\t\t\t\t\tВсе типы (${t[53].reduce(t[147],0)})\n\t\t\t\t\t`;for(let t=0;t<r.length;t+=1)r[t].c();l.__value="",l.value=l.__value,$(l,"class","svelte-1jsovbn"),$(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===t[17]&&X(()=>t[148].call(n)),$(e,"class","pLine svelte-1jsovbn")},m(s,i,a){C(s,e,i),j(e,n),j(n,l);for(let t=0;t<r.length;t+=1)r[t].m(n,null);H(n,t[17]),a&&y(o),o=[E(n,"change",t[148]),E(n,"change",t[80])]},p(t,e){if(6291456&e[1]){let l;for(s=t[53],l=0;l<s.length;l+=1){const o=de(t,s,l);r[l]?r[l].p(o,e):(r[l]=ln(o),r[l].c(),r[l].m(n,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=s.length}131072&e[0]&&H(n,t[17])},d(t){t&&w(e),D(r,t),y(o)}}}(t);return{c(){e=z("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),l=z("div"),l.innerHTML="Фильтры - <b>ДТП Сводный</b>",o=T(),s=z("div"),r=z("div"),i=F("ID ДТП: "),a=z("input"),p=T(),c=z("div"),d=z("input"),u=z("label"),u.textContent="Все",_=T(),L.c(),h=T(),v=z("div"),f=z("input"),m=z("label"),m.textContent="Только ГИБДД",g=T(),O&&O.c(),$(e,"class","pLine svelte-1jsovbn"),$(l,"class","pLine svelte-1jsovbn"),$(a,"type","text"),a.value=t[13],$(a,"class","svelte-1jsovbn"),$(r,"class","pLine svelte-1jsovbn"),$(d,"type","radio"),$(d,"id","d0"),$(d,"name","drone"),d.value="0",d.checked=!0,$(d,"class","svelte-1jsovbn"),$(u,"for","d0"),$(u,"class","svelte-1jsovbn"),$(c,"class","pLine svelte-1jsovbn"),$(f,"type","radio"),$(f,"id","d3"),$(f,"name","drone"),f.value="3",$(f,"class","svelte-1jsovbn"),$(m,"for","d3"),$(m,"class","svelte-1jsovbn"),$(v,"class","pLine svelte-1jsovbn"),$(s,"class","filtersCont svelte-1jsovbn")},m(x,k,w){C(x,e,k),C(x,n,k),C(x,l,k),C(x,o,k),C(x,s,k),j(s,r),j(r,i),j(r,a),j(s,p),j(s,c),j(c,d),j(c,u),j(s,_),L.m(s,null),j(s,h),j(s,v),j(v,f),j(v,m),j(s,g),O&&O.m(s,null),w&&y(b),b=[E(a,"input",t[75]),E(d,"click",t[84]),E(f,"click",t[84])]},p(t,e){8192&e[0]&&a.value!==t[13]&&(a.value=t[13]),k===(k=x(t))&&L?L.p(t,e):(L.d(1),L=k(t),L&&(L.c(),L.m(s,h))),t[52].collision_type&&O.p(t,e)},d(t){t&&w(e),t&&w(n),t&&w(l),t&&w(o),t&&w(s),L.d(),O&&O.d(),y(b)}}}function en(t){let e,n,l,o,s,r,i,a;return{c(){e=z("div"),n=z("input"),l=z("label"),l.textContent="Только Пересечения",o=T(),s=z("div"),r=z("input"),i=z("label"),i.textContent="Только СКПДИ",$(n,"type","radio"),$(n,"id","d1"),$(n,"name","drone"),n.value="1",$(n,"class","svelte-1jsovbn"),$(l,"for","d1"),$(l,"class","svelte-1jsovbn"),$(e,"class","pLine svelte-1jsovbn"),$(r,"type","radio"),$(r,"id","d2"),$(r,"name","drone"),r.value="2",$(r,"class","svelte-1jsovbn"),$(i,"for","d2"),$(i,"class","svelte-1jsovbn"),$(s,"class","pLine svelte-1jsovbn")},m(p,c,d){C(p,e,c),j(e,n),j(e,l),C(p,o,c),C(p,s,c),j(s,r),j(s,i),d&&y(a),a=[E(n,"click",t[84]),E(r,"click",t[84])]},p:f,d(t){t&&w(e),t&&w(o),t&&w(s),y(a)}}}function nn(t){let e,n,l,o;return{c(){e=z("div"),n=z("input"),l=z("label"),l.textContent="Только Пересечения ГИБДД и СКПДИ",$(n,"type","radio"),$(n,"id","d1"),$(n,"name","drone"),n.value="1",$(n,"class","svelte-1jsovbn"),$(l,"for","d1"),$(l,"class","svelte-1jsovbn"),$(e,"class","pLine svelte-1jsovbn")},m(s,r,i){C(s,e,r),j(e,n),j(e,l),i&&o(),o=E(n,"click",t[84])},p:f,d(t){t&&w(e),o()}}}function ln(t){let e,n,l,o,s,r,i,a,p=t[52].collision_type[t[159]]+"",c=t[159]+"";return{c(){e=z("option"),n=F("("),l=F(p),o=F(") - "),s=F(c),r=T(),e.__value=i=t[159],e.value=e.__value,$(e,"class",a="icon_type_"+t[52].iconType[t[159]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,l),j(e,o),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function on(t){let e,n,l,o,s,r,i,a,p,c,d=t[54].collision_type&&function(t){let e,n,l,o,s=t[55],r=[];for(let e=0;e<s.length;e+=1)r[e]=sn(ce(t,s,e));return{c(){e=z("div"),n=z("select"),l=z("option"),l.textContent=`\n\t\t\t\t\t\tВсе типы (${t[55].reduce(t[149],0)})\n\t\t\t\t\t`;for(let t=0;t<r.length;t+=1)r[t].c();l.__value="",l.value=l.__value,$(l,"class","svelte-1jsovbn"),$(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===t[18]&&X(()=>t[150].call(n)),$(e,"class","pLine svelte-1jsovbn")},m(s,i,a){C(s,e,i),j(e,n),j(n,l);for(let t=0;t<r.length;t+=1)r[t].m(n,null);H(n,t[18]),a&&y(o),o=[E(n,"change",t[150]),E(n,"change",t[83])]},p(t,e){if(25165824&e[1]){let l;for(s=t[55],l=0;l<s.length;l+=1){const o=ce(t,s,l);r[l]?r[l].p(o,e):(r[l]=sn(o),r[l].c(),r[l].m(n,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=s.length}262144&e[0]&&H(n,t[18])},d(t){t&&w(e),D(r,t),y(o)}}}(t);return{c(){e=z("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),l=z("div"),l.innerHTML="Фильтры - <b>ДТП СКПДИ</b>",o=T(),s=z("div"),r=z("div"),i=F("ID ДТП: "),a=z("input"),p=T(),d&&d.c(),$(e,"class","pLine svelte-1jsovbn"),$(l,"class","pLine svelte-1jsovbn"),$(a,"type","text"),a.value=t[13],$(a,"class","svelte-1jsovbn"),$(r,"class","pLine svelte-1jsovbn"),$(s,"class","filtersCont svelte-1jsovbn")},m(u,_,h){C(u,e,_),C(u,n,_),C(u,l,_),C(u,o,_),C(u,s,_),j(s,r),j(r,i),j(r,a),j(s,p),d&&d.m(s,null),h&&c(),c=E(a,"input",t[75])},p(t,e){8192&e[0]&&a.value!==t[13]&&(a.value=t[13]),t[54].collision_type&&d.p(t,e)},d(t){t&&w(e),t&&w(n),t&&w(l),t&&w(o),t&&w(s),d&&d.d(),c()}}}function sn(t){let e,n,l,o,s,r,i,a,p=t[54].collision_type[t[159]]+"",c=t[159]+"";return{c(){e=z("option"),n=F("("),l=F(p),o=F(") - "),s=F(c),r=T(),e.__value=i=t[159],e.value=e.__value,$(e,"class",a="icon_type_"+t[54].iconType[t[159]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,l),j(e,o),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function rn(t){let e,n,l,o,s,r,i,a,p,c,d=t[56].collision_type&&function(t){let e,n,l,o,s=t[57],r=[];for(let e=0;e<s.length;e+=1)r[e]=an(pe(t,s,e));return{c(){e=z("div"),n=z("select"),l=z("option"),l.textContent=`\n\t\t\t\t\t\tВсе типы (${t[57].reduce(t[151],0)})\n\t\t\t\t\t`;for(let t=0;t<r.length;t+=1)r[t].c();l.__value="",l.value=l.__value,$(l,"class","svelte-1jsovbn"),$(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===t[19]&&X(()=>t[152].call(n)),$(e,"class","pLine svelte-1jsovbn")},m(s,i,a){C(s,e,i),j(e,n),j(n,l);for(let t=0;t<r.length;t+=1)r[t].m(n,null);H(n,t[19]),a&&y(o),o=[E(n,"change",t[152]),E(n,"change",t[82])]},p(t,e){if(100663296&e[1]){let l;for(s=t[57],l=0;l<s.length;l+=1){const o=pe(t,s,l);r[l]?r[l].p(o,e):(r[l]=an(o),r[l].c(),r[l].m(n,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=s.length}524288&e[0]&&H(n,t[19])},d(t){t&&w(e),D(r,t),y(o)}}}(t);return{c(){e=z("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),l=z("div"),l.innerHTML="Фильтры - <b>ДТП ГИБДД</b>",o=T(),s=z("div"),r=z("div"),i=F("ID ДТП: "),a=z("input"),p=T(),d&&d.c(),$(e,"class","pLine svelte-1jsovbn"),$(l,"class","pLine svelte-1jsovbn"),$(a,"type","text"),a.value=t[13],$(a,"class","svelte-1jsovbn"),$(r,"class","pLine svelte-1jsovbn"),$(s,"class","filtersCont svelte-1jsovbn")},m(u,_,h){C(u,e,_),C(u,n,_),C(u,l,_),C(u,o,_),C(u,s,_),j(s,r),j(r,i),j(r,a),j(s,p),d&&d.m(s,null),h&&c(),c=E(a,"input",t[75])},p(t,e){8192&e[0]&&a.value!==t[13]&&(a.value=t[13]),t[56].collision_type&&d.p(t,e)},d(t){t&&w(e),t&&w(n),t&&w(l),t&&w(o),t&&w(s),d&&d.d(),c()}}}function an(t){let e,n,l,o,s,r,i,a,p=t[56].collision_type[t[159]]+"",c=t[159]+"";return{c(){e=z("option"),n=F("("),l=F(p),o=F(") - "),s=F(c),r=T(),e.__value=i=t[159],e.value=e.__value,$(e,"class",a="icon_type_"+t[56].iconType[t[159]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,l),j(e,o),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function pn(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,f,m,g=t[58].collision_type&&function(t){let e,n,l,o,s=t[59],r=[];for(let e=0;e<s.length;e+=1)r[e]=cn(ae(t,s,e));return{c(){e=z("div"),n=z("select"),l=z("option"),l.textContent=`\n\t\t\t\t\t\tВсе типы (${t[59].reduce(t[155],0)})\n\t\t\t\t\t`;for(let t=0;t<r.length;t+=1)r[t].c();l.__value="",l.value=l.__value,$(l,"class","svelte-1jsovbn"),$(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===t[20]&&X(()=>t[156].call(n)),$(e,"class","pLine svelte-1jsovbn")},m(s,i,a){C(s,e,i),j(e,n),j(n,l);for(let t=0;t<r.length;t+=1)r[t].m(n,null);H(n,t[20]),a&&y(o),o=[E(n,"change",t[156]),E(n,"change",t[81])]},p(t,e){if(402653184&e[1]){let l;for(s=t[59],l=0;l<s.length;l+=1){const o=ae(t,s,l);r[l]?r[l].p(o,e):(r[l]=cn(o),r[l].c(),r[l].m(n,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=s.length}1048576&e[0]&&H(n,t[20])},d(t){t&&w(e),D(r,t),y(o)}}}(t);return{c(){e=z("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),l=z("div"),l.innerHTML="Фильтры - <b>ДТП ГИБДД + Рубежи</b>",o=T(),s=z("div"),r=F("ID ДТП: "),i=z("input"),a=T(),p=z("div"),c=z("input"),d=z("label"),d.textContent="- с рубежами",u=T(),_=z("input"),h=z("label"),h.textContent="- без рубежей",v=T(),f=z("div"),g&&g.c(),$(e,"class","pLine svelte-1jsovbn"),$(l,"class","pLine svelte-1jsovbn"),$(i,"type","text"),i.value=t[13],$(i,"class","svelte-1jsovbn"),$(s,"class","pLine svelte-1jsovbn"),$(c,"type","checkbox"),$(c,"name","list_rubOn"),$(c,"class","svelte-1jsovbn"),$(d,"for","list_rubOn"),$(d,"class","svelte-1jsovbn"),$(_,"type","checkbox"),$(_,"name","list_rubOff"),$(_,"class","svelte-1jsovbn"),$(h,"for","list_rubOff"),$(h,"class","svelte-1jsovbn"),$(p,"class","pLine svelte-1jsovbn"),$(f,"class","filtersCont svelte-1jsovbn")},m(b,x,k){C(b,e,x),C(b,n,x),C(b,l,x),C(b,o,x),C(b,s,x),j(s,r),j(s,i),C(b,a,x),C(b,p,x),j(p,c),c.checked=t[27],j(p,d),j(p,u),j(p,_),_.checked=t[28],j(p,h),C(b,v,x),C(b,f,x),g&&g.m(f,null),k&&y(m),m=[E(i,"input",t[75]),E(c,"change",t[153]),E(c,"change",t[81]),E(_,"change",t[154]),E(_,"change",t[81])]},p(t,e){8192&e[0]&&i.value!==t[13]&&(i.value=t[13]),134217728&e[0]&&(c.checked=t[27]),268435456&e[0]&&(_.checked=t[28]),t[58].collision_type&&g.p(t,e)},d(t){t&&w(e),t&&w(n),t&&w(l),t&&w(o),t&&w(s),t&&w(a),t&&w(p),t&&w(v),t&&w(f),g&&g.d(),y(m)}}}function cn(t){let e,n,l,o,s,r,i,a,p=t[58].collision_type[t[159]]+"",c=t[159]+"";return{c(){e=z("option"),n=F("("),l=F(p),o=F(") - "),s=F(c),r=T(),e.__value=i=t[159],e.value=e.__value,$(e,"class",a="icon_type_"+t[58].iconType[t[159]]+" svelte-1jsovbn")},m(t,i){C(t,e,i),j(e,n),j(e,l),j(e,o),j(e,s),j(e,r)},p:f,d(t){t&&w(e)}}}function dn(t){let e,n,l,o,s,r,i,a,p,c,d,u;return{c(){e=z("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=T(),l=z("div"),l.innerHTML="Фильтры - <b>Рубежей</b>",o=T(),s=z("div"),r=z("div"),i=z("input"),a=z("label"),a.textContent="- есть комплексы",p=T(),c=z("input"),d=z("label"),d.textContent="-  нет комплексов",$(e,"class","pLine svelte-1jsovbn"),$(l,"class","pLine svelte-1jsovbn"),$(i,"type","checkbox"),$(i,"name","comp1"),$(i,"class","svelte-1jsovbn"),$(a,"for","comp1"),$(a,"class","svelte-1jsovbn"),$(c,"type","checkbox"),$(c,"name","comp"),$(c,"class","svelte-1jsovbn"),$(d,"for","comp"),$(d,"class","svelte-1jsovbn"),$(r,"class","pLine svelte-1jsovbn"),$(s,"class","filtersCont")},m(_,h,v){C(_,e,h),C(_,n,h),C(_,l,h),C(_,o,h),C(_,s,h),j(s,r),j(r,i),i.checked=t[25],j(r,a),j(r,p),j(r,c),c.checked=t[26],j(r,d),v&&y(u),u=[E(i,"change",t[157]),E(i,"change",t[73]),E(c,"change",t[158]),E(c,"change",t[73])]},p(t,e){33554432&e[0]&&(i.checked=t[25]),67108864&e[0]&&(c.checked=t[26])},d(t){t&&w(e),t&&w(n),t&&w(l),t&&w(o),t&&w(s),y(u)}}}function un(t){let e,n,l,o,s,r,i,a,p,c,d,u,_=t[0]._map&&t[0]._opt&&t[0]._opt.years&&Fe(t),h=t[1]._map&&t[1]._opt&&t[1]._opt.years&&Oe(t),v=t[2]._map&&t[2]._opt&&t[2]._opt.years&&$e(t),m=t[8]._map&&t[8]._opt&&t[8]._opt.years&&Ne(t),g=t[9]._map&&t[9]._opt&&t[9]._opt.years&&Ie(t),y=t[10]._map&&t[10]._opt&&t[10]._opt.years&&Ye(t);function b(t,e){return t[3]._map||t[4]._map||t[5]._map||t[6]._map?Xe:t[10]._map||t[8]._map||t[9]._map||t[0]._map||t[2]._map||t[1]._map||t[7]._map?void 0:Qe}let x=b(t),k=x&&x(t),L=t[3]._map&&tn(t),D=t[4]._map&&on(t),F=t[5]._map&&rn(t),O=t[6]._map&&pn(t),E=t[7]._map&&dn(t);return{c(){e=z("div"),_&&_.c(),n=T(),h&&h.c(),l=T(),v&&v.c(),o=T(),m&&m.c(),s=T(),g&&g.c(),r=T(),y&&y.c(),i=T(),k&&k.c(),a=T(),L&&L.c(),p=T(),D&&D.c(),c=T(),F&&F.c(),d=T(),O&&O.c(),u=T(),E&&E.c(),$(e,"class","mvsFilters")},m(t,f){C(t,e,f),_&&_.m(e,null),j(e,n),h&&h.m(e,null),j(e,l),v&&v.m(e,null),j(e,o),m&&m.m(e,null),j(e,s),g&&g.m(e,null),j(e,r),y&&y.m(e,null),j(e,i),k&&k.m(e,null),j(e,a),L&&L.m(e,null),j(e,p),D&&D.m(e,null),j(e,c),F&&F.m(e,null),j(e,d),O&&O.m(e,null),j(e,u),E&&E.m(e,null)},p(t,f){t[0]._map&&t[0]._opt&&t[0]._opt.years?_?_.p(t,f):(_=Fe(t),_.c(),_.m(e,n)):_&&(_.d(1),_=null),t[1]._map&&t[1]._opt&&t[1]._opt.years?h?h.p(t,f):(h=Oe(t),h.c(),h.m(e,l)):h&&(h.d(1),h=null),t[2]._map&&t[2]._opt&&t[2]._opt.years?v?v.p(t,f):(v=$e(t),v.c(),v.m(e,o)):v&&(v.d(1),v=null),t[8]._map&&t[8]._opt&&t[8]._opt.years?m?m.p(t,f):(m=Ne(t),m.c(),m.m(e,s)):m&&(m.d(1),m=null),t[9]._map&&t[9]._opt&&t[9]._opt.years?g?g.p(t,f):(g=Ie(t),g.c(),g.m(e,r)):g&&(g.d(1),g=null),t[10]._map&&t[10]._opt&&t[10]._opt.years?y?y.p(t,f):(y=Ye(t),y.c(),y.m(e,i)):y&&(y.d(1),y=null),x===(x=b(t))&&k?k.p(t,f):(k&&k.d(1),k=x&&x(t),k&&(k.c(),k.m(e,a))),t[3]._map?L?L.p(t,f):(L=tn(t),L.c(),L.m(e,p)):L&&(L.d(1),L=null),t[4]._map?D?D.p(t,f):(D=on(t),D.c(),D.m(e,c)):D&&(D.d(1),D=null),t[5]._map?F?F.p(t,f):(F=rn(t),F.c(),F.m(e,d)):F&&(F.d(1),F=null),t[6]._map?O?O.p(t,f):(O=pn(t),O.c(),O.m(e,u)):O&&(O.d(1),O=null),t[7]._map?E?E.p(t,f):(E=dn(t),E.c(),E.m(e,null)):E&&(E.d(1),E=null)},i:f,o:f,d(t){t&&w(e),_&&_.d(),h&&h.d(),v&&v.d(),m&&m.d(),g&&g.d(),y&&y.d(),k&&k.d(),L&&L.d(),D&&D.d(),F&&F.d(),O&&O.d(),E&&E.d()}}}function _n(t,e,n){let{DtpHearthsPicket:l}=e,{DtpHearths5:o}=e,{DtpHearths3:s}=e,{DtpHearthsStat:r}=e,{DtpHearthsTmp:i}=e,{DtpHearths:a}=e,{DtpVerifyed:p}=e,{DtpSkpdi:c}=e,{DtpGibdd:d}=e,{DtpGibddRub:u}=e,{Rub:_}=e,{control:h}=e;_||(_={}),u||(u={}),l||(l={}),o||(o={}),s||(s={});let v,f,m=0;const g=new Date,y=new Date(new Date(g.getFullYear(),g.getMonth(),g.getDate()).getTime()),b=g,x=new Date(2019,0,1);let k,j,C,w=h._id_dtp||null,D=h._dateInterval||[x.getTime()/1e3,b.getTime()/1e3],z=p._opt||{},F=z.collision_type?Object.keys(z.collision_type).sort((t,e)=>z.collision_type[e]-z.collision_type[t]):[],T=c._opt||{},O=T.collision_type?Object.keys(T.collision_type).sort((t,e)=>T.collision_type[e]-T.collision_type[t]):[],E=d._opt||{},M=E.collision_type?Object.keys(E.collision_type).sort((t,e)=>E.collision_type[e]-E.collision_type[t]):[],$=(u||{})._opt||{},P=$.collision_type?Object.keys($.collision_type).sort((t,e)=>$.collision_type[e]-$.collision_type[t]):[],N=(a||{})._opt||{},S=N.str_icon_type?Object.keys(N.str_icon_type).sort((t,e)=>N.str_icon_type[e]-N.str_icon_type[t]):[],H=(i||{})._opt||{},I=H.str_icon_type?Object.keys(H.str_icon_type).sort((t,e)=>H.str_icon_type[e]-H.str_icon_type[t]):[],G=(r||{})._opt||{},R=G.str_icon_type?Object.keys(G.str_icon_type).sort((t,e)=>G.str_icon_type[e]-G.str_icon_type[t]):[],Z=(s||{})._opt||{},Y=Z.str_icon_type?Object.keys(Z.str_icon_type).sort((t,e)=>Z.str_icon_type[e]-Z.str_icon_type[t]):[],W=(o||{})._opt||{},K=W.str_icon_type?Object.keys(W.str_icon_type).sort((t,e)=>W.str_icon_type[e]-W.str_icon_type[t]):[],J=(l||{})._opt||{},Q=J.road?Object.keys(J.road).sort((t,e)=>J.road[e]-J.road[t]):[],X=[""],tt={hearth3:!0,hearth5:!0},et=null,nt=[""],lt=[""],ot=[""],st=[""],rt={radius:19,blur:11.26,minOpacity:.34},it=rt.radius,at=11.26,pt=.34,ct=_&&_._argFilters?_._argFilters[0]:{type:"comp",zn:{on:!0,off:!0}},dt=ct.zn.on,ut=ct.zn.off;const _t=()=>{if(l._map){let t=[];w&&t.push({type:"id_dtp",zn:w}),et&&t.push({type:"id_hearth",zn:et}),X&&t.push({type:"roads",zn:X}),t.push({type:"ht",zn:tt}),l.setFilter(t)}},ht=()=>{_t(),Ft({}),Pt({}),le({}),Kt({}),Gt({}),xt(),bt(),yt(),vt()},vt=()=>{if(p._map){let t=[{type:"itemType",zn:m}];w&&t.push({type:"id_dtp",zn:w}),D&&(n(92,h._dateInterval=D,h),t.push({type:"date",zn:D})),nt&&t.push({type:"collision_type",zn:nt}),p.setFilter(t)}};let ft=u._argFilters&&u._argFilters.length?u._argFilters[0]:{type:"list_rub",zn:{on:!0,off:!0}},mt=ft.zn.on,gt=ft.zn.off;const yt=()=>{if(u._map){let t=[{type:"list_rub",zn:{on:mt,off:gt}}];w&&t.push({type:"id_dtp",zn:w}),D&&t.push({type:"date",zn:D}),st&&t.push({type:"collision_type",zn:st}),u.setFilter(t)}},bt=()=>{if(d._map){let t=[];w&&t.push({type:"id_dtp",zn:w}),D&&t.push({type:"date",zn:D}),ot&&t.push({type:"collision_type",zn:ot}),d.setFilter(t)}},xt=()=>{if(c._map){let t=[];w&&t.push({type:"id_dtp",zn:w}),D&&t.push({type:"date",zn:D}),lt&&t.push({type:"collision_type",zn:lt}),c.setFilter(t)}};var kt;kt=()=>{let t={onSelect(t){this._o.field.value=this.toString(),D[this._o._dint]=this.getDate().getTime()/1e3+24*this._o._dint*60*60,vt(),xt(),bt(),yt()},toString(t,e){let n=t.getDate();n<10&&(n="0"+n);let l=t.getMonth()+1;return l<10&&(l="0"+l),`${n}.${l}.${t.getFullYear()}`},parse(t,e){const n=t.split("."),l=parseInt(n[0],10),o=parseInt(n[1],10)-1,s=parseInt(n[2],10);return new Date(s,o,l)},i18n:{previousMonth:"Предыдущий месяц",nextMonth:"Следующий месяц",months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],weekdays:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],weekdaysShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"]},format:"DD.MM.YYYY",setDefaultDate:!0,yearRange:20,blurFieldOnSelect:!1};k=new Pikaday(L.extend({},t,{_dint:0,field:v,defaultDate:new Date(1e3*D[0])})),j=new Pikaday(L.extend({},t,{_dint:1,field:f,defaultDate:new Date(1e3*D[1])})),ht()},A().$$.on_mount.push(kt);let jt,Lt,Ct=[""],wt=1,Dt={},zt={};Object.keys(W.years||{}).sort().forEach(t=>{n(32,Dt[t]=!0,Dt),Object.keys(W.years[t]).sort().forEach(e=>{Lt={},Lt[t]={},Lt[t][e]=!0})}),zt=Lt||{};const Ft=t=>{if(o._map){let e=[],l=t.target||{},s=l.checked,r=l.id,i=l.name;if("hearths_period_type_52"===r)n(31,wt=2);else if("hearths_period_type_51"===r)n(31,wt=1);else if("hearths_year_5"===r)s?n(32,Dt[i]=!0,Dt):delete Dt[i];else if("hearths_quarter_5"===r){let t=i.split("_");s?(zt[t[0]]||(zt[t[0]]={}),zt[t[0]][t[1]]=!0):(zt[t[0]]&&delete zt[t[0]][t[1]],0===Object.keys(zt[t[0]]).length&&delete zt[t[0]])}1===wt?e.push({type:"year",zn:Dt}):2===wt&&e.push({type:"quarter",zn:zt}),jt&&e.push({type:"stricken",zn:Number(jt)}),Ct.length>0&&Ct[0]&&e.push({type:"str_icon_type",zn:Ct}),w&&e.push({type:"id_dtp",zn:w}),o.setFilter(e)}};let Tt,Ot,Et=[""],Mt=1,$t={},qt={};Object.keys(Z.years||{}).sort().forEach(t=>{n(36,$t[t]=!0,$t),Object.keys(Z.years[t]).sort().forEach(e=>{Ot={},Ot[t]={},Ot[t][e]=!0})}),qt=Ot||{};const Pt=t=>{if(s._map){let e=[],l=t.target||{},o=l.checked,r=l.id,i=l.name;if("hearths_period_type_32"===r)n(35,Mt=2);else if("hearths_period_type_31"===r)n(35,Mt=1);else if("hearths_year_3"===r)o?n(36,$t[i]=!0,$t):delete $t[i];else if("hearths_quarter_3"===r){let t=i.split("_");o?(qt[t[0]]||(qt[t[0]]={}),qt[t[0]][t[1]]=!0):(qt[t[0]]&&delete qt[t[0]][t[1]],0===Object.keys(qt[t[0]]).length&&delete qt[t[0]])}1===Mt?e.push({type:"year",zn:$t}):2===Mt&&e.push({type:"quarter",zn:qt}),Tt&&e.push({type:"stricken",zn:Number(Tt)}),Et.length>0&&Et[0]&&e.push({type:"str_icon_type",zn:Et}),w&&e.push({type:"id_dtp",zn:w}),s.setFilter(e)}};let Nt,St,Ht=[""],Bt=1,Ut={},It={};Object.keys(G.years||{}).sort().forEach(t=>{n(40,Ut[t]=!0,Ut),Object.keys(G.years[t]).sort().forEach(e=>{St={},St[t]={},St[t][e]=!0})}),It=St||{};const Gt=t=>{if(r._map){let e=[],l=t.target||{},o=l.checked,s=l.id,i=l.name;if("hearths_period_type_Stat2"===s)n(39,Bt=2);else if("hearths_period_type_Stat1"===s)n(39,Bt=1);else if("hearths_year_Stat"===s)o?n(40,Ut[i]=!0,Ut):delete Ut[i];else if("hearths_quarter_Stat"===s){let t=i.split("_");o?(It[t[0]]||n(41,It[t[0]]={},It),n(41,It[t[0]][t[1]]=!0,It)):(It[t[0]]&&delete It[t[0]][t[1]],0===Object.keys(It[t[0]]).length&&delete It[t[0]])}1===Bt?e.push({type:"year",zn:Ut}):2===Bt&&e.push({type:"quarter",zn:It}),Nt&&e.push({type:"stricken",zn:Number(Nt)}),Ht.length>0&&Ht[0]&&e.push({type:"str_icon_type",zn:Ht}),w&&e.push({type:"id_dtp",zn:w}),r.setFilter(e)}};let At,Rt,Zt=[""],Yt=1,Vt={},Wt={};Object.keys(H.years||{}).sort().forEach(t=>{n(45,Vt[t]=!0,Vt),Object.keys(H.years[t]).sort().forEach(e=>{Rt={},Rt[t]={},Rt[t][e]=!0})}),Wt=Rt||{};const Kt=t=>{if(i._map){let e=[],l=t.target||{},o=l.checked,s=l.id,r=l.name;if("hearths_period_type_tmp2"===s)n(44,Yt=2);else if("hearths_period_type_tmp1"===s)n(44,Yt=1);else if("hearths_year_tmp"===s)o?n(45,Vt[r]=!0,Vt):delete Vt[r];else if("hearths_quarter_tmp"===s){let t=r.split("_");o?(Wt[t[0]]||n(46,Wt[t[0]]={},Wt),n(46,Wt[t[0]][t[1]]=!0,Wt)):(Wt[t[0]]&&delete Wt[t[0]][t[1]],0===Object.keys(Wt[t[0]]).length&&delete Wt[t[0]])}1===Yt?e.push({type:"year",zn:Vt}):2===Yt&&e.push({type:"quarter",zn:Wt}),At&&e.push({type:"stricken",zn:Number(At)}),Zt.length>0&&Zt[0]&&e.push({type:"str_icon_type",zn:Zt}),w&&e.push({type:"id_dtp",zn:w}),i.setFilter(e)}};let Jt,Qt,Xt=[""],te=1,ee={},ne={};Object.keys(N.years||{}).sort().forEach(t=>{n(50,ee[t]=!0,ee),Object.keys(N.years[t]).sort().forEach(e=>{Qt={},Qt[t]={},Qt[t][e]=!0})}),ne=Qt||{};const le=t=>{if(a._map){let e=[],l=t.target||{},o=l.checked,s=l.id,r=l.name;if("hearths_period_type2"===s)n(49,te=2);else if("hearths_period_type1"===s)n(49,te=1);else if("hearths_year"===s)o?n(50,ee[r]=!0,ee):delete ee[r];else if("hearths_quarter"===s){let t=r.split("_");o?(ne[t[0]]||n(51,ne[t[0]]={},ne),n(51,ne[t[0]][t[1]]=!0,ne)):(ne[t[0]]&&delete ne[t[0]][t[1]],0===Object.keys(ne[t[0]]).length&&delete ne[t[0]])}1===te?e.push({type:"year",zn:ee}):2===te&&e.push({type:"quarter",zn:ne}),Jt&&e.push({type:"stricken",zn:Number(Jt)}),Xt.length>0&&Xt[0]&&e.push({type:"str_icon_type",zn:Xt}),w&&e.push({type:"id_dtp",zn:w}),a.setFilter(e)}};return t.$set=t=>{"DtpHearthsPicket"in t&&n(0,l=t.DtpHearthsPicket),"DtpHearths5"in t&&n(1,o=t.DtpHearths5),"DtpHearths3"in t&&n(2,s=t.DtpHearths3),"DtpHearthsStat"in t&&n(8,r=t.DtpHearthsStat),"DtpHearthsTmp"in t&&n(9,i=t.DtpHearthsTmp),"DtpHearths"in t&&n(10,a=t.DtpHearths),"DtpVerifyed"in t&&n(3,p=t.DtpVerifyed),"DtpSkpdi"in t&&n(4,c=t.DtpSkpdi),"DtpGibdd"in t&&n(5,d=t.DtpGibdd),"DtpGibddRub"in t&&n(6,u=t.DtpGibddRub),"Rub"in t&&n(7,_=t.Rub),"control"in t&&n(92,h=t.control)},[l,o,s,p,c,d,u,_,r,i,a,v,f,w,X,tt,et,nt,lt,ot,st,it,at,pt,C,dt,ut,mt,gt,jt,Ct,wt,Dt,Tt,Et,Mt,$t,Nt,Ht,Bt,Ut,It,At,Zt,Yt,Vt,Wt,Jt,Xt,te,ee,ne,z,F,T,O,E,M,$,P,N,S,H,I,G,R,Z,Y,W,K,J,Q,rt,t=>{let e=[{type:"comp",zn:{on:dt,off:ut}}];_.setFilter(e)},_t,t=>{let e=t.target.value;n(13,w=e||null),n(92,h._id_dtp=w,h),ht()},t=>{let e=t.target.value;n(16,et=e||null),_t()},t=>{let e=t.target;n(15,tt[e.name]=e.checked,tt),_t()},t=>{let e=t.target;n(6,u._needHeat=n(5,d._needHeat=n(4,c._needHeat=n(3,p._needHeat=!!e.checked&&rt,p),c),d),u),yt(),bt(),xt(),vt()},()=>{let t={radius:it,blur:at,minOpacity:pt};d._heat&&d._heat.setOptions(t),c._heat&&c._heat.setOptions(t),p._heat&&p._heat.setOptions(t)},vt,yt,bt,xt,t=>{let e=t.target;m=Number(e.value),vt()},()=>{let t=j.getDate(),e=k.getDate(),n=t-e;0===n&&(n=864e5),k.setDate(new Date(e.getTime()-n)),j.setDate(new Date(t.getTime()-n)),D=[k.getDate().getTime()/1e3,86400+j.getDate().getTime()/1e3],vt(),xt(),bt(),yt()},()=>{let t=j.getDate(),e=k.getDate(),n=t-e;0===n&&(n=864e5),k.setDate(new Date(e.getTime()+n)),j.setDate(new Date(t.getTime()+n)),D=[k.getDate().getTime()/1e3,86400+j.getDate().getTime()/1e3],vt(),xt(),bt(),yt()},Ft,Pt,Gt,Kt,le,h,m,D,k,j,zt,Lt,qt,Ot,St,Rt,Qt,g,y,b,x,void 0,void 0,void 0,void 0,ct,ht,ft,(t,e)=>t+=J.road[e],function(){X=U(this),n(14,X),n(71,Q)},function(){wt=this.__value,n(31,wt)},[[],[],[],[],[]],(t,e)=>t+=W.str_icon_type[e],function(){Ct=U(this),n(30,Ct),n(69,K)},function(){jt=B(this),n(29,jt)},function(){Mt=this.__value,n(35,Mt)},(t,e)=>t+=Z.str_icon_type[e],function(){Et=U(this),n(34,Et),n(67,Y)},function(){Tt=B(this),n(33,Tt)},function(){Bt=this.__value,n(39,Bt)},function(){Bt=this.__value,n(39,Bt)},(t,e)=>t+=G.str_icon_type[e],function(){Ht=U(this),n(38,Ht),n(65,R)},function(){Nt=B(this),n(37,Nt)},function(){Yt=this.__value,n(44,Yt)},function(){Yt=this.__value,n(44,Yt)},(t,e)=>t+=H.str_icon_type[e],function(){Zt=U(this),n(43,Zt),n(63,I)},function(){At=B(this),n(42,At)},function(){te=this.__value,n(49,te)},function(){te=this.__value,n(49,te)},(t,e)=>t+=N.str_icon_type[e],function(){Xt=U(this),n(48,Xt),n(61,S)},function(){Jt=B(this),n(47,Jt)},function(t){V[t?"unshift":"push"](()=>{n(11,v=t)})},function(t){V[t?"unshift":"push"](()=>{n(12,f=t)})},function(){pt=q(this.value),n(23,pt)},function(){it=q(this.value),n(21,it)},function(){at=q(this.value),n(22,at)},function(t){V[t?"unshift":"push"](()=>{n(24,C=t)})},(t,e)=>t+=z.collision_type[e],function(){nt=U(this),n(17,nt),n(53,F)},(t,e)=>t+=T.collision_type[e],function(){lt=U(this),n(18,lt),n(55,O)},(t,e)=>t+=E.collision_type[e],function(){ot=U(this),n(19,ot),n(57,M)},function(){mt=this.checked,n(27,mt)},function(){gt=this.checked,n(28,gt)},(t,e)=>t+=$.collision_type[e],function(){st=U(this),n(20,st),n(59,P)},function(){dt=this.checked,n(25,dt)},function(){ut=this.checked,n(26,ut)}]}ie._needHeat={radius:19,blur:11.26,minOpacity:.34},ie.checkZoom=t=>{Object.keys(ie._layers).length?t<12&&ie.setFilter(re):t>11&&ie.setFilter(re)},ie.setFilter=t=>{if(!ie._map)return;ie.clearLayers(),re=t||[];let e=[],n=[];ie._group&&ie._map&&(ie._group.getLayers().forEach(t=>{let l=t.options.props,o=0;re.forEach(t=>{"itemType"===t.type?(0===t.zn||1===t.zn&&l.id_stat&&l.id_skpdi||2===t.zn&&l.id_skpdi&&!l.id_stat||3===t.zn&&l.id_stat&&!l.id_skpdi)&&o++:"id_dtp"===t.type?l.id_skpdi!=t.zn&&l.id_stat!=t.zn||o++:"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===l.collision_type).length)&&o++:"date"===t.type&&l.date>=t.zn[0]&&l.date<t.zn[1]&&o++}),o===re.length&&(e.push(t),n.push(t._latlng))}),ie._needHeat?(ie._map.addLayer(ie._heat),ie._heat.setLatLngs(n),ie._heat.setOptions(ie._needHeat),ie._map._zoom>11&&ie.addLayer(oe.layerGroup(e))):(ie.addLayer(oe.layerGroup(e)),ie._map.removeLayer(ie._heat)))},ie.on("remove",()=>{ie._map.removeLayer(ie._heat),ie.clearLayers()}).on("add",t=>{re=[],ie._heat=oe.heatLayer([],{interactive:!1}),fetch("https://dtp.mvs.group/scripts/index_dev.php?request=get_collision",{}).then(t=>t.json()).then(t=>{let e={collision_type:{},iconType:{}},n=[],l=t.map(t=>{let l=t.iconType||0,o=[],s=!1,r="#2F4F4F";l&&(s=l%2==0,l>=1&&l<=6?r="#8B4513":7===l||8===l?r="#228B22":l>=9&&l<=14?r="#8B4513":15===l||16===l?r="#7B68EE":17!==l&&18!==l||(r="#2F4F4F")),t.id_skpdi&&o.push({type:"skpdi",id:t.id_skpdi}),t.id_stat&&o.push({type:"gibdd",id:t.id_stat}),t._cur=o,t.lat&&t.lon||(console.log("_______",t),t.lat=t.lon=0);let i=e.collision_type[t.collision_type];i?i++:i=1,e.collision_type[t.collision_type]=i,e.iconType[t.collision_type]=l;let a=oe.latLng(t.lat,t.lon,s?1:.5);return n.push(a),new v(a,{props:t,radius:6,triangle:o.length>1,box:!!t.id_skpdi,stroke:s,fillColor:r}).bindPopup(se).on("popupopen",t=>{!function(t){let e=oe.DomUtil.create("div");new le({target:e,props:{prp:t}}),se.setContent(e)}(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});ie.addLayer(ie._heat),ie._heat.setLatLngs(n),ie._heat.setOptions(ie._needHeat),ie._opt=e,ie._group=oe.layerGroup(l),re?ie.setFilter(re):ie.addLayer(ie._group),ie.checkZoom(ie._map._zoom),ie._refreshFilters()})});class hn extends vt{constructor(t){super(),ht(this,t,_n,un,x,{DtpHearthsPicket:0,DtpHearths5:1,DtpHearths3:2,DtpHearthsStat:8,DtpHearthsTmp:9,DtpHearths:10,DtpVerifyed:3,DtpSkpdi:4,DtpGibdd:5,DtpGibddRub:6,Rub:7,control:92},[-1,-1,-1,-1,-1,-1,-1])}}function vn(t,e,n){const l=t.slice();return l[7]=e[n],l[9]=n,l}function fn(t){let e,n,l,o,s,r,i,a,p,c,d,u=(t[0].piketaj_start_km||0)+"",_=(t[0].piketaj_finish_km||0)+"";return{c(){e=z("tr"),n=z("td"),n.textContent="Пикетаж:",l=T(),o=z("td"),s=F("От: "),r=z("b"),i=F(u),a=F(" км. до: "),p=z("b"),c=F(_),d=F(" км."),$(n,"class","first svelte-mnr9l0")},m(t,u){C(t,e,u),j(e,n),j(e,l),j(e,o),j(o,s),j(o,r),j(r,i),j(o,a),j(o,p),j(p,c),j(o,d)},p(t,e){1&e&&u!==(u=(t[0].piketaj_start_km||0)+"")&&P(i,u),1&e&&_!==(_=(t[0].piketaj_finish_km||0)+"")&&P(c,_)},d(t){t&&w(e)}}}function mn(t){let e,n;const l=new le({props:{prp:t[7],closeMe:t[6]}});return{c(){e=z("div"),ct(l.$$.fragment),$(e,"class","win leaflet-popup-content-wrapper  svelte-mnr9l0")},m(t,o){C(t,e,o),dt(l,e,null),n=!0},p(t,e){const n={};1&e&&(n.prp=t[7]),2&e&&(n.closeMe=t[6]),l.$set(n)},i(t){n||(at(l.$$.fragment,t),n=!0)},o(t){pt(l.$$.fragment,t),n=!1},d(t){t&&w(e),ut(l)}}}function gn(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,f,m,g,b,x,k,L,D,O,M,q,N,S,H,B=Math.floor(t[7].piketaj_m/1e3)+"",U=t[7].piketaj_m%1e3+"",I=new Date(1e3*t[7].date).toLocaleDateString()+"",G=t[7].lost+"",A=t[7].stricken+"",R=t[7].address+"";function Z(...e){return t[4](t[9],...e)}function Y(...e){return t[5](t[9],...e)}let V=t[1]===t[9]&&mn(t);return{c(){e=z("tr"),n=z("td"),l=z("ul"),o=z("li"),s=F("Пикетаж: "),r=F(B),i=F(" км. "),a=F(U),p=F(" м."),c=T(),d=z("li"),u=F(I),_=F(" погибших "),h=F(G),v=F(", раненых "),f=F(A),g=T(),b=z("tr"),x=z("td"),x.textContent="Адрес:",k=T(),L=z("td"),D=F(R),O=z("br"),M=z("span"),M.textContent="подробнее",q=T(),V&&V.c(),N=T(),$(o,"class","svelte-mnr9l0"),$(d,"title",m="id: "+t[7].id),$(d,"class","svelte-mnr9l0"),$(n,"class","first svelte-mnr9l0"),$(n,"colspan","2"),$(x,"class","first svelte-mnr9l0"),$(M,"class","link svelte-mnr9l0")},m(t,m,w){C(t,e,m),j(e,n),j(n,l),j(l,o),j(o,s),j(o,r),j(o,i),j(o,a),j(o,p),j(l,c),j(l,d),j(d,u),j(d,_),j(d,h),j(d,v),j(d,f),C(t,g,m),C(t,b,m),j(b,x),j(b,k),j(b,L),j(L,D),j(L,O),j(L,M),j(L,q),V&&V.m(L,null),j(b,N),S=!0,w&&y(H),H=[E(d,"click",Z),E(M,"click",Y)]},p(e,n){t=e,(!S||1&n)&&B!==(B=Math.floor(t[7].piketaj_m/1e3)+"")&&P(r,B),(!S||1&n)&&U!==(U=t[7].piketaj_m%1e3+"")&&P(a,U),(!S||1&n)&&I!==(I=new Date(1e3*t[7].date).toLocaleDateString()+"")&&P(u,I),(!S||1&n)&&G!==(G=t[7].lost+"")&&P(h,G),(!S||1&n)&&A!==(A=t[7].stricken+"")&&P(f,A),(!S||1&n&&m!==(m="id: "+t[7].id))&&$(d,"title",m),(!S||1&n)&&R!==(R=t[7].address+"")&&P(D,R),t[1]===t[9]?V?(V.p(t,n),at(V,1)):(V=mn(t),V.c(),at(V,1),V.m(L,null)):V&&(rt(),pt(V,1,1,()=>{V=null}),it())},i(t){S||(at(V),S=!0)},o(t){pt(V),S=!1},d(t){t&&w(e),t&&w(g),t&&w(b),V&&V.d(),y(H)}}}function yn(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,f,m,g,y,b,x,k,L,O,E,M,q,N,S,H,B,U,I,G,A,R,Z,Y,V,W,K,J=(t[0].id||t[0].id_hearth)+"",Q=t[0].quarter?t[0].quarter+" кв.":"",X=t[0].year+"",tt=(t[0].str_icon_type||"")+"",et=t[0].list_dtp.length+"",nt=t[0].count_lost+"",lt=t[0].count_stricken+"",ot=t[0].piketaj_start_km&&fn(t),st=t[0].list_dtp,ct=[];for(let e=0;e<st.length;e+=1)ct[e]=gn(vn(t,st,e));const dt=t=>pt(ct[t],1,1,()=>{ct[t]=null});return{c(){e=z("div"),n=z("div"),l=F("Очаг ДТП (id: "),o=F(J),s=F(")"),r=T(),i=z("div"),a=F(Q),p=T(),c=F(X),d=F("г."),u=T(),_=z("div"),h=z("table"),v=z("tbody"),ot&&ot.c(),f=T(),m=z("tr"),g=z("td"),g.textContent="Тип ДТП:",y=T(),b=z("td"),x=F(tt),k=T(),L=z("tr"),O=z("td"),O.textContent="Всего ДТП:",E=T(),M=z("td"),q=F(et),N=T(),S=z("tr"),H=z("td"),H.textContent="Погибших:",B=T(),U=z("td"),I=F(nt),G=T(),A=z("tr"),R=z("td"),R.textContent="Раненых:",Z=T(),Y=z("td"),V=F(lt),W=T();for(let t=0;t<ct.length;t+=1)ct[t].c();$(n,"class","pLine"),$(i,"class","pLine"),$(g,"class","first svelte-mnr9l0"),$(O,"class","first svelte-mnr9l0"),$(H,"class","first svelte-mnr9l0"),$(R,"class","first svelte-mnr9l0"),$(h,"class","table svelte-mnr9l0"),$(_,"class","featureCont"),$(e,"class","mvsPopup svelte-mnr9l0")},m(t,w){C(t,e,w),j(e,n),j(n,l),j(n,o),j(n,s),j(e,r),j(e,i),j(i,a),j(i,p),j(i,c),j(i,d),j(e,u),j(e,_),j(_,h),j(h,v),ot&&ot.m(v,null),j(v,f),j(v,m),j(m,g),j(m,y),j(m,b),j(b,x),j(v,k),j(v,L),j(L,O),j(L,E),j(L,M),j(M,q),j(v,N),j(v,S),j(S,H),j(S,B),j(S,U),j(U,I),j(v,G),j(v,A),j(A,R),j(A,Z),j(A,Y),j(Y,V),j(v,W);for(let t=0;t<ct.length;t+=1)ct[t].m(v,null);K=!0},p(t,[e]){if((!K||1&e)&&J!==(J=(t[0].id||t[0].id_hearth)+"")&&P(o,J),(!K||1&e)&&Q!==(Q=t[0].quarter?t[0].quarter+" кв.":"")&&P(a,Q),(!K||1&e)&&X!==(X=t[0].year+"")&&P(c,X),t[0].piketaj_start_km?ot?ot.p(t,e):(ot=fn(t),ot.c(),ot.m(v,f)):ot&&(ot.d(1),ot=null),(!K||1&e)&&tt!==(tt=(t[0].str_icon_type||"")+"")&&P(x,tt),(!K||1&e)&&et!==(et=t[0].list_dtp.length+"")&&P(q,et),(!K||1&e)&&nt!==(nt=t[0].count_lost+"")&&P(I,nt),(!K||1&e)&&lt!==(lt=t[0].count_stricken+"")&&P(V,lt),7&e){let n;for(st=t[0].list_dtp,n=0;n<st.length;n+=1){const l=vn(t,st,n);ct[n]?(ct[n].p(l,e),at(ct[n],1)):(ct[n]=gn(l),ct[n].c(),at(ct[n],1),ct[n].m(v,null))}for(rt(),n=st.length;n<ct.length;n+=1)dt(n);it()}},i(t){if(!K){for(let t=0;t<st.length;t+=1)at(ct[t]);K=!0}},o(t){ct=ct.filter(Boolean);for(let t=0;t<ct.length;t+=1)pt(ct[t]);K=!1},d(t){t&&w(e),ot&&ot.d(),D(ct,t)}}}function bn(t,e,n){let l,{prp:o}=e;const s=t=>{let e=o._bounds.options.items[t];e&&e._map&&e._map.panTo(e._latlng)};return t.$set=t=>{"prp"in t&&n(0,o=t.prp)},[o,l,s,t=>{console.log("showDtpInfo ",t)},t=>{s(t)},t=>{n(1,l=t)},()=>{n(1,l=null)}]}class xn extends vt{constructor(t){super(),ht(this,t,bn,yn,x,{prp:0})}}const kn=(t,e)=>{let n=t.count_lost,l=t.count_stricken;!l&&n&&(e.stricken[1]=1+(e.stricken[1]||0)),l&&!n&&(e.stricken[2]=1+(e.stricken[2]||0)),(l||n)&&(e.stricken[3]=1+(e.stricken[3]||0)),l&&n&&(e.stricken[4]=1+(e.stricken[4]||0))},jn=window.L,Ln=jn.popup(),Cn=jn.popup({minWidth:200});let wn;const Dn=function(t){let e=jn.DomUtil.create("div");return new le({target:e,props:{prp:t}}),Ln.setContent(e),e},zn=jn.featureGroup([]);zn.setFilter=t=>{zn.clearLayers(),wn=t;let e=[];zn._group&&zn._map&&(zn._group.getLayers().forEach(t=>{let n=t.options.cluster,l=n.list_dtp||[],o=0;wn.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("id_dtp"===t.type)l.filter(e=>e.id==t.zn||e.id_skpdi==t.zn||e.id_stat==t.zn).length&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&!n.count_stricken&&n.count_lost||2===e&&n.count_stricken&&!n.count_lost||3===e&&(n.count_stricken||n.count_lost)||4===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===wn.length&&e.push(t)}),zn.addLayer(jn.layerGroup(e)))},zn.on("remove",()=>{zn.clearLayers()}).on("add",t=>{wn=[];let e={str_icon_type:{},iconType:{},years:{},dtps:{},stricken:{0:0}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearths_dev/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{e.stricken[0]+=t.length,t.forEach(t=>{let l=t.icon_type||1,o=jn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(kn(t,e),s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c=e.str_icon_type[t.str_icon_type];c?c++:c=1,e.str_icon_type[t.str_icon_type]=c,e.iconType[t.str_icon_type]=l,l&&(r=l%2==0,1===l||2===l?i="#FFA500":3===l||4===l?i="#B8860B":5===l||6===l?i="#CD853F":7===l||8===l?i="#228B22":9===l||10===l?i="#FF8C00":11===l||12===l?i="#D2691E":13===l||14===l?i="#DEB887":15===l||16===l?i="#7B68EE":17!==l&&18!==l||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let l=n.coords||{lat:0,lon:0},s=jn.latLng(l.lat,l.lon),a=[];o.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new v(jn.latLng(l.lat,l.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(Ln).on("popupopen",t=>{Dn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=jn.rectangle(o,{items:d,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{jn.DomEvent.stopPropagation(e);let n,l=1e3,o=e.target,s=e.latlng;e.originalEvent.ctrlKey&&o.bringToBack(),o.options.items.forEach(t=>{let e=t._latlng.distanceTo(s);e<l&&(l=e,n=t)}),l<10?(Dn(n.options.props),Ln.setLatLng(n._latlng).openOn(zn._map)):(!function(t){let e=jn.DomUtil.create("div");new xn({target:e,props:{prp:t}}),Cn.setContent(e)}(t),Cn.setLatLng(s).openOn(zn._map))}),n.push(t._bounds),n=n.concat(d)}}),zn._opt=e,zn._group=jn.layerGroup(n),wn?zn.setFilter(wn):zn.addLayer(zn._group),zn._refreshFilters()})})});const Fn=window.L,Tn=Fn.popup(),On=Fn.popup({minWidth:200});let En;const Mn=function(t){let e=Fn.DomUtil.create("div");return new le({target:e,props:{prp:t}}),Tn.setContent(e),e},$n=Fn.featureGroup([]);$n.setFilter=t=>{$n.clearLayers(),En=t;let e=[];$n._group&&$n._map&&($n._group.getLayers().forEach(t=>{let n=t.options.cluster,l=n.list_dtp||[],o=0;En.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("id_dtp"===t.type)l.filter(e=>e.id==t.zn||e.id_skpdi==t.zn||e.id_stat==t.zn).length&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&!n.count_stricken&&n.count_lost||2===e&&n.count_stricken&&!n.count_lost||3===e&&(n.count_stricken||n.count_lost)||4===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===En.length&&e.push(t)}),$n.addLayer(Fn.layerGroup(e)))},$n.on("remove",()=>{$n.clearLayers()}).on("add",t=>{En=[];let e={str_icon_type:{},iconType:{},years:{},dtps:{},stricken:{0:0}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearthstmp_dev/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{e.stricken[0]+=t.length,t.forEach(t=>{let l=t.icon_type||1,o=Fn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(kn(t,e),s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c=e.str_icon_type[t.str_icon_type];c?c++:c=1,e.str_icon_type[t.str_icon_type]=c,e.iconType[t.str_icon_type]=l,l&&(r=l%2==0,1===l||2===l?i="#FFA500":3===l||4===l?i="#B8860B":5===l||6===l?i="#CD853F":7===l||8===l?i="#228B22":9===l||10===l?i="#FF8C00":11===l||12===l?i="#D2691E":13===l||14===l?i="#DEB887":15===l||16===l?i="#7B68EE":17!==l&&18!==l||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let l=n.coords||{lat:0,lon:0},s=Fn.latLng(l.lat,l.lon),a=[];o.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new v(Fn.latLng(l.lat,l.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(Tn).on("popupopen",t=>{Mn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=Fn.rectangle(o,{items:d,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{Fn.DomEvent.stopPropagation(e);let n,l=1e3,o=e.target,s=e.latlng;e.originalEvent.ctrlKey&&o.bringToBack(),o.options.items.forEach(t=>{let e=t._latlng.distanceTo(s);e<l&&(l=e,n=t)}),l<10?(Mn(n.options.props),Tn.setLatLng(n._latlng).openOn($n._map)):(!function(t){let e=Fn.DomUtil.create("div");new xn({target:e,props:{prp:t}}),On.setContent(e)}(t),On.setLatLng(s).openOn($n._map))}),n.push(t._bounds),n=n.concat(d)}}),$n._opt=e,$n._group=Fn.layerGroup(n),En?$n.setFilter(En):$n.addLayer($n._group),$n._refreshFilters()})})});const qn=window.L,Pn=qn.popup(),Nn=qn.popup({minWidth:200});let Sn;const Hn=function(t){let e=qn.DomUtil.create("div");return new le({target:e,props:{prp:t}}),Pn.setContent(e),e},Bn=qn.featureGroup([]);Bn.setFilter=t=>{Bn.clearLayers(),Sn=t;let e=[];Bn._group&&Bn._map&&(Bn._group.getLayers().forEach(t=>{let n=t.options.cluster,l=n.list_dtp||[],o=0;Sn.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("id_dtp"===t.type)l.filter(e=>e.id==t.zn||e.id_skpdi==t.zn||e.id_stat==t.zn).length&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&!n.count_stricken&&n.count_lost||2===e&&n.count_stricken&&!n.count_lost||3===e&&(n.count_stricken||n.count_lost)||4===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===Sn.length&&e.push(t)}),Bn.addLayer(qn.layerGroup(e)))},Bn.on("remove",()=>{Bn.clearLayers()}).on("add",t=>{Sn=[];let e={str_icon_type:{},iconType:{},years:{},dtps:{},stricken:{0:0}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearthsstat_dev/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{e.stricken[0]+=t.length,t.forEach(t=>{let l=t.icon_type||1,o=qn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(kn(t,e),s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c=e.str_icon_type[t.str_icon_type];c?c++:c=1,e.str_icon_type[t.str_icon_type]=c,e.iconType[t.str_icon_type]=l,l&&(r=l%2==0,1===l||2===l?i="#FFA500":3===l||4===l?i="#B8860B":5===l||6===l?i="#CD853F":7===l||8===l?i="#228B22":9===l||10===l?i="#FF8C00":11===l||12===l?i="#D2691E":13===l||14===l?i="#DEB887":15===l||16===l?i="#7B68EE":17!==l&&18!==l||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let l=n.coords||{lat:0,lon:0},s=qn.latLng(l.lat,l.lon),a=[];o.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new v(qn.latLng(l.lat,l.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(Pn).on("popupopen",t=>{Hn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=qn.rectangle(o,{items:d,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{qn.DomEvent.stopPropagation(e);let n,l=1e3,o=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&o.bringToBack(),o.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<l&&(l=e,n=t)}),l<10?(Hn(n.options.props),Pn.setLatLng(n._latlng).openOn(Bn._map)):(!function(t){let e=qn.DomUtil.create("div");new xn({target:e,props:{prp:t}}),Nn.setContent(e)}(t),Nn.setLatLng(s).openOn(Bn._map))}),n.push(t._bounds),n=n.concat(d)}}),Bn._opt=e,Bn._group=qn.layerGroup(n),Sn?Bn.setFilter(Sn):Bn.addLayer(Bn._group),Bn._refreshFilters()})})});const Un=window.L,In=Un.popup(),Gn=Un.popup({minWidth:200});let An;const Rn=function(t){let e=Un.DomUtil.create("div");return new le({target:e,props:{prp:t}}),In.setContent(e),e},Zn=Un.featureGroup([]);Zn.setFilter=t=>{Zn.clearLayers(),An=t;let e=[];Zn._group&&Zn._map&&(Zn._group.getLayers().forEach(t=>{let n=t.options.cluster,l=n.list_dtp||[],o=0;An.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("id_dtp"===t.type)l.filter(e=>e.id==t.zn||e.id_skpdi==t.zn||e.id_stat==t.zn).length&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&!n.count_stricken&&n.count_lost||2===e&&n.count_stricken&&!n.count_lost||3===e&&(n.count_stricken||n.count_lost)||4===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===An.length&&e.push(t)}),Zn.addLayer(Un.layerGroup(e)))},Zn.on("remove",()=>{Zn.clearLayers()}).on("add",t=>{An=[];let e={str_icon_type:{},iconType:{},years:{},dtps:{},stricken:{0:0}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearths3_dev/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{e.stricken[0]+=t.length,t.forEach(t=>{let l=t.icon_type||1,o=Un.latLngBounds(),s=t.list_dtp,r=!1,i=(kn(t,e),"#FF0000");if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c,d=e.str_icon_type[t.str_icon_type];d?d++:d=1,e.str_icon_type[t.str_icon_type]=d,e.iconType[t.str_icon_type]=l,l&&(r=l%2==0,1===l||2===l?i="#FFA500":3===l||4===l?i="#B8860B":5===l||6===l?i="#CD853F":7===l||8===l?i="#228B22":9===l||10===l?i="#FF8C00":11===l||12===l?i="#D2691E":13===l||14===l?i="#DEB887":15===l||16===l?i="#7B68EE":17!==l&&18!==l||(i="#2F4F4F"));let u=s.map(n=>{n.iconType;let l=n.coords||{lat:0,lon:0},s=Un.latLng(l.lat,l.lon),a=[];o.extend(s),n.id===t.head&&(c=n),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new v(Un.latLng(l.lat,l.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(In).on("popupopen",t=>{Rn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=c?Un.circle(Un.latLng(c.coords.lat,c.coords.lon),{radius:t.radius||500,items:u,cluster:t,color:i}):Un.rectangle(o,{items:u,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}),t._bounds.on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{Un.DomEvent.stopPropagation(e);let n,l=1e3,o=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&o.bringToBack(),o.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<l&&(l=e,n=t)}),l<10?(Rn(n.options.props),In.setLatLng(n._latlng).openOn(Zn._map)):(!function(t){let e=Un.DomUtil.create("div");new xn({target:e,props:{prp:t}}),Gn.setContent(e)}(t),Gn.setLatLng(s).openOn(Zn._map))}),n.push(t._bounds),n=n.concat(u)}}),Zn._opt=e,Zn._group=Un.layerGroup(n),An?Zn.setFilter(An):Zn.addLayer(Zn._group),Zn._refreshFilters()}),console.log("__DtpHearths3_____",t,Zn._opt)})});const Yn=window.L,Vn=Yn.popup(),Wn=Yn.popup({minWidth:200});let Kn;const Jn=function(t){let e=Yn.DomUtil.create("div");return new le({target:e,props:{prp:t}}),Vn.setContent(e),e},Qn=Yn.featureGroup([]);Qn.setFilter=t=>{Qn.clearLayers(),Kn=t;let e=[];Qn._group&&Qn._map&&(Qn._group.getLayers().forEach(t=>{let n=t.options.cluster,l=n.list_dtp||[],o=0;Kn.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("id_dtp"===t.type)l.filter(e=>e.id==t.zn||e.id_skpdi==t.zn||e.id_stat==t.zn).length&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&!n.count_stricken&&n.count_lost||2===e&&n.count_stricken&&!n.count_lost||3===e&&(n.count_stricken||n.count_lost)||4===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===Kn.length&&e.push(t)}),Qn.addLayer(Yn.layerGroup(e)))},Qn.on("remove",()=>{Qn.clearLayers()}).on("add",t=>{Kn=[];let e={str_icon_type:{},iconType:{},years:{},dtps:{},stricken:{0:0}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearths5_dev/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{e.stricken[0]+=t.length,t.forEach(t=>{let l=t.icon_type||1,o=Yn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(kn(t,e),s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c,d=e.str_icon_type[t.str_icon_type];d?d++:d=1,e.str_icon_type[t.str_icon_type]=d,e.iconType[t.str_icon_type]=l,l&&(r=l%2==0,1===l||2===l?i="#FFA500":3===l||4===l?i="#B8860B":5===l||6===l?i="#CD853F":7===l||8===l?i="#228B22":9===l||10===l?i="#FF8C00":11===l||12===l?i="#D2691E":13===l||14===l?i="#DEB887":15===l||16===l?i="#7B68EE":17!==l&&18!==l||(i="#2F4F4F"));let u=s.map(n=>{n.iconType;let l=n.coords||{lat:0,lon:0},s=Yn.latLng(l.lat,l.lon),a=[];o.extend(s),n.id===t.head&&(c=n),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new v(Yn.latLng(l.lat,l.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(Vn).on("popupopen",t=>{Jn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=c?Yn.circle(Yn.latLng(c.coords.lat,c.coords.lon),{radius:t.radius||500,items:u,cluster:t,color:i}):Yn.rectangle(o,{items:u,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}),t._bounds.on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{Yn.DomEvent.stopPropagation(e);let n,l=1e3,o=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&o.bringToBack(),o.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<l&&(l=e,n=t)}),l<10?(Jn(n.options.props),Vn.setLatLng(n._latlng).openOn(Qn._map)):(!function(t){let e=Yn.DomUtil.create("div");new xn({target:e,props:{prp:t}}),Wn.setContent(e)}(t),Wn.setLatLng(s).openOn(Qn._map))}),n.push(t._bounds),n=n.concat(u)}}),Qn._opt=e,Qn._group=Yn.layerGroup(n),Kn?Qn.setFilter(Kn):Qn.addLayer(Qn._group),Qn._refreshFilters()})})});const Xn=window.L,tl=Xn.popup(),el=Xn.popup({minWidth:200});let nl;const ll=function(t){let e=Xn.DomUtil.create("div");return new le({target:e,props:{prp:t}}),tl.setContent(e),e},ol=Xn.featureGroup([]);function sl(t,e,n){const l=t.slice();return l[4]=e[n],l[6]=n,l}function rl(t,e,n){const l=t.slice();return l[4]=e[n],l[6]=n,l}function il(t){let e,n,l,o,s=t[4].complexName+"";return{c(){e=z("button"),n=F(s),$(e,"class",l="tab "+t[6]+" "+(0===t[6]?"active":"")+" svelte-h8luxq")},m(l,s,r){C(l,e,s),j(e,n),r&&o(),o=E(e,"click",t[2])},p:f,d(t){t&&w(e),o()}}}function al(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,f,m,g,y,b,x,k,L,D,O,E,M,q,N,S,H,B,U,I,G,A=t[4].complexName+"",R=t[4].complexSid+"",Z=t[4].complexModelName+"",Y=t[4].complexTypeName+"",V=t[4].complexStageName+"",W=(t[4].kvfStatus||"")+"",K=(t[4].roadName||t[0].roadName||"")+"";return{c(){e=z("table"),n=z("tr"),l=z("td"),l.textContent="Комплекс:",o=z("td"),s=F(A),r=F(" (id: "),i=F(R),a=F(")"),p=T(),c=z("tr"),d=z("td"),d.textContent="Модель:",u=z("td"),_=F(Z),h=T(),v=z("tr"),f=z("td"),f.textContent="Тип:",m=z("td"),g=F(Y),y=T(),b=z("tr"),x=z("td"),x.textContent="Этап:",k=z("td"),L=F(V),D=T(),O=z("tr"),E=z("td"),E.textContent="Работоспособность:",M=z("td"),q=F(W),N=T(),S=z("tr"),H=z("td"),H.textContent="Дорога:",B=z("td"),U=F(K),I=T(),$(l,"class","first svelte-h8luxq"),$(d,"class","first svelte-h8luxq"),$(f,"class","first svelte-h8luxq"),$(x,"class","first svelte-h8luxq"),$(E,"class","first svelte-h8luxq"),$(H,"class","first svelte-h8luxq"),$(e,"class",G="tabCont "+t[6]+" "+(0===t[6]?"":"hidden")+" svelte-h8luxq")},m(t,w){C(t,e,w),j(e,n),j(n,l),j(n,o),j(o,s),j(o,r),j(o,i),j(o,a),j(e,p),j(e,c),j(c,d),j(c,u),j(u,_),j(e,h),j(e,v),j(v,f),j(v,m),j(m,g),j(e,y),j(e,b),j(b,x),j(b,k),j(k,L),j(e,D),j(e,O),j(O,E),j(O,M),j(M,q),j(e,N),j(e,S),j(S,H),j(S,B),j(B,U),j(e,I)},p(t,e){1&e&&K!==(K=(t[4].roadName||t[0].roadName||"")+"")&&P(U,K)},d(t){t&&w(e)}}}function pl(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,m,g,y,b,x,k,L,O,M,q,N,S,H,B,U,I,G,A,R,Z,Y,V,W,K,J,Q=(t[0].id||t[0].lineSid)+"",X=(t[0].roadName||"")+"",tt=t[0].lat+"",et=t[0].lon+"",nt=(t[0].lineAddress||"")+"",lt=t[3],ot=[];for(let e=0;e<lt.length;e+=1)ot[e]=il(rl(t,lt,e));let st=t[3],rt=[];for(let e=0;e<st.length;e+=1)rt[e]=al(sl(t,st,e));return{c(){e=z("div"),n=z("div"),l=F("Рубеж (id: "),o=F(Q),s=F(")"),r=T(),i=z("div"),a=z("table"),p=z("tbody"),c=z("tr"),d=z("td"),d.textContent="Дорога:",u=T(),_=z("td"),h=F(X),v=T(),m=z("tr"),g=z("td"),g.textContent="Координаты:",y=T(),b=z("td"),x=F(tt),k=T(),L=F(et),O=T(),M=z("span"),q=T(),N=z("tr"),S=z("td"),S.textContent="Адрес:",H=T(),B=z("td"),U=F(nt),I=T(),G=z("tr"),A=z("td"),A.textContent="Комплексов:",R=T(),Z=z("td"),Z.textContent=`${t[3].length}`,Y=T(),V=z("tr"),W=z("td");for(let t=0;t<ot.length;t+=1)ot[t].c();K=T();for(let t=0;t<rt.length;t+=1)rt[t].c();$(n,"class","pLine"),$(d,"class","first svelte-h8luxq"),$(g,"class","first svelte-h8luxq"),$(M,"title","Скопировать в буфер обмена"),$(M,"class","leaflet-gmx-icon-copy"),$(S,"class","first svelte-h8luxq"),$(A,"class","first svelte-h8luxq"),$(W,"class","tabs svelte-h8luxq"),$(W,"colspan","2"),$(a,"class","table svelte-h8luxq"),$(i,"class","featureCont"),$(e,"class","mvsPopup svelte-h8luxq")},m(f,w,D){C(f,e,w),j(e,n),j(n,l),j(n,o),j(n,s),j(e,r),j(e,i),j(i,a),j(a,p),j(p,c),j(c,d),j(c,u),j(c,_),j(_,h),j(p,v),j(p,m),j(m,g),j(m,y),j(m,b),j(b,x),j(b,k),j(b,L),j(b,O),j(b,M),j(p,q),j(p,N),j(N,S),j(N,H),j(N,B),j(B,U),j(p,I),j(p,G),j(G,A),j(G,R),j(G,Z),j(p,Y),j(p,V),j(V,W);for(let t=0;t<ot.length;t+=1)ot[t].m(W,null);j(W,K);for(let t=0;t<rt.length;t+=1)rt[t].m(W,null);D&&J(),J=E(M,"click",t[1])},p(t,[e]){if(1&e&&Q!==(Q=(t[0].id||t[0].lineSid)+"")&&P(o,Q),1&e&&X!==(X=(t[0].roadName||"")+"")&&P(h,X),1&e&&tt!==(tt=t[0].lat+"")&&P(x,tt),1&e&&et!==(et=t[0].lon+"")&&P(L,et),1&e&&nt!==(nt=(t[0].lineAddress||"")+"")&&P(U,nt),12&e){let n;for(lt=t[3],n=0;n<lt.length;n+=1){const l=rl(t,lt,n);ot[n]?ot[n].p(l,e):(ot[n]=il(l),ot[n].c(),ot[n].m(W,K))}for(;n<ot.length;n+=1)ot[n].d(1);ot.length=lt.length}if(9&e){let n;for(st=t[3],n=0;n<st.length;n+=1){const l=sl(t,st,n);rt[n]?rt[n].p(l,e):(rt[n]=al(l),rt[n].c(),rt[n].m(W,null))}for(;n<rt.length;n+=1)rt[n].d(1);rt.length=st.length}},i:f,o:f,d(t){t&&w(e),D(ot,t),D(rt,t),J()}}}function cl(t,e,n){let{prp:l}=e;let o=l&&l.complexes?l.complexes:[];return console.log("complexes ",o),t.$set=t=>{"prp"in t&&n(0,l=t.prp)},[l,t=>{navigator.clipboard.writeText(t.target.parentNode.textContent).catch(t=>{console.log("Something went wrong",t)})},t=>{let e=t.target,n=/tab (\d)/.exec(e.className),l=n&&2===n.length?n[1]:0,o=e.parentNode;for(let t=0,e=o.childNodes.length;t<e;t++){let e=o.childNodes[t];if(e.classList){let t=e.classList.contains(l);"BUTTON"===e.tagName?e.classList[t?"add":"remove"]("active"):"TABLE"===e.tagName&&e.classList[t?"remove":"add"]("hidden")}}},o]}ol.setFilter=t=>{if(!ol._map)return;ol.clearLayers(),nl=t;let e=[];ol._group&&(ol._group.getLayers().forEach(t=>{let n=t.options.cluster,l=0;nl.forEach(t=>{if("ht"===t.type)t.zn[n.ht]&&l++;else if("roads"===t.type)(t.zn.filter(t=>t===n.road).length||1===t.zn.length&&""===t.zn[0])&&l++;else if("id_dtp"===t.type)!n.list_dtp.filter(e=>e.id==t.zn).length&&t.zn.length||l++;else if("id_hearth"===t.type)t.zn==n.id_hearth&&l++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&!n.count_stricken&&n.count_lost||2===e&&n.count_stricken&&!n.count_lost||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&l++:l++}}),l===nl.length&&e.push(t)}),ol.addLayer(Xn.layerGroup(e)))},ol.on("remove",()=>{ol.clearLayers()}).on("add",t=>{let e={road:{},str_icon_type:{},iconType:{},years:{},dtps:{}},n=[],l=(t,l)=>{let o=t.icon_type||1,s=Xn.latLngBounds(),r=[],i=t.list_dtp,a=!1,p="#FF0000";if(t.ht=l,i.length){Number(t.year),Number(t.quarter);let l=e.years[t.year];l||(l=e.years[t.year]={}),e.years[t.year]=l;let c=l[t.quarter];t.quarter in l?c++:c=l[t.quarter]=1,l[t.quarter]=c;let d,u=e.str_icon_type[t.str_icon_type];u?u++:u=1,e.str_icon_type[t.str_icon_type]=u,e.iconType[t.str_icon_type]=o,t.road in e.road?e.road[t.road]++:e.road[t.road]=1,o&&(a=o%2==0,1===o||2===o?p="#FFA500":3===o||4===o?p="#B8860B":5===o||6===o?p="#CD853F":7===o||8===o?p="#228B22":9===o||10===o?p="#FF8C00":11===o||12===o?p="#D2691E":13===o||14===o?p="#DEB887":15===o||16===o?p="#7B68EE":17!==o&&18!==o||(p="#2F4F4F"));let _=i.map(n=>{n.iconType;let l=n.coords||{lat:0,lon:0},o=Xn.latLng(l.lat,l.lon),i=[];s.extend(o),r.push(o),n.id===t.head&&(d=n),n.id_skpdi&&i.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&i.push({type:"gibdd",id:n.id_stat}),n._cur=i;let c=e.dtps[n.id]||{},u=t.id||t.id_hearth;return c?c[u]?c[u]++:c[u]=1:(c={},c[u]=1),e.dtps[n.id]=c,new v(Xn.latLng(l.lat,l.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:a,fillColor:p}).bindPopup(tl).on("popupopen",t=>{ll(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});d?t._bounds=Xn.circle(Xn.latLng(d.coords.lat,d.coords.lon),{radius:t.radius||500,items:_,cluster:t,color:p}):r.length?t._bounds=Xn.polyline(r,{items:_,cluster:t,color:p,weight:4}):t._bounds=Xn.rectangle(s,{items:_,cluster:t,fill:!0,color:p,dashArray:"8 3 1"}),t._bounds.on("mouseover",t=>{let e=t.target;e._weight=e.options.weight,e._color=e.options.color,e.options.weight=8,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.weight=e._weight,e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{Xn.DomEvent.stopPropagation(e);let n,l=1e3,o=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&o.bringToBack(),o.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<l&&(l=e,n=t)}),l<10?(ll(n.options.props),tl.setLatLng(n._latlng).openOn(ol._map)):(!function(t){let e=Xn.DomUtil.create("div");new xn({target:e,props:{prp:t}}),el.setContent(e)}(t),el.setLatLng(s).openOn(ol._map))}),n.push(t._bounds),n=n.concat(_)}};Promise.all([2019].map(t=>fetch("https://dtp.mvs.group/scripts/hearths_picket_dev/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{(t.hearth3||[]).forEach(t=>{l(t,"hearth3")}),(t.hearth5||[]).forEach(t=>{l(t,"hearth5")})}),ol._opt=e,ol._group=Xn.layerGroup(n),nl?ol.setFilter(nl):ol.addLayer(ol._group),ol._refreshFilters()}),console.log("__allJson_____",t,ol._opt)})});class dl extends vt{constructor(t){super(),ht(this,t,cl,pl,x,{prp:0})}}const ul=window.L,_l=ul.popup();ul.popup({minWidth:200});let hl;const vl=ul.featureGroup([]);function fl(t,e,n){const l=t.slice();return l[4]=e[n],l[6]=n,l}function ml(t,e,n){const l=t.slice();return l[4]=e[n],l[6]=n,l}function gl(t){let e,n,l,o,s=t[4].complex_name+"";return{c(){e=z("button"),n=F(s),$(e,"class",l="tab "+t[6]+" "+(0===t[6]?"active":"")+" svelte-h8luxq")},m(l,s,r){C(l,e,s),j(e,n),r&&o(),o=E(e,"click",t[2])},p:f,d(t){t&&w(e),o()}}}function yl(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,m,g,y,b,x,k,L,D,O,E,M=t[4].complex_name+"",q=t[4].complex_sid+"",P=t[4].complex_model_name+"",N=t[4].complex_type_name+"",S=(t[4].cafap_status||"")+"";return{c(){e=z("table"),n=z("tr"),l=z("td"),l.textContent="Комплекс:",o=z("td"),s=F(M),r=F(" (id: "),i=F(q),a=F(")"),p=T(),c=z("tr"),d=z("td"),d.textContent="Модель:",u=z("td"),_=F(P),h=T(),v=z("tr"),m=z("td"),m.textContent="Тип:",g=z("td"),y=F(N),b=T(),x=z("tr"),k=z("td"),k.textContent="Работоспособность:",L=z("td"),D=F(S),O=T(),$(l,"class","first svelte-h8luxq"),$(d,"class","first svelte-h8luxq"),$(m,"class","first svelte-h8luxq"),$(k,"class","first svelte-h8luxq"),$(e,"class",E="tabCont "+t[6]+" "+(0===t[6]?"":"hidden")+" svelte-h8luxq")},m(t,f){C(t,e,f),j(e,n),j(n,l),j(n,o),j(o,s),j(o,r),j(o,i),j(o,a),j(e,p),j(e,c),j(c,d),j(c,u),j(u,_),j(e,h),j(e,v),j(v,m),j(v,g),j(g,y),j(e,b),j(e,x),j(x,k),j(x,L),j(L,D),j(e,O)},p:f,d(t){t&&w(e)}}}function bl(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,m,g,y,b,x,k,L,O,M,q,N,S,H,B,U,I,G,A,R,Z,Y,V,W,K,J,Q,X,tt,et,nt,lt,ot=(t[0].id||t[0].line_id)+"",st=(t[0].stage_name||"")+"",rt=(t[0].road_name||"")+"",it=t[0].lat+"",at=t[0].lon+"",pt=(t[0].address||"")+"",ct=t[3],dt=[];for(let e=0;e<ct.length;e+=1)dt[e]=gl(ml(t,ct,e));let ut=t[3],_t=[];for(let e=0;e<ut.length;e+=1)_t[e]=yl(fl(t,ut,e));return{c(){e=z("div"),n=z("div"),l=F("Рубеж (id: "),o=F(ot),s=F(")"),r=T(),i=z("div"),a=z("table"),p=z("tbody"),c=z("tr"),d=z("td"),d.textContent="Этап:",u=T(),_=z("td"),h=F(st),v=T(),m=z("tr"),g=z("td"),g.textContent="Дорога:",y=T(),b=z("td"),x=F(rt),k=T(),L=z("tr"),O=z("td"),O.textContent="Координаты:",M=T(),q=z("td"),N=F(it),S=T(),H=F(at),B=T(),U=z("span"),I=T(),G=z("tr"),A=z("td"),A.textContent="Адрес:",R=T(),Z=z("td"),Y=F(pt),V=T(),W=z("tr"),K=z("td"),K.textContent="Комплексов:",J=T(),Q=z("td"),Q.textContent=`${t[3].length}`,X=T(),tt=z("tr"),et=z("td");for(let t=0;t<dt.length;t+=1)dt[t].c();nt=T();for(let t=0;t<_t.length;t+=1)_t[t].c();$(n,"class","pLine"),$(d,"class","first svelte-h8luxq"),$(g,"class","first svelte-h8luxq"),$(O,"class","first svelte-h8luxq"),$(U,"title","Скопировать в буфер обмена"),$(U,"class","leaflet-gmx-icon-copy"),$(A,"class","first svelte-h8luxq"),$(K,"class","first svelte-h8luxq"),$(et,"class","tabs svelte-h8luxq"),$(et,"colspan","2"),$(a,"class","table svelte-h8luxq"),$(i,"class","featureCont"),$(e,"class","mvsPopup svelte-h8luxq")},m(f,w,D){C(f,e,w),j(e,n),j(n,l),j(n,o),j(n,s),j(e,r),j(e,i),j(i,a),j(a,p),j(p,c),j(c,d),j(c,u),j(c,_),j(_,h),j(p,v),j(p,m),j(m,g),j(m,y),j(m,b),j(b,x),j(p,k),j(p,L),j(L,O),j(L,M),j(L,q),j(q,N),j(q,S),j(q,H),j(q,B),j(q,U),j(p,I),j(p,G),j(G,A),j(G,R),j(G,Z),j(Z,Y),j(p,V),j(p,W),j(W,K),j(W,J),j(W,Q),j(p,X),j(p,tt),j(tt,et);for(let t=0;t<dt.length;t+=1)dt[t].m(et,null);j(et,nt);for(let t=0;t<_t.length;t+=1)_t[t].m(et,null);D&&lt(),lt=E(U,"click",t[1])},p(t,[e]){if(1&e&&ot!==(ot=(t[0].id||t[0].line_id)+"")&&P(o,ot),1&e&&st!==(st=(t[0].stage_name||"")+"")&&P(h,st),1&e&&rt!==(rt=(t[0].road_name||"")+"")&&P(x,rt),1&e&&it!==(it=t[0].lat+"")&&P(N,it),1&e&&at!==(at=t[0].lon+"")&&P(H,at),1&e&&pt!==(pt=(t[0].address||"")+"")&&P(Y,pt),12&e){let n;for(ct=t[3],n=0;n<ct.length;n+=1){const l=ml(t,ct,n);dt[n]?dt[n].p(l,e):(dt[n]=gl(l),dt[n].c(),dt[n].m(et,nt))}for(;n<dt.length;n+=1)dt[n].d(1);dt.length=ct.length}if(8&e){let n;for(ut=t[3],n=0;n<ut.length;n+=1){const l=fl(t,ut,n);_t[n]?_t[n].p(l,e):(_t[n]=yl(l),_t[n].c(),_t[n].m(et,null))}for(;n<_t.length;n+=1)_t[n].d(1);_t.length=ut.length}},i:f,o:f,d(t){t&&w(e),D(dt,t),D(_t,t),lt()}}}function xl(t,e,n){let{prp:l}=e;let o=l&&l.list_complex?l.list_complex:[];return console.log("complexes ",o),t.$set=t=>{"prp"in t&&n(0,l=t.prp)},[l,t=>{navigator.clipboard.writeText(t.target.parentNode.textContent).catch(t=>{console.log("Something went wrong",t)})},t=>{let e=t.target,n=/tab (\d)/.exec(e.className),l=n&&2===n.length?n[1]:0,o=e.parentNode;for(let t=0,e=o.childNodes.length;t<e;t++){let e=o.childNodes[t];if(e.classList){let t=e.classList.contains(l);"BUTTON"===e.tagName?e.classList[t?"add":"remove"]("active"):"TABLE"===e.tagName&&e.classList[t?"remove":"add"]("hidden")}}},o]}vl.setFilter=t=>{if(!vl._map)return;vl.clearLayers(),hl=t;let e=[];vl._group&&(vl._group.getLayers().forEach(t=>{let n=t.options.cluster,l=0;hl.forEach(t=>{if("ht"===t.type)t.zn[n.ht]&&l++;else if("roads"===t.type)(t.zn.filter(t=>t===n.road).length||1===t.zn.length&&""===t.zn[0])&&l++;else if("id_dtp"===t.type)!n.list_dtp.filter(e=>e.id==t.zn).length&&t.zn.length||l++;else if("id_hearth"===t.type)t.zn==n.id_hearth&&l++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&!n.count_stricken&&n.count_lost||2===e&&n.count_stricken&&!n.count_lost||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&l++:l++}}),l===hl.length&&e.push(t)}),vl.addLayer(ul.layerGroup(e)))},vl.on("remove",()=>{vl.clearLayers()}).on("add",t=>{let e=t=>{let e=ul.latLngBounds(),n="#FF0000";t.complexes&&(1===t.complexes.length?n="#FFA500":t.complexes.length>1&&(n="#0000FF"));let l=t.coords||{lat:t.lat,lon:t.lon},o=ul.latLng(l.lat,l.lon);return e.extend(o),new v(ul.latLng(l.lat,l.lon),{props:t,radius:6,zIndexOffset:5e4,stroke:!1,fillColor:n}).bindPopup(_l).on("popupopen",t=>{!function(t){let e=ul.DomUtil.create("div");new dl({target:e,props:{prp:t}}),_l.setContent(e)}(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})};fetch("./static/rub.geojson",{}).then(t=>t.json()).then(t=>{let n=t.map(e);vl._group=ul.layerGroup(n),vl.addLayer(vl._group)})});class kl extends vt{constructor(t){super(),ht(this,t,xl,bl,x,{prp:0})}}const jl=window.L,Ll=jl.popup();jl.popup({minWidth:200});let Cl,wl="https://dtp.mvs.group/scripts/rubez_dev/";const Dl=jl.featureGroup([]);function zl(t,e,n){const l=t.slice();return l[9]=e[n],l[11]=n,l}function Fl(t,e,n){const l=t.slice();return l[14]=e[n],l}function Tl(t,e,n){const l=t.slice();return l[9]=e[n],l}function Ol(t){let e,n,l,o=t[14].k_uch&&(t[14].npdd||t[14].sop_npdd)&&function(t){let e,n,l=t[14].k_uch+"";return{c(){e=z("li"),n=F(l)},m(t,l){C(t,e,l),j(e,n)},p:f,d(t){t&&w(e)}}}(t),s=t[14].npdd&&function(t){let e,n,l=t[14].npdd+"";return{c(){e=z("li"),n=F(l)},m(t,l){C(t,e,l),j(e,n)},p:f,d(t){t&&w(e)}}}(t),r=t[14].sop_npdd&&function(t){let e,n,l=t[14].sop_npdd+"";return{c(){e=z("li"),n=F(l)},m(t,l){C(t,e,l),j(e,n)},p:f,d(t){t&&w(e)}}}(t);return{c(){o&&o.c(),e=T(),s&&s.c(),n=T(),r&&r.c(),l=O()},m(t,i){o&&o.m(t,i),C(t,e,i),s&&s.m(t,i),C(t,n,i),r&&r.m(t,i),C(t,l,i)},p(t,e){t[14].k_uch&&(t[14].npdd||t[14].sop_npdd)&&o.p(t,e),t[14].npdd&&s.p(t,e),t[14].sop_npdd&&r.p(t,e)},d(t){o&&o.d(t),t&&w(e),s&&s.d(t),t&&w(n),r&&r.d(t),t&&w(l)}}}function El(t){let e,n,l=t[9].ts&&function(t){let e,n,l=t[9].ts+"";return{c(){e=z("li"),n=F(l)},m(t,l){C(t,e,l),j(e,n)},p:f,d(t){t&&w(e)}}}(t),o=t[9].arr,s=[];for(let e=0;e<o.length;e+=1)s[e]=Ol(Fl(t,o,e));return{c(){l&&l.c(),e=T();for(let t=0;t<s.length;t+=1)s[t].c();n=O()},m(t,o){l&&l.m(t,o),C(t,e,o);for(let e=0;e<s.length;e+=1)s[e].m(t,o);C(t,n,o)},p(t,e){if(t[9].ts&&l.p(t,e),16&e){let l;for(o=t[9].arr,l=0;l<o.length;l+=1){const r=Fl(t,o,l);s[l]?s[l].p(r,e):(s[l]=Ol(r),s[l].c(),s[l].m(n.parentNode,n))}for(;l<s.length;l+=1)s[l].d(1);s.length=o.length}},d(t){l&&l.d(t),t&&w(e),D(s,t),t&&w(n)}}}function Ml(t){let e,n,l,o,s,r=t[0].spog+"";return{c(){e=z("div"),n=z("div"),n.textContent="Погода:",l=T(),o=z("div"),s=F(r),$(n,"class","stitle"),$(o,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,l),j(e,o),j(o,s)},p(t,e){1&e&&r!==(r=t[0].spog+"")&&P(s,r)},d(t){t&&w(e)}}}function $l(t){let e,n,l,o,s,r=t[0].s_pch+"";return{c(){e=z("div"),n=z("div"),n.textContent="Покрытие:",l=T(),o=z("div"),s=F(r),$(n,"class","stitle"),$(o,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,l),j(e,o),j(o,s)},p(t,e){1&e&&r!==(r=t[0].s_pch+"")&&P(s,r)},d(t){t&&w(e)}}}function ql(t){let e,n,l,o,s,r=t[0].osv+"";return{c(){e=z("div"),n=z("div"),n.textContent="Освещенность:",l=T(),o=z("div"),s=F(r),$(n,"class","stitle"),$(o,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,l),j(e,o),j(o,s)},p(t,e){1&e&&r!==(r=t[0].osv+"")&&P(s,r)},d(t){t&&w(e)}}}function Pl(t){let e,n,l,o,s,r=t[0].ndu+"";return{c(){e=z("div"),n=z("div"),n.textContent="Иные условия:",l=T(),o=z("div"),s=F(r),$(n,"class","stitle"),$(o,"class","sval")},m(t,r){C(t,e,r),j(e,n),j(e,l),j(e,o),j(o,s)},p(t,e){1&e&&r!==(r=t[0].ndu+"")&&P(s,r)},d(t){t&&w(e)}}}function Nl(t){let e,n,l,o,s,r,i,a=t[9].line_id+"",p=t[9].range+"";return{c(){e=z("li"),n=F(a),l=F(" ("),o=F(p),s=F(" м.)"),$(e,"class","link svelte-vw4d3d"),e.value=r=t[9].line_id},m(r,a,p){C(r,e,a),j(e,n),j(e,l),j(e,o),j(e,s),p&&i(),i=E(e,"click",t[2])},p(t,l){1&l&&a!==(a=t[9].line_id+"")&&P(n,a),1&l&&p!==(p=t[9].range+"")&&P(o,p),1&l&&r!==(r=t[9].line_id)&&(e.value=r)},d(t){t&&w(e),i()}}}function Sl(t){let e,n,l,o,s,r,i,a,p,c,d,u,_,h,v,m,g,y,b,x,k,L,O,M,q,N,S,H,B,U,I,G,A,R,Z,Y,V,W,K,J,Q,X,tt,et,nt,lt,ot,st,rt,it,at,pt,ct,dt,ut,_t,ht,vt,ft,mt,gt,yt,bt,xt,kt,jt,Lt,Ct,wt,Dt,zt,Ft,Tt,Ot,Et,Mt,$t,qt,Pt,Nt,St,Ht,Bt,Ut,It,Gt,At=(t[0].name||t[0].dtvp||"")+"",Rt=(t[0].sid||t[0].id_stat||t[0].id_skpdi||"")+"",Zt=(t[0].district||"")+"",Yt=(t[0].dor||"")+"",Vt=(t[0].km||0)+"",Wt=(t[0].m||0)+"",Kt=t[0].lat+"",Jt=t[0].lon+"",Qt=(t[0].collision_date||t[0].dtp_date||"")+"",Xt=(t[0].dtvp||"")+"",te=t[0].pog+"",ee=t[0].ran+"",ne=t[4],le=[];for(let e=0;e<ne.length;e+=1)le[e]=El(Tl(t,ne,e));let oe=t[0].spog&&Ml(t),se=t[0].s_pch&&$l(t),re=t[0].osv&&ql(t),ie=t[0].ndu&&Pl(t),ae=t[0].list_rub||[],pe=[];for(let e=0;e<ae.length;e+=1)pe[e]=Nl(zl(t,ae,e));return{c(){e=z("div"),n=z("div"),l=z("b"),o=F(At),s=T(),r=z("div"),i=z("table"),a=z("tbody"),p=z("tr"),c=z("td"),c.textContent="ID:",d=T(),u=z("td"),_=F(Rt),h=T(),v=z("tr"),m=z("td"),m.textContent="Адрес:",g=T(),y=z("td"),b=F(Zt),x=T(),k=F(Yt),L=T(),O=z("tr"),M=z("td"),M.textContent="Пикетаж:",q=T(),N=z("td"),S=z("b"),H=F(Vt),B=F(" км. "),U=z("b"),I=F(Wt),G=F(" м."),A=T(),R=z("tr"),Z=z("td"),Z.textContent="Координаты:",Y=T(),V=z("td"),W=F(Kt),K=T(),J=F(Jt),Q=T(),X=z("span"),tt=T(),et=z("tr"),nt=z("td"),nt.textContent="Дата/время:",lt=T(),ot=z("td"),st=F(Qt),rt=T(),it=z("tr"),at=z("td"),at.textContent="Вид ДТП:",pt=T(),ct=z("td"),dt=F(Xt),ut=T(),_t=z("tr"),ht=z("td"),ht.textContent="Нарушения:",vt=T(),ft=z("td"),mt=z("ul");for(let t=0;t<le.length;t+=1)le[t].c();gt=T(),yt=z("tr"),bt=z("td"),bt.textContent="Условия:",xt=T(),kt=z("td"),oe&&oe.c(),jt=T(),se&&se.c(),Lt=T(),re&&re.c(),Ct=T(),ie&&ie.c(),wt=T(),Dt=z("tr"),zt=z("td"),zt.textContent="Количество погибших/раненых:",Ft=T(),Tt=z("td"),Ot=z("b"),Et=F(te),Mt=F("/"),$t=F(ee),qt=T(),Pt=z("tr"),Nt=z("td"),Nt.textContent="Рубежи:",St=T(),Ht=z("td"),Bt=z("div"),Ut=T(),It=z("ul");for(let t=0;t<pe.length;t+=1)pe[t].c();$(n,"class","pLine"),$(c,"class","first svelte-vw4d3d"),$(m,"class","first svelte-vw4d3d"),$(M,"class","first svelte-vw4d3d"),$(Z,"class","first svelte-vw4d3d"),$(X,"title","Скопировать в буфер обмена"),$(X,"class","leaflet-gmx-icon-copy"),$(nt,"class","first svelte-vw4d3d"),$(at,"class","first svelte-vw4d3d"),$(ht,"class","first svelte-vw4d3d"),$(bt,"class","first svelte-vw4d3d"),$(zt,"class","first svelte-vw4d3d"),$(Nt,"class","first svelte-vw4d3d"),$(Bt,"class","win leaflet-popup-content-wrapper  svelte-vw4d3d"),$(i,"class","table"),$(r,"class","featureCont"),$(e,"class","mvsPopup svelte-vw4d3d")},m(f,w,D){C(f,e,w),j(e,n),j(n,l),j(l,o),j(e,s),j(e,r),j(r,i),j(i,a),j(a,p),j(p,c),j(p,d),j(p,u),j(u,_),j(a,h),j(a,v),j(v,m),j(v,g),j(v,y),j(y,b),j(y,x),j(y,k),j(a,L),j(a,O),j(O,M),j(O,q),j(O,N),j(N,S),j(S,H),j(N,B),j(N,U),j(U,I),j(N,G),j(a,A),j(a,R),j(R,Z),j(R,Y),j(R,V),j(V,W),j(V,K),j(V,J),j(V,Q),j(V,X),j(a,tt),j(a,et),j(et,nt),j(et,lt),j(et,ot),j(ot,st),j(a,rt),j(a,it),j(it,at),j(it,pt),j(it,ct),j(ct,dt),j(a,ut),j(a,_t),j(_t,ht),j(_t,vt),j(_t,ft),j(ft,mt);for(let t=0;t<le.length;t+=1)le[t].m(mt,null);j(a,gt),j(a,yt),j(yt,bt),j(yt,xt),j(yt,kt),oe&&oe.m(kt,null),j(kt,jt),se&&se.m(kt,null),j(kt,Lt),re&&re.m(kt,null),j(kt,Ct),ie&&ie.m(kt,null),j(a,wt),j(a,Dt),j(Dt,zt),j(Dt,Ft),j(Dt,Tt),j(Tt,Ot),j(Ot,Et),j(Ot,Mt),j(Ot,$t),j(a,qt),j(a,Pt),j(Pt,Nt),j(Pt,St),j(Pt,Ht),j(Ht,Bt),t[8](Bt),j(Ht,Ut),j(Ht,It);for(let t=0;t<pe.length;t+=1)pe[t].m(It,null);D&&Gt(),Gt=E(X,"click",t[3])},p(t,[e]){if(1&e&&At!==(At=(t[0].name||t[0].dtvp||"")+"")&&P(o,At),1&e&&Rt!==(Rt=(t[0].sid||t[0].id_stat||t[0].id_skpdi||"")+"")&&P(_,Rt),1&e&&Zt!==(Zt=(t[0].district||"")+"")&&P(b,Zt),1&e&&Yt!==(Yt=(t[0].dor||"")+"")&&P(k,Yt),1&e&&Vt!==(Vt=(t[0].km||0)+"")&&P(H,Vt),1&e&&Wt!==(Wt=(t[0].m||0)+"")&&P(I,Wt),1&e&&Kt!==(Kt=t[0].lat+"")&&P(W,Kt),1&e&&Jt!==(Jt=t[0].lon+"")&&P(J,Jt),1&e&&Qt!==(Qt=(t[0].collision_date||t[0].dtp_date||"")+"")&&P(st,Qt),1&e&&Xt!==(Xt=(t[0].dtvp||"")+"")&&P(dt,Xt),16&e){let n;for(ne=t[4],n=0;n<ne.length;n+=1){const l=Tl(t,ne,n);le[n]?le[n].p(l,e):(le[n]=El(l),le[n].c(),le[n].m(mt,null))}for(;n<le.length;n+=1)le[n].d(1);le.length=ne.length}if(t[0].spog?oe?oe.p(t,e):(oe=Ml(t),oe.c(),oe.m(kt,jt)):oe&&(oe.d(1),oe=null),t[0].s_pch?se?se.p(t,e):(se=$l(t),se.c(),se.m(kt,Lt)):se&&(se.d(1),se=null),t[0].osv?re?re.p(t,e):(re=ql(t),re.c(),re.m(kt,Ct)):re&&(re.d(1),re=null),t[0].ndu?ie?ie.p(t,e):(ie=Pl(t),ie.c(),ie.m(kt,null)):ie&&(ie.d(1),ie=null),1&e&&te!==(te=t[0].pog+"")&&P(Et,te),1&e&&ee!==(ee=t[0].ran+"")&&P($t,ee),5&e){let n;for(ae=t[0].list_rub||[],n=0;n<ae.length;n+=1){const l=zl(t,ae,n);pe[n]?pe[n].p(l,e):(pe[n]=Nl(l),pe[n].c(),pe[n].m(It,null))}for(;n<pe.length;n+=1)pe[n].d(1);pe.length=ae.length}},i:f,o:f,d(n){n&&w(e),D(le,n),oe&&oe.d(),se&&se.d(),re&&re.d(),ie&&ie.d(),t[8](null),D(pe,n),Gt()}}}function Hl(t,e,n){let l,o,{showModal:s=!1}=e,{prp:r}=e,i=r.skpdiFiles?"":"disabled";R(()=>{s&&(l=new kt({target:document.body,props:{data:r.skpdiFiles}}),l.$on("close",t=>{l.$destroy(),n(5,s=!1)}))});const a=(r.tsInfo||[]).map(t=>{let e=t.ts_uch||[];return{ts:"Осталось на месте ДТП"!==t.ts?t.ts:"",arr:e.map(t=>({k_uch:t.k_uch||"",npdd:"Нет нарушений"!==t.npdd?t.npdd:"",sop_npdd:"Нет нарушений"!==t.sop_npdd?t.sop_npdd:""}))}});return console.log("ddddd",r),t.$set=t=>{"showModal"in t&&n(5,s=t.showModal),"prp"in t&&n(0,r=t.prp)},[r,o,t=>{let e=t.target.value;console.log("showRub",t.target.value),n(1,o.innerHTML="",o),fetch("https://dtp.mvs.group/scripts/rubez_dev/rubez-complex-"+e+".txt",{}).then(t=>t.json()).then(t=>{new kl({target:o,props:{prp:t[0]}})})},t=>{navigator.clipboard.writeText(t.target.parentNode.textContent).catch(t=>{console.log("Something went wrong",t)})},a,s,l,i,function(t){V[t?"unshift":"push"](()=>{n(1,o=t)})}]}Dl.setFilter=t=>{if(!Dl._map)return;Dl.clearLayers(),Cl=t,Dl._argFilters=Cl;let e=[];Dl._group&&(Dl._group.getLayers().forEach(t=>{let n=t.options.props,l=0;Cl.forEach(t=>{"comp"===t.type&&(n.rub_flag?t.zn.on&&l++:t.zn.off&&l++)}),l===Cl.length&&e.push(t)}),Dl.addLayer(jl.layerGroup(e)))},Dl.on("remove",()=>{Dl.clearLayers()}).on("add",t=>{let e={road:{},bad:[]},n=[],l={},o=t=>{let o=jl.latLngBounds(),s="gray";if(t.rub_flag&&(s="#00FF00"),l[t.line_sid]?console.log("___Дубль____",t):l[t.line_sid]=t,!t.lat||!t.lon)return void e.bad.push(t);let r=t.coords||{lat:t.lat,lon:t.lon},i=jl.latLng(r.lat,r.lon);o.extend(i),n.push(new v(jl.latLng(r.lat,r.lon),{props:t,radius:6,zIndexOffset:5e4,path:"camera",stroke:!1,fillColor:s}).bindPopup(Ll).on("popupopen",t=>{!function(t){let e=jl.DomUtil.create("div"),n=t.line_sid;fetch(wl+"rubez-complex-"+n+".txt",{}).then(t=>t.json()).then(t=>{new kl({target:e,props:{prp:t[0]}}),Ll.setContent(e)}),Ll.setContent(e)}(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)}))};fetch(wl+"rubez.txt",{}).then(t=>t.json()).then(t=>{t.forEach(o),Dl._group=jl.layerGroup(n),Dl.addLayer(Dl._group),console.log("opt",e)})});class Bl extends vt{constructor(t){super(),ht(this,t,Hl,Sl,x,{showModal:5,prp:0})}}const Ul=window.L,Il=Ul.popup();let Gl;const Al=Ul.featureGroup([]);Al._needHeat={radius:19,blur:11.26,minOpacity:.34},Al.checkZoom=t=>{Object.keys(Al._layers).length?t<12&&Al.setFilter(Gl):t>11&&Al.setFilter(Gl)},Al.setFilter=t=>{if(!Al._map)return;Al.clearLayers(),Gl=t||[],Al._argFilters=Gl;let e=[],n=[];Al._group&&Al._map&&(Al._group.getLayers().forEach(t=>{let l=t.options.props,o=0;Gl.forEach(t=>{"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===l.collision_type).length)&&o++:"id_dtp"===t.type?l.id==t.zn&&o++:"list_rub"===t.type?l.list_rub.length?t.zn.on&&o++:t.zn.off&&o++:"date"===t.type&&l.date>=t.zn[0]&&l.date<t.zn[1]&&o++}),o===Gl.length&&(e.push(t),n.push(t._latlng))}),Al._needHeat?(Al._map.addLayer(Al._heat),Al._heat.setLatLngs(n),Al._heat.setOptions(Al._needHeat),Al._map._zoom>11&&Al.addLayer(Ul.layerGroup(e))):(Al.addLayer(Ul.layerGroup(e)),Al._map.removeLayer(Al._heat)))},Al.on("remove",t=>{Al._map.removeLayer(Al._heat),Al.clearLayers()}).on("add",t=>{Al._heat=Ul.heatLayer([],{gradient:{.1:"blue",.4:"lime",1:"red"}}),Gl=null,fetch("https://dtp.mvs.group/scripts/dtprubez_dev/get_stat_gipdd_with_rub.txt",{}).then(t=>t.json()).then(t=>{let e={collision_type:{},iconType:{}},n=[],l=t.map(t=>{let l=t.iconType||0,o=!1,s="#2F4F4F";l&&(o=l%2==0,l>=1&&l<=6?s="#8B4513":7===l||8===l?s="#228B22":l>=9&&l<=14?s="#8B4513":15===l||16===l?s="#7B68EE":17!==l&&18!==l||(s="#2F4F4F")),t.list_rub||(t.list_rub=[]),t.lat&&t.lon||(console.log("_______",t),t.lat=t.lon=0);let r=e.collision_type[t.collision_type];r?r++:r=1,e.collision_type[t.collision_type]=r,e.iconType[t.collision_type]=l;let i=Ul.latLng(t.lat,t.lon,o?1:.5);return n.push(i),new v(i,{props:t,radius:6,stroke:o,fillColor:s}).bindPopup(Il).on("popupopen",t=>{var e;e=t.target.options.props.id,fetch("https://dtp.mvs.group/scripts/dtprubez_dev/get_stat_gipdd_with_rub_"+e+".txt",{}).then(t=>t.json()).then(t=>{let e=Ul.DomUtil.create("div");const n=new Bl({target:e,props:{prp:t}});Il._svObj=n,Il.setContent(e)})}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});Al.addLayer(Al._heat),Al._heat.setLatLngs(n),Al._heat.setOptions(Al._needHeat),Al._opt=e,Al._group=Ul.layerGroup(l),Al.setFilter(),Al._map._zoom>11&&Al.addLayer(Al._group),Al._refreshFilters()})});const Rl=window.L;Rl.popup();let Zl;const Yl=Rl.featureGroup([]);Yl._needHeat={radius:19,blur:11.26,minOpacity:.34},Yl.checkZoom=t=>{Object.keys(Yl._layers).length?t<12&&Yl.setFilter(Zl):t>11&&Yl.setFilter(Zl)},Yl.setFilter=t=>{if(!Yl._map)return;Yl.clearLayers(),Zl=t||[],Yl._argFilters=Zl;let e=[],n=[];Yl._group&&(Yl._group.getLayers().forEach(t=>{let l=t.options.props,o=0;Zl.forEach(t=>{"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===l.collision_type).length)&&o++:"list_rub"===t.type?l.list_rub.length?t.zn.on&&o++:t.zn.off&&o++:"date"===t.type&&l.date>=t.zn[0]&&l.date<t.zn[1]&&o++}),o===Zl.length&&(e.push(t),n.push(t._latlng))}),Yl.addLayer(Rl.layerGroup(e)))},Yl.on("remove",t=>{Yl.clearLayers()}).on("add",t=>{fetch("https://dtp.mvs.group/static/proxy.php?url=https://graphql.dev.mvs.group/graphql",{body:'{"operationName":null,"variables":{},"query":"{\\n  allVMapLineInfos(filter: {lon: {isNull: false}, lat: {isNull: false}}) {\\n    totalCount\\n    nodes {\\n      lineSid: sid\\n      lineName: name\\n      lineAddress: address\\n      roadName\\n      stage\\n      lat\\n      lon\\n      yield\\n      complexes\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n"}',method:"POST",mode:"cors"}).then(t=>t.json()).then(t=>{console.log("json",t)})});const Vl=window.L,Wl=Vl.map(document.body,{center:[55.758031,37.611694],minZoom:1,zoom:8,maxZoom:21,attributionControl:!1,trackResize:!0,fadeAnimation:!0,zoomAnimation:!0,distanceUnit:"auto",squareUnit:"auto"});var Kl=Wl._controlCorners,Jl=Wl._controlContainer,Ql="leaflet-top leaflet-bottom",Xl="leaflet-left leaflet-right",to={bottom:"leaflet-bottom "+Xl,gmxbottomleft:"leaflet-bottom leaflet-left",gmxbottomcenter:"leaflet-bottom "+Xl,gmxbottomright:"leaflet-bottom leaflet-right",center:Ql+" "+Xl,right:"leaflet-right "+Ql,left:"leaflet-left "+Ql,top:"leaflet-top "+Xl};for(var eo in to)Kl[eo]||(Kl[eo]=Vl.DomUtil.create("div",to[eo],Jl));Wl.addControl(Vl.control.gmxCenter()).addControl(Vl.control.fitCenter());var no=Vl.TileLayer.extend({options:{tilesCRS:Vl.CRS.EPSG3395},_getTiledPixelBounds:function(t){var e=Vl.TileLayer.prototype._getTiledPixelBounds.call(this,t);return this._shiftY=this._getShiftY(this._tileZoom),e.min.y+=this._shiftY,e.max.y+=this._shiftY,e},_tileOnError:function(t,e,n){var l=e.getAttribute("src"),o=l.indexOf("/mapcache/");if(o>-1){var s=new URL("http:"+l).searchParams,r=l.substr(o+1).split("/"),i=a[r[1]];e.src=Vl.Util.template(i.errorTileUrlPrefix+i.postfix,{z:s.get("z"),x:s.get("x"),y:s.get("y")})}t(n,e)},_getTilePos:function(t){return Vl.TileLayer.prototype._getTilePos.call(this,t).subtract([0,this._shiftY])},_getShiftY:function(t){var e=this._map,n=e.getCenter(),l=e.options.crs.project(n).y-this.options.tilesCRS.project(n).y;return Math.floor(Vl.CRS.scale(t)*l/40075016.685578495)}});Vl.TileLayer.Mercator=no,Vl.tileLayer.Mercator=function(t,e){return new no(t,e)};let lo={};p.b||(p.b="m2"),["m2","m3"].forEach(t=>{let e=a[t],n=Vl.tileLayer.Mercator(e.prefix+e.postfix,e.options);lo[e.title]=n,p.b===e.options.key&&n.addTo(Wl)}),lo.OpenStreetMap=Vl.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:21,maxNativeZoom:18});let oo={"Рубежи":Dl,"Очаги ГИБДД по пикетажу":ol,"Очаги ГИБДД разные типы, геометрия":Qn,"Очаги ГИБДД одного типа, геометрия":Zn,"ДТП Очаги(Stat)":Bn,"ДТП Очаги(tmp)":$n,"Очаги ГИБДД+СКПДИ по кварталам геометрия":zn,"ДТП  ГИБДД+СКПДИ (объединение)":ie,"ДТП СКПДИ + тепловая карта":Kt,"ДТП ГИБДД + тепловая карта":Nt,"ДТП ГИБДД + тепловая карта + Рубежи":Al},so=p.o?p.o.split(",").reduce((t,e)=>(t[e]=!0,t),{}):{};["m1","m4","m5"].forEach(t=>{let e=a[t],n=Vl.tileLayer.Mercator(e.prefix+e.postfix,e.options);oo[e.title]=n,so[e.options.key]&&n.addTo(Wl)}),Vl.control.layers(lo,oo).addTo(Wl);let ro=Vl.control.gmxIcon({id:"filters",className:"leaflet-bar",togglable:!0,title:"Фильтры"}).on("statechange",(function(t){let e=t.target,n=e._container,l=e._win;e.options.isActive?l||(l=e._win=Vl.DomUtil.create("div","win leaflet-control-layers",n),Vl.DomEvent.disableScrollPropagation(l),l._Filters=new hn({target:l,props:{control:e,DtpGibddRub:Al,DtpGibdd:Nt,DtpSkpdi:Kt,Rub:Dl,DtpHearthsPicket:ol,DtpHearths5:Qn,DtpHearths3:Zn,DtpHearthsStat:Bn,DtpHearthsTmp:$n,DtpHearths:zn,DtpVerifyed:ie}})):(e._win.parentNode.removeChild(e._win),e._win=null)})).addTo(Wl);const io=(t,e)=>{for(var n=Math.PI/180,l={lon:n*t.lng,lat:n*t.lat},o={lon:n*e.lng,lat:n*e.lat},s=6378137,r=6356752.3142,i=1/298.257223563,a=o.lon-l.lon,p=Math.atan((1-i)*Math.tan(l.lat)),c=Math.atan((1-i)*Math.tan(o.lat)),d=Math.sin(p),u=Math.cos(p),_=Math.sin(c),h=Math.cos(c),v=a,f=2*Math.PI,m=20;Math.abs(v-f)>1e-12&&--m>0;){var g=Math.sin(v),y=Math.cos(v),b=Math.sqrt(h*g*(h*g)+(u*_-d*h*y)*(u*_-d*h*y));if(0===b)return 0;var x=d*_+u*h*y,k=Math.atan2(b,x),j=u*h*g/b,L=1-j*j,C=x-2*d*_/L;isNaN(C)&&(C=0);var w=i/16*L*(4+i*(4-3*L));f=v,v=a+(1-w)*i*j*(k+w*b*(C+w*x*(2*C*C-1)))}if(0===m)return NaN;var D=L*(s*s/(r*r)-1),z=D/1024*(256+D*(D*(74-47*D)-128));return r*(1+D/16384*(4096+D*(D*(320-175*D)-768)))*(k-z*b*(C+z/4*(x*(2*C*C-1)-z/6*C*(4*b*b-3)*(4*C*C-3))))};let ao,po;Wl.pm.setLang("customName",{tooltips:{finishLine:"Щелкните любой существующий маркер для завершения"}},"ru"),Wl.pm.setLang("ru"),Wl.on("pm:create",t=>{Wl.removeLayer(t.layer),co.setActive(!1)}).on("pm:drawstart",t=>{let e=t.workingLayer;if("Line"===t.shape){let n=Wl.pm.Draw.Line._hintMarker;n&&n.on("move",(function(t){var l=e.getLatLngs();if(l.length){var o=(t=>{let e=0,n=(t=t||[])[0];return t.forEach(t=>{e+=io(t,n),n=t}),e})(l),s=io(l[l.length-1],t.latlng),r=(o+=s)>1e3?(o/1e3).toFixed(2)+" км":Math.ceil(o)+" м",i=s>1e3?(s/1e3).toFixed(2)+" км":Math.ceil(s)+" м";n._tooltip.setContent("Отрезок <b>("+i+")</b>участка <b>("+r+")</b>")}})),ao&&t.target.pm.Toolbar.buttons.drawPolyline.buttonsDomNode&&(po=t.target.pm.Toolbar.buttons.drawPolyline.buttonsDomNode.children[1],po.style.display="none")}});let co=Vl.control.gmxIcon({id:"measure",className:"leaflet-bar",togglable:!0,title:"Включить/Отключить режим измерения расстояний"}).on("statechange",(function(t){ao=t.target.options.isActive,ao?Wl.pm.enableDraw("Line",{finishOn:"dblclick"}):(Wl.pm.disableDraw("Line"),po&&(po.style.display=""))})).addTo(Wl);const uo=()=>{setTimeout(()=>{ro.options.isActive&&(ro.setActive(!1),ro._win=null,ro.setActive(!0))})};Al._refreshFilters=Nt._refreshFilters=Kt._refreshFilters=ie._refreshFilters=zn._refreshFilters=Bn._refreshFilters=Zn._refreshFilters=Qn._refreshFilters=ol._refreshFilters=Dl._refreshFilters=$n._refreshFilters=uo;return Al.on("remove",uo),Nt.on("remove",uo),Kt.on("remove",uo),ie.on("remove",uo),zn.on("remove",uo),$n.on("remove",uo),Bn.on("remove",uo),Zn.on("remove",uo),Qn.on("remove",uo),ol.on("remove",uo),Dl.on("remove",uo),Wl.on("zoomend",t=>{Wl._crpx=0,ie._map&&ie.checkZoom(Wl._zoom),Kt._map&&Kt.checkZoom(Wl._zoom),Nt._map&&Nt.checkZoom(Wl._zoom)}),window._map=Wl,Wl}();
//# sourceMappingURL=main.js.map
