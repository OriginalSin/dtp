var dtp=function(){"use strict";const t=window.L;t.Control.GmxIcon=t.Control.extend({includes:t.Evented?t.Evented.prototype:t.Mixin.Events,options:{position:"topleft",id:"defaultIcon",isActive:!1},setActive:function(e,n,o){var l=this.options,s=this._container;if(l.togglable||l.toggle){var r=l.isActive,i=this._prefix,a=i+"-"+l.id;l.isActive=e,this._img&&(e&&l.activeImageUrl?this._img.src=l.activeImageUrl:!e&&l.regularImageUrl&&(this._img.src=l.regularImageUrl)),e?(t.DomUtil.addClass(s,i+"-active"),t.DomUtil.addClass(s,a+"-active"),s.children.length&&t.DomUtil.addClass(s,i+"-externalImage-active"),l.styleActive&&this.setStyle(l.styleActive)):(t.DomUtil.removeClass(s,i+"-active"),t.DomUtil.removeClass(s,a+"-active"),s.children.length&&t.DomUtil.removeClass(s,i+"-externalImage-active"),l.style&&this.setStyle(l.style)),n||r===e||this.fire("statechange",o)}if(t.gmxUtil&&t.gmxUtil.isIEOrEdge){var p=s.getElementsByTagName("use");if(p.length){var c=p[0],d=c.getAttribute("href")||c.getAttribute("xlink:href");c.setAttribute("href",d)}}},onAdd:function(e){var n=null,o=this.options,l=o.svgSprite||e.options.svgSprite,s="leaflet-gmx-icon"+(!l||o.regularImageUrl||o.text?"":"Svg"),r=s+"-"+o.id;this._prefix=s;var i=t.DomUtil.create("div",s+" "+r);if(i._id=o.id,this._container=i,o.title&&(i.title=o.title),this.setStyle=function(t){for(var e in t)i.style[e]=t[e]},o.className&&t.DomUtil.addClass(i,o.className),o.regularImageUrl)(n=t.DomUtil.create("img","",i)).src=o.regularImageUrl,this._img=n,t.DomUtil.addClass(i,s+"-img"),t.DomUtil.addClass(i,s+"-externalImage");else if(o.text)t.DomUtil.addClass(i,s+"-text"),t.DomUtil.create("span","",i).innerHTML=o.text;else if(l){t.DomUtil.addClass(i,"svgIcon");var a="#"+o.id.toLowerCase();i.innerHTML='<svg role="img" class="svgIcon"><use xlink:href="'+a+'" href="'+a+'"></use></svg>'}else t.DomUtil.addClass(i,s+"-img "+s+"-sprite");o.style&&this.setStyle(o.style),this._iconClick=function(t){i.parentNode&&i===t.toElement&&(this.setActive(!this.options.isActive,!1,t),this.fire("click",t),this.options.stateChange&&this.options.stateChange(this,t))};var p=t.DomEvent.stopPropagation;t.DomEvent.preventDefault;return t.DomEvent.on(i,"mousemove",p).on(i,"touchstart",p).on(i,"mousedown",p).on(i,"dblclick",p).on(i,"click",p).on(i,"click",this._iconClick,this),o.onAdd&&o.onAdd(this),this.fire("controladd"),e.fire("controladd",this),o.notHide&&(i._notHide=!0),e.gmxControlsManager&&e.gmxControlsManager.add(this),i},onRemove:function(e){e.gmxControlsManager&&e.gmxControlsManager.remove(this),this.fire("controlremove"),e.fire("controlremove",this);var n=this._container,o=t.DomEvent.stopPropagation;t.DomEvent.off(n,"mousemove",o).off(n,"touchstart",o).off(n,"mousedown",o).off(n,"dblclick",o).off(n,"click",o).off(n,"click",this._iconClick,this)},addTo:function(e){return t.Control.prototype.addTo.call(this,e),this.options.addBefore&&this.addBefore(this.options.addBefore),this},addBefore:function(t){var e=this._parent&&this._parent._container;if(e||(e=this._map&&this._map._controlCorners[this.getPosition()]),e)for(var n=0,o=e.childNodes.length;n<o;n++){var l=e.childNodes[n];if(t===l._id){e.insertBefore(this._container,l);break}}else this.options.addBefore=t;return this}}),t.Control.gmxIcon=t.Control.GmxIcon,t.control.gmxIcon=function(e){return new t.Control.GmxIcon(e)};const e=window.L;e.Control.GmxCenter=e.Control.extend({options:{position:"center",id:"center",notHide:!0,color:"red"},onRemove:function(t){t.gmxControlsManager&&t.gmxControlsManager.remove(this),t.fire("controlremove",this)},onAdd:function(t){var n="http://www.w3.org/2000/svg",o=e.DomUtil.create("div","leaflet-gmx-center"),l=e.DomUtil.create("div","leaflet-gmx-center"),s=document.createElementNS(n,"svg"),r=document.createElementNS(n,"g"),i=document.createElementNS(n,"path");return this._container=o,o._id=this.options.id,this.options.notHide&&(o._notHide=!0),i.setAttribute("stroke-width",2),i.setAttribute("stroke-opacity",2),i.setAttribute("d","M9 0L9 18M0 9L18 9"),this._path=i,r.appendChild(i),s.appendChild(r),s.setAttribute("width",18),s.setAttribute("height",18),l.appendChild(s),o.appendChild(l),this.setColor(this.options.color),t.fire("controladd",this),t.gmxControlsManager&&t.gmxControlsManager.add(this),o},setColor:function(t){return this.options.color=t,this._map&&this._path.setAttribute("stroke",t),this}}),e.Control.gmxCenter=e.Control.GmxCenter,e.control.gmxCenter=function(t){return new e.Control.GmxCenter(t)};const n=window.L;n.Control.FitCenter=n.Control.extend({options:{position:"topright",id:"fitcenter",notHide:!0,color:"#216b9c"},onRemove:function(t){t.gmxControlsManager&&t.gmxControlsManager.remove(this),t.off("moveend",this._update,this).fire("controlremove",this)},onAdd:function(t){var e=this.options.id,o="leaflet-gmx-"+e,l=n.DomUtil.create("div",o),s=n.DomUtil.create("input","",l),r=n.DomUtil.create("button","",l),i=n.DomUtil.create("div","results",l);return r.title="Переместить центр карты",s.placeholder="Поиск по адресам, координатам",this._input=s,this._container=l,this._results=i,l._id=e,t.on("mousemove",t=>{this._results.style.display="none"},this),n.DomEvent.on(s,"input",this._getSuggestions,this),n.DomEvent.on(s,"contextmenu",n.DomEvent.stopPropagation,this),n.DomEvent.on(l,"mousemove",n.DomEvent.stop),n.DomEvent.on(l,"mouseover",t=>{"block"!==this._results.style.display&&(this._results.style.display="block")},this),n.DomEvent.on(r,"click",(function(){let e=s.value.match(/[+-]?([0-9]*[.])?[0-9]+/g);e&&e.length>1&&t.setView([Number(e[0]),Number(e[1])])})),n.DomEvent.disableClickPropagation(l),t.on("moveend",this._update,this).fire("controladd",this),t.gmxControlsManager&&t.gmxControlsManager.add(this),l},_parseSearch:function(t){if((t=t||[]).length){this._results;let e=document.createDocumentFragment();t.forEach(t=>{let o=t.display_name,l=t.boundingbox,s=n.DomUtil.create("div","",e);s.innerHTML=o,n.DomEvent.on(s,"click",t=>{this._map.fitBounds([[l[0],l[2]],[l[1],l[3]]])},this)}),this._results.innerText="",this._results.appendChild(e),this._results.classList.add("active")}},_getSuggestions:function(t){const e=t.target.value||"калужское шоссе",n=["format=json","limit=10","polygon_text=1","bounded=1","viewbox=34,53,41,57"].join("&"),o="&q="+encodeURI(e);fetch(`//nominatim.openstreetmap.org/search?${n}${o}`,{}).then(t=>t.json()).then(this._parseSearch.bind(this))},_update:function(t){this._map&&this.setCoords(this._map.getCenter())},_trunc:function(t){return(""+(Math.round(1e7*t)/1e7+1e-8)).substring(0,9)},setCoords:function(t){return this}}),n.control.fitCenter=function(t){return new n.Control.FitCenter(t)};const o='&copy; <a href="https://n.maps.yandex.ru/?oid=1900133#!/?z=18&ll=36.860478%2C55.429679&l=nk%23map">Yandex</a> contributors',l="//inv.mvs.group/mapcache/",s=new Date,r=s.getMonth()+1,i=s.getDate(),a=(s.getFullYear(),{m1:{title:"Дороги",prefix:l+"m1/",postfix:"?x={x}&y={y}&z={z}&l=mrcss",errorTileUrlPrefix:"//core-nmaps-mrc-browser.maps.yandex.ru/tiles",options:{key:"m1",minZoom:10,maxZoom:19,attribution:o}},m2:{title:"Карта(Яндекс)",prefix:l+"m2/tiles",postfix:"?l=map&v=18.01.10-2&x={x}&y={y}&z={z}&scale=1&lang=ru_RU",errorTileUrlPrefix:"//vec01.maps.yandex.net/tiles",options:{key:"m2",maxNativeZoom:19,maxZoom:21,attribution:o}},m3:{title:"Снимки(Яндекс)",prefix:l+"m3/tiles",postfix:"?l=sat&v=3.462.0&x={x}&y={y}&z={z}&lang=ru_RU",errorTileUrlPrefix:"//sat04.maps.yandex.net/tiles",options:{key:"m3",maxNativeZoom:19,maxZoom:21,attribution:o}},m4:{title:"Скорость(Народная карта)",prefix:l+"m4/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=104,301135,302526,302827,5300026,5400046,70300236,70300638",errorTileUrlPrefix:"//04.core-nmaps-renderer-nmaps.maps.yandex.net/tile",options:{key:"m4",minZoom:8,maxZoom:19,attribution:o}},m5:{title:"Светофоры",prefix:l+"m5/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=301750",errorTileUrlPrefix:"//04.core-nmaps-renderer-nmaps.maps.yandex.net/tile",options:{key:"m4",minZoom:12,maxZoom:19,attribution:o}},m6:{title:"Дороги в стадии строительства",prefix:"//03.core-nmaps-renderer-nmaps.maps.yandex.net/",postfix:"?x={x}&y={y}&z={z}&l=mpskl&sl=70300289",errorTileUrlPrefix:"//03.core-nmaps-renderer-nmaps.maps.yandex.net/",options:{key:"m6",minZoom:10,maxZoom:19,attribution:o}}}),p={};window.URLSearchParams&&new URLSearchParams(window.location.search).forEach((t,e)=>{p[e]=t});const c=window.L;let d=c.canvas();const u=function(t,e){var n=c.Projection.Mercator.project(e),o=c.Projection.Mercator.unproject(new c.Point(n.x+40,n.y+30));return 156543.033928041*Math.pow(2,-t)*((t,e)=>{for(var n=Math.PI/180,o={lon:n*t.lng,lat:n*t.lat},l={lon:n*e.lng,lat:n*e.lat},s=6378137,r=6356752.3142,i=1/298.257223563,a=l.lon-o.lon,p=Math.atan((1-i)*Math.tan(o.lat)),c=Math.atan((1-i)*Math.tan(l.lat)),d=Math.sin(p),u=Math.cos(p),_=Math.sin(c),h=Math.cos(c),v=a,f=2*Math.PI,m=20;Math.abs(v-f)>1e-12&&--m>0;){var y=Math.sin(v),g=Math.cos(v),b=Math.sqrt(h*y*(h*y)+(u*_-d*h*g)*(u*_-d*h*g));if(0===b)return 0;var k=d*_+u*h*g,x=Math.atan2(b,k),j=u*h*y/b,L=1-j*j,C=k-2*d*_/L;isNaN(C)&&(C=0);var D=i/16*L*(4+i*(4-3*L));f=v,v=a+(1-D)*i*j*(x+D*b*(C+D*k*(2*C*C-1)))}if(0===m)return NaN;var w=L*(s*s/(r*r)-1),F=w/1024*(256+w*(w*(74-47*w)-128));return r*(1+w/16384*(4096+w*(w*(320-175*w)-768)))*(x-F*b*(C+F/4*(k*(2*C*C-1)-F/6*C*(4*b*b-3)*(4*C*C-3))))})(e,o)/50};c.canvas({padding:.5});c.Canvas.include({_updateMarkerPoint:function(t){if(!(!this._drawing||t._empty()||t.feature&&t.feature.properties._isHidden)){var e=t._point,n=t.options._radiusM,o=t.options.image,l=t._map,s=this._ctx,r=t.options.iconName||"border";if(l){if(o){let n=t.options.w||20,l=t.options.h||20;return void s.drawImage(o,e.x-n/2,e.y-l/2,n,l)}let i=l._zoom;n&&!l._rpx&&l._needRound&&(l._rpx=l._needRound*n/u(i,l.getCenter())),l._rpx>20&&l._needRound&&(s.save(),s.beginPath(),s.globalAlpha=.2,s.fillStyle="gray",s.arc(e.x,e.y,l._rpx,0,2*Math.PI),s.fill(),s.stroke(),s.closePath(),s.restore()),i>12&&(s.save(),s.beginPath(),s.globalAlpha=1,s.fillStyle="white",s.arc(e.x,e.y,14,0,2*Math.PI),s.fill(),s.closePath(),s.restore()),s.save(),s.beginPath(),s.translate(e.x-0,e.y-0),this._fillStroke(s,t),s.stroke(iconPaths[r].path),s.globalAlpha=t.options.fillOpacity,s.fill(iconPaths[r].path),s.closePath(),s.restore()}}},_updateCirclePoint:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=t.options,o=n.radius||14,l=2*o,s=(t._map,this._ctx);s.save(),s.beginPath(),s.globalAlpha=1,s.fillStyle=n.fillColor||"red",n.triangle?(s.moveTo(e.x,e.y+o),s.lineTo(e.x+o,e.y-o),s.lineTo(e.x-o,e.y-o),s.lineTo(e.x,e.y+o)):n.rhomb?(s.moveTo(e.x+o,e.y),s.lineTo(e.x,e.y+o),s.lineTo(e.x-o,e.y),s.lineTo(e.x,e.y-o),s.lineTo(e.x+o,e.y)):n.box?s.fillRect(e.x-o,e.y-o,l,l):s.arc(e.x,e.y,o,0,2*Math.PI),s.fill(),n.stroke&&(s.stroke(),n.triangle?(s.moveTo(e.x,e.y+o),s.lineTo(e.x+o,e.y-o),s.lineTo(e.x-o,e.y-o),s.lineTo(e.x,e.y+o)):n.box?s.strokeRect(e.x-o,e.y-o,l,l):s.arc(e.x,e.y,o,0,2*Math.PI)),s.closePath(),s.restore()}}});c.CircleMarker.extend({_updatePath:function(){this._renderer._updateMarkerPoint(this)}});const _=c.CircleMarker.extend({options:{renderer:d},_updatePath:function(){this._renderer._updateCirclePoint(this)}});c.Rectangle.extend({options:{renderer:d}});function h(){}function v(t){return t()}function f(){return Object.create(null)}function m(t){t.forEach(v)}function y(t){return"function"==typeof t}function g(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function b(t){return null==t?"":t}function k(t,e){t.appendChild(e)}function x(t,e,n){t.insertBefore(e,n||null)}function j(t){t.parentNode.removeChild(t)}function C(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function D(t){return document.createElement(t)}function w(t){return document.createTextNode(t)}function F(){return w(" ")}function T(){return w("")}function E(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function O(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function z(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function M(t){return""===t?void 0:+t}function P(t,e){e=""+e,t.data!==e&&(t.data=e)}function $(t,e){(null!=e||t.value)&&(t.value=e)}function q(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}}function S(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];o.selected=~e.indexOf(o.__value)}}function H(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function B(t){return[].map.call(t.querySelectorAll(":checked"),t=>t.__value)}let U;function N(t){U=t}function A(){if(!U)throw new Error("Function called outside component initialization");return U}function I(t){A().$$.after_update.push(t)}function G(){const t=A();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const l=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);o.slice().forEach(e=>{e.call(t,l)})}}}const Z=[],R=[],Y=[],J=[],K=Promise.resolve();let V=!1;function W(t){Y.push(t)}let Q=!1;const X=new Set;function tt(){if(!Q){Q=!0;do{for(let t=0;t<Z.length;t+=1){const e=Z[t];N(e),et(e.$$)}for(Z.length=0;R.length;)R.pop()();for(let t=0;t<Y.length;t+=1){const e=Y[t];X.has(e)||(X.add(e),e())}Y.length=0}while(Z.length);for(;J.length;)J.pop()();V=!1,Q=!1,X.clear()}}function et(t){if(null!==t.fragment){t.update(),m(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(W)}}const nt=new Set;let ot;function lt(){ot={r:0,c:[],p:ot}}function st(){ot.r||m(ot.c),ot=ot.p}function rt(t,e){t&&t.i&&(nt.delete(t),t.i(e))}function it(t,e,n,o){if(t&&t.o){if(nt.has(t))return;nt.add(t),ot.c.push(()=>{nt.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}function at(t){t&&t.c()}function pt(t,e,n){const{fragment:o,on_mount:l,on_destroy:s,after_update:r}=t.$$;o&&o.m(e,n),W(()=>{const e=l.map(v).filter(y);s?s.push(...e):m(e),t.$$.on_mount=[]}),r.forEach(W)}function ct(t,e){const n=t.$$;null!==n.fragment&&(m(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function dt(t,e){-1===t.$$.dirty[0]&&(Z.push(t),V||(V=!0,K.then(tt)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ut(t,e,n,o,l,s,r=[-1]){const i=U;N(t);const a=e.props||{},p=t.$$={fragment:null,ctx:null,props:s,update:h,not_equal:l,bound:f(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(i?i.$$.context:[]),callbacks:f(),dirty:r};let c=!1;if(p.ctx=n?n(t,a,(e,n,...o)=>{const s=o.length?o[0]:n;return p.ctx&&l(p.ctx[e],p.ctx[e]=s)&&(p.bound[e]&&p.bound[e](s),c&&dt(t,e)),n}):[],p.update(),c=!0,m(p.before_update),p.fragment=!!o&&o(p.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);p.fragment&&p.fragment.l(t),t.forEach(j)}else p.fragment&&p.fragment.c();e.intro&&rt(t.$$.fragment),pt(t,e.target,e.anchor),tt()}N(i)}class _t{$destroy(){ct(this,1),this.$destroy=h}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function ht(t,e,n){const o=t.slice();return o[7]=e[n],o[9]=n,o}function vt(t){let e,n,o,l,s;function r(...e){return t[6](t[9],...e)}return{c(){e=D("li"),z(e,"class",n="dot"+(t[9]===t[1]?" selected":"")+" svelte-jjp3es"),e.value=o=t[9],z(e,"role","button"),z(e,"tabindex","0"),z(e,"aria-label",l="slide item "+t[9])},m(t,n,o){x(t,e,n),o&&s(),s=E(e,"click",O(r))},p(o,l){t=o,2&l&&n!==(n="dot"+(t[9]===t[1]?" selected":"")+" svelte-jjp3es")&&z(e,"class",n)},d(t){t&&j(e),s()}}}function ft(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,v,f,y,g,b,L,T,M,$,q,S,H,B,U,N,A,I,G=(t[0][t[1]].kindName||"Фото и схемы ДТП")+"",Z=t[1]+1+"",R=t[0].length+"",Y=t[0],J=[];for(let e=0;e<Y.length;e+=1)J[e]=vt(ht(t,Y,e));return{c(){e=D("div"),n=F(),o=D("div"),l=D("div"),s=F(),r=D("div"),i=D("div"),a=D("div"),p=w(G),c=F(),d=D("div"),u=D("div"),_=D("div"),v=D("button"),f=F(),y=D("div"),g=D("a"),b=D("img"),M=F(),$=D("button"),q=F(),S=D("ul");for(let t=0;t<J.length;t+=1)J[t].c();H=F(),B=D("p"),U=w(Z),N=w(" из "),A=w(R),z(e,"class","modal-background svelte-jjp3es"),z(l,"title","Закрыть"),z(l,"class","ant-modal-close svelte-jjp3es"),z(a,"class","ant-modal-title"),z(a,"id","rcDialogTitle1"),z(i,"class","ant-modal-header svelte-jjp3es"),z(v,"type","button"),z(v,"aria-label","previous slide / item"),z(v,"class","control-arrow control-prev svelte-jjp3es"),b.src!==(L=""+(mt+t[0][t[1]].guid))&&z(b,"src",L),z(b,"alt",""),z(b,"class","svelte-jjp3es"),z(g,"target","_blank"),z(g,"href",T=""+(mt+t[0][t[1]].guid)),z(g,"title","Открыть на весь экран"),z(g,"class","svelte-jjp3es"),z(y,"class","slider-wrapper axis-horizontal svelte-jjp3es"),z($,"type","button"),z($,"aria-label","next slide / item"),z($,"class","control-arrow control-next svelte-jjp3es"),z(S,"class","control-dots svelte-jjp3es"),z(B,"class","carousel-status svelte-jjp3es"),z(_,"class","carousel carousel-slider svelte-jjp3es"),function(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}(_,"width","100%"),z(d,"class","ant-modal-body svelte-jjp3es"),z(r,"class","ant-modal-content svelte-jjp3es"),z(o,"class","modal svelte-jjp3es"),z(o,"role","dialog"),z(o,"aria-modal","true")},m(h,j,L){x(h,e,j),x(h,n,j),x(h,o,j),k(o,l),k(o,s),k(o,r),k(r,i),k(i,a),k(a,p),k(r,c),k(r,d),k(d,u),k(u,_),k(_,v),k(_,f),k(_,y),k(y,g),k(g,b),k(_,M),k(_,$),k(_,q),k(_,S);for(let t=0;t<J.length;t+=1)J[t].m(S,null);k(_,H),k(_,B),k(B,U),k(B,N),k(B,A),L&&m(I),I=[E(e,"click",O(t[2])),E(l,"click",O(t[2])),E(v,"click",O(t[3])),E($,"click",O(t[4])),E(o,"click",O(yt))]},p(t,[e]){if(3&e&&G!==(G=(t[0][t[1]].kindName||"Фото и схемы ДТП")+"")&&P(p,G),3&e&&b.src!==(L=""+(mt+t[0][t[1]].guid))&&z(b,"src",L),3&e&&T!==(T=""+(mt+t[0][t[1]].guid))&&z(g,"href",T),3&e){let n;for(Y=t[0],n=0;n<Y.length;n+=1){const o=ht(t,Y,n);J[n]?J[n].p(o,e):(J[n]=vt(o),J[n].c(),J[n].m(S,null))}for(;n<J.length;n+=1)J[n].d(1);J.length=Y.length}2&e&&Z!==(Z=t[1]+1+"")&&P(U,Z),1&e&&R!==(R=t[0].length+"")&&P(A,R)},i:h,o:h,d(t){t&&j(e),t&&j(n),t&&j(o),C(J,t),m(I)}}}const mt="//map.mvs.group/skpdi/proxy.php?guid=",yt=()=>{};function gt(t,e,n){const o=G();let{data:l}=e,s=0;return t.$set=t=>{"data"in t&&n(0,l=t.data)},[l,s,()=>{o("close")},()=>{s&&n(1,s--,s)},()=>{s<l.length-1&&n(1,s++,s)},o,t=>{n(1,s=t)}]}class bt extends _t{constructor(t){super(),ut(this,t,gt,ft,g,{data:0})}}function kt(t,e,n){const o=t.slice();return o[9]=e[n],o}function xt(t,e,n){const o=t.slice();return o[6]=e[n],o}function jt(t){let e,n,o,l=t[9].k_uch&&(t[9].npdd||t[9].sop_npdd)&&function(t){let e,n,o=t[9].k_uch+"";return{c(){e=D("li"),n=w(o)},m(t,o){x(t,e,o),k(e,n)},p:h,d(t){t&&j(e)}}}(t),s=t[9].npdd&&function(t){let e,n,o=t[9].npdd+"";return{c(){e=D("li"),n=w(o)},m(t,o){x(t,e,o),k(e,n)},p:h,d(t){t&&j(e)}}}(t),r=t[9].sop_npdd&&function(t){let e,n,o=t[9].sop_npdd+"";return{c(){e=D("li"),n=w(o)},m(t,o){x(t,e,o),k(e,n)},p:h,d(t){t&&j(e)}}}(t);return{c(){l&&l.c(),e=F(),s&&s.c(),n=F(),r&&r.c(),o=T()},m(t,i){l&&l.m(t,i),x(t,e,i),s&&s.m(t,i),x(t,n,i),r&&r.m(t,i),x(t,o,i)},p(t,e){t[9].k_uch&&(t[9].npdd||t[9].sop_npdd)&&l.p(t,e),t[9].npdd&&s.p(t,e),t[9].sop_npdd&&r.p(t,e)},d(t){l&&l.d(t),t&&j(e),s&&s.d(t),t&&j(n),r&&r.d(t),t&&j(o)}}}function Lt(t){let e,n,o=t[6].ts&&function(t){let e,n,o=t[6].ts+"";return{c(){e=D("li"),n=w(o)},m(t,o){x(t,e,o),k(e,n)},p:h,d(t){t&&j(e)}}}(t),l=t[6].arr,s=[];for(let e=0;e<l.length;e+=1)s[e]=jt(kt(t,l,e));return{c(){o&&o.c(),e=F();for(let t=0;t<s.length;t+=1)s[t].c();n=T()},m(t,l){o&&o.m(t,l),x(t,e,l);for(let e=0;e<s.length;e+=1)s[e].m(t,l);x(t,n,l)},p(t,e){if(t[6].ts&&o.p(t,e),4&e){let o;for(l=t[6].arr,o=0;o<l.length;o+=1){const r=kt(t,l,o);s[o]?s[o].p(r,e):(s[o]=jt(r),s[o].c(),s[o].m(n.parentNode,n))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(t){o&&o.d(t),t&&j(e),C(s,t),t&&j(n)}}}function Ct(t){let e,n,o,l,s,r=t[0].spog+"";return{c(){e=D("div"),n=D("div"),n.textContent="Погода:",o=F(),l=D("div"),s=w(r),z(n,"class","stitle"),z(l,"class","sval")},m(t,r){x(t,e,r),k(e,n),k(e,o),k(e,l),k(l,s)},p(t,e){1&e&&r!==(r=t[0].spog+"")&&P(s,r)},d(t){t&&j(e)}}}function Dt(t){let e,n,o,l,s,r=t[0].s_pch+"";return{c(){e=D("div"),n=D("div"),n.textContent="Покрытие:",o=F(),l=D("div"),s=w(r),z(n,"class","stitle"),z(l,"class","sval")},m(t,r){x(t,e,r),k(e,n),k(e,o),k(e,l),k(l,s)},p(t,e){1&e&&r!==(r=t[0].s_pch+"")&&P(s,r)},d(t){t&&j(e)}}}function wt(t){let e,n,o,l,s,r=t[0].osv+"";return{c(){e=D("div"),n=D("div"),n.textContent="Освещенность:",o=F(),l=D("div"),s=w(r),z(n,"class","stitle"),z(l,"class","sval")},m(t,r){x(t,e,r),k(e,n),k(e,o),k(e,l),k(l,s)},p(t,e){1&e&&r!==(r=t[0].osv+"")&&P(s,r)},d(t){t&&j(e)}}}function Ft(t){let e,n,o,l,s,r=t[0].ndu+"";return{c(){e=D("div"),n=D("div"),n.textContent="Иные условия:",o=F(),l=D("div"),s=w(r),z(n,"class","stitle"),z(l,"class","sval")},m(t,r){x(t,e,r),k(e,n),k(e,o),k(e,l),k(l,s)},p(t,e){1&e&&r!==(r=t[0].ndu+"")&&P(s,r)},d(t){t&&j(e)}}}function Tt(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,v,f,m,y,g,b,L,T,O,M,$,q,S,H,B,U,N,A,I,G,Z,R,Y,J,K,V,W,Q,X,tt,et,nt,ot,lt,st,rt,it,at,pt,ct,dt,ut,_t,ht,vt,ft,mt,yt,gt,bt,kt,jt,Tt,Et,Ot,zt,Mt,Pt,$t,qt,St,Ht,Bt,Ut,Nt,At=(t[0].name||t[0].dtvp||"")+"",It=(t[0].sid||t[0].id_stat||t[0].id_skpdi||"")+"",Gt=(t[0].district||"")+"",Zt=(t[0].dor||"")+"",Rt=(t[0].km||0)+"",Yt=(t[0].m||0)+"",Jt=t[0].lat+"",Kt=t[0].lon+"",Vt=(t[0].collision_date||t[0].dtp_date||"")+"",Wt=(t[0].dtvp||"")+"",Qt=t[0].pog+"",Xt=t[0].ran+"",te=t[2],ee=[];for(let e=0;e<te.length;e+=1)ee[e]=Lt(xt(t,te,e));let ne=t[0].spog&&Ct(t),oe=t[0].s_pch&&Dt(t),le=t[0].osv&&wt(t),se=t[0].ndu&&Ft(t);return{c(){e=D("div"),n=D("div"),o=D("b"),l=w(At),s=F(),r=D("div"),i=D("table"),a=D("tbody"),p=D("tr"),c=D("td"),c.textContent="ID:",d=F(),u=D("td"),_=w(It),v=F(),f=D("tr"),m=D("td"),m.textContent="Адрес:",y=F(),g=D("td"),b=w(Gt),L=F(),T=w(Zt),O=F(),M=D("tr"),$=D("td"),$.textContent="Пикетаж:",q=F(),S=D("td"),H=D("b"),B=w(Rt),U=w(" км. "),N=D("b"),A=w(Yt),I=w(" м."),G=F(),Z=D("tr"),R=D("td"),R.textContent="Координаты:",Y=F(),J=D("td"),K=w(Jt),V=F(),W=w(Kt),Q=F(),X=D("span"),tt=F(),et=D("tr"),nt=D("td"),nt.textContent="Дата/время:",ot=F(),lt=D("td"),st=w(Vt),rt=F(),it=D("tr"),at=D("td"),at.textContent="Вид ДТП:",pt=F(),ct=D("td"),dt=w(Wt),ut=F(),_t=D("tr"),ht=D("td"),ht.textContent="Нарушения:",vt=F(),ft=D("td"),mt=D("ul");for(let t=0;t<ee.length;t+=1)ee[t].c();yt=F(),gt=D("tr"),bt=D("td"),bt.textContent="Условия:",kt=F(),jt=D("td"),ne&&ne.c(),Tt=F(),oe&&oe.c(),Et=F(),le&&le.c(),Ot=F(),se&&se.c(),zt=F(),Mt=D("tr"),Pt=D("td"),Pt.textContent="Количество погибших/раненых:",$t=F(),qt=D("td"),St=D("b"),Ht=w(Qt),Bt=w("/"),Ut=w(Xt),z(n,"class","pLine"),z(c,"class","first svelte-ipyqnf"),z(m,"class","first svelte-ipyqnf"),z($,"class","first svelte-ipyqnf"),z(R,"class","first svelte-ipyqnf"),z(X,"title","Скопировать в буфер обмена"),z(X,"class","leaflet-gmx-icon-copy"),z(nt,"class","first svelte-ipyqnf"),z(at,"class","first svelte-ipyqnf"),z(ht,"class","first svelte-ipyqnf"),z(bt,"class","first svelte-ipyqnf"),z(Pt,"class","first svelte-ipyqnf"),z(i,"class","table"),z(r,"class","featureCont"),z(e,"class","mvsPopup svelte-ipyqnf")},m(h,j,C){x(h,e,j),k(e,n),k(n,o),k(o,l),k(e,s),k(e,r),k(r,i),k(i,a),k(a,p),k(p,c),k(p,d),k(p,u),k(u,_),k(a,v),k(a,f),k(f,m),k(f,y),k(f,g),k(g,b),k(g,L),k(g,T),k(a,O),k(a,M),k(M,$),k(M,q),k(M,S),k(S,H),k(H,B),k(S,U),k(S,N),k(N,A),k(S,I),k(a,G),k(a,Z),k(Z,R),k(Z,Y),k(Z,J),k(J,K),k(J,V),k(J,W),k(J,Q),k(J,X),k(a,tt),k(a,et),k(et,nt),k(et,ot),k(et,lt),k(lt,st),k(a,rt),k(a,it),k(it,at),k(it,pt),k(it,ct),k(ct,dt),k(a,ut),k(a,_t),k(_t,ht),k(_t,vt),k(_t,ft),k(ft,mt);for(let t=0;t<ee.length;t+=1)ee[t].m(mt,null);k(a,yt),k(a,gt),k(gt,bt),k(gt,kt),k(gt,jt),ne&&ne.m(jt,null),k(jt,Tt),oe&&oe.m(jt,null),k(jt,Et),le&&le.m(jt,null),k(jt,Ot),se&&se.m(jt,null),k(a,zt),k(a,Mt),k(Mt,Pt),k(Mt,$t),k(Mt,qt),k(qt,St),k(St,Ht),k(St,Bt),k(St,Ut),C&&Nt(),Nt=E(X,"click",t[1])},p(t,[e]){if(1&e&&At!==(At=(t[0].name||t[0].dtvp||"")+"")&&P(l,At),1&e&&It!==(It=(t[0].sid||t[0].id_stat||t[0].id_skpdi||"")+"")&&P(_,It),1&e&&Gt!==(Gt=(t[0].district||"")+"")&&P(b,Gt),1&e&&Zt!==(Zt=(t[0].dor||"")+"")&&P(T,Zt),1&e&&Rt!==(Rt=(t[0].km||0)+"")&&P(B,Rt),1&e&&Yt!==(Yt=(t[0].m||0)+"")&&P(A,Yt),1&e&&Jt!==(Jt=t[0].lat+"")&&P(K,Jt),1&e&&Kt!==(Kt=t[0].lon+"")&&P(W,Kt),1&e&&Vt!==(Vt=(t[0].collision_date||t[0].dtp_date||"")+"")&&P(st,Vt),1&e&&Wt!==(Wt=(t[0].dtvp||"")+"")&&P(dt,Wt),4&e){let n;for(te=t[2],n=0;n<te.length;n+=1){const o=xt(t,te,n);ee[n]?ee[n].p(o,e):(ee[n]=Lt(o),ee[n].c(),ee[n].m(mt,null))}for(;n<ee.length;n+=1)ee[n].d(1);ee.length=te.length}t[0].spog?ne?ne.p(t,e):(ne=Ct(t),ne.c(),ne.m(jt,Tt)):ne&&(ne.d(1),ne=null),t[0].s_pch?oe?oe.p(t,e):(oe=Dt(t),oe.c(),oe.m(jt,Et)):oe&&(oe.d(1),oe=null),t[0].osv?le?le.p(t,e):(le=wt(t),le.c(),le.m(jt,Ot)):le&&(le.d(1),le=null),t[0].ndu?se?se.p(t,e):(se=Ft(t),se.c(),se.m(jt,null)):se&&(se.d(1),se=null),1&e&&Qt!==(Qt=t[0].pog+"")&&P(Ht,Qt),1&e&&Xt!==(Xt=t[0].ran+"")&&P(Ut,Xt)},i:h,o:h,d(t){t&&j(e),C(ee,t),ne&&ne.d(),oe&&oe.d(),le&&le.d(),se&&se.d(),Nt()}}}function Et(t,e,n){let o,{showModal:l=!1}=e,{prp:s}=e;s.skpdiFiles;I(()=>{l&&(o=new bt({target:document.body,props:{data:s.skpdiFiles}}),o.$on("close",t=>{o.$destroy(),n(3,l=!1)}))});const r=(s.tsInfo||[]).map(t=>{let e=t.ts_uch||[];return{ts:"Осталось на месте ДТП"!==t.ts?t.ts:"",arr:e.map(t=>({k_uch:t.k_uch||"",npdd:"Нет нарушений"!==t.npdd?t.npdd:"",sop_npdd:"Нет нарушений"!==t.sop_npdd?t.sop_npdd:""}))}});return t.$set=t=>{"showModal"in t&&n(3,l=t.showModal),"prp"in t&&n(0,s=t.prp)},[s,t=>{navigator.clipboard.writeText(t.target.parentNode.textContent).catch(t=>{console.log("Something went wrong",t)})},r,l]}class Ot extends _t{constructor(t){super(),ut(this,t,Et,Tt,g,{showModal:3,prp:0})}}const zt=window.L,Mt=zt.popup();let Pt;const $t=zt.featureGroup([]);function qt(t,e,n){const o=t.slice();return o[6]=e[n],o}function St(t,e,n){const o=t.slice();return o[6]=e[n],o}function Ht(t){let e,n=t[1].collisionTypes,o=[];for(let e=0;e<n.length;e+=1)o[e]=Bt(St(t,n,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=T()},m(t,n){for(let e=0;e<o.length;e+=1)o[e].m(t,n);x(t,e,n)},p(t,l){if(2&l){let s;for(n=t[1].collisionTypes,s=0;s<n.length;s+=1){const r=St(t,n,s);o[s]?o[s].p(r,l):(o[s]=Bt(r),o[s].c(),o[s].m(e.parentNode,e))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(t){C(o,t),t&&j(e)}}}function Bt(t){let e,n,o=(t[6].collisionType||"")+"";return{c(){e=D("li"),n=w(o)},m(t,o){x(t,e,o),k(e,n)},p(t,e){2&e&&o!==(o=(t[6].collisionType||"")+"")&&P(n,o)},d(t){t&&j(e)}}}function Ut(t){let e,n=t[1].uchs,o=[];for(let e=0;e<n.length;e+=1)o[e]=Nt(qt(t,n,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=T()},m(t,n){for(let e=0;e<o.length;e+=1)o[e].m(t,n);x(t,e,n)},p(t,l){if(2&l){let s;for(n=t[1].uchs,s=0;s<n.length;s+=1){const r=qt(t,n,s);o[s]?o[s].p(r,l):(o[s]=Nt(r),o[s].c(),o[s].m(e.parentNode,e))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(t){C(o,t),t&&j(e)}}}function Nt(t){let e,n,o,l,s,r,i,a,p=(t[6].collisionPartyCategory||"")+"",c=(t[6].collisionPartyCond||"")+"";return{c(){e=D("li"),n=w(p),o=F(),l=D("b"),s=D("i"),r=w("("),i=w(c),a=w(")")},m(t,p){x(t,e,p),k(e,n),k(e,o),k(e,l),k(l,s),k(s,r),k(s,i),k(s,a)},p(t,e){2&e&&p!==(p=(t[6].collisionPartyCategory||"")+"")&&P(n,p),2&e&&c!==(c=(t[6].collisionPartyCond||"")+"")&&P(i,c)},d(t){t&&j(e)}}}function At(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,v,f,y,g,b,L,C,T,O,M,$,q,S,H,B,U,N,A,I,G,Z,R,Y,J,K,V,W,Q,X,tt,et,nt,ot,lt,st,rt,it,at,pt,ct,dt,ut,_t,ht,vt,ft,mt,yt,gt,bt,kt,xt,jt=(t[1].name||t[1].dtvp||"")+"",Lt=(t[1].sid||t[1].id_stat||t[1].id_skpdi||"")+"",Ct=(t[1].km||0)+"",Dt=(t[1].m||0)+"",wt=t[1].lat+"",Ft=t[1].lon+"",Tt=(t[1].collision_date||t[1].dtp_date||"")+"",Et=(t[1].collision_context||t[1].dtp_date||"")+"",Ot=t[1].collisionTypes&&t[1].collisionTypes.length&&Ht(t),zt=t[1].uchs&&t[1].uchs.length&&Ut(t);return{c(){e=D("div"),n=D("div"),o=D("b"),l=w(jt),s=F(),r=D("div"),i=D("table"),a=D("tbody"),p=D("tr"),c=D("td"),c.textContent="ID:",d=F(),u=D("td"),_=w(Lt),v=F(),f=D("tr"),y=D("td"),y.textContent="Пикетаж:",g=F(),b=D("td"),L=D("b"),C=w(Ct),T=w(" км. "),O=D("b"),M=w(Dt),$=w(" м."),q=F(),S=D("tr"),H=D("td"),H.textContent="Координаты:",B=F(),U=D("td"),N=w(wt),A=F(),I=w(Ft),G=F(),Z=D("span"),R=F(),Y=D("tr"),J=D("td"),J.textContent="Дата/время:",K=F(),V=D("td"),W=w(Tt),Q=F(),X=D("tr"),tt=D("td"),et=D("div"),et.textContent="Условия ДТП:",nt=F(),ot=D("div"),lt=w(Et),st=F(),rt=D("tr"),it=D("td"),it.textContent="Нарушения:",at=F(),pt=D("td"),ct=D("ul"),Ot&&Ot.c(),dt=F(),ut=D("tr"),_t=D("td"),_t.textContent="Участники:",ht=F(),vt=D("td"),ft=D("ul"),zt&&zt.c(),mt=F(),yt=D("tr"),gt=D("td"),bt=D("button"),kt=w("Фото и схемы"),z(n,"class","pLine"),z(c,"class","first"),z(y,"class","first"),z(H,"class","first"),z(Z,"title","Скопировать в буфер обмена"),z(Z,"class","leaflet-gmx-icon-copy"),z(J,"class","first"),z(et,"class","first"),z(tt,"colspan","2"),z(it,"class","first"),z(_t,"class","first"),z(bt,"class","primary svelte-1aipaym"),bt.disabled=t[2],z(gt,"class","center"),z(gt,"colspan","2"),z(i,"class","table"),z(r,"class","featureCont"),z(e,"class","mvsPopup")},m(h,j,D){x(h,e,j),k(e,n),k(n,o),k(o,l),k(e,s),k(e,r),k(r,i),k(i,a),k(a,p),k(p,c),k(p,d),k(p,u),k(u,_),k(a,v),k(a,f),k(f,y),k(f,g),k(f,b),k(b,L),k(L,C),k(b,T),k(b,O),k(O,M),k(b,$),k(a,q),k(a,S),k(S,H),k(S,B),k(S,U),k(U,N),k(U,A),k(U,I),k(U,G),k(U,Z),k(a,R),k(a,Y),k(Y,J),k(Y,K),k(Y,V),k(V,W),k(a,Q),k(a,X),k(X,tt),k(tt,et),k(tt,nt),k(tt,ot),k(ot,lt),k(a,st),k(a,rt),k(rt,it),k(rt,at),k(rt,pt),k(pt,ct),Ot&&Ot.m(ct,null),k(a,dt),k(a,ut),k(ut,_t),k(ut,ht),k(ut,vt),k(vt,ft),zt&&zt.m(ft,null),k(a,mt),k(a,yt),k(yt,gt),k(gt,bt),k(bt,kt),D&&m(xt),xt=[E(Z,"click",t[3]),E(bt,"click",t[5])]},p(t,[e]){2&e&&jt!==(jt=(t[1].name||t[1].dtvp||"")+"")&&P(l,jt),2&e&&Lt!==(Lt=(t[1].sid||t[1].id_stat||t[1].id_skpdi||"")+"")&&P(_,Lt),2&e&&Ct!==(Ct=(t[1].km||0)+"")&&P(C,Ct),2&e&&Dt!==(Dt=(t[1].m||0)+"")&&P(M,Dt),2&e&&wt!==(wt=t[1].lat+"")&&P(N,wt),2&e&&Ft!==(Ft=t[1].lon+"")&&P(I,Ft),2&e&&Tt!==(Tt=(t[1].collision_date||t[1].dtp_date||"")+"")&&P(W,Tt),2&e&&Et!==(Et=(t[1].collision_context||t[1].dtp_date||"")+"")&&P(lt,Et),t[1].collisionTypes&&t[1].collisionTypes.length?Ot?Ot.p(t,e):(Ot=Ht(t),Ot.c(),Ot.m(ct,null)):Ot&&(Ot.d(1),Ot=null),t[1].uchs&&t[1].uchs.length?zt?zt.p(t,e):(zt=Ut(t),zt.c(),zt.m(ft,null)):zt&&(zt.d(1),zt=null),4&e&&(bt.disabled=t[2])},i:h,o:h,d(t){t&&j(e),Ot&&Ot.d(),zt&&zt.d(),m(xt)}}}function It(t,e,n){let o,{showModal:l=!1}=e,{prp:s}=e,r=s.files&&s.files.length?"":"disabled";I(()=>{n(2,r=s.files&&s.files.length?"":"disabled"),l&&(o=new bt({target:document.body,props:{data:s.files}}),o.$on("close",t=>{o.$destroy(),n(0,l=!1)}))});return t.$set=t=>{"showModal"in t&&n(0,l=t.showModal),"prp"in t&&n(1,s=t.prp)},[l,s,r,t=>{navigator.clipboard.writeText(t.target.parentNode.textContent).catch(t=>{console.log("Something went wrong",t)})},o,()=>n(0,l=!0)]}$t._needHeat={radius:19,blur:11.26,minOpacity:.34},$t.checkZoom=t=>{Object.keys($t._layers).length?t<12&&$t.setFilter(Pt):t>11&&$t.setFilter(Pt)},$t.setFilter=t=>{$t.clearLayers(),Pt=t||[];let e=[],n=[];$t._group&&($t._group.getLayers().forEach(t=>{let o=t.options.props,l=0;Pt.forEach(t=>{"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===o.collision_type).length)&&l++:"date"===t.type&&o.date>=t.zn[0]&&o.date<t.zn[1]&&l++}),l===Pt.length&&(e.push(t),n.push(t._latlng))}),$t._needHeat?($t._map.addLayer($t._heat),$t._heat.setLatLngs(n),$t._heat.setOptions($t._needHeat),$t._map._zoom>11&&$t.addLayer(zt.layerGroup(e))):($t.addLayer(zt.layerGroup(e)),$t._map.removeLayer($t._heat)))},$t.on("remove",t=>{$t._map.removeLayer($t._heat),$t.clearLayers()}).on("add",t=>{$t._heat=zt.heatLayer([],{gradient:{.1:"blue",.4:"lime",1:"red"}}),fetch("https://dtp.mvs.group/scripts/index.php?request=get_stat_gipdd",{}).then(t=>t.json()).then(t=>{let e={collision_type:{},iconType:{}},n=[],o=t.map(t=>{let o=t.iconType||0,l=!1,s="#2F4F4F";o&&(l=o%2==0,o>=1&&o<=6?s="#8B4513":7===o||8===o?s="#228B22":o>=9&&o<=14?s="#8B4513":15===o||16===o?s="#7B68EE":17!==o&&18!==o||(s="#2F4F4F")),t.lat&&t.lon||(console.log("_______",t),t.lat=t.lon=0);let r=e.collision_type[t.collision_type];r?r++:r=1,e.collision_type[t.collision_type]=r,e.iconType[t.collision_type]=o;let i=zt.latLng(t.lat,t.lon,l?1:.5);return n.push(i),new _(i,{props:t,radius:6,stroke:l,fillColor:s}).bindPopup(Mt).on("popupopen",t=>{var e;e=t.target.options.props.id,fetch("https://dtp.mvs.group/scripts/index.php?request=get_dtp_id&id="+e+"&type=gibdd",{}).then(t=>t.json()).then(t=>{let e=zt.DomUtil.create("div");const n=new Ot({target:e,props:{prp:t}});Mt._svObj=n,Mt.setContent(e)})}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});$t.addLayer($t._heat),$t._heat.setLatLngs(n),$t._heat.setOptions($t._needHeat),$t._opt=e,$t._group=zt.layerGroup(o),Pt?$t.setFilter(Pt):$t._map._zoom>11&&$t.addLayer($t._group),$t._refreshFilters()})});class Gt extends _t{constructor(t){super(),ut(this,t,It,At,g,{showModal:0,prp:1})}}const Zt=window.L,Rt=Zt.popup();let Yt;const Jt=Zt.featureGroup([]);function Kt(t,e,n){const o=t.slice();return o[6]=e[n],o[8]=n,o}function Vt(t){let e,n,o,l,s,r="gibdd"===t[6].type?"ГИБДД":"СКПДИ";return{c(){e=D("button"),n=w(r),z(e,"class",o=b(t[2]===t[8]?"current":"")+" svelte-txaali"),e.value=l=t[8]},m(o,l,r){x(o,e,l),k(e,n),r&&s(),s=E(e,"click",t[4])},p(t,l){1&l&&r!==(r="gibdd"===t[6].type?"ГИБДД":"СКПДИ")&&P(n,r),4&l&&o!==(o=b(t[2]===t[8]?"current":"")+" svelte-txaali")&&z(e,"class",o)},d(t){t&&j(e),s()}}}function Wt(t){let e;const n=new Gt({props:{prp:t[3]}});return{c(){at(n.$$.fragment)},m(t,o){pt(n,t,o),e=!0},p(t,e){const o={};8&e&&(o.prp=t[3]),n.$set(o)},i(t){e||(rt(n.$$.fragment,t),e=!0)},o(t){it(n.$$.fragment,t),e=!1},d(t){ct(n,t)}}}function Qt(t){let e;const n=new Ot({props:{prp:t[3]}});return{c(){at(n.$$.fragment)},m(t,o){pt(n,t,o),e=!0},p(t,e){const o={};8&e&&(o.prp=t[3]),n.$set(o)},i(t){e||(rt(n.$$.fragment,t),e=!0)},o(t){it(n.$$.fragment,t),e=!1},d(t){ct(n,t)}}}function Xt(t){let e,n,o,l,s,r,i,a,p,c,d=t[0]._cur,u=[];for(let e=0;e<d.length;e+=1)u[e]=Vt(Kt(t,d,e));const _=[Qt,Wt],h=[];function v(t,e){return"gibdd"===t[0]._cur[t[2]].type?0:1}return i=v(t),a=h[i]=_[i](t),{c(){e=D("div"),n=D("div"),o=D("a"),o.textContent="×",l=F(),s=D("div");for(let t=0;t<u.length;t+=1)u[t].c();r=F(),a.c(),z(o,"class","leaflet-popup-close-button"),z(o,"href","#close"),z(n,"class","close"),z(s,"class","pLine"),z(e,"class","mvsPopup")},m(a,d,_){x(a,e,d),k(e,n),k(n,o),k(e,l),k(e,s);for(let t=0;t<u.length;t+=1)u[t].m(s,null);var v;k(e,r),h[i].m(e,null),p=!0,_&&c(),c=E(o,"click",(v=function(){y(t[1])&&t[1].apply(this,arguments)},function(t){return t.preventDefault(),v.call(this,t)}))},p(n,[o]){if(t=n,21&o){let e;for(d=t[0]._cur,e=0;e<d.length;e+=1){const n=Kt(t,d,e);u[e]?u[e].p(n,o):(u[e]=Vt(n),u[e].c(),u[e].m(s,null))}for(;e<u.length;e+=1)u[e].d(1);u.length=d.length}let l=i;i=v(t),i===l?h[i].p(t,o):(lt(),it(h[l],1,1,()=>{h[l]=null}),st(),a=h[i],a||(a=h[i]=_[i](t),a.c()),rt(a,1),a.m(e,null))},i(t){p||(rt(a),p=!0)},o(t){it(a),p=!1},d(t){t&&j(e),C(u,t),h[i].d(),c()}}}function te(t,e,n){let{prp:o}=e,{closeMe:l=(()=>{})}=e,s=0,r={};const i=t=>{let e=o._cur[t],l=e.type,s="https://dtp.mvs.group/scripts/index.php?request=get_dtp_id&id="+e.id+"&type="+l;fetch(s,{}).then(t=>t.json()).then(t=>{n(3,r=t)})};return i(s),t.$set=t=>{"prp"in t&&n(0,o=t.prp),"closeMe"in t&&n(1,l=t.closeMe)},[o,l,s,r,t=>{let e=t.target,o=Number(e.value);s!==o&&(n(2,s=o),i(s))}]}Jt._needHeat={radius:19,blur:11.26,minOpacity:.34},Jt.checkZoom=t=>{Object.keys(Jt._layers).length?t<12&&Jt.setFilter(Yt):t>11&&Jt.setFilter(Yt)},Jt.setFilter=t=>{Jt.clearLayers(),Yt=t||[];let e=[],n=[];Jt._group&&(Jt._group.getLayers().forEach(t=>{let o=t.options.props,l=0;Yt.forEach(t=>{"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===o.collision_type).length)&&l++:"date"===t.type&&o.date>=t.zn[0]&&o.date<t.zn[1]&&l++}),l===Yt.length&&(e.push(t),n.push(t._latlng))}),Jt._needHeat?(Jt._map.addLayer(Jt._heat),Jt._heat.setLatLngs(n),Jt._heat.setOptions(Jt._needHeat),Jt._map._zoom>11&&Jt.addLayer(Zt.layerGroup(e))):(Jt.addLayer(Zt.layerGroup(e)),Jt._map.removeLayer(Jt._heat)))},Jt.on("remove",()=>{Jt._map.removeLayer(Jt._heat),Jt.clearLayers()}).on("add",t=>{Jt._heat=Zt.heatLayer([]),fetch("https://dtp.mvs.group/scripts/index.php?request=get_skpdi",{}).then(t=>t.json()).then(t=>{let e={collision_type:{},iconType:{}},n=[],o=t.map(t=>{let o=t.iconType||0,l=!1,s="#2F4F4F";o&&(l=o%2==0,o>=1&&o<=6?s="#8B4513":7===o||8===o?s="#228B22":o>=9&&o<=14?s="#8B4513":15===o||16===o?s="#7B68EE":17!==o&&18!==o||(s="#2F4F4F")),t.lat&&t.lon||(console.log("_______",t),t.lat=t.lon=0);let r=e.collision_type[t.collision_type];r?r++:r=1,e.collision_type[t.collision_type]=r,e.iconType[t.collision_type]=o;let i=Zt.latLng(t.lat,t.lon,l?1:.5);return n.push(i),new _(i,{props:t,radius:6,box:!0,stroke:l,fillColor:s}).bindPopup(Rt).on("popupopen",t=>{var e;e=t.target.options.props.id,fetch("https://dtp.mvs.group/scripts/index.php?request=get_dtp_id&id="+e+"&type=skpdi",{}).then(t=>t.json()).then(t=>{let e=Zt.DomUtil.create("div");const n=new Gt({target:e,props:{prp:t}});Rt._svObj=n,Rt.setContent(e)})}).on("popupclose",t=>{console.log("popupclose",t),t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});Jt.addLayer(Jt._heat),Jt._heat.setLatLngs(n),Jt._heat.setOptions(Jt._needHeat),Jt._opt=e,Jt._group=Zt.layerGroup(o),Yt?Jt.setFilter(Yt):Jt.addLayer(Jt._group),Jt.checkZoom(Jt._map._zoom),Jt._refreshFilters()})});class ee extends _t{constructor(t){super(),ut(this,t,te,Xt,g,{prp:0,closeMe:1})}}const ne=window.L,oe=ne.popup();let le;const se=ne.featureGroup([]);function re(t,e,n){const o=t.slice();return o[138]=e[n],o}function ie(t,e,n){const o=t.slice();return o[138]=e[n],o}function ae(t,e,n){const o=t.slice();return o[138]=e[n],o}function pe(t,e,n){const o=t.slice();return o[138]=e[n],o}function ce(t,e,n){const o=t.slice();return o[149]=e[n],o}function de(t,e,n){const o=t.slice();return o[138]=e[n],o}function ue(t,e,n){const o=t.slice();return o[138]=e[n],o}function _e(t,e,n){const o=t.slice();return o[138]=e[n],o}function he(t,e,n){const o=t.slice();return o[149]=e[n],o}function ve(t,e,n){const o=t.slice();return o[138]=e[n],o}function fe(t,e,n){const o=t.slice();return o[138]=e[n],o}function me(t,e,n){const o=t.slice();return o[138]=e[n],o}function ye(t,e,n){const o=t.slice();return o[149]=e[n],o}function ge(t,e,n){const o=t.slice();return o[138]=e[n],o}function be(t,e,n){const o=t.slice();return o[138]=e[n],o}function ke(t,e,n){const o=t.slice();return o[138]=e[n],o}function xe(t,e,n){const o=t.slice();return o[138]=e[n],o}function je(t,e,n){const o=t.slice();return o[138]=e[n],o}function Le(t,e,n){const o=t.slice();return o[138]=e[n],o}function Ce(t,e,n){const o=t.slice();return o[138]=e[n],o}function De(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,y,g,b,L,T,O,M,P,$=t[62],q=[];for(let e=0;e<$.length;e+=1)q[e]=we(Ce(t,$,e));return{c(){e=D("div"),e.innerHTML="Фильтры - <b>ДТП Очаги(Picket)</b>",n=F(),o=D("div"),l=D("div"),s=w("ID Очага: "),r=D("input"),i=F(),a=D("div"),p=w("ID ДТП: "),c=D("input"),d=F(),u=D("div"),_=D("input"),v=D("label"),v.textContent="Hearths3",f=F(),y=D("input"),b=D("label"),b.textContent="Hearths5",L=F(),T=D("div"),O=D("select"),M=D("option"),M.textContent=`\n\t\t\t\t\t\tВсе дороги (${t[62].reduce(t[100],0)})\n\t\t\t\t\t`;for(let t=0;t<q.length;t+=1)q[t].c();z(e,"class","pLine svelte-1jsovbn"),z(r,"type","text"),r.value=t[13],z(r,"class","svelte-1jsovbn"),z(l,"class","pLine svelte-1jsovbn"),z(c,"type","text"),c.value=t[14],z(c,"class","svelte-1jsovbn"),z(a,"class","pLine svelte-1jsovbn"),z(_,"type","checkbox"),z(_,"id","ht_3"),_.checked=h=t[12].hearth3,z(_,"name","hearth3"),z(_,"class","svelte-1jsovbn"),z(v,"for","ht_3"),z(v,"class","svelte-1jsovbn"),z(y,"type","checkbox"),z(y,"id","ht_5"),y.checked=g=t[12].hearth5,z(y,"name","hearth5"),z(y,"class","svelte-1jsovbn"),z(b,"for","ht_5"),z(b,"class","svelte-1jsovbn"),z(u,"class","pLine svelte-1jsovbn"),M.__value="",M.value=M.__value,z(M,"class","svelte-1jsovbn"),z(O,"class","multiple_icon_typeTmp svelte-1jsovbn"),O.multiple=!0,void 0===t[11]&&W(()=>t[101].call(O)),z(T,"class","pLine svelte-1jsovbn"),z(o,"class","filtersCont svelte-1jsovbn")},m(h,g,j){x(h,e,g),x(h,n,g),x(h,o,g),k(o,l),k(l,s),k(l,r),k(o,i),k(o,a),k(a,p),k(a,c),k(o,d),k(o,u),k(u,_),k(u,v),k(u,f),k(u,y),k(u,b),k(o,L),k(o,T),k(T,O),k(O,M);for(let t=0;t<q.length;t+=1)q[t].m(O,null);S(O,t[11]),j&&m(P),P=[E(r,"input",t[66]),E(c,"input",t[65]),E(_,"change",t[67]),E(y,"change",t[67]),E(O,"change",t[101]),E(O,"change",t[64])]},p(t,e){if(8192&e[0]&&r.value!==t[13]&&(r.value=t[13]),16384&e[0]&&c.value!==t[14]&&(c.value=t[14]),4096&e[0]&&h!==(h=t[12].hearth3)&&(_.checked=h),4096&e[0]&&g!==(g=t[12].hearth5)&&(y.checked=g),1073741824&e[1]|1&e[2]){let n;for($=t[62],n=0;n<$.length;n+=1){const o=Ce(t,$,n);q[n]?q[n].p(o,e):(q[n]=we(o),q[n].c(),q[n].m(O,null))}for(;n<q.length;n+=1)q[n].d(1);q.length=$.length}2048&e[0]&&S(O,t[11])},d(t){t&&j(e),t&&j(n),t&&j(o),C(q,t),m(P)}}}function we(t){let e,n,o,l,s,r,i,a=t[138]+"",p=t[61].road[t[138]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(p),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[138],e.value=e.__value,z(e,"class",i="road_"+t[138]+" svelte-1jsovbn")},m(t,r){x(t,e,r),k(e,n),k(e,o),k(e,l),k(e,s)},p:h,d(t){t&&j(e)}}}function Fe(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,y,g,b,L,w,T,O,M,P,$,H,B=Object.keys(t[4]._opt.years).sort(),U=[];for(let e=0;e<B.length;e+=1)U[e]=Te(Le(t,B,e));let N=t[60],A=[];for(let e=0;e<N.length;e+=1)A[e]=Ee(je(t,N,e));return{c(){e=D("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (5)</b>",n=F(),o=D("div"),l=D("div"),s=D("fieldset"),r=D("legend"),r.textContent="Фильтрация по периодам:",i=F(),a=D("div"),p=D("input"),u=D("label"),u.textContent="Фильтрация по годам",_=F(),h=D("div");for(let t=0;t<U.length;t+=1)U[t].c();v=F(),f=D("div"),y=D("select"),g=D("option"),g.textContent=`\n\t\t\t\t\t\tВсе типы (${t[60].reduce(t[104],0)})\n\t\t\t\t\t`;for(let t=0;t<A.length;t+=1)A[t].c();b=F(),L=D("div"),w=D("select"),T=D("option"),T.textContent="Очаги все",O=D("option"),O.textContent="Только с погибшими",M=D("option"),M.textContent="Только с пострадавшими",P=D("option"),P.textContent="С пострадавшими или погибшими",$=D("option"),$.textContent="С пострадавшими и погибшими",z(e,"class","pLine svelte-1jsovbn"),z(p,"type","radio"),p.__value=c=1,p.value=p.__value,p.checked=d=1===t[24],z(p,"id","hearths_period_type_51"),z(p,"name","hearths_period_type_5"),z(p,"class","svelte-1jsovbn"),t[103][4].push(p),z(u,"for","hearths_period_type_51"),z(u,"class","svelte-1jsovbn"),z(h,"class","pLine margin svelte-1jsovbn"),z(a,"class","pLine type svelte-1jsovbn"),z(l,"class","pLine nowrap svelte-1jsovbn"),g.__value="",g.value=g.__value,z(g,"class","svelte-1jsovbn"),z(y,"class","multiple_icon_typeTmp svelte-1jsovbn"),y.multiple=!0,void 0===t[23]&&W(()=>t[105].call(y)),z(f,"class","pLine svelte-1jsovbn"),T.__value="",T.value=T.__value,O.__value="1",O.value=O.__value,M.__value="2",M.value=M.__value,P.__value="3",P.value=P.__value,$.__value="4",$.value=$.__value,z(w,"class","svelte-1jsovbn"),void 0===t[22]&&W(()=>t[106].call(w)),z(L,"class","pLine svelte-1jsovbn"),z(o,"class","filtersCont svelte-1jsovbn")},m(c,d,j){x(c,e,d),x(c,n,d),x(c,o,d),k(o,l),k(l,s),k(s,r),k(s,i),k(s,a),k(a,p),p.checked=p.__value===t[24],k(a,u),k(a,_),k(a,h);for(let t=0;t<U.length;t+=1)U[t].m(h,null);k(o,v),k(o,f),k(f,y),k(y,g);for(let t=0;t<A.length;t+=1)A[t].m(y,null);S(y,t[23]),k(o,b),k(o,L),k(L,w),k(w,T),k(w,O),k(w,M),k(w,P),k(w,$),q(w,t[22]),j&&m(H),H=[E(p,"change",t[76]),E(p,"change",t[102]),E(y,"change",t[105]),E(y,"change",t[76]),E(w,"change",t[106]),E(w,"change",t[76])]},p(t,e){if(16777216&e[0]&&d!==(d=1===t[24])&&(p.checked=d),16777216&e[0]&&(p.checked=p.__value===t[24]),50331664&e[0]|16384&e[2]){let n;for(B=Object.keys(t[4]._opt.years).sort(),n=0;n<B.length;n+=1){const o=Le(t,B,n);U[n]?U[n].p(o,e):(U[n]=Te(o),U[n].c(),U[n].m(h,null))}for(;n<U.length;n+=1)U[n].d(1);U.length=B.length}if(805306368&e[1]){let n;for(N=t[60],n=0;n<N.length;n+=1){const o=je(t,N,n);A[n]?A[n].p(o,e):(A[n]=Ee(o),A[n].c(),A[n].m(y,null))}for(;n<A.length;n+=1)A[n].d(1);A.length=N.length}8388608&e[0]&&S(y,t[23]),4194304&e[0]&&q(w,t[22])},d(l){l&&j(e),l&&j(n),l&&j(o),t[103][4].splice(t[103][4].indexOf(p),1),C(U,l),C(A,l),m(H)}}}function Te(t){let e,n,o,l,s,r,i,a=t[138]+"";return{c(){e=D("input"),s=D("label"),r=w(a),z(e,"type","checkbox"),z(e,"id","hearths_year_5"),e.checked=n=t[25][t[138]],e.disabled=o=2===t[24],z(e,"name",l=t[138]),z(e,"class","svelte-1jsovbn"),z(s,"for","hearths_year_5"),z(s,"class","svelte-1jsovbn")},m(n,o,l){x(n,e,o),x(n,s,o),k(s,r),l&&i(),i=E(e,"change",t[76])},p(t,s){33554448&s[0]&&n!==(n=t[25][t[138]])&&(e.checked=n),16777216&s[0]&&o!==(o=2===t[24])&&(e.disabled=o),16&s[0]&&l!==(l=t[138])&&z(e,"name",l),16&s[0]&&a!==(a=t[138]+"")&&P(r,a)},d(t){t&&j(e),t&&j(s),i()}}}function Ee(t){let e,n,o,l,s,r,i,a=t[138]+"",p=t[59].str_icon_type[t[138]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(p),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[138],e.value=e.__value,z(e,"class",i="icon_type_"+t[59].iconType[t[138]]+" svelte-1jsovbn")},m(t,r){x(t,e,r),k(e,n),k(e,o),k(e,l),k(e,s)},p:h,d(t){t&&j(e)}}}function Oe(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,y,g,b,L,w,T,O,M,P,$,H,B=Object.keys(t[5]._opt.years).sort(),U=[];for(let e=0;e<B.length;e+=1)U[e]=ze(xe(t,B,e));let N=t[58],A=[];for(let e=0;e<N.length;e+=1)A[e]=Me(ke(t,N,e));return{c(){e=D("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (3)</b>",n=F(),o=D("div"),l=D("div"),s=D("fieldset"),r=D("legend"),r.textContent="Фильтрация по периодам:",i=F(),a=D("div"),p=D("input"),u=D("label"),u.textContent="Фильтрация по годам",_=F(),h=D("div");for(let t=0;t<U.length;t+=1)U[t].c();v=F(),f=D("div"),y=D("select"),g=D("option"),g.textContent=`\n\t\t\t\t\t\tВсе типы (${t[58].reduce(t[108],0)})\n\t\t\t\t\t`;for(let t=0;t<A.length;t+=1)A[t].c();b=F(),L=D("div"),w=D("select"),T=D("option"),T.textContent="Очаги все",O=D("option"),O.textContent="Только с погибшими",M=D("option"),M.textContent="Только с пострадавшими",P=D("option"),P.textContent="С пострадавшими или погибшими",$=D("option"),$.textContent="С пострадавшими и погибшими",z(e,"class","pLine svelte-1jsovbn"),z(p,"type","radio"),p.__value=c=1,p.value=p.__value,p.checked=d=1===t[28],z(p,"id","hearths_period_type_31"),z(p,"name","hearths_period_type_3"),z(p,"class","svelte-1jsovbn"),t[103][3].push(p),z(u,"for","hearths_period_type_31"),z(u,"class","svelte-1jsovbn"),z(h,"class","pLine margin svelte-1jsovbn"),z(a,"class","pLine type svelte-1jsovbn"),z(l,"class","pLine nowrap svelte-1jsovbn"),g.__value="",g.value=g.__value,z(g,"class","svelte-1jsovbn"),z(y,"class","multiple_icon_typeTmp svelte-1jsovbn"),y.multiple=!0,void 0===t[27]&&W(()=>t[109].call(y)),z(f,"class","pLine svelte-1jsovbn"),T.__value="",T.value=T.__value,O.__value="1",O.value=O.__value,M.__value="2",M.value=M.__value,P.__value="3",P.value=P.__value,$.__value="4",$.value=$.__value,z(w,"class","svelte-1jsovbn"),void 0===t[26]&&W(()=>t[110].call(w)),z(L,"class","pLine svelte-1jsovbn"),z(o,"class","filtersCont svelte-1jsovbn")},m(c,d,j){x(c,e,d),x(c,n,d),x(c,o,d),k(o,l),k(l,s),k(s,r),k(s,i),k(s,a),k(a,p),p.checked=p.__value===t[28],k(a,u),k(a,_),k(a,h);for(let t=0;t<U.length;t+=1)U[t].m(h,null);k(o,v),k(o,f),k(f,y),k(y,g);for(let t=0;t<A.length;t+=1)A[t].m(y,null);S(y,t[27]),k(o,b),k(o,L),k(L,w),k(w,T),k(w,O),k(w,M),k(w,P),k(w,$),q(w,t[26]),j&&m(H),H=[E(p,"change",t[77]),E(p,"change",t[107]),E(y,"change",t[109]),E(y,"change",t[77]),E(w,"change",t[110]),E(w,"change",t[77])]},p(t,e){if(268435456&e[0]&&d!==(d=1===t[28])&&(p.checked=d),268435456&e[0]&&(p.checked=p.__value===t[28]),805306400&e[0]|32768&e[2]){let n;for(B=Object.keys(t[5]._opt.years).sort(),n=0;n<B.length;n+=1){const o=xe(t,B,n);U[n]?U[n].p(o,e):(U[n]=ze(o),U[n].c(),U[n].m(h,null))}for(;n<U.length;n+=1)U[n].d(1);U.length=B.length}if(201326592&e[1]){let n;for(N=t[58],n=0;n<N.length;n+=1){const o=ke(t,N,n);A[n]?A[n].p(o,e):(A[n]=Me(o),A[n].c(),A[n].m(y,null))}for(;n<A.length;n+=1)A[n].d(1);A.length=N.length}134217728&e[0]&&S(y,t[27]),67108864&e[0]&&q(w,t[26])},d(l){l&&j(e),l&&j(n),l&&j(o),t[103][3].splice(t[103][3].indexOf(p),1),C(U,l),C(A,l),m(H)}}}function ze(t){let e,n,o,l,s,r,i,a=t[138]+"";return{c(){e=D("input"),s=D("label"),r=w(a),z(e,"type","checkbox"),z(e,"id","hearths_year_3"),e.checked=n=t[29][t[138]],e.disabled=o=2===t[28],z(e,"name",l=t[138]),z(e,"class","svelte-1jsovbn"),z(s,"for","hearths_year_3"),z(s,"class","svelte-1jsovbn")},m(n,o,l){x(n,e,o),x(n,s,o),k(s,r),l&&i(),i=E(e,"change",t[77])},p(t,s){536870944&s[0]&&n!==(n=t[29][t[138]])&&(e.checked=n),268435456&s[0]&&o!==(o=2===t[28])&&(e.disabled=o),32&s[0]&&l!==(l=t[138])&&z(e,"name",l),32&s[0]&&a!==(a=t[138]+"")&&P(r,a)},d(t){t&&j(e),t&&j(s),i()}}}function Me(t){let e,n,o,l,s,r,i,a=t[138]+"",p=t[57].str_icon_type[t[138]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(p),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[138],e.value=e.__value,z(e,"class",i="icon_type_"+t[57].iconType[t[138]]+" svelte-1jsovbn")},m(t,r){x(t,e,r),k(e,n),k(e,o),k(e,l),k(e,s)},p:h,d(t){t&&j(e)}}}function Pe(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,y,g,b,L,w,T,O,M,P,$,H,B,U,N,A,I,G,Z,R=Object.keys(t[6]._opt.years).sort(),Y=[];for(let e=0;e<R.length;e+=1)Y[e]=$e(be(t,R,e));let J=Object.keys(t[6]._opt.years).sort(),K=[];for(let e=0;e<J.length;e+=1)K[e]=Se(ge(t,J,e));let V=t[56],Q=[];for(let e=0;e<V.length;e+=1)Q[e]=He(me(t,V,e));return{c(){e=D("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (Stat)</b>",n=F(),o=D("div"),l=D("div"),s=D("fieldset"),r=D("legend"),r.textContent="Фильтрация по периодам:",i=F(),a=D("div"),p=D("input"),u=D("label"),u.textContent="Фильтрация по годам",_=F(),h=D("div");for(let t=0;t<Y.length;t+=1)Y[t].c();v=F(),f=D("div"),y=D("input"),b=D("label"),b.textContent="Фильтрация по кварталам",L=F(),w=D("div");for(let t=0;t<K.length;t+=1)K[t].c();T=F(),O=D("div"),M=D("select"),P=D("option"),P.textContent=`\n\t\t\t\t\t\tВсе типы (${t[56].reduce(t[113],0)})\n\t\t\t\t\t`;for(let t=0;t<Q.length;t+=1)Q[t].c();$=F(),H=D("div"),B=D("select"),U=D("option"),U.textContent="Очаги все",N=D("option"),N.textContent="Только с погибшими",A=D("option"),A.textContent="Только с пострадавшими",I=D("option"),I.textContent="С пострадавшими или погибшими",G=D("option"),G.textContent="С пострадавшими и погибшими",z(e,"class","pLine svelte-1jsovbn"),z(p,"type","radio"),p.__value=c=1,p.value=p.__value,p.checked=d=1===t[32],z(p,"id","hearths_period_type_Stat1"),z(p,"name","hearths_period_type_Stat"),z(p,"class","svelte-1jsovbn"),t[103][2].push(p),z(u,"for","hearths_period_type_Stat1"),z(u,"class","svelte-1jsovbn"),z(h,"class","pLine margin svelte-1jsovbn"),z(a,"class","pLine type svelte-1jsovbn"),z(y,"type","radio"),y.__value=g=2,y.value=y.__value,z(y,"id","hearths_period_type_Stat2"),z(y,"name","hearths_period_type_Stat"),z(y,"class","svelte-1jsovbn"),t[103][2].push(y),z(b,"for","hearths_period_type_Stat2"),z(b,"class","svelte-1jsovbn"),z(w,"class","pLine margin svelte-1jsovbn"),z(f,"class","pLine type svelte-1jsovbn"),z(l,"class","pLine nowrap svelte-1jsovbn"),P.__value="",P.value=P.__value,z(P,"class","svelte-1jsovbn"),z(M,"class","multiple_icon_typeTmp svelte-1jsovbn"),M.multiple=!0,void 0===t[31]&&W(()=>t[114].call(M)),z(O,"class","pLine svelte-1jsovbn"),U.__value="",U.value=U.__value,N.__value="1",N.value=N.__value,A.__value="2",A.value=A.__value,I.__value="3",I.value=I.__value,G.__value="4",G.value=G.__value,z(B,"class","svelte-1jsovbn"),void 0===t[30]&&W(()=>t[115].call(B)),z(H,"class","pLine svelte-1jsovbn"),z(o,"class","filtersCont svelte-1jsovbn")},m(c,d,g){x(c,e,d),x(c,n,d),x(c,o,d),k(o,l),k(l,s),k(s,r),k(s,i),k(s,a),k(a,p),p.checked=p.__value===t[32],k(a,u),k(a,_),k(a,h);for(let t=0;t<Y.length;t+=1)Y[t].m(h,null);k(s,v),k(s,f),k(f,y),y.checked=y.__value===t[32],k(f,b),k(f,L),k(f,w);for(let t=0;t<K.length;t+=1)K[t].m(w,null);k(o,T),k(o,O),k(O,M),k(M,P);for(let t=0;t<Q.length;t+=1)Q[t].m(M,null);S(M,t[31]),k(o,$),k(o,H),k(H,B),k(B,U),k(B,N),k(B,A),k(B,I),k(B,G),q(B,t[30]),g&&m(Z),Z=[E(p,"change",t[78]),E(p,"change",t[111]),E(y,"change",t[78]),E(y,"change",t[112]),E(M,"change",t[114]),E(M,"change",t[78]),E(B,"change",t[115]),E(B,"change",t[78])]},p(t,e){if(2&e[1]&&d!==(d=1===t[32])&&(p.checked=d),2&e[1]&&(p.checked=p.__value===t[32]),64&e[0]|6&e[1]|65536&e[2]){let n;for(R=Object.keys(t[6]._opt.years).sort(),n=0;n<R.length;n+=1){const o=be(t,R,n);Y[n]?Y[n].p(o,e):(Y[n]=$e(o),Y[n].c(),Y[n].m(h,null))}for(;n<Y.length;n+=1)Y[n].d(1);Y.length=R.length}if(2&e[1]&&(y.checked=y.__value===t[32]),64&e[0]|10&e[1]|65536&e[2]){let n;for(J=Object.keys(t[6]._opt.years).sort(),n=0;n<J.length;n+=1){const o=ge(t,J,n);K[n]?K[n].p(o,e):(K[n]=Se(o),K[n].c(),K[n].m(w,null))}for(;n<K.length;n+=1)K[n].d(1);K.length=J.length}if(50331648&e[1]){let n;for(V=t[56],n=0;n<V.length;n+=1){const o=me(t,V,n);Q[n]?Q[n].p(o,e):(Q[n]=He(o),Q[n].c(),Q[n].m(M,null))}for(;n<Q.length;n+=1)Q[n].d(1);Q.length=V.length}1&e[1]&&S(M,t[31]),1073741824&e[0]&&q(B,t[30])},d(l){l&&j(e),l&&j(n),l&&j(o),t[103][2].splice(t[103][2].indexOf(p),1),C(Y,l),t[103][2].splice(t[103][2].indexOf(y),1),C(K,l),C(Q,l),m(Z)}}}function $e(t){let e,n,o,l,s,r,i,a=t[138]+"";return{c(){e=D("input"),s=D("label"),r=w(a),z(e,"type","checkbox"),z(e,"id","hearths_year_Stat"),e.checked=n=t[33][t[138]],e.disabled=o=2===t[32],z(e,"name",l=t[138]),z(e,"class","svelte-1jsovbn"),z(s,"for","hearths_year_Stat"),z(s,"class","svelte-1jsovbn")},m(n,o,l){x(n,e,o),x(n,s,o),k(s,r),l&&i(),i=E(e,"change",t[78])},p(t,s){64&s[0]|4&s[1]&&n!==(n=t[33][t[138]])&&(e.checked=n),2&s[1]&&o!==(o=2===t[32])&&(e.disabled=o),64&s[0]&&l!==(l=t[138])&&z(e,"name",l),64&s[0]&&a!==(a=t[138]+"")&&P(r,a)},d(t){t&&j(e),t&&j(s),i()}}}function qe(t){let e,n,o,l,s,r,i,a,p,c,d=t[149]+"",u=t[138]+"";return{c(){e=D("input"),s=D("label"),r=w(d),i=w(" кв. "),a=w(u),z(e,"type","checkbox"),z(e,"id","hearths_quarter_Stat"),e.checked=n=t[34][t[138]]&&t[34][t[138]][t[149]],e.disabled=o=1===t[32],z(e,"name",l=t[138]+"_"+t[149]),z(e,"class","svelte-1jsovbn"),z(s,"for",p="hearths_quarter_Stat_"+t[138]+"_"+t[149]),z(s,"class","svelte-1jsovbn")},m(n,o,l){x(n,e,o),x(n,s,o),k(s,r),k(s,i),k(s,a),l&&c(),c=E(e,"change",t[78])},p(t,i){64&i[0]|8&i[1]&&n!==(n=t[34][t[138]]&&t[34][t[138]][t[149]])&&(e.checked=n),2&i[1]&&o!==(o=1===t[32])&&(e.disabled=o),64&i[0]&&l!==(l=t[138]+"_"+t[149])&&z(e,"name",l),64&i[0]&&d!==(d=t[149]+"")&&P(r,d),64&i[0]&&u!==(u=t[138]+"")&&P(a,u),64&i[0]&&p!==(p="hearths_quarter_Stat_"+t[138]+"_"+t[149])&&z(s,"for",p)},d(t){t&&j(e),t&&j(s),c()}}}function Se(t){let e,n,o=Object.keys(t[6]._opt.years[t[138]]).sort(),l=[];for(let e=0;e<o.length;e+=1)l[e]=qe(ye(t,o,e));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=F(),n=D("br")},m(t,o){for(let e=0;e<l.length;e+=1)l[e].m(t,o);x(t,e,o),x(t,n,o)},p(t,n){if(64&n[0]|10&n[1]|65536&n[2]){let s;for(o=Object.keys(t[6]._opt.years[t[138]]).sort(),s=0;s<o.length;s+=1){const r=ye(t,o,s);l[s]?l[s].p(r,n):(l[s]=qe(r),l[s].c(),l[s].m(e.parentNode,e))}for(;s<l.length;s+=1)l[s].d(1);l.length=o.length}},d(t){C(l,t),t&&j(e),t&&j(n)}}}function He(t){let e,n,o,l,s,r,i,a=t[138]+"",p=t[55].str_icon_type[t[138]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(p),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[138],e.value=e.__value,z(e,"class",i="icon_type_"+t[55].iconType[t[138]]+" svelte-1jsovbn")},m(t,r){x(t,e,r),k(e,n),k(e,o),k(e,l),k(e,s)},p:h,d(t){t&&j(e)}}}function Be(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,y,g,b,L,w,T,O,M,P,$,H,B,U,N,A,I,G,Z,R=Object.keys(t[7]._opt.years).sort(),Y=[];for(let e=0;e<R.length;e+=1)Y[e]=Ue(fe(t,R,e));let J=Object.keys(t[7]._opt.years).sort(),K=[];for(let e=0;e<J.length;e+=1)K[e]=Ae(ve(t,J,e));let V=t[54],Q=[];for(let e=0;e<V.length;e+=1)Q[e]=Ie(_e(t,V,e));return{c(){e=D("div"),e.innerHTML="Фильтры - <b>ДТП Очаги (TMP)</b>",n=F(),o=D("div"),l=D("div"),s=D("fieldset"),r=D("legend"),r.textContent="Фильтрация по периодам:",i=F(),a=D("div"),p=D("input"),u=D("label"),u.textContent="Фильтрация по годам",_=F(),h=D("div");for(let t=0;t<Y.length;t+=1)Y[t].c();v=F(),f=D("div"),y=D("input"),b=D("label"),b.textContent="Фильтрация по кварталам",L=F(),w=D("div");for(let t=0;t<K.length;t+=1)K[t].c();T=F(),O=D("div"),M=D("select"),P=D("option"),P.textContent=`\n\t\t\t\t\t\tВсе типы (${t[54].reduce(t[118],0)})\n\t\t\t\t\t`;for(let t=0;t<Q.length;t+=1)Q[t].c();$=F(),H=D("div"),B=D("select"),U=D("option"),U.textContent="Очаги все",N=D("option"),N.textContent="Только с погибшими",A=D("option"),A.textContent="Только с пострадавшими",I=D("option"),I.textContent="С пострадавшими или погибшими",G=D("option"),G.textContent="С пострадавшими и погибшими",z(e,"class","pLine svelte-1jsovbn"),z(p,"type","radio"),p.__value=c=1,p.value=p.__value,p.checked=d=1===t[37],z(p,"id","hearths_period_type_tmp1"),z(p,"name","hearths_period_type_tmp"),z(p,"class","svelte-1jsovbn"),t[103][1].push(p),z(u,"for","hearths_period_type_tmp1"),z(u,"class","svelte-1jsovbn"),z(h,"class","pLine margin svelte-1jsovbn"),z(a,"class","pLine type svelte-1jsovbn"),z(y,"type","radio"),y.__value=g=2,y.value=y.__value,z(y,"id","hearths_period_type_tmp2"),z(y,"name","hearths_period_type_tmp"),z(y,"class","svelte-1jsovbn"),t[103][1].push(y),z(b,"for","hearths_period_type_tmp2"),z(b,"class","svelte-1jsovbn"),z(w,"class","pLine margin svelte-1jsovbn"),z(f,"class","pLine type svelte-1jsovbn"),z(l,"class","pLine nowrap svelte-1jsovbn"),P.__value="",P.value=P.__value,z(P,"class","svelte-1jsovbn"),z(M,"class","multiple_icon_typeTmp svelte-1jsovbn"),M.multiple=!0,void 0===t[36]&&W(()=>t[119].call(M)),z(O,"class","pLine svelte-1jsovbn"),U.__value="",U.value=U.__value,N.__value="1",N.value=N.__value,A.__value="2",A.value=A.__value,I.__value="3",I.value=I.__value,G.__value="4",G.value=G.__value,z(B,"class","svelte-1jsovbn"),void 0===t[35]&&W(()=>t[120].call(B)),z(H,"class","pLine svelte-1jsovbn"),z(o,"class","filtersCont svelte-1jsovbn")},m(c,d,g){x(c,e,d),x(c,n,d),x(c,o,d),k(o,l),k(l,s),k(s,r),k(s,i),k(s,a),k(a,p),p.checked=p.__value===t[37],k(a,u),k(a,_),k(a,h);for(let t=0;t<Y.length;t+=1)Y[t].m(h,null);k(s,v),k(s,f),k(f,y),y.checked=y.__value===t[37],k(f,b),k(f,L),k(f,w);for(let t=0;t<K.length;t+=1)K[t].m(w,null);k(o,T),k(o,O),k(O,M),k(M,P);for(let t=0;t<Q.length;t+=1)Q[t].m(M,null);S(M,t[36]),k(o,$),k(o,H),k(H,B),k(B,U),k(B,N),k(B,A),k(B,I),k(B,G),q(B,t[35]),g&&m(Z),Z=[E(p,"change",t[79]),E(p,"change",t[116]),E(y,"change",t[79]),E(y,"change",t[117]),E(M,"change",t[119]),E(M,"change",t[79]),E(B,"change",t[120]),E(B,"change",t[79])]},p(t,e){if(64&e[1]&&d!==(d=1===t[37])&&(p.checked=d),64&e[1]&&(p.checked=p.__value===t[37]),128&e[0]|192&e[1]|131072&e[2]){let n;for(R=Object.keys(t[7]._opt.years).sort(),n=0;n<R.length;n+=1){const o=fe(t,R,n);Y[n]?Y[n].p(o,e):(Y[n]=Ue(o),Y[n].c(),Y[n].m(h,null))}for(;n<Y.length;n+=1)Y[n].d(1);Y.length=R.length}if(64&e[1]&&(y.checked=y.__value===t[37]),128&e[0]|320&e[1]|131072&e[2]){let n;for(J=Object.keys(t[7]._opt.years).sort(),n=0;n<J.length;n+=1){const o=ve(t,J,n);K[n]?K[n].p(o,e):(K[n]=Ae(o),K[n].c(),K[n].m(w,null))}for(;n<K.length;n+=1)K[n].d(1);K.length=J.length}if(12582912&e[1]){let n;for(V=t[54],n=0;n<V.length;n+=1){const o=_e(t,V,n);Q[n]?Q[n].p(o,e):(Q[n]=Ie(o),Q[n].c(),Q[n].m(M,null))}for(;n<Q.length;n+=1)Q[n].d(1);Q.length=V.length}32&e[1]&&S(M,t[36]),16&e[1]&&q(B,t[35])},d(l){l&&j(e),l&&j(n),l&&j(o),t[103][1].splice(t[103][1].indexOf(p),1),C(Y,l),t[103][1].splice(t[103][1].indexOf(y),1),C(K,l),C(Q,l),m(Z)}}}function Ue(t){let e,n,o,l,s,r,i,a=t[138]+"";return{c(){e=D("input"),s=D("label"),r=w(a),z(e,"type","checkbox"),z(e,"id","hearths_year_tmp"),e.checked=n=t[38][t[138]],e.disabled=o=2===t[37],z(e,"name",l=t[138]),z(e,"class","svelte-1jsovbn"),z(s,"for","hearths_year_tmp"),z(s,"class","svelte-1jsovbn")},m(n,o,l){x(n,e,o),x(n,s,o),k(s,r),l&&i(),i=E(e,"change",t[79])},p(t,s){128&s[0]|128&s[1]&&n!==(n=t[38][t[138]])&&(e.checked=n),64&s[1]&&o!==(o=2===t[37])&&(e.disabled=o),128&s[0]&&l!==(l=t[138])&&z(e,"name",l),128&s[0]&&a!==(a=t[138]+"")&&P(r,a)},d(t){t&&j(e),t&&j(s),i()}}}function Ne(t){let e,n,o,l,s,r,i,a,p,c,d=t[149]+"",u=t[138]+"";return{c(){e=D("input"),s=D("label"),r=w(d),i=w(" кв. "),a=w(u),z(e,"type","checkbox"),z(e,"id","hearths_quarter_tmp"),e.checked=n=t[39][t[138]]&&t[39][t[138]][t[149]],e.disabled=o=1===t[37],z(e,"name",l=t[138]+"_"+t[149]),z(e,"class","svelte-1jsovbn"),z(s,"for",p="hearths_quarter_tmp_"+t[138]+"_"+t[149]),z(s,"class","svelte-1jsovbn")},m(n,o,l){x(n,e,o),x(n,s,o),k(s,r),k(s,i),k(s,a),l&&c(),c=E(e,"change",t[79])},p(t,i){128&i[0]|256&i[1]&&n!==(n=t[39][t[138]]&&t[39][t[138]][t[149]])&&(e.checked=n),64&i[1]&&o!==(o=1===t[37])&&(e.disabled=o),128&i[0]&&l!==(l=t[138]+"_"+t[149])&&z(e,"name",l),128&i[0]&&d!==(d=t[149]+"")&&P(r,d),128&i[0]&&u!==(u=t[138]+"")&&P(a,u),128&i[0]&&p!==(p="hearths_quarter_tmp_"+t[138]+"_"+t[149])&&z(s,"for",p)},d(t){t&&j(e),t&&j(s),c()}}}function Ae(t){let e,n,o=Object.keys(t[7]._opt.years[t[138]]).sort(),l=[];for(let e=0;e<o.length;e+=1)l[e]=Ne(he(t,o,e));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=F(),n=D("br")},m(t,o){for(let e=0;e<l.length;e+=1)l[e].m(t,o);x(t,e,o),x(t,n,o)},p(t,n){if(128&n[0]|320&n[1]|131072&n[2]){let s;for(o=Object.keys(t[7]._opt.years[t[138]]).sort(),s=0;s<o.length;s+=1){const r=he(t,o,s);l[s]?l[s].p(r,n):(l[s]=Ne(r),l[s].c(),l[s].m(e.parentNode,e))}for(;s<l.length;s+=1)l[s].d(1);l.length=o.length}},d(t){C(l,t),t&&j(e),t&&j(n)}}}function Ie(t){let e,n,o,l,s,r,i,a=t[138]+"",p=t[53].str_icon_type[t[138]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(p),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[138],e.value=e.__value,z(e,"class",i="icon_type_"+t[53].iconType[t[138]]+" svelte-1jsovbn")},m(t,r){x(t,e,r),k(e,n),k(e,o),k(e,l),k(e,s)},p:h,d(t){t&&j(e)}}}function Ge(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,y,g,b,L,w,T,O,M,P,$,H,B,U,N,A,I,G,Z,R,Y,J=Object.keys(t[8]._opt.years).sort(),K=[];for(let e=0;e<J.length;e+=1)K[e]=Ze(ue(t,J,e));let V=Object.keys(t[8]._opt.years).sort(),Q=[];for(let e=0;e<V.length;e+=1)Q[e]=Ye(de(t,V,e));let X=t[52],tt=[];for(let e=0;e<X.length;e+=1)tt[e]=Je(pe(t,X,e));return{c(){e=D("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=F(),o=D("div"),o.innerHTML="Фильтры - <b>ДТП Очаги</b>",l=F(),s=D("div"),r=D("div"),i=D("fieldset"),a=D("legend"),a.textContent="Фильтрация по периодам:",p=F(),c=D("div"),d=D("input"),h=D("label"),h.textContent="Фильтрация по годам",v=F(),f=D("div");for(let t=0;t<K.length;t+=1)K[t].c();y=F(),g=D("div"),b=D("input"),w=D("label"),w.textContent="Фильтрация по кварталам",T=F(),O=D("div");for(let t=0;t<Q.length;t+=1)Q[t].c();M=F(),P=D("div"),$=D("select"),H=D("option"),H.textContent=`\n\t\t\t\t\t\tВсе типы (${t[52].reduce(t[123],0)})\n\t\t\t\t\t`;for(let t=0;t<tt.length;t+=1)tt[t].c();B=F(),U=D("div"),N=D("select"),A=D("option"),A.textContent="Очаги все",I=D("option"),I.textContent="Только с погибшими",G=D("option"),G.textContent="Только с пострадавшими",Z=D("option"),Z.textContent="С пострадавшими или погибшими",R=D("option"),R.textContent="С пострадавшими и погибшими",z(e,"class","pLine svelte-1jsovbn"),z(o,"class","pLine svelte-1jsovbn"),z(d,"type","radio"),d.__value=u=1,d.value=d.__value,d.checked=_=1===t[42],z(d,"id","hearths_period_type1"),z(d,"name","hearths_period_type"),z(d,"class","svelte-1jsovbn"),t[103][0].push(d),z(h,"for","hearths_period_type1"),z(h,"class","svelte-1jsovbn"),z(f,"class","pLine margin svelte-1jsovbn"),z(c,"class","pLine type svelte-1jsovbn"),z(b,"type","radio"),b.__value=L=2,b.value=b.__value,z(b,"id","hearths_period_type2"),z(b,"name","hearths_period_type"),z(b,"class","svelte-1jsovbn"),t[103][0].push(b),z(w,"for","hearths_period_type2"),z(w,"class","svelte-1jsovbn"),z(O,"class","pLine margin svelte-1jsovbn"),z(g,"class","pLine type svelte-1jsovbn"),z(r,"class","pLine nowrap svelte-1jsovbn"),H.__value="",H.value=H.__value,z(H,"class","svelte-1jsovbn"),z($,"class","multiple_icon_typeTmp svelte-1jsovbn"),$.multiple=!0,void 0===t[41]&&W(()=>t[124].call($)),z(P,"class","pLine svelte-1jsovbn"),A.__value="",A.value=A.__value,I.__value="1",I.value=I.__value,G.__value="2",G.value=G.__value,Z.__value="3",Z.value=Z.__value,R.__value="4",R.value=R.__value,z(N,"class","svelte-1jsovbn"),void 0===t[40]&&W(()=>t[125].call(N)),z(U,"class","pLine svelte-1jsovbn"),z(s,"class","filtersCont svelte-1jsovbn")},m(u,_,j){x(u,e,_),x(u,n,_),x(u,o,_),x(u,l,_),x(u,s,_),k(s,r),k(r,i),k(i,a),k(i,p),k(i,c),k(c,d),d.checked=d.__value===t[42],k(c,h),k(c,v),k(c,f);for(let t=0;t<K.length;t+=1)K[t].m(f,null);k(i,y),k(i,g),k(g,b),b.checked=b.__value===t[42],k(g,w),k(g,T),k(g,O);for(let t=0;t<Q.length;t+=1)Q[t].m(O,null);k(s,M),k(s,P),k(P,$),k($,H);for(let t=0;t<tt.length;t+=1)tt[t].m($,null);S($,t[41]),k(s,B),k(s,U),k(U,N),k(N,A),k(N,I),k(N,G),k(N,Z),k(N,R),q(N,t[40]),j&&m(Y),Y=[E(d,"change",t[80]),E(d,"change",t[121]),E(b,"change",t[80]),E(b,"change",t[122]),E($,"change",t[124]),E($,"change",t[80]),E(N,"change",t[125]),E(N,"change",t[80])]},p(t,e){if(2048&e[1]&&_!==(_=1===t[42])&&(d.checked=_),2048&e[1]&&(d.checked=d.__value===t[42]),256&e[0]|6144&e[1]|262144&e[2]){let n;for(J=Object.keys(t[8]._opt.years).sort(),n=0;n<J.length;n+=1){const o=ue(t,J,n);K[n]?K[n].p(o,e):(K[n]=Ze(o),K[n].c(),K[n].m(f,null))}for(;n<K.length;n+=1)K[n].d(1);K.length=J.length}if(2048&e[1]&&(b.checked=b.__value===t[42]),256&e[0]|10240&e[1]|262144&e[2]){let n;for(V=Object.keys(t[8]._opt.years).sort(),n=0;n<V.length;n+=1){const o=de(t,V,n);Q[n]?Q[n].p(o,e):(Q[n]=Ye(o),Q[n].c(),Q[n].m(O,null))}for(;n<Q.length;n+=1)Q[n].d(1);Q.length=V.length}if(3145728&e[1]){let n;for(X=t[52],n=0;n<X.length;n+=1){const o=pe(t,X,n);tt[n]?tt[n].p(o,e):(tt[n]=Je(o),tt[n].c(),tt[n].m($,null))}for(;n<tt.length;n+=1)tt[n].d(1);tt.length=X.length}1024&e[1]&&S($,t[41]),512&e[1]&&q(N,t[40])},d(r){r&&j(e),r&&j(n),r&&j(o),r&&j(l),r&&j(s),t[103][0].splice(t[103][0].indexOf(d),1),C(K,r),t[103][0].splice(t[103][0].indexOf(b),1),C(Q,r),C(tt,r),m(Y)}}}function Ze(t){let e,n,o,l,s,r,i,a,p=t[138]+"";return{c(){e=D("input"),s=D("label"),r=w(p),z(e,"type","checkbox"),z(e,"id","hearths_year"),e.checked=n=t[43][t[138]],e.disabled=o=2===t[42],z(e,"name",l=t[138]),z(e,"class","svelte-1jsovbn"),z(s,"for",i="hearths_year"+t[138]),z(s,"class","svelte-1jsovbn")},m(n,o,l){x(n,e,o),x(n,s,o),k(s,r),l&&a(),a=E(e,"change",t[80])},p(t,a){256&a[0]|4096&a[1]&&n!==(n=t[43][t[138]])&&(e.checked=n),2048&a[1]&&o!==(o=2===t[42])&&(e.disabled=o),256&a[0]&&l!==(l=t[138])&&z(e,"name",l),256&a[0]&&p!==(p=t[138]+"")&&P(r,p),256&a[0]&&i!==(i="hearths_year"+t[138])&&z(s,"for",i)},d(t){t&&j(e),t&&j(s),a()}}}function Re(t){let e,n,o,l,s,r,i,a,p,c,d=t[149]+"",u=t[138]+"";return{c(){e=D("input"),s=D("label"),r=w(d),i=w(" кв. "),a=w(u),z(e,"type","checkbox"),z(e,"id","hearths_quarter"),e.checked=n=t[44][t[138]]&&t[44][t[138]][t[149]],e.disabled=o=1===t[42],z(e,"name",l=t[138]+"_"+t[149]),z(e,"class","svelte-1jsovbn"),z(s,"for",p="hearths_quarter_"+t[138]+"_"+t[149]),z(s,"class","svelte-1jsovbn")},m(n,o,l){x(n,e,o),x(n,s,o),k(s,r),k(s,i),k(s,a),l&&c(),c=E(e,"change",t[80])},p(t,i){256&i[0]|8192&i[1]&&n!==(n=t[44][t[138]]&&t[44][t[138]][t[149]])&&(e.checked=n),2048&i[1]&&o!==(o=1===t[42])&&(e.disabled=o),256&i[0]&&l!==(l=t[138]+"_"+t[149])&&z(e,"name",l),256&i[0]&&d!==(d=t[149]+"")&&P(r,d),256&i[0]&&u!==(u=t[138]+"")&&P(a,u),256&i[0]&&p!==(p="hearths_quarter_"+t[138]+"_"+t[149])&&z(s,"for",p)},d(t){t&&j(e),t&&j(s),c()}}}function Ye(t){let e,n,o=Object.keys(t[8]._opt.years[t[138]]).sort(),l=[];for(let e=0;e<o.length;e+=1)l[e]=Re(ce(t,o,e));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=F(),n=D("br")},m(t,o){for(let e=0;e<l.length;e+=1)l[e].m(t,o);x(t,e,o),x(t,n,o)},p(t,n){if(256&n[0]|10240&n[1]|262144&n[2]){let s;for(o=Object.keys(t[8]._opt.years[t[138]]).sort(),s=0;s<o.length;s+=1){const r=ce(t,o,s);l[s]?l[s].p(r,n):(l[s]=Re(r),l[s].c(),l[s].m(e.parentNode,e))}for(;s<l.length;s+=1)l[s].d(1);l.length=o.length}},d(t){C(l,t),t&&j(e),t&&j(n)}}}function Je(t){let e,n,o,l,s,r,i,a=t[138]+"",p=t[51].str_icon_type[t[138]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(p),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[138],e.value=e.__value,z(e,"class",i="icon_type_"+t[51].iconType[t[138]]+" svelte-1jsovbn")},m(t,r){x(t,e,r),k(e,n),k(e,o),k(e,l),k(e,s)},p:h,d(t){t&&j(e)}}}function Ke(t){let e;return{c(){e=D("div"),e.textContent="Нет включенных слоев",z(e,"class","pLine svelte-1jsovbn")},m(t,n){x(t,e,n)},p:h,d(t){t&&j(e)}}}function Ve(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,y,g,b,L,C,T,O,M,q,S,H,B,U,N,A,I,G,Z,R,Y,J,K,V,W,Q,X,tt,et,nt,ot;return{c(){e=D("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=F(),o=D("div"),l=D("button"),s=F(),r=D("input"),i=F(),a=D("input"),p=F(),c=D("button"),d=F(),u=D("div"),_=D("br"),h=F(),v=D("label"),f=D("input"),g=D("span"),b=w("Мин.яркость ("),L=w(t[20]),C=w(")"),T=F(),O=D("br"),M=F(),q=D("label"),S=D("input"),B=D("span"),U=w("Радиус ("),N=w(t[18]),A=w(")"),I=F(),G=D("br"),Z=F(),R=D("label"),Y=D("input"),K=D("span"),V=w("Размытие ("),W=w(t[19]),Q=w(")"),X=F(),tt=D("div"),et=D("input"),nt=D("label"),nt.textContent="- тепловая карта",z(e,"class","pLine svelte-1jsovbn"),z(l,"class","pika-prev"),z(r,"type","text"),z(r,"class","begDate svelte-1jsovbn"),z(a,"type","text"),z(a,"class","endDate svelte-1jsovbn"),z(c,"class","pika-next"),z(o,"class","pikaday pLine svelte-1jsovbn"),z(f,"type","range"),z(f,"min","0.05"),z(f,"max","1"),z(f,"step","0.01"),f.disabled=y=!t[63],z(f,"class","svelte-1jsovbn"),z(v,"class","svelte-1jsovbn"),z(S,"type","range"),z(S,"min","0"),z(S,"max","100"),z(S,"step","1"),S.disabled=H=!t[63],z(S,"class","svelte-1jsovbn"),z(q,"class","svelte-1jsovbn"),z(Y,"type","range"),z(Y,"min","0"),z(Y,"max","15"),z(Y,"step","0.01"),Y.disabled=J=!t[63],z(Y,"class","svelte-1jsovbn"),z(R,"class","svelte-1jsovbn"),z(u,"class","pLine svelte-1jsovbn"),z(et,"type","checkbox"),et.checked=!0,z(et,"name","heat"),z(et,"class","svelte-1jsovbn"),z(nt,"for","heat"),z(nt,"class","svelte-1jsovbn"),z(tt,"class","pLine svelte-1jsovbn")},m(y,j,D){x(y,e,j),x(y,n,j),x(y,o,j),k(o,l),k(o,s),k(o,r),t[126](r),k(o,i),k(o,a),t[127](a),k(o,p),k(o,c),x(y,d,j),x(y,u,j),k(u,_),k(u,h),k(u,v),k(v,f),$(f,t[20]),k(v,g),k(g,b),k(g,L),k(g,C),k(u,T),k(u,O),k(u,M),k(u,q),k(q,S),$(S,t[18]),k(q,B),k(B,U),k(B,N),k(B,A),k(u,I),k(u,G),k(u,Z),k(u,R),k(R,Y),$(Y,t[19]),k(R,K),k(K,V),k(K,W),k(K,Q),x(y,X,j),x(y,tt,j),k(tt,et),t[131](et),k(tt,nt),D&&m(ot),ot=[E(l,"click",t[74]),E(c,"click",t[75]),E(f,"change",t[128]),E(f,"input",t[128]),E(f,"input",t[69]),E(S,"change",t[129]),E(S,"input",t[129]),E(S,"input",t[69]),E(Y,"change",t[130]),E(Y,"input",t[130]),E(Y,"input",t[69]),E(et,"change",t[68])]},p(t,e){1048576&e[0]&&$(f,t[20]),1048576&e[0]&&P(L,t[20]),262144&e[0]&&$(S,t[18]),262144&e[0]&&P(N,t[18]),524288&e[0]&&$(Y,t[19]),524288&e[0]&&P(W,t[19])},d(l){l&&j(e),l&&j(n),l&&j(o),t[126](null),t[127](null),l&&j(d),l&&j(u),l&&j(X),l&&j(tt),t[131](null),m(ot)}}}function We(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v;function f(t,e){return t[0]._arm?Xe:Qe}let y=f(t),g=y(t),b=t[45].collision_type&&function(t){let e,n,o,l,s=t[46],r=[];for(let e=0;e<s.length;e+=1)r[e]=tn(ae(t,s,e));return{c(){e=D("div"),n=D("select"),o=D("option"),o.textContent=`\n\t\t\t\t\t\tВсе типы (${t[46].reduce(t[132],0)})\n\t\t\t\t\t`;for(let t=0;t<r.length;t+=1)r[t].c();o.__value="",o.value=o.__value,z(o,"class","svelte-1jsovbn"),z(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===t[15]&&W(()=>t[133].call(n)),z(e,"class","pLine svelte-1jsovbn")},m(s,i,a){x(s,e,i),k(e,n),k(n,o);for(let t=0;t<r.length;t+=1)r[t].m(n,null);S(n,t[15]),a&&m(l),l=[E(n,"change",t[133]),E(n,"change",t[70])]},p(t,e){if(49152&e[1]){let o;for(s=t[46],o=0;o<s.length;o+=1){const l=ae(t,s,o);r[o]?r[o].p(l,e):(r[o]=tn(l),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=s.length}32768&e[0]&&S(n,t[15])},d(t){t&&j(e),C(r,t),m(l)}}}(t);return{c(){e=D("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=F(),o=D("div"),o.innerHTML="Фильтры - <b>ДТП Сводный</b>",l=F(),s=D("div"),r=D("div"),i=D("input"),a=D("label"),a.textContent="Все",p=F(),g.c(),c=F(),d=D("div"),u=D("input"),_=D("label"),_.textContent="Только ГИБДД",h=F(),b&&b.c(),z(e,"class","pLine svelte-1jsovbn"),z(o,"class","pLine svelte-1jsovbn"),z(i,"type","radio"),z(i,"id","d0"),z(i,"name","drone"),i.value="0",i.checked=!0,z(i,"class","svelte-1jsovbn"),z(a,"for","d0"),z(a,"class","svelte-1jsovbn"),z(r,"class","pLine svelte-1jsovbn"),z(u,"type","radio"),z(u,"id","d3"),z(u,"name","drone"),u.value="3",z(u,"class","svelte-1jsovbn"),z(_,"for","d3"),z(_,"class","svelte-1jsovbn"),z(d,"class","pLine svelte-1jsovbn"),z(s,"class","filtersCont svelte-1jsovbn")},m(f,y,j){x(f,e,y),x(f,n,y),x(f,o,y),x(f,l,y),x(f,s,y),k(s,r),k(r,i),k(r,a),k(s,p),g.m(s,null),k(s,c),k(s,d),k(d,u),k(d,_),k(s,h),b&&b.m(s,null),j&&m(v),v=[E(i,"click",t[73]),E(u,"click",t[73])]},p(t,e){y===(y=f(t))&&g?g.p(t,e):(g.d(1),g=y(t),g&&(g.c(),g.m(s,c))),t[45].collision_type&&b.p(t,e)},d(t){t&&j(e),t&&j(n),t&&j(o),t&&j(l),t&&j(s),g.d(),b&&b.d(),m(v)}}}function Qe(t){let e,n,o,l,s,r,i,a;return{c(){e=D("div"),n=D("input"),o=D("label"),o.textContent="Только Пересечения",l=F(),s=D("div"),r=D("input"),i=D("label"),i.textContent="Только СКПДИ",z(n,"type","radio"),z(n,"id","d1"),z(n,"name","drone"),n.value="1",z(n,"class","svelte-1jsovbn"),z(o,"for","d1"),z(o,"class","svelte-1jsovbn"),z(e,"class","pLine svelte-1jsovbn"),z(r,"type","radio"),z(r,"id","d2"),z(r,"name","drone"),r.value="2",z(r,"class","svelte-1jsovbn"),z(i,"for","d2"),z(i,"class","svelte-1jsovbn"),z(s,"class","pLine svelte-1jsovbn")},m(p,c,d){x(p,e,c),k(e,n),k(e,o),x(p,l,c),x(p,s,c),k(s,r),k(s,i),d&&m(a),a=[E(n,"click",t[73]),E(r,"click",t[73])]},p:h,d(t){t&&j(e),t&&j(l),t&&j(s),m(a)}}}function Xe(t){let e,n,o,l;return{c(){e=D("div"),n=D("input"),o=D("label"),o.textContent="Только Пересечения ГИБДД и СКПДИ",z(n,"type","radio"),z(n,"id","d1"),z(n,"name","drone"),n.value="1",z(n,"class","svelte-1jsovbn"),z(o,"for","d1"),z(o,"class","svelte-1jsovbn"),z(e,"class","pLine svelte-1jsovbn")},m(s,r,i){x(s,e,r),k(e,n),k(e,o),i&&l(),l=E(n,"click",t[73])},p:h,d(t){t&&j(e),l()}}}function tn(t){let e,n,o,l,s,r,i,a=t[138]+"",p=t[45].collision_type[t[138]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(p),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[138],e.value=e.__value,z(e,"class",i="icon_type_"+t[45].iconType[t[138]]+" svelte-1jsovbn")},m(t,r){x(t,e,r),k(e,n),k(e,o),k(e,l),k(e,s)},p:h,d(t){t&&j(e)}}}function en(t){let e,n,o,l,s,r=t[47].collision_type&&function(t){let e,n,o,l,s=t[48],r=[];for(let e=0;e<s.length;e+=1)r[e]=nn(ie(t,s,e));return{c(){e=D("div"),n=D("select"),o=D("option"),o.textContent=`\n\t\t\t\t\t\tВсе типы (${t[48].reduce(t[134],0)})\n\t\t\t\t\t`;for(let t=0;t<r.length;t+=1)r[t].c();o.__value="",o.value=o.__value,z(o,"class","svelte-1jsovbn"),z(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===t[16]&&W(()=>t[135].call(n)),z(e,"class","pLine svelte-1jsovbn")},m(s,i,a){x(s,e,i),k(e,n),k(n,o);for(let t=0;t<r.length;t+=1)r[t].m(n,null);S(n,t[16]),a&&m(l),l=[E(n,"change",t[135]),E(n,"change",t[72])]},p(t,e){if(196608&e[1]){let o;for(s=t[48],o=0;o<s.length;o+=1){const l=ie(t,s,o);r[o]?r[o].p(l,e):(r[o]=nn(l),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=s.length}65536&e[0]&&S(n,t[16])},d(t){t&&j(e),C(r,t),m(l)}}}(t);return{c(){e=D("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=F(),o=D("div"),o.innerHTML="Фильтры - <b>ДТП СКПДИ</b>",l=F(),s=D("div"),r&&r.c(),z(e,"class","pLine svelte-1jsovbn"),z(o,"class","pLine svelte-1jsovbn"),z(s,"class","filtersCont svelte-1jsovbn")},m(t,i){x(t,e,i),x(t,n,i),x(t,o,i),x(t,l,i),x(t,s,i),r&&r.m(s,null)},p(t,e){t[47].collision_type&&r.p(t,e)},d(t){t&&j(e),t&&j(n),t&&j(o),t&&j(l),t&&j(s),r&&r.d()}}}function nn(t){let e,n,o,l,s,r,i,a=t[138]+"",p=t[47].collision_type[t[138]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(p),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[138],e.value=e.__value,z(e,"class",i="icon_type_"+t[47].iconType[t[138]]+" svelte-1jsovbn")},m(t,r){x(t,e,r),k(e,n),k(e,o),k(e,l),k(e,s)},p:h,d(t){t&&j(e)}}}function on(t){let e,n,o,l,s,r=t[49].collision_type&&function(t){let e,n,o,l,s=t[50],r=[];for(let e=0;e<s.length;e+=1)r[e]=ln(re(t,s,e));return{c(){e=D("div"),n=D("select"),o=D("option"),o.textContent=`\n\t\t\t\t\t\tВсе типы (${t[50].reduce(t[136],0)})\n\t\t\t\t\t`;for(let t=0;t<r.length;t+=1)r[t].c();o.__value="",o.value=o.__value,z(o,"class","svelte-1jsovbn"),z(n,"class","multiple_icon_type svelte-1jsovbn"),n.multiple=!0,void 0===t[17]&&W(()=>t[137].call(n)),z(e,"class","pLine svelte-1jsovbn")},m(s,i,a){x(s,e,i),k(e,n),k(n,o);for(let t=0;t<r.length;t+=1)r[t].m(n,null);S(n,t[17]),a&&m(l),l=[E(n,"change",t[137]),E(n,"change",t[71])]},p(t,e){if(786432&e[1]){let o;for(s=t[50],o=0;o<s.length;o+=1){const l=re(t,s,o);r[o]?r[o].p(l,e):(r[o]=ln(l),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=s.length}131072&e[0]&&S(n,t[17])},d(t){t&&j(e),C(r,t),m(l)}}}(t);return{c(){e=D("div"),e.innerHTML='<hr class="svelte-1jsovbn">',n=F(),o=D("div"),o.innerHTML="Фильтры - <b>ДТП ГИБДД</b>",l=F(),s=D("div"),r&&r.c(),z(e,"class","pLine svelte-1jsovbn"),z(o,"class","pLine svelte-1jsovbn"),z(s,"class","filtersCont svelte-1jsovbn")},m(t,i){x(t,e,i),x(t,n,i),x(t,o,i),x(t,l,i),x(t,s,i),r&&r.m(s,null)},p(t,e){t[49].collision_type&&r.p(t,e)},d(t){t&&j(e),t&&j(n),t&&j(o),t&&j(l),t&&j(s),r&&r.d()}}}function ln(t){let e,n,o,l,s,r,i,a=t[138]+"",p=t[49].collision_type[t[138]]+"";return{c(){e=D("option"),n=w(a),o=w(" ("),l=w(p),s=w(")\n\t\t\t\t\t\t"),e.__value=r=t[138],e.value=e.__value,z(e,"class",i="icon_type_"+t[49].iconType[t[138]]+" svelte-1jsovbn")},m(t,r){x(t,e,r),k(e,n),k(e,o),k(e,l),k(e,s)},p:h,d(t){t&&j(e)}}}function sn(t){let e,n,o,l,s,r,i,a,p,c,d=t[3]._map&&t[3]._opt&&t[3]._opt.years&&De(t),u=t[4]._map&&t[4]._opt&&t[4]._opt.years&&Fe(t),_=t[5]._map&&t[5]._opt&&t[5]._opt.years&&Oe(t),v=t[6]._map&&t[6]._opt&&t[6]._opt.years&&Pe(t),f=t[7]._map&&t[7]._opt&&t[7]._opt.years&&Be(t),m=t[8]._map&&t[8]._opt&&t[8]._opt.years&&Ge(t);function y(t,e){return t[0]._map||t[1]._map||t[2]._map?Ve:t[8]._map||t[7]._map||t[3]._map?void 0:Ke}let g=y(t),b=g&&g(t),L=t[0]._map&&We(t),C=t[1]._map&&en(t),w=t[2]._map&&on(t);return{c(){e=D("div"),d&&d.c(),n=F(),u&&u.c(),o=F(),_&&_.c(),l=F(),v&&v.c(),s=F(),f&&f.c(),r=F(),m&&m.c(),i=F(),b&&b.c(),a=F(),L&&L.c(),p=F(),C&&C.c(),c=F(),w&&w.c(),z(e,"class","mvsFilters")},m(t,h){x(t,e,h),d&&d.m(e,null),k(e,n),u&&u.m(e,null),k(e,o),_&&_.m(e,null),k(e,l),v&&v.m(e,null),k(e,s),f&&f.m(e,null),k(e,r),m&&m.m(e,null),k(e,i),b&&b.m(e,null),k(e,a),L&&L.m(e,null),k(e,p),C&&C.m(e,null),k(e,c),w&&w.m(e,null)},p(t,h){t[3]._map&&t[3]._opt&&t[3]._opt.years?d?d.p(t,h):(d=De(t),d.c(),d.m(e,n)):d&&(d.d(1),d=null),t[4]._map&&t[4]._opt&&t[4]._opt.years?u?u.p(t,h):(u=Fe(t),u.c(),u.m(e,o)):u&&(u.d(1),u=null),t[5]._map&&t[5]._opt&&t[5]._opt.years?_?_.p(t,h):(_=Oe(t),_.c(),_.m(e,l)):_&&(_.d(1),_=null),t[6]._map&&t[6]._opt&&t[6]._opt.years?v?v.p(t,h):(v=Pe(t),v.c(),v.m(e,s)):v&&(v.d(1),v=null),t[7]._map&&t[7]._opt&&t[7]._opt.years?f?f.p(t,h):(f=Be(t),f.c(),f.m(e,r)):f&&(f.d(1),f=null),t[8]._map&&t[8]._opt&&t[8]._opt.years?m?m.p(t,h):(m=Ge(t),m.c(),m.m(e,i)):m&&(m.d(1),m=null),g===(g=y(t))&&b?b.p(t,h):(b&&b.d(1),b=g&&g(t),b&&(b.c(),b.m(e,a))),t[0]._map?L?L.p(t,h):(L=We(t),L.c(),L.m(e,p)):L&&(L.d(1),L=null),t[1]._map?C?C.p(t,h):(C=en(t),C.c(),C.m(e,c)):C&&(C.d(1),C=null),t[2]._map?w?w.p(t,h):(w=on(t),w.c(),w.m(e,null)):w&&(w.d(1),w=null)},i:h,o:h,d(t){t&&j(e),d&&d.d(),u&&u.d(),_&&_.d(),v&&v.d(),f&&f.d(),m&&m.d(),b&&b.d(),L&&L.d(),C&&C.d(),w&&w.d()}}}function rn(t,e,n){let o,l,{DtpHearthsPicket:s}=e,{DtpHearths5:r}=e,{DtpHearths3:i}=e,{DtpHearthsStat:a}=e,{DtpHearthsTmp:p}=e,{DtpHearths:c}=e,{DtpVerifyed:d}=e,{DtpSkpdi:u}=e,{DtpGibdd:_}=e,h=0;const v=new Date,f=new Date(new Date(v.getFullYear(),v.getMonth(),v.getDate()).getTime()),m=v,y=new Date(2018,0,1);let g,b,k,x=[y.getTime()/1e3,m.getTime()/1e3],j=d._opt||{},C=j.collision_type?Object.keys(j.collision_type).sort((t,e)=>j.collision_type[e]-j.collision_type[t]):[],D=u._opt||{},w=D.collision_type?Object.keys(D.collision_type).sort((t,e)=>D.collision_type[e]-D.collision_type[t]):[],F=_._opt||{},T=F.collision_type?Object.keys(F.collision_type).sort((t,e)=>F.collision_type[e]-F.collision_type[t]):[],E=c._opt||{},O=E.str_icon_type?Object.keys(E.str_icon_type).sort((t,e)=>E.str_icon_type[e]-E.str_icon_type[t]):[],z=p._opt||{},P=z.str_icon_type?Object.keys(z.str_icon_type).sort((t,e)=>z.str_icon_type[e]-z.str_icon_type[t]):[],$=a._opt||{},q=$.str_icon_type?Object.keys($.str_icon_type).sort((t,e)=>$.str_icon_type[e]-$.str_icon_type[t]):[],S=i._opt||{},U=S.str_icon_type?Object.keys(S.str_icon_type).sort((t,e)=>S.str_icon_type[e]-S.str_icon_type[t]):[],N=r._opt||{},I=N.str_icon_type?Object.keys(N.str_icon_type).sort((t,e)=>N.str_icon_type[e]-N.str_icon_type[t]):[],G=s._opt||{},Z=G.road?Object.keys(G.road).sort((t,e)=>G.road[e]-G.road[t]):[],Y=[""],J={hearth3:!0,hearth5:!0},K=null,V=null,W=[""],Q=[""],X=[""],tt={radius:19,blur:11.26,minOpacity:.34},et=tt.radius,nt=11.26,ot=.34;const lt=()=>{let t=[];V&&t.push({type:"id_dtp",zn:V}),K&&t.push({type:"id_hearth",zn:K}),Y&&t.push({type:"roads",zn:Y}),t.push({type:"ht",zn:J}),s.setFilter(t)},st=()=>{let t=[{type:"itemType",zn:h}];x&&t.push({type:"date",zn:x}),W&&t.push({type:"collision_type",zn:W}),d.setFilter(t)},rt=()=>{let t=[];x&&t.push({type:"date",zn:x}),X&&t.push({type:"collision_type",zn:X}),_.setFilter(t)},it=()=>{let t=[];x&&t.push({type:"date",zn:x}),Q&&t.push({type:"collision_type",zn:Q}),u.setFilter(t)};var at;at=()=>{let t={onSelect(t){this._o.field.value=this.toString(),x[this._o._dint]=this.getDate().getTime()/1e3+24*this._o._dint*60*60,st(),it(),rt()},toString(t,e){let n=t.getDate();n<10&&(n="0"+n);let o=t.getMonth()+1;return o<10&&(o="0"+o),`${n}.${o}.${t.getFullYear()}`},parse(t,e){const n=t.split("."),o=parseInt(n[0],10),l=parseInt(n[1],10)-1,s=parseInt(n[2],10);return new Date(s,l,o)},i18n:{previousMonth:"Предыдущий месяц",nextMonth:"Следующий месяц",months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],weekdays:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],weekdaysShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"]},format:"DD.MM.YYYY",setDefaultDate:!0,yearRange:20,blurFieldOnSelect:!1};g=new Pikaday(L.extend({},t,{_dint:0,field:o,defaultDate:new Date(1e3*x[0])})),b=new Pikaday(L.extend({},t,{_dint:1,field:l,defaultDate:new Date(1e3*x[1])}))},A().$$.on_mount.push(at);let pt,ct,dt=[""],ut=1,_t={},ht={};Object.keys(N.years||{}).sort().forEach(t=>{n(25,_t[t]=!0,_t),Object.keys(N.years[t]).sort().forEach(e=>{ct={},ct[t]={},ct[t][e]=!0})}),ht=ct||{};let vt,ft,mt=[""],yt=1,gt={},bt={};Object.keys(S.years||{}).sort().forEach(t=>{n(29,gt[t]=!0,gt),Object.keys(S.years[t]).sort().forEach(e=>{ft={},ft[t]={},ft[t][e]=!0})}),bt=ft||{};let kt,xt,jt=[""],Lt=1,Ct={},Dt={};Object.keys($.years||{}).sort().forEach(t=>{n(33,Ct[t]=!0,Ct),Object.keys($.years[t]).sort().forEach(e=>{xt={},xt[t]={},xt[t][e]=!0})}),Dt=xt||{};let wt,Ft,Tt=[""],Et=1,Ot={},zt={};Object.keys(z.years||{}).sort().forEach(t=>{n(38,Ot[t]=!0,Ot),Object.keys(z.years[t]).sort().forEach(e=>{Ft={},Ft[t]={},Ft[t][e]=!0})}),zt=Ft||{};let Mt,Pt,$t=[""],qt=1,St={},Ht={};Object.keys(E.years||{}).sort().forEach(t=>{n(43,St[t]=!0,St),Object.keys(E.years[t]).sort().forEach(e=>{Pt={},Pt[t]={},Pt[t][e]=!0})}),Ht=Pt||{};return t.$set=t=>{"DtpHearthsPicket"in t&&n(3,s=t.DtpHearthsPicket),"DtpHearths5"in t&&n(4,r=t.DtpHearths5),"DtpHearths3"in t&&n(5,i=t.DtpHearths3),"DtpHearthsStat"in t&&n(6,a=t.DtpHearthsStat),"DtpHearthsTmp"in t&&n(7,p=t.DtpHearthsTmp),"DtpHearths"in t&&n(8,c=t.DtpHearths),"DtpVerifyed"in t&&n(0,d=t.DtpVerifyed),"DtpSkpdi"in t&&n(1,u=t.DtpSkpdi),"DtpGibdd"in t&&n(2,_=t.DtpGibdd)},[d,u,_,s,r,i,a,p,c,o,l,Y,J,K,V,W,Q,X,et,nt,ot,k,pt,dt,ut,_t,vt,mt,yt,gt,kt,jt,Lt,Ct,Dt,wt,Tt,Et,Ot,zt,Mt,$t,qt,St,Ht,j,C,D,w,F,T,E,O,z,P,$,q,S,U,N,I,G,Z,tt,lt,t=>{let e=t.target.value;n(14,V=e||null),lt()},t=>{let e=t.target.value;n(13,K=e||null),lt()},t=>{let e=t.target;n(12,J[e.name]=e.checked,J),lt()},t=>{let e=t.target;n(2,_._needHeat=n(1,u._needHeat=n(0,d._needHeat=!!e.checked&&tt,d),u),_),rt(),it(),st()},()=>{let t={radius:et,blur:nt,minOpacity:ot};_._heat&&_._heat.setOptions(t),u._heat&&u._heat.setOptions(t),d._heat&&d._heat.setOptions(t)},st,rt,it,t=>{let e=t.target;h=Number(e.value),st()},()=>{let t=b.getDate(),e=g.getDate(),n=t-e;0===n&&(n=864e5),g.setDate(new Date(e.getTime()-n)),b.setDate(new Date(t.getTime()-n)),x=[g.getDate().getTime()/1e3,86400+b.getDate().getTime()/1e3],st()},()=>{let t=b.getDate(),e=g.getDate(),n=t-e;0===n&&(n=864e5),g.setDate(new Date(e.getTime()+n)),b.setDate(new Date(t.getTime()+n)),x=[g.getDate().getTime()/1e3,86400+b.getDate().getTime()/1e3],st()},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,i=o.name;if("hearths_period_type_52"===s)n(24,ut=2);else if("hearths_period_type_51"===s)n(24,ut=1);else if("hearths_year_5"===s)l?n(25,_t[i]=!0,_t):delete _t[i];else if("hearths_quarter_5"===s){let t=i.split("_");l?(ht[t[0]]||(ht[t[0]]={}),ht[t[0]][t[1]]=!0):(ht[t[0]]&&delete ht[t[0]][t[1]],0===Object.keys(ht[t[0]]).length&&delete ht[t[0]])}1===ut?e.push({type:"year",zn:_t}):2===ut&&e.push({type:"quarter",zn:ht}),pt&&e.push({type:"stricken",zn:Number(pt)}),dt.length>0&&dt[0]&&e.push({type:"str_icon_type",zn:dt}),r.setFilter(e)},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,r=o.name;if("hearths_period_type_32"===s)n(28,yt=2);else if("hearths_period_type_31"===s)n(28,yt=1);else if("hearths_year_3"===s)l?n(29,gt[r]=!0,gt):delete gt[r];else if("hearths_quarter_3"===s){let t=r.split("_");l?(bt[t[0]]||(bt[t[0]]={}),bt[t[0]][t[1]]=!0):(bt[t[0]]&&delete bt[t[0]][t[1]],0===Object.keys(bt[t[0]]).length&&delete bt[t[0]])}1===yt?e.push({type:"year",zn:gt}):2===yt&&e.push({type:"quarter",zn:bt}),vt&&e.push({type:"stricken",zn:Number(vt)}),mt.length>0&&mt[0]&&e.push({type:"str_icon_type",zn:mt}),i.setFilter(e)},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,r=o.name;if("hearths_period_type_Stat2"===s)n(32,Lt=2);else if("hearths_period_type_Stat1"===s)n(32,Lt=1);else if("hearths_year_Stat"===s)l?n(33,Ct[r]=!0,Ct):delete Ct[r];else if("hearths_quarter_Stat"===s){let t=r.split("_");l?(Dt[t[0]]||n(34,Dt[t[0]]={},Dt),n(34,Dt[t[0]][t[1]]=!0,Dt)):(Dt[t[0]]&&delete Dt[t[0]][t[1]],0===Object.keys(Dt[t[0]]).length&&delete Dt[t[0]])}1===Lt?e.push({type:"year",zn:Ct}):2===Lt&&e.push({type:"quarter",zn:Dt}),kt&&e.push({type:"stricken",zn:Number(kt)}),jt.length>0&&jt[0]&&e.push({type:"str_icon_type",zn:jt}),a.setFilter(e)},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,r=o.name;if("hearths_period_type_tmp2"===s)n(37,Et=2);else if("hearths_period_type_tmp1"===s)n(37,Et=1);else if("hearths_year_tmp"===s)l?n(38,Ot[r]=!0,Ot):delete Ot[r];else if("hearths_quarter_tmp"===s){let t=r.split("_");l?(zt[t[0]]||n(39,zt[t[0]]={},zt),n(39,zt[t[0]][t[1]]=!0,zt)):(zt[t[0]]&&delete zt[t[0]][t[1]],0===Object.keys(zt[t[0]]).length&&delete zt[t[0]])}1===Et?e.push({type:"year",zn:Ot}):2===Et&&e.push({type:"quarter",zn:zt}),wt&&e.push({type:"stricken",zn:Number(wt)}),Tt.length>0&&Tt[0]&&e.push({type:"str_icon_type",zn:Tt}),p.setFilter(e)},t=>{let e=[],o=t.target||{},l=o.checked,s=o.id,r=o.name;if(console.log("setFilterHearths",l,s,r,t),"hearths_period_type2"===s)n(42,qt=2);else if("hearths_period_type1"===s)n(42,qt=1);else if("hearths_year"===s)l?n(43,St[r]=!0,St):delete St[r];else if("hearths_quarter"===s){let t=r.split("_");l?(Ht[t[0]]||n(44,Ht[t[0]]={},Ht),n(44,Ht[t[0]][t[1]]=!0,Ht)):(Ht[t[0]]&&delete Ht[t[0]][t[1]],0===Object.keys(Ht[t[0]]).length&&delete Ht[t[0]])}1===qt?e.push({type:"year",zn:St}):2===qt&&e.push({type:"quarter",zn:Ht}),Mt&&e.push({type:"stricken",zn:Number(Mt)}),$t.length>0&&$t[0]&&e.push({type:"str_icon_type",zn:$t}),c.setFilter(e)},h,x,g,b,ht,ct,bt,ft,xt,Ft,Pt,v,f,m,y,void 0,void 0,void 0,void 0,(t,e)=>t+=G.road[e],function(){Y=B(this),n(11,Y),n(62,Z)},function(){ut=this.__value,n(24,ut)},[[],[],[],[],[]],(t,e)=>t+=N.str_icon_type[e],function(){dt=B(this),n(23,dt),n(60,I)},function(){pt=H(this),n(22,pt)},function(){yt=this.__value,n(28,yt)},(t,e)=>t+=S.str_icon_type[e],function(){mt=B(this),n(27,mt),n(58,U)},function(){vt=H(this),n(26,vt)},function(){Lt=this.__value,n(32,Lt)},function(){Lt=this.__value,n(32,Lt)},(t,e)=>t+=$.str_icon_type[e],function(){jt=B(this),n(31,jt),n(56,q)},function(){kt=H(this),n(30,kt)},function(){Et=this.__value,n(37,Et)},function(){Et=this.__value,n(37,Et)},(t,e)=>t+=z.str_icon_type[e],function(){Tt=B(this),n(36,Tt),n(54,P)},function(){wt=H(this),n(35,wt)},function(){qt=this.__value,n(42,qt)},function(){qt=this.__value,n(42,qt)},(t,e)=>t+=E.str_icon_type[e],function(){$t=B(this),n(41,$t),n(52,O)},function(){Mt=H(this),n(40,Mt)},function(t){R[t?"unshift":"push"](()=>{n(9,o=t)})},function(t){R[t?"unshift":"push"](()=>{n(10,l=t)})},function(){ot=M(this.value),n(20,ot)},function(){et=M(this.value),n(18,et)},function(){nt=M(this.value),n(19,nt)},function(t){R[t?"unshift":"push"](()=>{n(21,k=t)})},(t,e)=>t+=j.collision_type[e],function(){W=B(this),n(15,W),n(46,C)},(t,e)=>t+=D.collision_type[e],function(){Q=B(this),n(16,Q),n(48,w)},(t,e)=>t+=F.collision_type[e],function(){X=B(this),n(17,X),n(50,T)}]}se._needHeat={radius:19,blur:11.26,minOpacity:.34},se.checkZoom=t=>{Object.keys(se._layers).length?t<12&&se.setFilter(le):t>11&&se.setFilter(le)},se.setFilter=t=>{se.clearLayers(),le=t||[];let e=[],n=[];se._group&&(se._group.getLayers().forEach(t=>{let o=t.options.props,l=0;le.forEach(t=>{"itemType"===t.type?(0===t.zn||1===t.zn&&o.id_stat&&o.id_skpdi||2===t.zn&&o.id_skpdi&&!o.id_stat||3===t.zn&&o.id_stat&&!o.id_skpdi)&&l++:"collision_type"===t.type?(""===t.zn[0]||t.zn.filter(t=>t===o.collision_type).length)&&l++:"date"===t.type&&o.date>=t.zn[0]&&o.date<t.zn[1]&&l++}),l===le.length&&(e.push(t),n.push(t._latlng))}),se._needHeat?(se._map.addLayer(se._heat),se._heat.setLatLngs(n),se._heat.setOptions(se._needHeat),se._map._zoom>11&&se.addLayer(ne.layerGroup(e))):(se.addLayer(ne.layerGroup(e)),se._map.removeLayer(se._heat)))},se.on("remove",()=>{se._map.removeLayer(se._heat),se.clearLayers()}).on("add",t=>{se._heat=ne.heatLayer([],{interactive:!1}),fetch("https://dtp.mvs.group/scripts/index.php?request=get_collision",{}).then(t=>t.json()).then(t=>{let e={collision_type:{},iconType:{}},n=[],o=t.map(t=>{let o=t.iconType||0,l=[],s=!1,r="#2F4F4F";o&&(s=o%2==0,o>=1&&o<=6?r="#8B4513":7===o||8===o?r="#228B22":o>=9&&o<=14?r="#8B4513":15===o||16===o?r="#7B68EE":17!==o&&18!==o||(r="#2F4F4F")),t.id_skpdi&&l.push({type:"skpdi",id:t.id_skpdi}),t.id_stat&&l.push({type:"gibdd",id:t.id_stat}),t._cur=l,t.lat&&t.lon||(console.log("_______",t),t.lat=t.lon=0);let i=e.collision_type[t.collision_type];i?i++:i=1,e.collision_type[t.collision_type]=i,e.iconType[t.collision_type]=o;let a=ne.latLng(t.lat,t.lon,s?1:.5);return n.push(a),new _(a,{props:t,radius:6,triangle:l.length>1,box:!!t.id_skpdi,stroke:s,fillColor:r}).bindPopup(oe).on("popupopen",t=>{!function(t){let e=ne.DomUtil.create("div");new ee({target:e,props:{prp:t}}),oe.setContent(e)}(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});se.addLayer(se._heat),se._heat.setLatLngs(n),se._heat.setOptions(se._needHeat),se._opt=e,se._group=ne.layerGroup(o),le?se.setFilter(le):se.addLayer(se._group),se.checkZoom(se._map._zoom),se._refreshFilters()})});class an extends _t{constructor(t){super(),ut(this,t,rn,sn,g,{DtpHearthsPicket:3,DtpHearths5:4,DtpHearths3:5,DtpHearthsStat:6,DtpHearthsTmp:7,DtpHearths:8,DtpVerifyed:0,DtpSkpdi:1,DtpGibdd:2},[-1,-1,-1,-1,-1,-1])}}function pn(t,e,n){const o=t.slice();return o[7]=e[n],o[9]=n,o}function cn(t){let e,n,o,l,s,r,i,a,p,c,d,u=(t[0].piketaj_start_km||0)+"",_=(t[0].piketaj_finish_km||0)+"";return{c(){e=D("tr"),n=D("td"),n.textContent="Пикетаж:",o=F(),l=D("td"),s=w("От: "),r=D("b"),i=w(u),a=w(" км. до: "),p=D("b"),c=w(_),d=w(" км."),z(n,"class","first svelte-mnr9l0")},m(t,u){x(t,e,u),k(e,n),k(e,o),k(e,l),k(l,s),k(l,r),k(r,i),k(l,a),k(l,p),k(p,c),k(l,d)},p(t,e){1&e&&u!==(u=(t[0].piketaj_start_km||0)+"")&&P(i,u),1&e&&_!==(_=(t[0].piketaj_finish_km||0)+"")&&P(c,_)},d(t){t&&j(e)}}}function dn(t){let e,n;const o=new ee({props:{prp:t[7],closeMe:t[6]}});return{c(){e=D("div"),at(o.$$.fragment),z(e,"class","win leaflet-popup-content-wrapper  svelte-mnr9l0")},m(t,l){x(t,e,l),pt(o,e,null),n=!0},p(t,e){const n={};1&e&&(n.prp=t[7]),2&e&&(n.closeMe=t[6]),o.$set(n)},i(t){n||(rt(o.$$.fragment,t),n=!0)},o(t){it(o.$$.fragment,t),n=!1},d(t){t&&j(e),ct(o)}}}function un(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,y,g,b,L,C,T,O,M,$,q,S,H,B,U=Math.floor(t[7].piketaj_m/1e3)+"",N=t[7].piketaj_m%1e3+"",A=new Date(1e3*t[7].date).toLocaleDateString()+"",I=t[7].lost+"",G=t[7].stricken+"",Z=t[7].address+"";function R(...e){return t[4](t[9],...e)}function Y(...e){return t[5](t[9],...e)}let J=t[1]===t[9]&&dn(t);return{c(){e=D("tr"),n=D("td"),o=D("ul"),l=D("li"),s=w("Пикетаж: "),r=w(U),i=w(" км. "),a=w(N),p=w(" м."),c=F(),d=D("li"),u=w(A),_=w(" погибших "),h=w(I),v=w(", раненых "),f=w(G),g=F(),b=D("tr"),L=D("td"),L.textContent="Адрес:",C=F(),T=D("td"),O=w(Z),M=D("br"),$=D("span"),$.textContent="подробнее",q=F(),J&&J.c(),S=F(),z(l,"class","svelte-mnr9l0"),z(d,"title",y="id: "+t[7].id),z(d,"class","svelte-mnr9l0"),z(n,"class","first svelte-mnr9l0"),z(n,"colspan","2"),z(L,"class","first svelte-mnr9l0"),z($,"class","link svelte-mnr9l0")},m(t,y,j){x(t,e,y),k(e,n),k(n,o),k(o,l),k(l,s),k(l,r),k(l,i),k(l,a),k(l,p),k(o,c),k(o,d),k(d,u),k(d,_),k(d,h),k(d,v),k(d,f),x(t,g,y),x(t,b,y),k(b,L),k(b,C),k(b,T),k(T,O),k(T,M),k(T,$),k(T,q),J&&J.m(T,null),k(b,S),H=!0,j&&m(B),B=[E(d,"click",R),E($,"click",Y)]},p(e,n){t=e,(!H||1&n)&&U!==(U=Math.floor(t[7].piketaj_m/1e3)+"")&&P(r,U),(!H||1&n)&&N!==(N=t[7].piketaj_m%1e3+"")&&P(a,N),(!H||1&n)&&A!==(A=new Date(1e3*t[7].date).toLocaleDateString()+"")&&P(u,A),(!H||1&n)&&I!==(I=t[7].lost+"")&&P(h,I),(!H||1&n)&&G!==(G=t[7].stricken+"")&&P(f,G),(!H||1&n&&y!==(y="id: "+t[7].id))&&z(d,"title",y),(!H||1&n)&&Z!==(Z=t[7].address+"")&&P(O,Z),t[1]===t[9]?J?(J.p(t,n),rt(J,1)):(J=dn(t),J.c(),rt(J,1),J.m(T,null)):J&&(lt(),it(J,1,1,()=>{J=null}),st())},i(t){H||(rt(J),H=!0)},o(t){it(J),H=!1},d(t){t&&j(e),t&&j(g),t&&j(b),J&&J.d(),m(B)}}}function _n(t){let e,n,o,l,s,r,i,a,p,c,d,u,_,h,v,f,m,y,g,b,L,T,E,O,M,$,q,S,H,B,U,N,A,I,G,Z,R,Y,J,K,V,W=(t[0].id||t[0].id_hearth)+"",Q=t[0].quarter?t[0].quarter+" кв.":"",X=t[0].year+"",tt=(t[0].str_icon_type||"")+"",et=t[0].list_dtp.length+"",nt=t[0].count_lost+"",ot=t[0].count_stricken+"",at=t[0].piketaj_start_km&&cn(t),pt=t[0].list_dtp,ct=[];for(let e=0;e<pt.length;e+=1)ct[e]=un(pn(t,pt,e));const dt=t=>it(ct[t],1,1,()=>{ct[t]=null});return{c(){e=D("div"),n=D("div"),o=w("Очаг ДТП (id: "),l=w(W),s=w(")"),r=F(),i=D("div"),a=w(Q),p=F(),c=w(X),d=w("г."),u=F(),_=D("div"),h=D("table"),v=D("tbody"),at&&at.c(),f=F(),m=D("tr"),y=D("td"),y.textContent="Тип ДТП:",g=F(),b=D("td"),L=w(tt),T=F(),E=D("tr"),O=D("td"),O.textContent="Всего ДТП:",M=F(),$=D("td"),q=w(et),S=F(),H=D("tr"),B=D("td"),B.textContent="Погибших:",U=F(),N=D("td"),A=w(nt),I=F(),G=D("tr"),Z=D("td"),Z.textContent="Раненых:",R=F(),Y=D("td"),J=w(ot),K=F();for(let t=0;t<ct.length;t+=1)ct[t].c();z(n,"class","pLine"),z(i,"class","pLine"),z(y,"class","first svelte-mnr9l0"),z(O,"class","first svelte-mnr9l0"),z(B,"class","first svelte-mnr9l0"),z(Z,"class","first svelte-mnr9l0"),z(h,"class","table svelte-mnr9l0"),z(_,"class","featureCont"),z(e,"class","mvsPopup svelte-mnr9l0")},m(t,j){x(t,e,j),k(e,n),k(n,o),k(n,l),k(n,s),k(e,r),k(e,i),k(i,a),k(i,p),k(i,c),k(i,d),k(e,u),k(e,_),k(_,h),k(h,v),at&&at.m(v,null),k(v,f),k(v,m),k(m,y),k(m,g),k(m,b),k(b,L),k(v,T),k(v,E),k(E,O),k(E,M),k(E,$),k($,q),k(v,S),k(v,H),k(H,B),k(H,U),k(H,N),k(N,A),k(v,I),k(v,G),k(G,Z),k(G,R),k(G,Y),k(Y,J),k(v,K);for(let t=0;t<ct.length;t+=1)ct[t].m(v,null);V=!0},p(t,[e]){if((!V||1&e)&&W!==(W=(t[0].id||t[0].id_hearth)+"")&&P(l,W),(!V||1&e)&&Q!==(Q=t[0].quarter?t[0].quarter+" кв.":"")&&P(a,Q),(!V||1&e)&&X!==(X=t[0].year+"")&&P(c,X),t[0].piketaj_start_km?at?at.p(t,e):(at=cn(t),at.c(),at.m(v,f)):at&&(at.d(1),at=null),(!V||1&e)&&tt!==(tt=(t[0].str_icon_type||"")+"")&&P(L,tt),(!V||1&e)&&et!==(et=t[0].list_dtp.length+"")&&P(q,et),(!V||1&e)&&nt!==(nt=t[0].count_lost+"")&&P(A,nt),(!V||1&e)&&ot!==(ot=t[0].count_stricken+"")&&P(J,ot),7&e){let n;for(pt=t[0].list_dtp,n=0;n<pt.length;n+=1){const o=pn(t,pt,n);ct[n]?(ct[n].p(o,e),rt(ct[n],1)):(ct[n]=un(o),ct[n].c(),rt(ct[n],1),ct[n].m(v,null))}for(lt(),n=pt.length;n<ct.length;n+=1)dt(n);st()}},i(t){if(!V){for(let t=0;t<pt.length;t+=1)rt(ct[t]);V=!0}},o(t){ct=ct.filter(Boolean);for(let t=0;t<ct.length;t+=1)it(ct[t]);V=!1},d(t){t&&j(e),at&&at.d(),C(ct,t)}}}function hn(t,e,n){let o,{prp:l}=e;const s=t=>{let e=l._bounds.options.items[t];e&&e._map&&e._map.panTo(e._latlng)};return t.$set=t=>{"prp"in t&&n(0,l=t.prp)},[l,o,s,t=>{console.log("showDtpInfo ",t)},t=>{s(t)},t=>{n(1,o=t)},()=>{n(1,o=null)}]}class vn extends _t{constructor(t){super(),ut(this,t,hn,_n,g,{prp:0})}}const fn=window.L,mn=fn.popup(),yn=fn.popup({minWidth:200});let gn;const bn=function(t){let e=fn.DomUtil.create("div");return new ee({target:e,props:{prp:t}}),mn.setContent(e),e},kn=fn.featureGroup([]);kn.setFilter=t=>{kn.clearLayers(),gn=t;let e=[];kn._group&&(kn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;gn.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&n.count_lost||2===e&&n.count_stricken||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===gn.length&&e.push(t)}),kn.addLayer(fn.layerGroup(e)))},kn.on("remove",()=>{kn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearths/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=fn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c=e.str_icon_type[t.str_icon_type];c?c++:c=1,e.str_icon_type[t.str_icon_type]=c,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=fn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new _(fn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(mn).on("popupopen",t=>{bn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=fn.rectangle(l,{items:d,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{fn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._latlng.distanceTo(s);e<o&&(o=e,n=t)}),o<10?(bn(n.options.props),mn.setLatLng(n._latlng).openOn(kn._map)):(!function(t){let e=fn.DomUtil.create("div");new vn({target:e,props:{prp:t}}),yn.setContent(e)}(t),yn.setLatLng(s).openOn(kn._map))}),n.push(t._bounds),n=n.concat(d)}}),kn._opt=e,kn._group=fn.layerGroup(n),gn?kn.setFilter(gn):kn.addLayer(kn._group),kn._refreshFilters()}),console.log("__allJson_____",t,kn._opt)})});const xn=window.L,jn=xn.popup(),Ln=xn.popup({minWidth:200});let Cn;const Dn=function(t){let e=xn.DomUtil.create("div");return new ee({target:e,props:{prp:t}}),jn.setContent(e),e},wn=xn.featureGroup([]);wn.setFilter=t=>{wn.clearLayers(),Cn=t;let e=[];wn._group&&(wn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;Cn.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&n.count_lost||2===e&&n.count_stricken||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===Cn.length&&e.push(t)}),wn.addLayer(xn.layerGroup(e)))},wn.on("remove",()=>{wn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearthstmp/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=xn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c=e.str_icon_type[t.str_icon_type];c?c++:c=1,e.str_icon_type[t.str_icon_type]=c,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=xn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new _(xn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(jn).on("popupopen",t=>{Dn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=xn.rectangle(l,{items:d,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{xn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._latlng.distanceTo(s);e<o&&(o=e,n=t)}),o<10?(Dn(n.options.props),jn.setLatLng(n._latlng).openOn(wn._map)):(!function(t){let e=xn.DomUtil.create("div");new vn({target:e,props:{prp:t}}),Ln.setContent(e)}(t),Ln.setLatLng(s).openOn(wn._map))}),n.push(t._bounds),n=n.concat(d)}}),wn._opt=e,wn._group=xn.layerGroup(n),Cn?wn.setFilter(Cn):wn.addLayer(wn._group),wn._refreshFilters()}),console.log("__allJson_____",t,wn._opt)})});const Fn=window.L,Tn=Fn.popup(),En=Fn.popup({minWidth:200});let On;const zn=function(t){let e=Fn.DomUtil.create("div");return new ee({target:e,props:{prp:t}}),Tn.setContent(e),e},Mn=Fn.featureGroup([]);Mn.setFilter=t=>{Mn.clearLayers(),On=t;let e=[];Mn._group&&(Mn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;On.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&n.count_lost||2===e&&n.count_stricken||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===On.length&&e.push(t)}),Mn.addLayer(Fn.layerGroup(e)))},Mn.on("remove",()=>{Mn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearthsstat/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=Fn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c=e.str_icon_type[t.str_icon_type];c?c++:c=1,e.str_icon_type[t.str_icon_type]=c,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let d=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=Fn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new _(Fn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(Tn).on("popupopen",t=>{zn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=Fn.rectangle(l,{items:d,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}).on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{Fn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<o&&(o=e,n=t)}),o<10?(zn(n.options.props),Tn.setLatLng(n._latlng).openOn(Mn._map)):(!function(t){let e=Fn.DomUtil.create("div");new vn({target:e,props:{prp:t}}),En.setContent(e)}(t),En.setLatLng(s).openOn(Mn._map))}),n.push(t._bounds),n=n.concat(d)}}),Mn._opt=e,Mn._group=Fn.layerGroup(n),On?Mn.setFilter(On):Mn.addLayer(Mn._group),Mn._refreshFilters()}),console.log("__allJson_____",t,Mn._opt)})});const Pn=window.L,$n=Pn.popup(),qn=Pn.popup({minWidth:200});let Sn;const Hn=function(t){let e=Pn.DomUtil.create("div");return new ee({target:e,props:{prp:t}}),$n.setContent(e),e},Bn=Pn.featureGroup([]);Bn.setFilter=t=>{Bn.clearLayers(),Sn=t;let e=[];Bn._group&&(Bn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;Sn.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&n.count_lost||2===e&&n.count_stricken||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===Sn.length&&e.push(t)}),Bn.addLayer(Pn.layerGroup(e)))},Bn.on("remove",()=>{Bn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearths3/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=Pn.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c,d=e.str_icon_type[t.str_icon_type];d?d++:d=1,e.str_icon_type[t.str_icon_type]=d,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let u=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=Pn.latLng(o.lat,o.lon),a=[];l.extend(s),n.id===t.head&&(c=n),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new _(Pn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup($n).on("popupopen",t=>{Hn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=c?Pn.circle(Pn.latLng(c.coords.lat,c.coords.lon),{radius:t.radius||500,items:u,cluster:t,color:i}):Pn.rectangle(l,{items:u,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}),t._bounds.on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{Pn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<o&&(o=e,n=t)}),o<10?(Hn(n.options.props),$n.setLatLng(n._latlng).openOn(Bn._map)):(!function(t){let e=Pn.DomUtil.create("div");new vn({target:e,props:{prp:t}}),qn.setContent(e)}(t),qn.setLatLng(s).openOn(Bn._map))}),n.push(t._bounds),n=n.concat(u)}}),Bn._opt=e,Bn._group=Pn.layerGroup(n),Sn?Bn.setFilter(Sn):Bn.addLayer(Bn._group),Bn._refreshFilters()}),console.log("__allJson_____",t,Bn._opt)})});const Un=window.L,Nn=Un.popup(),An=Un.popup({minWidth:200});let In;const Gn=function(t){let e=Un.DomUtil.create("div");return new ee({target:e,props:{prp:t}}),Nn.setContent(e),e},Zn=Un.featureGroup([]);Zn.setFilter=t=>{Zn.clearLayers(),In=t;let e=[];Zn._group&&(Zn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;In.forEach(t=>{if("quarter"===t.type)t.zn[n.year]&&t.zn[n.year][n.quarter]&&o++;else if("year"===t.type)t.zn[n.year]&&o++;else if("str_icon_type"===t.type)t.zn.filter(t=>t===n.str_icon_type).length&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&!n.count_stricken&&n.count_lost||2===e&&n.count_stricken&&!n.count_lost||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===In.length&&e.push(t)}),Zn.addLayer(Un.layerGroup(e)))},Zn.on("remove",()=>{Zn.clearLayers()}).on("add",t=>{let e={str_icon_type:{},iconType:{},years:{},dtps:{}},n=[];Promise.all([2019,2020].map(t=>fetch("https://dtp.mvs.group/scripts/hearths5/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{let o=t.icon_type||1,l=Un.latLngBounds(),s=t.list_dtp,r=!1,i="#FF0000";if(s.length){Number(t.year),Number(t.quarter);let a=e.years[t.year];a||(a=e.years[t.year]={}),e.years[t.year]=a;let p=a[t.quarter];t.quarter in a?p++:p=a[t.quarter]=1,a[t.quarter]=p;let c,d=e.str_icon_type[t.str_icon_type];d?d++:d=1,e.str_icon_type[t.str_icon_type]=d,e.iconType[t.str_icon_type]=o,o&&(r=o%2==0,1===o||2===o?i="#FFA500":3===o||4===o?i="#B8860B":5===o||6===o?i="#CD853F":7===o||8===o?i="#228B22":9===o||10===o?i="#FF8C00":11===o||12===o?i="#D2691E":13===o||14===o?i="#DEB887":15===o||16===o?i="#7B68EE":17!==o&&18!==o||(i="#2F4F4F"));let u=s.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},s=Un.latLng(o.lat,o.lon),a=[];l.extend(s),n.id===t.head&&(c=n),n.id_skpdi&&a.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&a.push({type:"gibdd",id:n.id_stat}),n._cur=a;let p=e.dtps[n.id];return p?p[t.id]?p[t.id]++:p[t.id]=1:(p={},p[t.id]=1),e.dtps[n.id]=p,new _(Un.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:r,fillColor:i}).bindPopup(Nn).on("popupopen",t=>{Gn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});t._bounds=c?Un.circle(Un.latLng(c.coords.lat,c.coords.lon),{radius:t.radius||500,items:u,cluster:t,color:i}):Un.rectangle(l,{items:u,cluster:t,fill:!0,color:i,dashArray:"8 3 1"}),t._bounds.on("mouseover",t=>{let e=t.target;e._color=e.options.color,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{Un.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<o&&(o=e,n=t)}),o<10?(Gn(n.options.props),Nn.setLatLng(n._latlng).openOn(Zn._map)):(!function(t){let e=Un.DomUtil.create("div");new vn({target:e,props:{prp:t}}),An.setContent(e)}(t),An.setLatLng(s).openOn(Zn._map))}),n.push(t._bounds),n=n.concat(u)}}),Zn._opt=e,Zn._group=Un.layerGroup(n),In?Zn.setFilter(In):Zn.addLayer(Zn._group),Zn._refreshFilters()}),console.log("__allJson_____",t,Zn._opt)})});const Rn=window.L,Yn=Rn.popup(),Jn=Rn.popup({minWidth:200});let Kn;const Vn=function(t){let e=Rn.DomUtil.create("div");return new ee({target:e,props:{prp:t}}),Yn.setContent(e),e},Wn=Rn.featureGroup([]);Wn.setFilter=t=>{Wn.clearLayers(),Kn=t;let e=[];Wn._group&&(Wn._group.getLayers().forEach(t=>{let n=t.options.cluster,o=0;Kn.forEach(t=>{if("ht"===t.type)t.zn[n.ht]&&o++;else if("roads"===t.type)(t.zn.filter(t=>t===n.road).length||1===t.zn.length&&""===t.zn[0])&&o++;else if("id_dtp"===t.type)!n.list_dtp.filter(e=>e.id==t.zn).length&&t.zn.length||o++;else if("id_hearth"===t.type)t.zn==n.id_hearth&&o++;else if("stricken"===t.type){let e=t.zn;e?(1===e&&!n.count_stricken&&n.count_lost||2===e&&n.count_stricken&&!n.count_lost||3===e&&(n.count_stricken||n.count_lost)||3===e&&n.count_stricken&&n.count_lost)&&o++:o++}}),o===Kn.length&&e.push(t)}),Wn.addLayer(Rn.layerGroup(e)))},Wn.on("remove",()=>{Wn.clearLayers()}).on("add",t=>{let e={road:{},str_icon_type:{},iconType:{},years:{},dtps:{}},n=[],o=(t,o)=>{let l=t.icon_type||1,s=Rn.latLngBounds(),r=[],i=t.list_dtp,a=!1,p="#FF0000";if(t.ht=o,i.length){Number(t.year),Number(t.quarter);let o=e.years[t.year];o||(o=e.years[t.year]={}),e.years[t.year]=o;let c=o[t.quarter];t.quarter in o?c++:c=o[t.quarter]=1,o[t.quarter]=c;let d,u,h=e.str_icon_type[t.str_icon_type];h?h++:h=1,e.str_icon_type[t.str_icon_type]=h,e.iconType[t.str_icon_type]=l,t.road in e.road?e.road[t.road]++:e.road[t.road]=1,l&&(a=l%2==0,1===l||2===l?p="#FFA500":3===l||4===l?p="#B8860B":5===l||6===l?p="#CD853F":7===l||8===l?p="#228B22":9===l||10===l?p="#FF8C00":11===l||12===l?p="#D2691E":13===l||14===l?p="#DEB887":15===l||16===l?p="#7B68EE":17!==l&&18!==l||(p="#2F4F4F"));let v=i.map(n=>{n.iconType;let o=n.coords||{lat:0,lon:0},l=Rn.latLng(o.lat,o.lon),i=[];s.extend(l),r.push(l),n.id===t.head&&(d=n),u=n.dor_k,n.id_skpdi&&i.push({type:"skpdi",id:n.id_skpdi}),n.id_stat&&i.push({type:"gibdd",id:n.id_stat}),n._cur=i,e.dtps[u]||(e.dtps[u]={});let c=e.dtps[u][n.id],h=t.id||t.id_hearth;return c?c[h]?c[h]++:c[h]=1:(c={},c[h]=1),e.dtps[u][n.id]=c,new _(Rn.latLng(o.lat,o.lon),{cluster:t,props:n,radius:6,zIndexOffset:5e4,rhomb:!0,stroke:a,fillColor:p}).bindPopup(Yn).on("popupopen",t=>{Vn(t.target.options.props)}).on("popupclose",t=>{t.popup._svObj&&(t.popup._svObj.$destroy(),delete t.popup._svObj)})});d?t._bounds=Rn.circle(Rn.latLng(d.coords.lat,d.coords.lon),{radius:t.radius||500,items:v,cluster:t,color:p}):r.length?(4===u&&(p="blue"),t._bounds=Rn.polyline(r,{items:v,cluster:t,color:p,weight:4})):t._bounds=Rn.rectangle(s,{items:v,cluster:t,fill:!0,color:p,dashArray:"8 3 1"}),t._bounds.on("mouseover",t=>{let e=t.target;e._weight=e.options.weight,e._color=e.options.color,e.options.weight=8,e.options.color="red",e._renderer._updateStyle(e)}).on("mouseout",t=>{let e=t.target;e.options.weight=e._weight,e.options.color=e._color,e._renderer._updateStyle(e)}).on("click",e=>{Rn.DomEvent.stopPropagation(e);let n,o=1e3,l=e.target,s=e.latlng,r=e.layerPoint;e.originalEvent.ctrlKey&&l.bringToBack(),l.options.items.forEach(t=>{let e=t._point.distanceTo(r);e<o&&(o=e,n=t)}),o<10?(Vn(n.options.props),Yn.setLatLng(n._latlng).openOn(Wn._map)):(!function(t){let e=Rn.DomUtil.create("div");new vn({target:e,props:{prp:t}}),Jn.setContent(e)}(t),Jn.setLatLng(s).openOn(Wn._map))}),n.push(t._bounds),n=n.concat(v)}};Promise.all([2019].map(t=>fetch("https://dtp.mvs.group/scripts/hearths_picket/"+t+".txt",{}).then(t=>t.json()))).then(t=>{t.forEach(t=>{t.forEach(t=>{(t.hearth3||[]).forEach(t=>{o(t,"hearth3")}),(t.hearth5||[]).forEach(t=>{o(t,"hearth5")})}),Wn._opt=e,Wn._group=Rn.layerGroup(n),Kn?Wn.setFilter(Kn):Wn.addLayer(Wn._group),Wn._refreshFilters()}),console.log("__allJson_____",t,Wn._opt)})});const Qn=window.L,Xn=Qn.map(document.body,{center:[55.758031,37.611694],minZoom:1,zoom:8,maxZoom:21,attributionControl:!1,trackResize:!0,fadeAnimation:!0,zoomAnimation:!0,distanceUnit:"auto",squareUnit:"auto"});var to=Xn._controlCorners,eo=Xn._controlContainer,no="leaflet-top leaflet-bottom",oo="leaflet-left leaflet-right",lo={bottom:"leaflet-bottom "+oo,gmxbottomleft:"leaflet-bottom leaflet-left",gmxbottomcenter:"leaflet-bottom "+oo,gmxbottomright:"leaflet-bottom leaflet-right",center:no+" "+oo,right:"leaflet-right "+no,left:"leaflet-left "+no,top:"leaflet-top "+oo};for(var so in lo)to[so]||(to[so]=Qn.DomUtil.create("div",lo[so],eo));Xn.addControl(Qn.control.gmxCenter()).addControl(Qn.control.fitCenter());var ro=Qn.TileLayer.extend({options:{tilesCRS:Qn.CRS.EPSG3395},_getTiledPixelBounds:function(t){var e=Qn.TileLayer.prototype._getTiledPixelBounds.call(this,t);return this._shiftY=this._getShiftY(this._tileZoom),e.min.y+=this._shiftY,e.max.y+=this._shiftY,e},_tileOnError:function(t,e,n){var o=e.getAttribute("src"),l=o.indexOf("/mapcache/");if(l>-1){var s=new URL("http:"+o).searchParams,r=o.substr(l+1).split("/"),i=a[r[1]];e.src=Qn.Util.template(i.errorTileUrlPrefix+i.postfix,{z:s.get("z"),x:s.get("x"),y:s.get("y")})}t(n,e)},_getTilePos:function(t){return Qn.TileLayer.prototype._getTilePos.call(this,t).subtract([0,this._shiftY])},_getShiftY:function(t){var e=this._map,n=e.getCenter(),o=e.options.crs.project(n).y-this.options.tilesCRS.project(n).y;return Math.floor(Qn.CRS.scale(t)*o/40075016.685578495)}});Qn.TileLayer.Mercator=ro,Qn.tileLayer.Mercator=function(t,e){return new ro(t,e)};let io={};p.b||(p.b="m2"),["m2","m3"].forEach(t=>{let e=a[t],n=Qn.tileLayer.Mercator(e.prefix+e.postfix,e.options);io[e.title]=n,p.b===e.options.key&&n.addTo(Xn)}),io.OpenStreetMap=Qn.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:21,maxNativeZoom:18});let ao={"ДТП Очаги(Picket)":Wn,"ДТП Очаги(5)":Zn,"ДТП Очаги(3)":Bn,"ДТП Очаги(Stat)":Mn,"ДТП Очаги(tmp)":wn,"ДТП Очаги":kn,"ДТП Сводный":se,"ДТП СКПДИ":Jt,"ДТП ГИБДД":$t},po=p.o?p.o.split(",").reduce((t,e)=>(t[e]=!0,t),{}):{};["m1","m4","m5"].forEach(t=>{let e=a[t],n=Qn.tileLayer.Mercator(e.prefix+e.postfix,e.options);ao[e.title]=n,po[e.options.key]&&n.addTo(Xn)}),Qn.control.layers(io,ao).addTo(Xn);let co=Qn.control.gmxIcon({id:"filters",className:"leaflet-bar",togglable:!0,title:"Фильтры"}).on("statechange",(function(t){let e=t.target,n=e._container,o=e._win;e.options.isActive?o||(o=e._win=Qn.DomUtil.create("div","win leaflet-control-layers",n),Qn.DomEvent.disableScrollPropagation(o),o._Filters=new an({target:o,props:{DtpGibdd:$t,DtpSkpdi:Jt,DtpHearthsPicket:Wn,DtpHearths5:Zn,DtpHearths3:Bn,DtpHearthsStat:Mn,DtpHearthsTmp:wn,DtpHearths:kn,DtpVerifyed:se}})):(e._win.parentNode.removeChild(e._win),e._win=null)})).addTo(Xn);const uo=(t,e)=>{for(var n=Math.PI/180,o={lon:n*t.lng,lat:n*t.lat},l={lon:n*e.lng,lat:n*e.lat},s=6378137,r=6356752.3142,i=1/298.257223563,a=l.lon-o.lon,p=Math.atan((1-i)*Math.tan(o.lat)),c=Math.atan((1-i)*Math.tan(l.lat)),d=Math.sin(p),u=Math.cos(p),_=Math.sin(c),h=Math.cos(c),v=a,f=2*Math.PI,m=20;Math.abs(v-f)>1e-12&&--m>0;){var y=Math.sin(v),g=Math.cos(v),b=Math.sqrt(h*y*(h*y)+(u*_-d*h*g)*(u*_-d*h*g));if(0===b)return 0;var k=d*_+u*h*g,x=Math.atan2(b,k),j=u*h*y/b,L=1-j*j,C=k-2*d*_/L;isNaN(C)&&(C=0);var D=i/16*L*(4+i*(4-3*L));f=v,v=a+(1-D)*i*j*(x+D*b*(C+D*k*(2*C*C-1)))}if(0===m)return NaN;var w=L*(s*s/(r*r)-1),F=w/1024*(256+w*(w*(74-47*w)-128));return r*(1+w/16384*(4096+w*(w*(320-175*w)-768)))*(x-F*b*(C+F/4*(k*(2*C*C-1)-F/6*C*(4*b*b-3)*(4*C*C-3))))};let _o,ho;Xn.pm.setLang("customName",{tooltips:{finishLine:"Щелкните любой существующий маркер для завершения"}},"ru"),Xn.pm.setLang("ru"),Xn.on("pm:create",t=>{Xn.removeLayer(t.layer),vo.setActive(!1)}).on("pm:drawstart",t=>{let e=t.workingLayer;if("Line"===t.shape){let n=Xn.pm.Draw.Line._hintMarker;n&&n.on("move",(function(t){var o=e.getLatLngs();if(o.length){var l=(t=>{let e=0,n=(t=t||[])[0];return t.forEach(t=>{e+=uo(t,n),n=t}),e})(o),s=uo(o[o.length-1],t.latlng),r=(l+=s)>1e3?(l/1e3).toFixed(2)+" км":Math.ceil(l)+" м",i=s>1e3?(s/1e3).toFixed(2)+" км":Math.ceil(s)+" м";n._tooltip.setContent("Отрезок <b>("+i+")</b>участка <b>("+r+")</b>")}})),_o&&t.target.pm.Toolbar.buttons.drawPolyline.buttonsDomNode&&(ho=t.target.pm.Toolbar.buttons.drawPolyline.buttonsDomNode.children[1],ho.style.display="none")}});let vo=Qn.control.gmxIcon({id:"measure",className:"leaflet-bar",togglable:!0,title:"Включить/Отключить режим измерения расстояний"}).on("statechange",(function(t){_o=t.target.options.isActive,_o?Xn.pm.enableDraw("Line",{finishOn:"dblclick"}):(Xn.pm.disableDraw("Line"),ho&&(ho.style.display=""))})).addTo(Xn);const fo=()=>{setTimeout(()=>{co.options.isActive&&(co.setActive(!1),co._win=null,co.setActive(!0))})};$t._refreshFilters=Jt._refreshFilters=se._refreshFilters=kn._refreshFilters=Mn._refreshFilters=Bn._refreshFilters=Zn._refreshFilters=Wn._refreshFilters=wn._refreshFilters=fo;return $t.on("remove",fo),Jt.on("remove",fo),se.on("remove",fo),kn.on("remove",fo),wn.on("remove",fo),Mn.on("remove",fo),Bn.on("remove",fo),Zn.on("remove",fo),Wn.on("remove",fo),Xn.on("zoomend",t=>{Xn._crpx=0,console.log("zoomend ",Xn._zoom),se._map&&se.checkZoom(Xn._zoom),Jt._map&&Jt.checkZoom(Xn._zoom),$t._map&&$t.checkZoom(Xn._zoom)}),window._map=Xn,Xn}();
//# sourceMappingURL=main.js.map
